function $E(oID){var node="string"==typeof oID?document.getElementById(oID):oID;return null!=node?node:null}function $C(tagName){return document.createElement(tagName)}function $N(name){return document.getElementsByName(name)}function $T(obj,tagName){return obj.getElementsByTagName(tagName)}"undefined"==typeof Sina&&(Sina={}),Sina.pkg=function(ns){if(!ns||!ns.length)return null;for(var levels=ns.split("."),nsobj=Sina,i="Sina"==levels[0]?1:0;i<levels.length;++i)nsobj[levels[i]]=nsobj[levels[i]]||{},nsobj=nsobj[levels[i]];return nsobj};try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}function Jobs(oOption){this.option=oOption||{},this._jobTable=[[],[],[],[]]}!function(){var bind=function(fFunction,object){var __method=fFunction;return function(){return __method.apply(object,arguments)}};null!=window.Debug&&"undefined"!=typeof window.Debug.log||(window.Debug={cacheData:[],base_url:"//sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(sInfo){this.addData(sInfo,1)},error:function(sInfo){this.addData(sInfo,2)},warning:function(sInfo){this.addData(sInfo,3)},info:function(sInfo){this.addData(sInfo,4)},log:function(sInfo){this.addData(sInfo,5)},dir:function(oInfo){this.addData(oInfo,5)},addData:function(sInfo,nType,sColor,sBgColor){if(null!=sInfo){"object"!=typeof sInfo&&(sInfo=sInfo.toString());var oOption={type:nType||"5",color:sColor||this.baseColor[nType].color,bgcolor:sBgColor||this.baseColor[nType].bgcolor};this.cacheData.push([sInfo,oOption]),1==this.initFinished&&this.showCurrentData([sInfo,oOption])}}},window.trace=bind(window.Debug.log,window.Debug),window.traceError=bind(window.Debug.error,window.Debug))}(),Sina.pkg("Core"),"undefined"==typeof Core&&(Core=Sina.Core),Sina.pkg("Core.Array"),Core.Array.foreach=function(ar,insp){if(null==ar&&ar.constructor!=Array)return[];for(var i=0,len=ar.length,r=[];i<len;){var x=insp(ar[i],i);null!==x&&(r[r.length]=x),i++}return r},Sina.pkg("Core.Events"),function(_s){var _ua=navigator.userAgent.toLowerCase(),system={$winXP:/windows nt 5.1/.test(_ua),$winVista:/windows nt 6.0/.test(_ua),$win7:/windows nt 6.1/.test(_ua),$macOS:/mac/.test(_ua)},browser={$OPERA:!1,$IE6:!1,$IE7:!1,$IE8:!1,$IE9:!1,$SAFARI:!1,$FF2:!1,$FF3:!1,$FF4:!1,$FF:!1,$CHROME:!1,$TT:!1,$360:!1,$SOGO:!1,$Maxthon:!1},engine={$IE:0,$MOZ:!1,$WEBKIT:!1,$KHTML:!1};if(/opera/.test(_ua)||_s.opera)browser.$OPERA=!0;else if(/chrome\/(\S+)/.test(_ua))browser.$CHROME=!0;else if(/safari\/(\S+)/.test(_ua))browser.$SAFARI=!0;else if(/msie/.test(_ua)){engine.$IE=!0,/360se/.test(_ua)?browser.$360=!0:/tencenttraveler/.test(_ua)?browser.$TT=!0:/se\s\S+\smetasr\s\d+\.\d+/.test(_ua)&&(browser.$SOGO=!0);var uaVersionArray=_ua.match(/msie (\d+)/),version=parseInt(uaVersionArray[1]);engine.$IE=version,8===version?browser.$IE8=!0:6===version?browser.$IE6=!0:9===version?browser.$IE9=!0:7===version?browser.$IE7=!0:10===version&&(browser.$IE10=!0)}else if(/firefox/.test(_ua)){uaVersionArray=_ua.match(/firefox\/(\d+)/);browser.$FF=parseInt(uaVersionArray[1]),/firefox\/3/.test(_ua)?browser.$FF3=!0:/firefox\/4/.test(_ua)?browser.$FF4=!0:/firefox\/2/.test(_ua)&&(browser.$FF2=!0)}else/trident\/7.0/.test(_ua)&&/rv:11.0/.test(_ua)&&(engine.$IE=11,browser.$IE11=!0);try{var t=window.external;browser.$Maxthon=!!t.max_version}catch(e){}function apply(thisObj,cfg){var p;for(p in cfg)thisObj[p]=cfg[p]}/applewebkit\/(\S+)/.test(_ua)?engine.$WEBKIT=!0:/khtml\/(\S+)/.test(_ua)?engine.$KHTML=!0:/rv:([^\)]+)\) gecko\/\d{8}/.test(_ua)&&(engine.$MOZ=!0),browser.$MOBILE=/mobile/i.test(_ua),browser.$MOBILE||(browser.$MOBILE=/HTC/.test(_ua)),apply(_s,browser),apply(_s,engine),apply(_s,system)}(window),Core.Events.addEvent=function(elm,func,evType,useCapture){var _el="string"==typeof elm?$E(elm):elm;if(null!=_el){if(void 0===useCapture&&(useCapture=!1),void 0===evType&&(evType="click"),_el.addEventListener)return"mousewheel"==evType&&$FF&&(evType="DOMMouseScroll"),_el.addEventListener(evType,func,useCapture),!0;if(_el.attachEvent){_el.attachEvent("on"+evType,func);return!0}_el["on"+evType]=func}else trace("addEvent 找不到对象："+elm)},Core.Events.removeEvent=function(oElement,fHandler,sName){var _el=$E(oElement);null!=_el?"function"==typeof fHandler&&(void 0===sName&&(sName="click"),_el.addEventListener?_el.removeEventListener(sName,fHandler,!1):_el.attachEvent&&_el.detachEvent("on"+sName,fHandler),fHandler[sName]=null):trace("removeEvent 找不到对象："+oElement)},Sina.pkg("Core.Function"),Core.Function.bind3=function(fFunc,object,args){args=null==args?[]:args;var __method=fFunc;return function(){return __method.apply(object,args)}},Core.Array.findit=function(arr,v){var k=-1;return Core.Array.foreach(arr,(function(value,index){v==value&&(k=index)})),k},window.onerror=function(err,file,line){return trace("Error occured:"+err+"<br/>file:"+file+"<br/>line:"+line+"<br/>"),!0},Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(jobName,rel){this._registedJobTable[jobName]=rel},error:function(sMsg){Debug.error(sMsg),this.errorMsg.push(sMsg)},add:function(jobName,type){type=type||1,-1==Core.Array.findit(this._jobTable[type],jobName)?this._jobTable[type].push(jobName):this.error("Error: Job <b>"+jobName+"</b> is existed now.")},start:function(){null!=this.option.onStart&&this.option.onStart();this._registedJobTable;var jobs=this._jobTable[1].concat(this._jobTable[2]),_this=this;this.fe=Core.Function.bind3(_this.focus,_this,[]);this.queue(jobs,(function(){0!=_this._jobTable[3].length?(Core.Events.addEvent(document.body,_this.fe,"focus"),Core.Events.addEvent(window,_this.fe,"scroll"),Core.Events.addEvent(document.body,_this.fe,"mousemove"),Core.Events.addEvent(document.body,_this.fe,"mouseover")):null!=_this.option.onEnd&&_this.option.onEnd()}))},focus:function(){if(this.focusdown)return Core.Events.removeEvent(document.body,this.fe,"focus"),Core.Events.removeEvent(window,this.fe,"scroll"),Core.Events.removeEvent(document.body,this.fe,"mousemove"),Core.Events.removeEvent(document.body,this.fe,"mouseover"),void(this.fe=null);this.focusdown=!0;var jobs=this._jobTable[3];this.queue(jobs,this.option.onEnd)},queue:function(jobs,callback){var _this=this,getTime=function(){return(new Date).valueOf()},regJobs=this._registedJobTable,joblen=jobs.length,i=0,interNum=window.setInterval((function(){if(i>=joblen)return clearInterval(interNum),interNum=null,void(null!=callback&&callback());var jobName=jobs[i],job=regJobs[jobName];if(i++,void 0!==job){var _try=!0,_start=getTime();try{job.call()}catch(e){throw _this.error("<b>Job["+jobName+"] failed!!!</b>"+e.message),null!=callback&&callback(),_try=!1,e}finally{if(_try){var _end=getTime();Debug.info("<b>Job["+jobName+"] done in "+(_end-_start)+"ms.</b>")}}}else _this.error("<b>Job["+jobName+"] is undefiend!!!</b>")}),10)},call:function(jobName,args){"undefined"!=typeof this._registedJobTable[jobName]?this._registedJobTable[jobName].apply(this,args):trace("<b>Job["+jobName+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}},$registJob=function(name,rel){Jobs.prototype._registJob(name,rel)},$callJob=function(name){var args=[];arguments.length>1&&(Core.Array.foreach(arguments,(function(v,i){args[i]=v})),args.shift()),Jobs.prototype.call(name,args)},Sina.pkg("Core.Dom"),Core.Dom.insertHTML=function(el,html,where){if(el=$E(el)||document.body,where=where.toLowerCase()||"beforeend",el.insertAdjacentHTML){switch(where){case"beforebegin":return el.insertAdjacentHTML("BeforeBegin",html),el.previousSibling;case"afterbegin":return el.insertAdjacentHTML("AfterBegin",html),el.firstChild;case"beforeend":return el.insertAdjacentHTML("BeforeEnd",html),el.lastChild;case"afterend":return el.insertAdjacentHTML("AfterEnd",html),el.nextSibling}throw'Illegal insertion point -> "'+where+'"'}var frag,range=el.ownerDocument.createRange();switch(where){case"beforebegin":return range.setStartBefore(el),frag=range.createContextualFragment(html),el.parentNode.insertBefore(frag,el),el.previousSibling;case"afterbegin":return el.firstChild?(range.setStartBefore(el.firstChild),frag=range.createContextualFragment(html),el.insertBefore(frag,el.firstChild),el.firstChild):(el.innerHTML=html,el.firstChild);case"beforeend":return el.lastChild?(range.setStartAfter(el.lastChild),frag=range.createContextualFragment(html),el.appendChild(frag),el.lastChild):(el.innerHTML=html,el.lastChild);case"afterend":return range.setStartAfter(el),frag=range.createContextualFragment(html),el.parentNode.insertBefore(frag,el.nextSibling),el.nextSibling}throw'Illegal insertion point -> "'+where+'"'},Core.Dom.setStyle=function(el,property,val){switch(property){case"opacity":el.style.filter="alpha(opacity="+100*val+")",el.currentStyle&&el.currentStyle.hasLayout||(el.style.zoom=1);break;case"float":property="styleFloat";default:el.style[property]=val}},$IE&&$IE<9||(Core.Dom.setStyle=function(el,property,val){"float"==property&&(property="cssFloat"),el.style[property]=val}),Sina.pkg("Core.String"),Core.String.formatNumber=function(n){return(n+="").replace(/(\d{1,3})(?=(\d{3})+(?:$|\.))/g,"$1,")},Core.String.encodeHTML=function(str){var div=document.createElement("div");return div.appendChild(document.createTextNode(str)),div.innerHTML.replace(/\s/g,"&nbsp;")},Core.String.trimHead=function(str){return str.replace(/^(\u3000|\s|\t)*/gi,"")},Core.String.trimTail=function(str){return str.replace(/(\u3000|\s|\t)*$/gi,"")},Core.String.trim=function(str){return Core.String.trimHead(Core.String.trimTail(str))},Sina.pkg("Utils"),"undefined"==typeof Utils&&(Utils=Sina.Utils),Sina.pkg("Utils.Io"),Sina.pkg("Core.System"),Core.System.parseParam=function(oSource,oParams){var key;try{if(void 0!==oParams)for(key in oSource)null!=oParams[key]&&(oSource[key]=oParams[key])}finally{return key=null,oSource}},Utils.Url=function(url){url=url||"",this.url=url,this.query={},this.parse()},Utils.Url.prototype={parse:function(url){url&&(this.url=url),this.parseAnchor(),this.parseParam()},parseAnchor:function(){var anchor=this.url.match(/\#(.*)/);anchor=anchor?anchor[1]:null,this._anchor=anchor,null!=anchor&&(this.anchor=this.getNameValuePair(anchor),this.url=this.url.replace(/\#.*/,""))},parseParam:function(){var query=this.url.match(/\?([^\?]*)/);null!=(query=query?query[1]:null)&&(this.url=this.url.replace(/\?([^\?]*)/,""),this.query=this.getNameValuePair(query))},getNameValuePair:function(str){var o={};return str.replace(/([^&=]*)(?:\=([^&]*))?/gim,(function(w,n,v){""!=n&&(o[n]=v||"")})),o},getParam:function(sPara){return this.query[sPara]||""},clearParam:function(){this.query={}},setParam:function(name,value){if(null==name||""==name||"string"!=typeof name)throw new Error("no param name set");this.query=this.query||{},this.query[name]=value},setParams:function(o){this.query=o},serialize:function(o){var ar=[];for(var i in o)null==o[i]||""==o[i]?ar.push(i+"="):ar.push(i+"="+o[i]);return ar.join("&")},toString:function(){var queryStr=this.serialize(this.query);return this.url+(queryStr.length>0?"?"+queryStr:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(forceSharp){return this.anchor?"#"+this.serialize(this.anchor):forceSharp?"#":""}},Core.String.encodeDoubleByte=function(str){return"string"!=typeof str?str:encodeURIComponent(str)},Utils.Io.JsLoad={},function(){function createScripts(oOpts,oCFG){!function(oOpts,oCFG){var i,key,url_cls,varname,rnd,urls=oOpts.urls,get_hash=oOpts.GET,len=urls.length;for(i=0;i<len;i++){for(key in rnd=window.parseInt(1e8*Math.random()),url_cls=new Utils.Url(urls[i].url),get_hash)1==oOpts.noencode?url_cls.setParam(key,get_hash[key]):url_cls.setParam(key,Core.String.encodeDoubleByte(get_hash[key]));if(varname=url_cls.getParam("varname")||"requestId_"+rnd,1!=oOpts.noreturn&&url_cls.setParam("varname",varname),"jsonp"==oOpts.returnType){var name=url_cls.getParam("callback")||"callback_"+rnd,callback="script_callbackes."+name;url_cls.setParam("callback",callback),window.script_callbackes||(window.script_callbackes=[]),window.script_callbackes[name]=function(res){oCFG.is_loadcomplete=!0,delete window.script_callbackes[name],null!=oCFG.timeout_flag&&clearTimeout(oCFG.timeout_flag),oCFG.is_timeout||null!=oOpts.onComplete&&oOpts.onComplete(res)}}oCFG.script_var_arr.push(varname),urls[i].url=url_cls.toString(),urls[i].charset=urls[i].charset||oOpts.charset}}(oOpts,oCFG);var i,urls=oOpts.urls,len=urls.length;for(i=0;i<len;i++){var js=$C("script");js.src=urls[i].url,js.charset=urls[i].charset,js.onload=js.onerror=js.onreadystatechange=function(){js&&js.readyState&&"loaded"!=js.readyState&&"complete"!=js.readyState||(oCFG.script_loaded_num++,js.onload=js.onreadystatechange=js.onerror=null,!1!==oOpts.isRemove&&(js.src="",js.parentNode.removeChild(js)),js=null)},document.getElementsByTagName("head")[0].appendChild(js)}}function ancestor(aUrls,oOpts){var _opts={isRemove:!0,urls:[],charset:"utf-8",noreturn:!1,noencode:!1,returnType:"",timeout:-1,POST:{},GET:{},onComplete:null,onException:null},_cfg={script_loaded_num:0,is_timeout:!1,is_loadcomplete:!1,script_var_arr:[],timeout_flag:null};_opts.urls="string"==typeof aUrls?[{url:aUrls}]:aUrls,Core.System.parseParam(_opts,oOpts),createScripts(_opts,_cfg),"jsonp"!=_opts.returnType&&function(){if(1!=_opts.noreturn||null!=_opts.onComplete){var i,data=[];if(_cfg.script_loaded_num!=_opts.urls.length)1!=_cfg.is_timeout&&setTimeout(arguments.callee,50);else if(_cfg.is_loadcomplete=!0,null!=_opts.onComplete){for(i=0;i<_cfg.script_var_arr.length;i++)data.push(window[_cfg.script_var_arr[i]]);_cfg.script_var_arr.length<2?_opts.onComplete(data[0]):_opts.onComplete(data)}}}(),_opts.timeout>0&&(_cfg.timeout_flag=setTimeout((function(){1!=_cfg.is_loadcomplete&&(null!=_opts.onException&&_opts.onException(),_cfg.is_timeout=!0)}),_opts.timeout))}Utils.Io.JsLoad.request=function(aUrls,oOpts){new ancestor(aUrls,oOpts)}}(),Sina.pkg("Core.Class"),Core.Class.AsPrototype={},Core.Class.create=function(){return function(t){t!=Core.Class.AsPrototype&&this.initialize.apply(this,arguments)}},"undefined"==typeof Lib&&(Lib={}),Lib.pkg=function(ns){if(!ns||!ns.length)return null;for(var levels=ns.split("."),nsobj=Lib,i="Lib"==levels[0]?1:0;i<levels.length;++i)nsobj[levels[i]]=nsobj[levels[i]]||{},nsobj=nsobj[levels[i]];return nsobj},Lib.pkg("Lib.Component"),Lib.Component=Core.Class.create(),Lib.Component.instances=Lib.Component.instances||{},Lib.Component.compSize={},Lib.Component.getInitCompSize=function(){if(null!=scope.component_lists){var compList=scope.component_lists;for(var key in compList)compList[key].list.length>0&&Core.Array.foreach(compList[key].list,(function(oItem){Lib.Component.compSize[oItem]=compList[key].size}));return!0}return null},Lib.Component.refresh=function(sCompId,oOption){oOption=oOption||{};try{null==Lib.Component.instances[sCompId]&&("undefined"==typeof Lib.Component["Comp_"+sCompId]&&$registComp(sCompId,{},"static"),Lib.Component.instances[sCompId]=new Lib.Component["Comp_"+sCompId](sCompId))}catch(e){}Debug.log("刷新组件 "+sCompId+" ，新宽度是 "+oOption.width),Debug.log("组件 "+sCompId+" 增加管理链接："+oOption.addManage),Lib.Component.instances[sCompId].reload(oOption.width,oOption.addManage,oOption.forceRefresh)},Lib.Component.set=function(sCompId){Debug.log("展开组件 "+sCompId+" 的设置功能"),null==Lib.Component.instances[sCompId]&&(Lib.Component.instances[sCompId]=new Lib.Component["Comp_"+sCompId](sCompId)),Lib.Component.instances[sCompId].getUserSet()},Core.Class.extend=function(destination,supClass,bForce){for(var property in supClass)null!=bForce&&destination[property]||(destination[property]=supClass[property]);return destination},Core.Class.define=function(init,superClz,methods){if(init&&init.__isClass&&init.__isClass())throw new Error("class cnt be used as another class' constructor : "+init);if(superClz=superClz||Object,(methods=methods||{}).initialize=init||methods.initialize||superClz.prototype.initialize||function(){},"function"!=typeof methods.initialize)throw new Error("only function can be used as constructor");methods.__isClass=function(){return!0};var clz=Core.Class.create();clz.__isClass=methods.__isClass;var proto=superClz==Object?{}:new superClz(Core.Class.AsPrototype);return clz.prototype=Core.Class.extend(proto,methods),clz},$registComp=Lib.Component.registComp=function(id,override,superClass){superClass=(superClass=null==superClass?Lib.Component.Comp:Lib.Component["Comp_"+superClass])||Lib.Component.Comp,override.compId=id,Lib.Component["Comp_"+id]=Core.Class.define(null,superClass,override)},Core.Function.bind2=function(fFunc,object){var __method=fFunc;return function(){return __method.apply(object,arguments)}},Function.prototype.bind2=function(object){var __method=this;return function(){return __method.apply(object,arguments)}},Core.Dom.getElementsByClass=function(el,tg,clz){var rs=[];clz=" "+clz+" ";for(var cldr=(el=el||document).getElementsByTagName(tg),len=cldr.length,i=0;i<len;++i){var o=cldr[i];if(1==o.nodeType)-1!=(" "+o.className+" ").indexOf(clz)&&(rs[rs.length]=o)}return rs},Core.Dom.byClz=Core.Dom.getElementsByClass,Core.Dom.removeNode=function(node){node=$E(node)||node;try{node.parentNode.removeChild(node)}catch(e){}},Lib.Component.Comp=Core.Class.create(),Lib.Component.Comp.prototype={initialize:function(sId){return 1==this.isInit||null==sId||null==Lib.Component.compSize[sId]?void 0:(this.isInit=!0,this.compId=sId,this.size=Lib.Component.compSize[sId],Lib.Component.instances[sId]=this,this)},compId:null,getContainer:function(){return $E("module_"+this.compId)},getTitle:function(){return Core.Dom.getElementsByClass($E("module_"+this.compId),"span","title")[0]},getManage:function(){var manageNode=Core.Dom.getElementsByClass($E("module_"+this.compId),"span","edit");return 0!=manageNode.length?manageNode[0]:(Debug.error("组件添加管理链接失败，检查组件"+this.compId+"标题栏 SPAN[class=edit] 是否存在"),null)},getContent:function(){var contentNode=Core.Dom.getElementsByClass($E("module_"+this.compId),"div","SG_connBody");return 0!=contentNode.length?contentNode[0]:(Debug.error("组件内容节点获取失败，检查组件"+this.compId+"内 DIV[class=SG_connBody] 是否存在"),null)},load:function(){trace("load compId="+this.compId),this.setContent("")},reload:function(sSize){this.clearContent(),this.load()},setTitle:function(sTitle){var titleNode=this.getTitle();titleNode&&(titleNode.innerHTML=sTitle||"")},setManage:function(){var manageNode=this.getManage();$isAdmin&&manageNode&&(manageNode.innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>')},setContent:function(sContent){sContent="string"==typeof sContent?sContent:sContent+"",this.getContent().innerHTML=sContent||""},clearContent:function(){this.getContent().innerHTML=""},remove:function(){Core.Dom.removeNode(this.getContainer()),this.finalize()},finalize:function(){this.isInit=null,Lib.Component.instances[this.compId]=null}};var $SYSMSG={extend:function(info,override){for(var i in info)$SYSMSG[i]=0==!!override?info[i]:$SYSMSG[i]}};$SYSMSG.extend({A80001:"暂无内容。",A80002:"暂无内容。",A80101:"组件加载失败，请刷新。",A80201:"你要删除留下的访问记录吗？",A80202:'<div class="CP_w_cnt SG_txtb">删除后一小时内不会在此留下访问记录。</div>',A80203:"确实要删除此访问记录吗？",A80204:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_12_deleteToBlack" class="CP_w_fm1" /><label for="comp_12_deleteToBlack" >将此人加入黑名单</label></li></ul><div class="CP_w_cnt SG_txtb">加入黑名单的用户无法和你沟通。</div>'].join(""),A02003:"已添加过此模块，不能重复添加。",A02004:"抱歉，该模块不能被克隆。",A02005:"抱歉，您的博客尚未升级，请<a href='//blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“添加到您的博客”。",A02006:"模块已成功添加到你的博客。",A02007:"确实要隐藏此模块吗？隐藏后可在“页面设置”中恢复。",A02008:"确实要隐藏此模块吗？此模块活动时间已结束，隐藏后不可恢复。"}),$registComp("dynamic",{render_210:function(){},render_510:function(){},render_730:function(){},show:function(str){this.setContent(str)},showEmpty:function(sEmptyTips){this.setContent('<div class="SG_nodata2">'+(sEmptyTips||$SYSMSG.A80001)+"</div>")},showError:function(sStatusCode){this.setContent(sStatusCode)},setManage:function(){$isAdmin&&this.getManage()&&(this.getManage().innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>')},reload:function(sSize,bAddManage,bForceRequest){null==sSize||sSize&&(210==sSize||510==sSize||730==sSize)?(this.size=sSize||this.size,this.getContent().innerHTML='<div class="wdtLoading"><img src="//simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>',this.isSetOn=null,Debug.log("this.isSetOn : "+this.isSetOn),1==bForceRequest||null==this.cacheData?(Debug.log("强制刷新："+this.compId),this.load()):(Debug.log("缓存刷新："+this.compId),this["render_"+this.size]()),bAddManage&&this.setManage()):Debug.error("请检查传入的组件尺寸是否正确。"+sSize)}}),Sina.pkg("Utils.Cookie"),Utils.Cookie.getCookie=function(name){name=name.replace(/([\.\[\]\$])/g,"\\$1");var rep=new RegExp(name+"=([^;]*)?;","i"),res=(document.cookie+";").match(rep);return res&&res[1]||""},Core.System.keyValue=function(string,key){var arr=string.match(new RegExp("(\\?|&)"+key+"=([^&]*)(&|$)"));return null!=arr?arr[2]:null};var __reqCheckLogin__=function(){var isReqEnd=!1,isReq=!1,funQueue=[];return function(func){if(funQueue.push(func),!isReq)if(isReqEnd)func&&func();else{var times=(new Date).getTime();isReq=!0,window["__check_login_status__"+times]=function(data){isReq=!1;var user=data.user;$nick=user.nick||null,$UID=user.uid||null,$isLogin=!!$UID,"undefined"==typeof scope.$uid?$isAdmin=!1:$isAdmin=scope.$uid==$UID;try{delete window["__check_login_status__"+times],document.head.removeChild(document.getElementById("jsonp_script"+times))}catch(e){}isReqEnd=!0;for(var i=0;i<funQueue.length;i++)try{funQueue[i].call(null)}catch(e){console.log(e.stack)}};var script=document.createElement("script");script.id="jsonp_script"+times,script.src="//control.blog.sina.com.cn/riaapi/check_login.php?callback=__check_login_status__"+times,document.getElementsByTagName("head")[0].appendChild(script)}}}();Lib.checkAuthor=function(func,fileName){var AuthorInfo=Utils.Cookie.getCookie("SUBP");if(AuthorInfo&&""!=AuthorInfo){var arrSubp=sinaSSOEncoder.getSUBPCookie.decode(AuthorInfo);"undefined"!=typeof arrSubp.nick?$nick=decodeURIComponent(arrSubp.nick.replace(/(^\s*)|(\s*$)/g,"")):$nick="null","undefined"==typeof arrSubp.uid?($isLogin=!1,$UID=null):($UID=arrSubp.uid.replace(/(^\s*)|(\s*$)/g,""),$isLogin=!0),"undefined"==typeof scope.$uid?$isAdmin=!1:"undefined"!=typeof arrSubp.uid?($UID=arrSubp.uid.replace(/(^\s*)|(\s*$)/g,""),$isAdmin=scope.$uid==$UID):$isAdmin=!1,func&&fileName&&func()}else __reqCheckLogin__(func)},Core.Array.uniq=function(ar){for(var x,result=[],i=0;i<ar.length;i++)x=ar[i],-1==Core.Array.findit(result,x)&&result.push(x);return result},Lib.Uic={_interfaceMultiquery:"//uic.sso.sina.com.cn/uic/Mutiquery.php",_interfaceNick:"//hs.blog.sina.com.cn/users/",cacheNickName:{},cacheNickPic:{},getNickName:function(arrUidLists,fCallBack){for(var cache=this.cacheNickName,hitCache={},notHitCacheList=[],i=0;i<arrUidLists.length;i++){var uid=arrUidLists[i];cache[uid]?hitCache[uid]=cache[uid]:notHitCacheList.push(uid)}notHitCacheList.length>0?Utils.Io.JsLoad.request(this._interfaceNick+notHitCacheList.join(",")+"?fields=uname,avatar",{returnType:"jsonp",onComplete:function(result){if(result.success){for(var key in result.data)hitCache[key]=result.data[key].uname||"用户"+key,this.cacheNickName[key]=result.data[key].uname||"用户"+key,this.cacheNickPic[key]=result.data[key].avatar||{b:"//portrait"+(1*key%8+1)+".sinaimg.cn/"+key+"/blog/180",s:"//portrait"+(1*key%8+1)+".sinaimg.cn/"+key+"/blog/180",m:"//portrait"+(1*key%8+1)+".sinaimg.cn/"+key+"/blog/180"};fCallBack(hitCache)}}.bind2(this)}):fCallBack(hitCache)},getUserPic:function(key,fCallBack){this.cacheNickPic[key]?fCallBack(this.cacheNickPic[key]):Utils.Io.JsLoad.request(this._interfaceNick+key+"?fields=uname,avatar",{returnType:"jsonp",onComplete:function(result){if(result.success){for(var key in result.data)hitCache[key]=result.data[key].uname,this.cacheNickName[key]=result.data[key].uname||"用户"+key,this.cacheNickPic[key]=result.data[key].avatar||{b:"//portrait"+(1*key%8+1)+".sinaimg.cn/"+key+"/blog/180",s:"//portrait"+(1*key%8+1)+".sinaimg.cn/"+key+"/blog/180",m:"//portrait"+(1*key%8+1)+".sinaimg.cn/"+key+"/blog/180"};fCallBack(this.cacheNickPic[key])}}.bind2(this)})}},$registComp("901",{load:function(){var _this=this;Lib.checkAuthor((function(){0==$isAdmin&&$isLogin?_this.loadIsFriend():0!=$isAdmin||$isLogin?(_this.isOnline=!0,_this.showOnlineInfo()):(_this.isFriend=!1,_this.loadOnline()),_this.loadNickname(),_this.loadOtherInfo()}),"901_load"+(new Date).getTime())},loadIsFriend:function(){new Interface("//control.blog.sina.com.cn/riaapi/profile/IsFriend.php","jsload").request({GET:{friend_uids:scope.$uid,version:7},onSuccess:function(result){this.friendSuccessCallback(result)}.bind2(this),onError:function(result){this.friendErrorCallback()}.bind2(this),onFail:function(){this.friendErrorCallback()}.bind2(this)})},friendSuccessCallback:function(result){for(var i=0,len=result.length;i<len;i++)result[i].uid==scope.$uid&&(this.isFriend=1==result[i].status);this.isFriend=null!=this.isFriend&&this.isFriend,this.loadOnline()},friendErrorCallback:function(){this.isFriend=!1,this.loadOnline()},loadOnline:function(){if($isAdmin)this.isOnline=!0,this.showOnlineInfo();else{this.showVisitButton();Utils.Io.JsLoad.request("//online.sso.sina.com.cn/status/MutiqueryVProduct.php",{GET:{UIDS:"["+scope.$uid+"]",Check:scope.$key,ProductType:"1000",Verbose:"0",noencode:!0},onComplete:Core.Function.bind2((function(result){try{var _status=result.Status;this.isOnline=1==_status[0]}catch(e){this.isOnline=!!$isAdmin}this.showOnlineInfo()}),this),onException:Core.Function.bind2((function(){this.isOnline=!1,this.showOnlineInfo()}),this)})}},loadNickname:function(){Lib.Uic.getNickName([scope.$uid],Core.Function.bind2((function(oResult){this.showNickName(oResult)}),this))},showOnlineInfo:function(){},showNickName:function(){},showVisitButton:function(){},loadOtherInfo:function(){},mashAddFriend:!1,reload:function(sSize,bAddManage,bForceRequest){null==sSize||sSize&&(210==sSize||510==sSize||730==sSize)?(this.size=sSize||this.size,1==bForceRequest||null==this.cacheData?this.load():this["render_"+this.size](),bAddManage&&this.setManage()):Debug.error("请检查传入的组件尺寸是否正确。"+sSize)}},"dynamic"),Core.String.j2o=function(str){if(!str||""==str)return null;try{return window.eval("("+str+")")}catch(e){return trace("j2o : 数据分析出错"),traceError(e),null}},Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(null!=this.loadFrames)return!1;var rndId1="loadingIframe_thread"+Math.ceil(1e4*Math.random()),rndId2="loadingIframe_thread"+Math.ceil(1e4*(Math.random()+1));this.loadFrames=[rndId1,rndId2];var html='<iframe id="'+rndId1+'" name="'+rndId1+'" class="invisible"\t              scrolling="no" src=""\t              allowTransparency="true" style="display:none;" frameborder="0"\t              ></iframe>\t\t\t\t  <iframe id="'+rndId2+'" name="'+rndId2+'" class="invisible"\t              scrolling="no" src=""\t              allowTransparency="true" style="display:none;" frameborder="0"\t              ></iframe>',oIjaxIframeCnt=$C("div");oIjaxIframeCnt.id="ijax_iframes",oIjaxIframeCnt.innerHTML=html,trace("创建 Ijax 需要的 iframe"),document.body.appendChild(oIjaxIframeCnt);var loadTimer=setInterval(Core.Function.bind2((function(){null!=$E(this.loadFrames[0])&&null!=$E(this.loadFrames[1])&&(clearInterval(loadTimer),loadTimer=null,this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:!1},thread2:{container:$E(this.loadFrames[1]),isBusy:!1}},this.loadByList())}),this),10)},isIjaxReady:function(){if("undefined"==typeof this.loadingIframe)return!1;for(var oLoadCnt in this.loadingIframe)if(0==this.loadingIframe[oLoadCnt].isBusy)return this.loadingIframe[oLoadCnt].isBusy=!0,this.loadingIframe[oLoadCnt];return!1},request:function(url,option){var oTask={};oTask.url=url,oTask.option=option||{},this.arrTaskLists.push(oTask),null==this.loadFrames?this.createLoadingIframe():this.loadByList()},loadByList:function(){if(0==this.arrTaskLists.length)return!1;var loadStatus=this.isIjaxReady();if(0==loadStatus)return!1;var newData=this.arrTaskLists[0];this.loadData(newData.url,newData.option,loadStatus),this.arrTaskLists.shift()},loadData:function(url,option,loader){var _url=new Utils.Url(url);if(option.GET)for(var key in option.GET)_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]));/\bdomain\b/.test(url)||_url.setParam("domain","1"),_url=_url.toString();var ifm=loader.container;if(ifm.listener=Core.Function.bind2((function(){try{var sResult,iframeObject=ifm.contentWindow.document,tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];sResult=void 0!==tArea?tArea.value:iframeObject.body.innerHTML,option.onComplete?option.onComplete(sResult):option.onException()}catch(e){traceError(e),option.onException&&option.onException(e.message,_url.toString())}loader.isBusy=!1,Core.Events.removeEvent(ifm,ifm.listener,"load"),this.loadByList()}),this),Core.Events.addEvent(ifm,ifm.listener,"load"),option.POST){var oIjaxForm=$C("form");for(var oItem in oIjaxForm.id="IjaxForm",oIjaxForm.action=_url,oIjaxForm.method="post",oIjaxForm.target=ifm.id,option.POST){var value;value=option.noEncode?Core.String.encodeDoubleByte(option.POST[oItem]):option.POST[oItem];var oInput=$C("input");oInput.type="hidden",oInput.name=oItem,oInput.value=value,oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm),oIjaxForm.submit()}else try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}},Utils.Io.Ajax={createRequest:function(){var request=null;try{request=new XMLHttpRequest}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(othermicrosoft){try{request=ActiveXObject("Microsoft.XMLHTTP")}catch(failed){}}}if(null!=request)return request},request:function(url,option){return(option=option||{}).onComplete=option.onComplete||function(){},option.onException=option.onException||function(){},option.returnType=option.returnType||"txt",option.method=option.method||"get",option.data=option.data||{},"undefined"!=typeof option.GET&&"undefined"!=typeof option.GET.url_random&&0==option.GET.url_random&&(this.rand=!1,option.GET.url_random=null),this.loadData(url,option)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[],_url=new Utils.Url(url);if(option.POST)for(var postkey in option.POST){var postvalue=option.POST[postkey];null!=postvalue&&tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}var sParameter=tmpArr.join("&")||"";if(option.GET)for(var key in option.GET)"url_random"!=key&&_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]));this.rand,request.onreadystatechange=function(){if(4==request.readyState){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE)response=request.responseXML;else{var Dparser=new DOMParser;response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")")}option.onComplete(response)}catch(e){return option.onException(e.message,_url),!1}}};try{option.POST?(request.open("POST",_url,!0),request.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),request.withCredentials=!0,request.send(sParameter)):(request.open("GET",_url,!0),request.send(null))}catch(e){return option.onException(e.message,_url),!1}return request}},$IE6&&"undefined"!=typeof Utils.Io.Ijax&&(Utils.Io.Ijax.loadData=function(url,option,loader){var _url=new Utils.Url(url);if(option.GET)for(var key in option.GET)_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]));/\bdomain\b/.test(url)||_url.setParam("domain","1"),_url=_url.toString();var ifm=loader.container;if(ifm.listener=Core.Function.bind2((function(){try{var sResult,iframeObject=ifm.contentWindow.document,tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];sResult=void 0!==tArea?tArea.value:iframeObject.body.innerHTML,option.onComplete?option.onComplete(sResult):option.onException()}catch(e){traceError(e),option.onException&&option.onException(e.message,_url.toString())}loader.isBusy=!1,Core.Events.removeEvent(ifm,ifm.listener,"load"),this.loadByList()}),this),Core.Events.addEvent(ifm,ifm.listener,"load"),option.POST){var oIjaxForm=$C("form");for(var oItem in oIjaxForm.id="IjaxForm",oIjaxForm.action=_url,oIjaxForm.method="post",oIjaxForm.target=ifm.id,option.POST){var value;value=option.noEncode?Core.String.encodeDoubleByte(option.POST[oItem]):option.POST[oItem];var oInput=$C("input");oInput.type="hidden",oInput.name=oItem,oInput.value=value,oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);var timenum=100;!function innerfun(){if(timenum>0)try{oIjaxForm.submit()}catch(e){setTimeout(innerfun,10)}timenum--}()}else try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}});var Interface=function(url,type){this.url=new Utils.Url(url),this.type=type.toLowerCase()};function v6SendLog(type,label){}function v7sendLog(type,pageid,msg){}Interface.prototype={url:null,type:"",request:function(option){var err=option.onError,suc=option.onSuccess;option.onComplete=option.onSuccess=function(result){try{if("string"==typeof result&&(result=result.replace(/;$/,"")),null!=(result="string"==typeof result&&/\s*{/.test(result)?Core.String.j2o(result):result)&&"undefined"==typeof result.code)return void trace("接口数据异常："+this.url,"#F00");null!=result&&"A00006"==result.code?suc(result.data):err(result)}catch(e){traceError(e)}}.bind2(this),option.onException=option.onError=option.onFail||function(){if(trace("接口失败："+this.url,"#F00"),arguments.length>0)for(var i=0,len=arguments.length;i<len;i++)arguments[i]&&"undefined"!=typeof arguments[i]&&trace("错误信息："+arguments[i].toString())}.bind2(this);var requestURL=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(requestURL,option);break;case"ajax":Utils.Io.Ajax.request(requestURL,option);break;case"script":case"jsload":Utils.Io.JsLoad.request(requestURL,option);break;default:throw new Error("未指定有效的数据传输类型")}}},Function.prototype.$define=function(def){var k;for(k in def)this.prototype[k]=def[k];if(this.__interface__)for(k in this.prototype)if("NI"===this.prototype[k])throw new Error("类定义错误，接口方法["+k+"]未实现");return this.prototype.constructor=this,this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")},this},Function.prototype.$extends=function(){var sup,fn,me=this;if(0===arguments.length)throw new Error("$extends语句错误：未指定父类");return fn=function(){sup.apply(this,arguments),me.apply(this,arguments)},(fn.prototype=function(o){function F(){}return F.prototype=o,new F}((sup=arguments[0]).prototype)).constructor=fn,fn.$super=sup.prototype,fn},Function.prototype.$implements=function(){for(var k,arg=Array.prototype.slice.call(arguments,0),i=arg.length;i--;){if("object"!=typeof arg[i])throw new Error("$implements语句错误：参数必须为object类型");for(k in arg[i])"undefined"==typeof this.prototype[k]&&(this.prototype[k]="NI")}return this.__interface__=!0,this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")},this},Core.Events.getEvent=function(){return window.event},(!$IE||$IE>8)&&(Core.Events.getEvent=function(){if(!$IE&&window.event)return window.event;for(var e,o=arguments.callee.caller,n=0;null!=o&&n<40;){if((e=o.arguments[0])&&(e.constructor==Event||e.constructor==MouseEvent))return e;n++,o=o.caller}return e}),Core.Events.stopEvent=function(el){var ev=el||Core.Events.getEvent();null!=ev&&(ev.cancelBubble=!0,ev.returnValue=!1)},(!$IE||$IE>8)&&(Core.Events.stopEvent=function(el){var ev=el||Core.Events.getEvent();null!=ev&&(ev.preventDefault(),ev.stopPropagation())}),Sina.pkg("Ui"),"undefined"==typeof Ui&&(Ui=Sina.Ui),Ui.Template=function(tmpl){this.tmpl=tmpl,this.pattern=/(#\{(.*?)\})/g},Ui.Template.prototype={evaluate:function(data){return this.tmpl.replace(this.pattern,(function(){return data[arguments[2]]||""}))},evaluateMulti:function(data,reverse){var _buffer=[];return Core.Array.foreach(data,Core.Function.bind2((function(v,i){i=reverse?data.length-i:i,_buffer[i]=this.evaluate(v)}),this)),_buffer.join("")}},function(){function __checkFunction(fn){return"string"!=typeof fn&&"function"==String.prototype.slice.call(fn,0,8)}function __getValue(obj,fn){var ret=fn.call(obj);return"string"==typeof ret||"number"==typeof ret?ret:null}Core.Function.defineGetter=function(obj,p,fn){if(p instanceof Array&&fn instanceof Array)for(var i=Math.min(p.length,fn.length);i--;)"string"==typeof p[i]&&__checkFunction(fn[i])&&(obj[p[i]]={valueOf:function(j){return function(){return __getValue(obj,fn[j])}}(i),toString:this.valueOf});else"string"==typeof p&&__checkFunction(fn)&&(obj[p]={valueOf:function(){return __getValue(obj,fn)},toString:this.valueOf})}}(),Ui.IE6FixedController=function(){var me=this;this.node=null,this.iframeNode=null,this.__orgX=0,this.__orgY=0,this.__isBindScroll=!1,this.__fixedHandle=function(){me.node&&(me.node.style.left=document.documentElement.scrollLeft+me.__orgX+"px",me.node.style.top=document.documentElement.scrollTop+me.__orgY+"px"),me.iframeNode&&(me.iframeNode.style.left=me.node.style.left,me.iframeNode.style.top=me.node.style.top)}}.$define({setFixed:function(node,state){this.updateOrgPosition(),state&&!this.__isBindScroll&&(Core.Events.addEvent(window,this.__fixedHandle,"scroll"),this.__isBindScroll=!0),!state&&this.__isBindScroll&&(Core.Events.removeEvent(window,this.__fixedHandle,"scroll"),this.__isBindScroll=!1)},setPosition:function(node,fixedState,p){"undefined"!=typeof p.x&&(fixedState?(node.style.left=p.x+document.documentElement.scrollLeft+"px",this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft):node.style.left=p.x+"px"),"undefined"!=typeof p.y&&(fixedState?(node.style.top=p.y+document.documentElement.scrollTop+"px",this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop):node.style.top=p.y+"px"),"undefined"!=typeof p.z&&(node.style.zIndex=p.z)},getX:function(node,fixedState){return fixedState?parseInt(node.style.left)-document.documentElement.scrollLeft:parseInt(node.style.left)},getY:function(node,fixedState){return fixedState?parseInt(node.style.top)-document.documentElement.scrollTop:parseInt(node.style.top)},updateIframe:function(isFixed){this.setFixed(this.iframeNode,isFixed),isFixed&&this.__fixedHandle()},updateOrgPosition:function(){this.node&&(this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft,this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop)},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll"),this.__isBindScroll=!1,this.node=null,this.iframeNode=null}}),Core.Events.EventDispatcher=function(target){this.__target=target,this.__events={}}.$define({addEventListener:function(type,handle){if(this.__checkFunction(handle)){var evts=this.__events;!evts[type=type.toLowerCase()]&&(evts[type]=[]),evts[type].push(handle)}},removeEventListener:function(type,handle){var evts=this.__events[type];if(type=type.toLowerCase(),this.__checkFunction(handle)&&evts&&evts.length)for(var i=evts.length-1;i>=0;i--)evts[i]==handle&&evts.splice(i,1)},dispatchEvent:function(type){type=type.toLowerCase();var evts=this.__events[type];if(evts&&evts.length){var args=Array.prototype.slice.call(arguments,0);args.shift();for(var i=0,l=evts.length;i<l;i++)evts[i].apply(this.__target,args)}},__checkFunction:function(func){return"string"!=typeof func&&"function"==String.prototype.slice.call(func,0,8)}}),Ui.IRenderer={setCanShow:function(state){},setCanHidden:function(state){},show:function(node){},hidden:function(node){},addEventListener:function(type,handle){},removeEventListener:function(type,handle){}},Ui.SimpleRenderer=function(){this.__canShow=!0,this.__canHidden=!0,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(state){this.__canShow=!!state},setCanHidden:function(state){this.__canHidden=!!state},show:function(node){return this.__eventDispatcher.dispatchEvent("beforeShow"),this.__canShow&&(node.style.display="",this.__eventDispatcher.dispatchEvent("show")),this},hidden:function(node){return this.__eventDispatcher.dispatchEvent("beforeHidden"),this.__canHidden&&(node.style.display="none",this.__eventDispatcher.dispatchEvent("hidden")),this},addEventListener:function(type,handle){return this.__eventDispatcher.addEventListener(type,handle),this},removeEventListener:function(type,handle){return this.__eventDispatcher.removeEventListener(type,handle),this}}),Ui.DisplayObject=function(parent,node){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]),this.__renderer=null,this.__entity=node,this.__isInited=!1,this.__parent=parent||document.body,this.__eventDispatcher=new Core.Events.EventDispatcher(this);var ed=this.__eventDispatcher;this.__onBeforeShow=function(){ed.dispatchEvent("beforeShow")},this.__onShow=function(){ed.dispatchEvent("show")},this.__onBeforeHidden=function(){ed.dispatchEvent("beforeHidden")},this.__onHidden=function(){ed.dispatchEvent("hidden")},this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(p){return!this.__isInited&&this.__initEntity(),"undefined"!=typeof p.x&&(this.__entity.style.left=p.x+"px"),"undefined"!=typeof p.y&&(this.__entity.style.top=p.y+"px"),"undefined"!=typeof p.z&&(this.__entity.style.zIndex=p.z),this},setSize:function(p){return!this.__isInited&&this.__initEntity(),"undefined"!=typeof p.width&&(this.__entity.style.width=p.width+"px"),"undefined"!=typeof p.height&&(this.__entity.style.height=p.height+"px"),this},setRenderer:function(rendererConstructor){return!this.__isInited&&this.__initEntity(),this.__updateRenderer(rendererConstructor),this},show:function(rendererConstructor){return this.isHidden=!1,this.isShow=!0,!this.__isInited&&this.__initEntity(),this.__updateRenderer(rendererConstructor),this.__renderer.show(this.__entity),this},hidden:function(rendererConstructor){return this.hide(rendererConstructor)},hide:function(rendererConstructor){return this.isHidden=!0,this.isShow=!1,!this.__isInited&&this.__initEntity(),this.__updateRenderer(rendererConstructor),this.__renderer.hidden(this.__entity),this},setCanShow:function(state){return this.__renderer.setCanShow(state),this},setCanHidden:function(state){return this.__renderer.setCanHidden(state),this},addEventListener:function(type,handle){return this.__eventDispatcher.addEventListener(type,handle),this},removeEventListener:function(type,handle){return this.__eventDispatcher.removeEventListener(type,handle),this},destroy:function(){this.__entity&&(!this.__isInited&&this.__initEntity(),this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity),this.__entity=null)},__initEntity:function(){var st;!this.__entity&&(this.__entity=$C("div")),(st=this.__entity.style).position="absolute",st.left=0,st.top=0,!this.__entity.parentNode&&this.__parent.appendChild(this.__entity),this.__isInited=!0},__updateRenderer:function(rendererConstructor){if(rendererConstructor){var addEvent=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};this.__renderer?this.__renderer.constructor!==rendererConstructor&&(this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden),this.__renderer=new rendererConstructor,addEvent.call(this)):(this.__renderer=new rendererConstructor,addEvent.call(this))}},__getX:function(){return!this.__isInited&&this.__initEntity(),parseInt(this.__entity.style.left)},__getY:function(){return!this.__isInited&&this.__initEntity(),parseInt(this.__entity.style.top)},__getZ:function(){return!this.__isInited&&this.__initEntity(),parseInt(this.__entity.style.zIndex)},__getWidth:function(){return!this.__isInited&&this.__initEntity(),this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){return!this.__isInited&&this.__initEntity(),this.__getSize(this.__entity,"offsetHeight")},__getSize:function(node,p){var v,et=node,ov=et.style.visibility;return"none"==et.style.display?(et.style.visibility="hidden",et.style.display="",v=et[p],et.style.display="none",et.style.visibility=ov):v=et[p],v}}),Ui.Panel=function(parent,node){this.nodes={},this.uniqueID=this.__getUniqueID(),this.entity=null,this.__iframe=null,this.__isSetAdamant=!1,this.__templateNodesIDs=[],this.__isFixed=!1,$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController)}.$extends(Ui.DisplayObject).$define({setTemplate:function(tpl){var nd=$C("div");return nd.innerHTML=new Ui.Template(tpl).evaluate(this.__getNodes(tpl,"i")),nd.style.display="none",this.__parent.appendChild(nd),this.__updateTemplate(nd),this.nodes=this.__getNodes(tpl),this.entity=this.__entity,this.nodes.panel=this.entity,this},setFixed:function(state){!this.__isInited&&this.__initEntity();var x=parseInt(this.__entity.style.left),y=parseInt(this.__entity.style.top);return $IE6?(this.__ie6FixedController.setFixed(this.__entity,state),this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,state)):(state&&!this.__isFixed&&(this.setPosition({x:x-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:y-Math.max(document.documentElement.scrollTop,document.body.scrollTop)}),this.__entity.style.position="fixed"),!state&&this.__isFixed&&(this.setPosition({x:x+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:y+Math.max(document.documentElement.scrollTop,document.body.scrollTop)}),this.__entity.style.position="absolute")),this.__isFixed=!!state,this.__updateIframe(),this},setAdamant:function(state){return this.__isSetAdamant=!!state,this.__isSetAdamant&&!this.__iframe&&this.__createIframe(),this.__updateIframe(),this},destroy:function(){this.__entity&&(Ui.Panel.$super.destroy.call(this),this.__ie6FixedController&&this.__ie6FixedController.destroy(),this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe))},setPosition:function(p){return!this.__isInited&&this.__initEntity(),$IE6?this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,p):Ui.Panel.$super.setPosition.call(this,p),this.__updateIframe(),this},setSize:function(p){return Ui.Panel.$super.setSize.call(this,p).__updateIframe(),this},show:function(renderer){return Ui.Panel.$super.show.call(this,renderer).__updateIframe(),this},hidden:function(renderer){return Ui.Panel.$super.hidden.call(this,renderer).__updateIframe(),this},__getX:function(){return!this.__isInited&&this.__initEntity(),$IE6?this.__ie6FixedController.getX(this.__entity,this.__isFixed):parseInt(this.__entity.style.left)},__getY:function(){return!this.__isInited&&this.__initEntity(),$IE6?this.__ie6FixedController.getY(this.__entity,this.__isFixed):parseInt(this.__entity.style.top)},__createIframe:function(){this.__iframe=$C("iframe"),this.__iframe.frameBorder="none",this.__parent.insertBefore(this.__iframe,this.__entity),Core.Dom.setStyle(this.__iframe,"opacity",0),this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe),this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var st=this.__iframe.style;st.backgroundColor="#ffffff",st.left=this.x+"px",st.top=this.y+"px",st.width=this.width+"px",st.height=this.height+"px",st.position=this.__entity.style.position,st.display=this.__entity.style.display,st.zIndex=this.__entity.style.zIndex,$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(nd){var l,t,z,p,d,et=this.__entity;if(et?(et.parentNode&&et.parentNode.removeChild(et),l=et.style.left,t=et.style.top,z=et.style.zIndex,p=et.style.position,d=et.style.display):d="none",(et=this.__entity=$E("_"+this.uniqueID+"_panel"))||(et=this.__entity=$E("_"+this.uniqueID+"_entity")),!et)throw new Error("[Panel Error]there missing identifier #{panel} in panel template");et.style.left=l||0,et.style.top=t||0,et.style.zIndex=z||0,et.style.position=p||"absolute",et.style.display=d,this.__parent.replaceChild(et,nd),this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(template,mode){var i,rets,r,m=mode||"o",nodes={};if(this.__templateNodesIDs=template.match(/\{[^\}]+(?=\})/g),rets=this.__templateNodesIDs)for(i=rets.length;i--;)switch(r=rets[i].replace("{",""),m){case"o":nodes[r]=$E("_"+this.uniqueID+"_"+r);break;case"i":nodes[r]="_"+this.uniqueID+"_"+r}return nodes},__getUniqueID:function(){return parseInt(1e3*Math.random()).toString()+(new Date).getTime().toString()},setContent:function(str){this.nodes.content&&(this.nodes.content.innerHTML=str)},getNodes:function(){return this.nodes}}),Ui.Drag=function(captureNode,attachNodes,isDragCapureNode){var me=this;this.canDrag=!0,this.isLock=!1,this.lockArea={left:0,right:0,top:0,bottom:0},this.__captureNode=captureNode,this.__dragNodes=[],this.__deltaX=[],this.__deltaY=[],this.__eventDispatcher=new Core.Events.EventDispatcher(this),this.__isDraging=!1,this.__canDragX=!0,this.__canDragY=!0,this.__dragHandle=function(){me.__drag()},this.__mouseDownHandle=function(){me.__isDraging=!0,me.__eventDispatcher.dispatchEvent("beforeDrag"),me.__setCapture(!0)},this.__mouseUpHandle=function(){me.__isDraging&&me.__eventDispatcher.dispatchEvent("afterDrag"),me.__isDraging=!1,me.__setCapture(!1)},this.__initNodes(captureNode,attachNodes,isDragCapureNode),this.__initCaputerNode()}.$define({addEventListener:function(type,handle){return this.__eventDispatcher.addEventListener(type,handle),this},removeEventListener:function(type,handle){return this.__eventDispatcher.removeEventListener(type,handle),this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown"),Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup"),this.__captureNode=null,this.__dragNodes=null},__initNodes:function(captureNode,attachNodes,isDragCapureNode){attachNodes?(attachNodes instanceof Array?this.__dragNodes=attachNodes:this.__dragNodes.push(attachNodes),(void 0===isDragCapureNode||isDragCapureNode)&&this.__dragNodes.push(this.__captureNode)):this.__dragNodes.push(this.__captureNode);for(var dns=this.__dragNodes,i=dns.length;i--;)!dns[i].style.position&&(dns[i].style.position="absolute"),!dns[i].style.left&&(dns[i].style.left=0),!dns[i].style.top&&(dns[i].style.top=0)},__initCaputerNode:function(){var cn=this.__captureNode;Core.Events.addEvent(cn,this.__mouseDownHandle,"mousedown"),Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(isCapture){for(var cn=this.__captureNode,dns=this.__dragNodes,evt=Core.Events.getEvent(),i=dns.length;i--;)this.__deltaX[i]=evt.clientX-parseInt(dns[i].style.left),this.__deltaY[i]=evt.clientY-parseInt(dns[i].style.top);isCapture?$IE?(cn.setCapture(),Core.Events.addEvent(cn,this.__dragHandle,"mousemove")):Core.Events.addEvent(document,this.__dragHandle,"mousemove"):$IE?(cn.releaseCapture(),Core.Events.removeEvent(cn,this.__dragHandle,"mousemove")):Core.Events.removeEvent(document,this.__dragHandle,"mousemove")},__drag:function(){if(this.canDrag){var dns=this.__dragNodes,evt=Core.Events.getEvent(),i=dns.length,la=this.lockArea,dX=0,dY=0;for(this.__eventDispatcher.dispatchEvent("drag");i--;)dX=evt.clientX-this.__deltaX[i],dY=evt.clientY-this.__deltaY[i],this.isLock&&(dX=Math.min(Math.max(dX,la.left),la.right),dY=Math.min(Math.max(dY,la.top),la.bottom)),dns[i].style.left=dX+"px",dns[i].style.top=dY+"px"}}}),Ui.IDragger={addEventListener:function(type,handle){},removeEventListener:function(type,handle){},setDrag:function(node,attachNodes,isDragCapureNode){},setLock:function(state){},setArea:function(area){},destroy:function(){}},Ui.SimpleDragger=function(){this.__drag=null,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(type,handle){return"afterdrag"===type.toLowerCase()?this.__eventDispatcher.addEventListener(type,handle):this.__drag.addEventListener(type,handle),this},removeEventListener:function(type,handle){return"afterdrag"===type.toLowerCase()?this.__eventDispatcher.removeEventListener(type,handle):this.__drag.removeEventListener(type,handle),this},setDrag:function(node,attachNode,isDragCapureNode){var me=this;return this.__drag=new Ui.Drag(node,attachNode,isDragCapureNode),this.__drag.addEventListener("afterDrag",(function(){me.__eventDispatcher.dispatchEvent("afterDrag")})),this},setLock:function(state){return this.__drag.isLock=!!state,this},setArea:function(area){return this.__drag.lockArea=area,this},destroy:function(){this.__drag.destroy()}}),Ui.Dialog=function(parent,node){var me=this;this.__dragger=null,this.__isBindUpadateAreaEvent=!1,this.__isBindUpdateIE6AreaEvent=!1,this.__beforeDragHandle=function(){me.__updateDraggerArea(),me.__eventDispatcher.dispatchEvent("beforedrag")},this.__dragHandle=function(){me.__isSetAdamant&&me.__updateIframe(),me.__eventDispatcher.dispatchEvent("drag")},this.__afterDragHandle=function(){me.__isFixed&&$IE6&&me.__updateIE6FCOrgPosition(),me.__eventDispatcher.dispatchEvent("afterdrag")},this.__updateDraggerAreaHandle=function(){setTimeout((function(){me.__updateDraggerArea()}),1)},this.__setMiddleHandle=function(){me.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(tpl){return Ui.Dialog.$super.setTemplate.call(this,tpl),this.__initTitleBar(),this.setDragger(Ui.SimpleDragger),this},setContent:function(content){return this.nodes.content?(this.nodes.content.innerHTML=new Ui.Template(content).evaluate(this.__getNodes(content,"i")),this.__addContentNodes(this.__getNodes(content)),this):this},setFixed:function(state){return Ui.Dialog.$super.setFixed.call(this,state),state?Core.Events.addEvent(window,this.__setMiddleHandle,"resize"):Core.Events.removeEvent(window,this.__setMiddleHandle,"resize"),this.__updateDraggerArea(),this},setMiddle:function(){var areaHeight=this.__getDocumentSize().height-this.height,goldenSection=(Math.sqrt(5)-1)/2,goldenSectionY=areaHeight*goldenSection/(goldenSection+1),middleX=this.__getDocumentSize().width/2-this.width/2;return this.__isFixed||(goldenSectionY+=Math.max(document.documentElement.scrollTop,document.body.scrollTop),middleX+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)),this.setPosition({x:Math.max(middleX,0),y:Math.max(goldenSectionY,0)}),this},setAreaLocked:function(state){return this.__dragger?(this.__dragger.setLock(state),this):this},setSize:function(p){return!this.__isInited&&this.__initEntity(),this.nodes.content?("undefined"!=typeof p.width&&(this.nodes.content.style.width=p.width+"px"),"undefined"!=typeof p.height&&(this.nodes.content.style.height=p.height+"px")):("undefined"!=typeof p.width&&(this.__entity.style.width=p.width+"px"),"undefined"!=typeof p.height&&(this.__entity.style.height=p.height+"px")),this},setDragger:function(draggerConstructor){if(!this.nodes.titleBar||!draggerConstructor)return this;if(this.__dragger){if(this.__dragger.constructor===draggerConstructor)return this}else this.__dragger=new draggerConstructor;return this.__updateDragger(draggerConstructor),this},destroy:function(){this.__entity&&(Ui.Dialog.$super.destroy.call(this),Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize"),Core.Events.removeEvent(window,this.__setMiddleHandle,"resize"))},__addContentNodes:function(nodes){var k,nds=this.nodes;for(k in nodes)nds[k]=nodes[k]},__updateDragger:function(draggerConstructor){this.__dragger.constructor!==draggerConstructor&&(this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle),this.__dragger.destroy(),this.__dragger=new draggerConstructor),this.__dragger.setDrag(this.nodes.titleBar,this.__entity,!1),this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle)},__updateDraggerArea:function(){var l,t,r,b;this.__isFixed?(l=$IE6?document.documentElement.scrollLeft:0,t=$IE6?document.documentElement.scrollTop:0,r=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width,b=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height):(l=0,t=0,r=document.documentElement.scrollWidth-this.width,b=document.documentElement.scrollHeight-this.height),this.__dragger.setArea({left:l,top:t,right:r,bottom:b})},__initTitleBar:function(){if(this.nodes.titleBar){var tb=this.nodes.titleBar;tb.style.cursor="move",$IE?Core.Events.addEvent(tb,(function(){return!1}),"selectstart"):tb.style.MozUserSelect="none"}},__getDocumentSize:function(){return{width:document.documentElement.clientWidth||document.body.clientWidth,height:document.documentElement.clientHeight||document.body.clientHeight}}}),Ui.ModuleDialog=function(tplConfig,iconSet,cfg){this.__bgShadow=null,this.__dialog=null,this.__isInitBgShadow=!1,this.__tplConfig=tplConfig,this.__iconSet=iconSet,this.__dialogQueue=[],this.__zIndex=cfg&&cfg.zIndex||5e3,this.__cfg=cfg||{},this.__initDialogEvent()}.$define({alert:function(text,cfg){cfg=cfg||{};var dlg=this.__createMessageDialog(cfg.tplConfig||this.__tplConfig.alert,cfg);return dlg.nodes.text&&(dlg.nodes.text.innerHTML=text||""),dlg.show(cfg.renderer||this.__cfg.renderer).addEventListener("hidden",(function(){this.destroy()})),dlg.nodes.linkOk&&"none"!==dlg.nodes.linkOk.style.display&&dlg.nodes.linkOk.focus(),dlg},newAlert:function(text,cfg,name){cfg.tplConfig=this.__tplConfig.newAlert,this.alert(text,cfg,name)},confirm:function(text,cfg){cfg=cfg||{};var dlg=this.__createMessageDialog(cfg.tplConfig||this.__tplConfig.confirm,cfg),me=this;return dlg.nodes.text&&(dlg.nodes.text.innerHTML=text||""),dlg.nodes.btnCancel&&(dlg.nodes.btnCancel.innerHTML=cfg.textCancel||"取消",Core.Events.addEvent(dlg.nodes.btnCancel,(function(){cfg.funcCancel&&cfg.funcCancel.call(dlg),dlg.hidden(cfg.renderer||me.__cfg.renderer),Core.Events.stopEvent()}),"click"),dlg.nodes.linkCancel&&Core.Events.addEvent(dlg.nodes.linkCancel,(function(){"13"==Core.Events.getEvent().keyCode&&(cfg.funcCancel&&cfg.funcCancel.call(dlg),dlg.hidden(cfg.renderer||me.__cfg.renderer))}),"keydown")),dlg.show(cfg.renderer||me.__cfg.renderer).addEventListener("hidden",(function(){this.destroy()})),0==cfg.defaultButton?dlg.nodes.linkCancel&&"none"!==dlg.nodes.linkCancel.style.display&&dlg.nodes.linkCancel.focus():dlg.nodes.linkOk&&"none"!==dlg.nodes.linkOk.style.display&&dlg.nodes.linkOk.focus(),dlg},newConfirm:function(text,cfg,name){cfg.tplConfig=this.__tplConfig.newConfirm,this.confirm(text,cfg,name)},create:function(cfg){cfg=cfg||{};var dlg=new Ui.Dialog;return dlg.setTemplate(cfg.tpl||this.__tplConfig.customs),cfg.content&&dlg.setContent(cfg.content),cfg.width&&!isNaN(cfg.width)&&dlg.setSize({width:cfg.width}),cfg.height&&!isNaN(cfg.height)&&dlg.setSize({height:cfg.height}),this.__initDialog(dlg,cfg)},__initDialogEvent:function(){var queue=this.__dialogQueue;Core.Events.addEvent(document,(function(){var e=Core.Events.getEvent();queue.length&&"27"==e.keyCode&&queue[queue.length-1].hidden()}),"keydown")},__createMessageDialog:function(tpl,cfg){var dlg=new Ui.Dialog,me=this;return dlg.setTemplate(tpl),cfg.width&&!isNaN(cfg.width)&&dlg.setSize({width:cfg.width}),cfg.height&&!isNaN(cfg.height)&&dlg.setSize({height:cfg.height}),dlg.nodes.subText&&(dlg.nodes.subText.innerHTML=cfg.subText||""),dlg.nodes.icon&&(dlg.nodes.icon.className=this.__iconSet[cfg.icon||"01"]["class"],dlg.nodes.icon.alt=this.__iconSet[cfg.icon||"01"].alt),dlg.nodes.btnOk&&(dlg.nodes.btnOk.innerHTML=cfg.textOk||"确定",Core.Events.addEvent(dlg.nodes.btnOk,(function(){dlg.hidden(cfg.renderer||me.__cfg.renderer),cfg.funcOk&&cfg.funcOk.call(dlg),Core.Events.stopEvent()}),"click")),dlg.nodes.linkOk&&Core.Events.addEvent(dlg.nodes.linkOk,(function(){"13"==Core.Events.getEvent().keyCode&&(dlg.hidden(cfg.renderer||me.__cfg.renderer),cfg.funcOk&&cfg.funcOk.call(dlg))}),"keydown"),dlg.setDragger(cfg.dragger||me.__cfg.dragger).setFixed(!0).setAreaLocked(!0),this.__initDialog(dlg,cfg)},__initDialog:function(dlg,cfg){var me=this;return cfg.zIndex&&(me.__zIndex=cfg.zIndex),dlg.nodes.titleName&&(dlg.nodes.titleName.innerHTML=cfg.title||"提示"),dlg.nodes.btnClose&&(Core.Events.addEvent(dlg.nodes.btnClose,(function(){var isCanHidden=!0;cfg.funcBeforeClose&&(isCanHidden=!1!==cfg.funcBeforeClose.call(dlg)),cfg.funcClose&&cfg.funcClose.call(dlg),isCanHidden&&dlg.hidden()}),"click"),Core.Events.addEvent(dlg.nodes.btnClose,(function(){Core.Events.stopEvent()}),"mousedown")),dlg.setPosition({z:cfg.zIndex||me.__zIndex}),dlg.setRenderer(cfg.renderer||this.__cfg.renderer),dlg.setDragger(cfg.dragger||this.__cfg.dragger),dlg.setMiddle(),dlg.addEventListener("beforeHidden",(function(){me.__updateDialogQueue(this,"remove")})),dlg.addEventListener("beforeShow",(function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var that=this;me.__isInitBgShadow||me.__initBGShadow(this,cfg.isAdamant||me.__cfg.isAdamant),me.__setBGShadowOpacity(0!==cfg.bgShadowOpacity?cfg.bgShadowOpacity||.4:cfg.bgShadowOpacity),window.setTimeout((function(){me.__bgShadow.show(),me.__updateDialogQueue(that,"add")}),1)})),dlg.setTitle=function(title){this.nodes.titleName&&(this.nodes.titleName.innerHTML=title)},dlg.setHelp=function(url){this.nodes.btnHelp&&(this.nodes.btnHelp.href=url)},dlg.close=function(){this.hidden()},dlg.getNodes=function(){return this.nodes},dlg.getX=function(){return this.x},dlg.getY=function(){return this.y},dlg.getWidth=function(){return this.width},dlg.getHeight=function(){return this.height},dlg},__initBGShadow:function(dlg,isAdamant){var w=this.__getDocumentSize().width,h=this.__getDocumentSize().height,me=this;this.__bgShadow=new Ui.Panel,this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:w,height:h}).setAdamant(isAdamant).setFixed(!0).setPosition({x:0,y:0,z:me.__zIndex}),Core.Events.addEvent(window,(function(){me.__bgShadow.setPosition({x:0,y:0}).setSize({width:me.__getDocumentSize().width,height:me.__getDocumentSize().height})}),"resize"),this.__isInitBgShadow=!0},__updateDialogQueue:function(dialog,op){var i,dlg;if("add"===op)this.__dialogQueue.push(dialog);else if("remove"===op)for(i=this.__dialogQueue.length;i--;)this.__dialogQueue[i]===dialog&&this.__dialogQueue.splice(i,1);0===this.__dialogQueue.length?this.__bgShadow.hidden():(dlg=this.__dialogQueue[this.__dialogQueue.length-1],this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,dlg.nodes.panel),this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel),dlg.nodes.linkOk&&"none"!==dlg.nodes.linkOk.style.display&&dlg.nodes.linkOk.focus())},__setBGShadowOpacity:function(v){v=isNaN(v)?0:Math.max(Math.min(v,1),0),Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",v)},__getDocumentSize:function(){return{width:document.documentElement.clientWidth||document.body.clientWidth,height:document.documentElement.clientHeight||document.body.clientHeight}}}),Ui.Transition={simple:function(t,b,c,d){return c*t/d+b},backEaseIn:function(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backEaseOut:function(t,b,c,d){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backEaseInOut:function(t,b,c,d){var s=1.70158;return(t/=d/2)<1?c/2*(t*t*((1+(s*=1.525))*t-s))+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},bounceEaseOut:function(t,b,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},bounceEaseIn:function(t,b,c,d){return c-Transition.bounceEaseOut(d-t,0,c,d)+b},bounceEaseInOut:function(t,b,c,d){return t<d/2?.5*Transition.bounceEaseIn(2*t,0,c,d)+b:.5*Transition.bounceEaseOut(2*t-d,0,c,d)+.5*c+b},regularEaseIn:function(t,b,c,d){return c*(t/=d)*t+b},regularEaseOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},regularEaseInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},strongEaseIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},strongEaseOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},strongEaseInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},elasticEaseIn:function(t,b,c,d){var a,p;if(0==t)return b;if(1==(t/=d))return b+c;if(p=.3*d,!a||a<Math.abs(c)){a=c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b},elasticEaseOut:function(t,b,c,d){var a,p;if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),!a||a<Math.abs(c)){a=c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},elasticEaseInOut:function(t,b,c,d){if(0==t)return b;if(2==(t/=d/2))return b+c;if(!p)var p=d*(.3*1.5);if(!a||a<Math.abs(c))var a=c,s=p/4;else s=p/(2*Math.PI)*Math.asin(c/a);return t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}},Ui.TweenStrategy=function(startValue,endValue,duration,motion){this.startValue=startValue||0,this.endValue=endValue||0,this.duration=duration||0,this.motion=motion||Ui.Transition.simple,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:!1,addEventListener:function(type,handle){return this.__eventDispatcher.addEventListener(type,handle),this},removeEventListener:function(type,handle){return this.__eventDispatcher.removeEventListener(type,handle),this},start:function(){if(!this._isTweenning){this._isTweenning=!0;var t,value,me=this,sv=this.startValue,ev=this.endValue,d=this.duration,startTime=(new Date).getTime();return this._itvID=window.setInterval((function(){(t=((new Date).getTime()-startTime)/1e3)>me.duration&&(t=me.duration),value=me.motion(t,sv,ev-sv,d),me.onTween&&me.onTween(value),me.__eventDispatcher.dispatchEvent("tween",value),t==me.duration&&me.stop()}),25),this}},stop:function(){return window.clearInterval(this._itvID),this._isTweenning=!1,this.onEnd&&this.onEnd(),this.__eventDispatcher.dispatchEvent("end"),this},onTween:function(value){},onEnd:function(){}}),Ui.OpacityRenderer=function(){this.__canShow=!0,this.__canHidden=!0,this.__node=null,this.__tween=new Ui.TweenStrategy(0,0,.6,Ui.Transition.strongEaseOut),this.__state="",this.__lastState="",this.__value=0,this.__node=null,this.__eventDispatcher=new Core.Events.EventDispatcher(this),this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(state){this.__canShow=!!state},setCanHidden:function(state){this.__canHidden=!!state},show:function(node){var tn=this.__tween;return tn.stop(),Core.Dom.setStyle(node,"opacity",this.__value),node.style.display="",this.__node=node,this.__state="show",this.__eventDispatcher.dispatchEvent("beforeShow"),this.__canShow&&(tn.startValue=this.__value,tn.endValue=1,tn.start()),this},hidden:function(node){var tn=this.__tween;return tn.stop(),this.__node=node,this.__state="hidden",this.__eventDispatcher.dispatchEvent("beforeHidden"),this.__canHidden&&(tn.startValue=this.__value,tn.endValue=0,tn.start()),this},addEventListener:function(type,handle){return this.__eventDispatcher.addEventListener(type,handle),this},removeEventListener:function(type,handle){return this.__eventDispatcher.removeEventListener(type,handle),this},__initTweenEvent:function(){var me=this;this.__tween.addEventListener("tween",(function(v){me.__value=v,Core.Dom.setStyle(me.__node,"opacity",v)})),this.__tween.addEventListener("end",(function(){me.__node&&me.__node.style.filter&&(me.__node.style.filter=""),""!==me.__state&&me.__state!==me.__lastState&&(me.__lastState=me.__state,me.__eventDispatcher.dispatchEvent(me.__state)),"hidden"===me.__state&&(me.__node.style.display="none")}))}}),Ui.BorderDragger=function(){this.__drag=null,this.__isBindEvent=!1,this.__border=null,this.__dragNode=null,this.__isCreated=!1,this.__tweenX=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut),this.__tweenY=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut),this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(type,handle){return"afterdrag"===type.toLowerCase()?this.__eventDispatcher.addEventListener(type,handle):this.__drag.addEventListener(type,handle),this},removeEventListener:function(type,handle){return"afterdrag"===type.toLowerCase()?this.__eventDispatcher.removeEventListener(type,handle):this.__drag.removeEventListener(type,handle),this},setDrag:function(node,attachNode,isDragCapureNode){return this.__isCreated||(this.__createBorder(attachNode),this.__initTweenEvent(attachNode)),this.__drag=new Ui.Drag(node,this.__border,isDragCapureNode),this.__dragNode=attachNode,this.__initDragEvent(),this},setLock:function(state){return this.__drag.isLock=!!state,this},setArea:function(area){return this.__drag.lockArea=area,this},destroy:function(){this.__drag.destroy()},__createBorder:function(node){this.__border=$C("div");var st=this.__border.style;st.border="2px dashed #BCC4D0",st.position="absolute",st.display="none",st.backgroundColor="transparent",st.MozUserSelect="none",document.body.appendChild(this.__border),this.__isCreated=!0},__initDragEvent:function(){if(!this.__isBindEvent){var me=this,bst=this.__border.style,nst=this.__dragNode.style,twX=this.__tweenX,twY=this.__tweenY;this.__drag.addEventListener("beforeDrag",(function(){bst.zIndex=nst.zIndex+1,bst.position=nst.position,bst.width=me.__dragNode.offsetWidth-4+"px",bst.height=me.__dragNode.offsetHeight-4+"px",bst.left=parseInt(nst.left)+"px",bst.top=parseInt(nst.top)+"px",bst.display=""})),this.__drag.addEventListener("afterDrag",(function(){$IE6?(nst.left=parseInt(bst.left)+"px",nst.top=parseInt(bst.top)+"px",bst.display="none",me.__eventDispatcher.dispatchEvent("afterDrag")):(twX.startValue=parseInt(nst.left),twX.endValue=parseInt(bst.left),twY.startValue=parseInt(nst.top),twY.endValue=parseInt(bst.top),twX.start(),twY.start())})),this.__isBindEvent=!0}},__initTweenEvent:function(node){var nst=node.style,bst=this.__border.style,me=this;this.__tweenX.addEventListener("tween",(function(v){nst.left=v+"px"})),this.__tweenY.addEventListener("tween",(function(v){nst.top=v+"px"})),this.__tweenX.addEventListener("end",(function(){bst.display="none",me.__eventDispatcher.dispatchEvent("afterDrag")}))}});var winDialog={},DialogTemplate={};function showError(code,ico){var msg=$SYSMSG[code]||code;winDialog.alert(msg,{icon:ico||"01"})}!function(){var dialogTemplates={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")},dialogs={},moduleDialog=new Ui.ModuleDialog(dialogTemplates,{"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}},{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(args,name){return name&&"string"==typeof name?(dialogs[name]=moduleDialog.create(args),dialogs[name]):moduleDialog.create(args)},winDialog.alert=function(text,cfg,name){return name&&"string"==typeof name?(dialogs[name]=moduleDialog.alert(text,cfg),dialogs[name]):moduleDialog.alert(text,cfg)},winDialog.newAlert=function(text,cfg,name){return name&&"string"==typeof name?(dialogs[name]=moduleDialog.newAlert(text,cfg),dialogs[name]):moduleDialog.newAlert(text,cfg)},winDialog.confirm=function(text,cfg,name){return name&&"string"==typeof name?(dialogs[name]=moduleDialog.confirm(text,cfg),dialogs[name]):moduleDialog.confirm(text,cfg)},winDialog.newConfirm=function(text,cfg,name){return name&&"string"==typeof name?(dialogs[name]=moduleDialog.newConfirm(text,cfg),dialogs[name]):moduleDialog.newConfirm(text,cfg)},winDialog.getDialog=function(name){if(name&&"string"==typeof name)return dialogs[name]},DialogTemplate=dialogTemplates}(),$SYSMSG.extend({A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4000520066。",A00002:"很抱歉，您的IP出现异常，请稍后再试",A00003:"无权限进行此操作，请重新登录。",A00004:"无权限进行此操作，请重新登录。",A00005:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4000520066。",A00006:"操作成功",A00007:"无权限进行此操作，请重新登录。",A00009:"博文存在敏感词，请修改后提交",A00010:"无升级权限",A11007:"你还未开通新浪博客，请先<a href='https://login.sina.com.cn/hd/reg_sec.php?entry=blog'> 开通博客</a>",A00800:"对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A00039:"对不起，该文章为私密文章，禁止评论！",A00038:"抱歉，您评论的文章不存在！",A00111:"抱歉，该文章禁止评论！",A00110:"用户设置为不允许评论！",P00001:"抱歉，您还没有认证实名，<br>请点击确认认证后，继续操作！",W00001:"认证用户，昵称修改，请到微博操作！"}),$SYSMSG.extend({B01001:"标题必须是48个中文或96个字符以内，请重新输入。",B02001:"请输入内容。",B02002:"博文内容超过容量限制，请重新编辑。 <br/><span style='font-size: 12px; font-weight: normal;'>博文内容最多允许1万汉字，2万字符。</span>",B02003:"是否要清除格式？粘帖的内容中含有冗余的格式，会影响在博客中的排版。",B02004:"上次撰写的博文未进行保存，要恢复内容继续编辑吗？",B02005:'您提交的内容中含有广告等不适当内容，"确认"后将被清除！',B03001:"标签总字数必须是30个中文或60个字符以内，请重新输入。",B03002:"标签个数必须是5个以内，请重新输入。",B03003:"每个标签字数必须是7个中文或14个字符以内，请重新输入。",B03105:"无法提取到有效标签，请手动输入些标签：如“体育、生活”。",B03106:"博文内容必须大于20个中文或40个字符，才能提取有效标签。",B03107:"博文内容必须大于20个中文或40个字符，才能提取有效标签。",B04001:"发布时间不能超出当前时间，请重新输入。",B04002:"抱歉,请选择“我记录”活动投稿类别。",B04022:"标签总字数必须是30个中文或60个字符以内，请重新输入。",B06001:"博文已发布成功。",B06011:"博文已发布成功。",B06012:"博文已发布成功。",B06002:"博文正在审核中，现在仅自己可见，请耐心等待审核，待通过后文章将正常可见。",B06003:"博文已成功保存到草稿箱。",B06004:"您的博文已经发表成功，目前已经进入后台审核中。审核时间为12小时，请耐心等候。",B06015:"文章正在审核中，暂时不能修改，请稍后再试。",B06016:"博文编辑成功。",B07001:"博文发布失败，请梢后再试。建议先将内容拷贝到本地硬盘备份。",B07003:"博文保存失败，请梢后再试。建议先将内容拷贝到本地硬盘备份。",B07004:"博文保存失败，请梢后再试。建议先将内容拷贝到本地硬盘备份。",B07005:"您短时间发表文章过多，请稍后再试",B08001:"不能一分钟内连续发博文，请稍后再试。",B08002:"发布中，请稍候…",B08003:"保存中，请稍候…",B08004:"由于网络原因上传失败，请稍后再试。或者尝试使用<a href='//photo.blog.sina.com.cn/upload/upload_html.php'>旧版网页上传</a>。",B08005:"由于网络原因上传失败，请稍后再试。",B36101:"文章不存在",B78001:"选择已达相关博文上限！请删除一些再勾选",B79001:'音乐地址要求是mp3格式，请重新输入！或者直接去<a onclick="scope.musicOperate.showStore();return false;" href="#">新浪乐库</a>中搜索。',B79002:'音乐地址要求以http://开始，请重新输入！或者直接去<a onclick="scope.musicOperate.showStore();return false;" href="#">新浪乐库</a>中搜索。',B79003:"是否要删除背景音乐？",B79004:"是否要删除相关博文？",B79005:"在模板中只能插入一张图片。",B79006:"每次最多只能插入20张图片。<br/>请先完成图片添加，再插入新图片",B79007:"<strong>此分类尚无博文，请选择其他分类</strong>",B79008:"<strong>尚无博文</strong>",B79009:"是否要删除推荐活动？",B89001:"请输入文章内容。",B89002:"正文内空转码失败。",B89003:"服务分析出错。",B89004:"没有找到匹配的歌曲名。",B89005:"为了保证您的博文打开速度，每篇博文最多只能插入3个音乐播放器。",B89006:"每个播放器最多只能添加20首歌",B89007:"歌曲已成功添加！<br/>但添加至上一个播放器，仅在当本博文中已有播放器时适用。",B89008:"歌曲已成功添加！<br/>但插入歌词功能仅在插入单首歌曲时可用。",B89009:"请输入搜索内容",B89011:"抱歉，您还没有选择音乐，请至少选择一首。",B89012:'博文中无可识别的歌曲名。<br/><span style="color:#999">帮助：此功能会根据您输入的博文内容，自动识别出您博文内容中出现的歌曲名，并为此歌曲名匹配相应试听链接，浏览者即可一键轻松试听您博文中的音乐。</span>',B89013:"已成功添加至上一个播放器中！",B79010:"请在图片上传完成后再进行添加。",A00200:"您输入的内容包含非法字符"}),$SYSMSG.extend({A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限，不能再添加新的关注了！<br/>可以到<a href='//control.blog.sina.com.cn/blogprofile/attention.php' target='_blank'>关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功！",A33005:"你不能添加自己为关注！",A33008:"取消关注失败",A33009:"移除关注成功，加黑名单失败",A33010:"对不起，您短时间添加关注过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~"}),Utils.Cookie.setCookie=function(name,value,expire,path,domain,secure){var cstr=[];if(cstr.push(name+"="+escape(value)),expire){var dd=new Date,expires=dd.getTime()+36e5*expire;dd.setTime(expires),cstr.push("expires="+dd.toGMTString())}path&&cstr.push("path="+path),domain&&cstr.push("domain="+domain),secure&&cstr.push(secure),document.cookie=cstr.join(";")},String.prototype.format=function(){arguments[0]&&"undefined"!=typeof arguments[0]&&arguments[0].toString();var re=/(.*?)({(\d+)(:([0-9a-z]+))?})/gi,t=this.match(re);if(t){for(var i=0,l=t.length;i<l;i++)switch(t[i]=t[i].replace(re,(function(){return RegExp.$1})),t[i]=RegExp.$1,typeof arguments[parseInt(RegExp.$3)]){case"undefined":t[i]+=RegExp.$2;break;case"number":t[i]+=isNaN(RegExp.$5)||""==RegExp.$5?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:t[i]+=arguments[parseInt(RegExp.$3)]}return t.push(this.replace(re,"")),t.join("")}return this},Sina.pkg("Core.Math"),Core.Math.getUniqueId=function(_start,_end){return parseInt(1e4*Math.random()).toString()+(new Date).getTime().toString()},Lib.pkg("Login"),Lib.Login.info=function(){var info;return window.sinaSSOController&&(info=sinaSSOController.getLoginInfo())?info:{}},Lib.Login.LoginPost=Core.Class.create(),Lib.Login.LoginPost.prototype={url:"https://i.sso.sina.com.cn/js/ssologin.js",callback:null,state:{isRequesting:!1},initialize:function(callback,clearDomain,from){var _self=this;window.sinaSSOConfig=new function(){from&&(this.from=from),this.pageCharset="utf-8",this.noActiveTime=14400,this.setDomain=!0,this.entry="boke",this.customInit=function(){},this.customLoginCallBack=function(){callback.apply(null,arguments),_self.state.isRequesting=!1},this.customLogoutCallBack=function(result){},this.useIframe=!0}},login:function(username,password,time){function __login(){void 0===time?sinaSSOController.login(username,password):sinaSSOController.login(username,password,time)}this.state.isRequesting||(this.state.isRequesting=!0,"undefined"!=typeof sinaSSOController&&sinaSSOController?(trace("has sso"),sinaSSOController.init(),"function"==typeof sinaSSOController.setLoginType&&sinaSSOController.setLoginType(2),sinaSSOController.getServerTime,trace("init ok"),__login()):(trace("no sso"),Utils.Io.JsLoad.request(this.url,{onComplete:function(){__login()},onException:function(){},timeout:3e4,isRemove:!1})))},parse:function(loginStatus){this.callback.call(loginStatus)}},Core.System.getScrollPos=function(oDocument){var dd=(oDocument=oDocument||document).documentElement,db=oDocument.body;return[Math.max(dd.scrollTop,db.scrollTop),Math.max(dd.scrollLeft,db.scrollLeft),Math.max(dd.scrollWidth,db.scrollWidth),Math.max(dd.scrollHeight,db.scrollHeight)]},Core.Dom.getStyle=function(el,property){switch(property){case"opacity":var val=100;try{val=el.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(e){try{val=el.filters("alpha").opacity}catch(e){}}return val/100;case"float":property="styleFloat";default:var value=el.currentStyle?el.currentStyle[property]:null;return el.style[property]||value}},(!$IE||$IE>8)&&(Core.Dom.getStyle=function(el,property){"float"==property&&(property="cssFloat");try{var computed=document.defaultView.getComputedStyle(el,"")}catch(e){traceError(e)}return el.style[property]||computed?computed[property]:null}),Core.Dom.getXY=function(el){if((null==el.parentNode||null==el.offsetParent||"none"==Core.Dom.getStyle(el,"display"))&&el!=document.body)return!1;var box;el.ownerDocument;box=el.getBoundingClientRect();var scrollPos=Core.System.getScrollPos(el.ownerDocument);return[box.left+scrollPos[1],box.top+scrollPos[0]]},$IE||(Core.Dom.getXY=function(el){if((null==el.parentNode||null==el.offsetParent||"none"==Core.Dom.getStyle(el,"display"))&&el!=document.body)return!1;var parentNode=null,pos=[];el.ownerDocument;pos=[el.offsetLeft,el.offsetTop],parentNode=el.offsetParent;var hasAbs="absolute"==Core.Dom.getStyle(el,"position");if(parentNode!=el)for(;parentNode;)pos[0]+=parentNode.offsetLeft,pos[1]+=parentNode.offsetTop,$SAFARI&&!hasAbs&&"absolute"==Core.Dom.getStyle(parentNode,"position")&&(hasAbs=!0),parentNode=parentNode.offsetParent;for($SAFARI&&hasAbs&&(pos[0]-=el.ownerDocument.body.offsetLeft,pos[1]-=el.ownerDocument.body.offsetTop),parentNode=el.parentNode;parentNode.tagName&&!/^body|html$/i.test(parentNode.tagName);)Core.Dom.getStyle(parentNode,"display").search(/^inline|table-row.*$/i)&&(pos[0]-=parentNode.scrollLeft,pos[1]-=parentNode.scrollTop),parentNode=parentNode.parentNode;return pos}),function(){var _rndID=parseInt(100*Math.random()),_showMenuItems=[],_selectMenuIndex=-1,_selectMenuText="",_css="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}\t\t\t\t#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;\t\t\t\tborder: 1px solid #CCCCCC;background: #ffffff;text-align:left;}\t\t\t\t#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;\t\t\t\tline-height: 20px;cursor: pointer;color: #999999;}\t\t\t\t#sinaNote li.note {text-align: left;color: #999999;}",_viewWindow=window,passcardOBJ={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":!0,"sina.cn":!0,"vip.sina.com":!0,"qq.com":!0,"163.com":!0,"126.com":!0,"hotmail.com":!0,"yahoo.com.cn":!0,"gmail.com":!0},createNode:function(){var d=_viewWindow.document,div=d.createElement("div");div.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var obj=d.createElement("style");obj.setAttribute("type","text/css");try{$IE?obj.styleSheet.cssText=_css:obj.innerHTML=_css}catch(e){trace(e.message)}var total=d.createElement("div");total.appendChild(div),total.appendChild(obj),d.body.appendChild(total)},arrowKey:function(keyCodeNum){38==keyCodeNum&&(_selectMenuIndex<=0&&(_selectMenuIndex=_showMenuItems.length),_selectMenuIndex--,passcardOBJ.selectLi(_selectMenuIndex)),40==keyCodeNum&&(_selectMenuIndex>=_showMenuItems.length-1&&(_selectMenuIndex=-1),_selectMenuIndex++,passcardOBJ.selectLi(_selectMenuIndex))},showList:function(e){_selectMenuText="";var keyCodeNum=Core.Events.getEvent().keyCode;if(38==keyCodeNum||40==keyCodeNum)return passcardOBJ.arrowKey(keyCodeNum),!1;$E("sinaNote")||passcardOBJ.createNode();var username=$E(e).value,atIndex=username.indexOf("@"),InputCase="",InputStr="";for(var key in atIndex>-1&&(InputCase=username.substr(atIndex+1),InputStr=username.substr(0,atIndex)),_selectMenuIndex=0,(_showMenuItems=[])[_showMenuItems.length]="sinaNote_MenuItem_Title_"+_rndID,this.menuStatus)this.menuStatus[key]=!0,""!=InputCase&&InputCase!=key.substr(0,InputCase.length)?this.menuStatus[key]=!1:_showMenuItems[_showMenuItems.length]="sinaNote_MenuItem_"+key+"_"+_rndID;var itemLabel,listcontent='<li class="note">请选择登录类型</li>';for(var mykey in listcontent+='<li id="sinaNote_MenuItem_Title_'+_rndID+'">'+username+"</li>",this.menuStatus)1==this.menuStatus[mykey]&&(listcontent+='<li id="sinaNote_MenuItem_'+mykey+"_"+_rndID+'" title="'+(itemLabel=""==InputStr?username+"@"+mykey:InputStr+"@"+mykey)+'">'+itemLabel+"</li>");$E("sinaNote").innerHTML=listcontent;for(var i=0;i<username.length;i++)username.charCodeAt(i)<160?($E("sinaNote").style.display="",this.selectList(e)):this.hideList();var framePos,el=$E(e),note=$E("sinaNote"),frameLeft=0,frameTop=0;_viewWindow!=window&&(frameLeft=(framePos=Core.Dom.getXY(window.frameElement))[0],frameTop=framePos[1]);var inputWidth=el.offsetWidth;inputWidth<200&&(inputWidth=200),note.style.width=inputWidth-2+"px";var inputXY=Core.Dom.getXY(el);note.style.left=inputXY[0]-($IE?2:-1)+frameLeft+"px",note.style.top=inputXY[1]+el.offsetHeight-($IE?2:-1)+frameTop+"px"},selectList:function(e){for(var unames=$E("sinaNote").getElementsByTagName("li"),i=1;i<unames.length;i++)unames[1].style.backgroundColor=passcardOBJ.overbgcolor,unames[1].style.color=passcardOBJ.outfcolor,unames[i].onmousedown=function(){var temp=this.innerHTML;if(temp.indexOf("非新浪邮箱")>-1){var pos=temp.split("@");$E(e).value=pos[0]}else $E(e).value=this.innerHTML;null!=Core.Events.getEvent()&&Core.Events.stopEvent()},unames[i].onmouseover=function(){1!=i&&(unames[1].style.backgroundColor=passcardOBJ.outbgcolor,unames[1].style.color=passcardOBJ.overfcolor),this.style.backgroundColor=passcardOBJ.overbgcolor,this.style.color=passcardOBJ.outfcolor},unames[i].onmouseout=function(){this.style.backgroundColor=passcardOBJ.outbgcolor,this.style.color=passcardOBJ.overfcolor,unames[1].style.backgroundColor=passcardOBJ.overbgcolor,unames[1].style.color=passcardOBJ.outfcolor}},selectLi:function(nIndex){var menuNode;$E("sinaNote_MenuItem_Title_"+_rndID).style.backgroundColor=passcardOBJ.outbgcolor,$E("sinaNote_MenuItem_Title_"+_rndID).style.color=passcardOBJ.overfcolor;for(var i=0;i<_showMenuItems.length;i++)(menuNode=$E(_showMenuItems[i])).style.backgroundColor=passcardOBJ.outbgcolor,menuNode.style.color=passcardOBJ.overfcolor;$E(_showMenuItems[nIndex]).style.backgroundColor=passcardOBJ.overbgcolor,$E(_showMenuItems[nIndex]).style.color=passcardOBJ.outfcolor,_selectMenuText=$E(_showMenuItems[nIndex]).innerHTML},hideList:function(){$E("sinaNote")||passcardOBJ.createNode(),$E("sinaNote").style.display="none"},init:function(oNode,oColors,oFocusNode,oWindowTarget){for(var key in null==(oWindowTarget=oWindowTarget||window).document.body&&setTimeout(Core.Function.bind3((function(){this.init(oNode,oColors,oFocusNode,oWindowTarget)}),this),100),oColors)this[key]=oColors[key];Core.Events.addEvent(document,passcardOBJ.hideList,"click"),Core.Events.addEvent(oNode,passcardOBJ.hideList,"blur"),Core.Events.addEvent(oNode,Core.Function.bind3(passcardOBJ.showList,this,[oNode]),"keyup"),Core.Events.addEvent(oNode,(function(e){var isSinaMail,keyCodeNum=Core.Events.getEvent().keyCode;if(13==keyCodeNum||9==keyCodeNum){if(""!=_selectMenuText){var temp=_selectMenuText;if(temp.indexOf("非新浪邮箱")>-1){var pos=temp.split("@");oNode.value=pos[0]+"@",isSinaMail=!1}else oNode.value=_selectMenuText,isSinaMail=!0}isSinaMail?null!=oFocusNode&&setTimeout((function(){oFocusNode.focus()}),0):oNode&&oNode.focus()}}),"keydown"),oWindowTarget&&(_viewWindow=oWindowTarget)}};Lib.passcardOBJ=passcardOBJ}(),Lib.Login.Ui=Core.Class.create();var msnRefreshTimer=0;function msnrefreshWindow(){var setCookie=Utils.Cookie.setCookie,getCookie=Utils.Cookie.getCookie;clearTimeout(msnRefreshTimer);var cookieArr,cid,code,reg_token=getCookie("reg_token");if(!reg_token)return trace("no token..."),void(msnRefreshTimer=setTimeout(msnrefreshWindow,1e3));trace("token find out..."),setCookie("reg_token","","","/",".blog.sina.com.cn");var c_cid=getCookie("c_uid"),CBcookie=getCookie("msnLinkCB"),altReg=getCookie("AlT");if(setCookie("msnLoginComeFrom",window.location.href,1,"/",".blog.sina.com.cn"),CBcookie&&(cid=(cookieArr=CBcookie.split("_"))[0],code=cookieArr[1]),c_cid==cid)switch(code){case"noCid":case"loginError":case"pass":break;case"unlink":deleteCookie("msnLinkCB"),trace("noAccount"),window.location.href="//blog.sina.com.cn/blog_rebuild/msn/interface/connect_user_confirm.php";break;case"done":deleteCookie("msnLinkCB"),setCookie("loginFromMsn","msn",24,"/",".blog.sina.com.cn"),function(arg,reg_tk){if(trace("has Account"),arg){trace("alt:"+arg);var iframe=$C("iframe");iframe.setAttribute("height",0),iframe.setAttribute("width",0),document.body.appendChild(iframe),iframe.src="https://login.sina.com.cn/sso/login.php?entry=blogmsn&service=blogmsn&alt="+encodeURIComponent(arg)+"&savestate=7&returntype=TEXT",function(){var me=arguments.callee;me.count||(me.count=0),me.count++>10?(trace("放弃获取SUBP"),iframe.parentNode.removeChild(iframe)):(trace("尝试获取SUBP, count:"+me.count),getCookie("SUBP")?(trace("获取到 SUBP"+getCookie("SUBP")),window.location.reload()):setTimeout(me,1e3))}()}else window.location.reload()}(altReg)}function deleteCookie(name){var Then=new Date;Then.setTime(Then.getTime()-1),document.cookie=name+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+Then.toGMTString()}}Lib.Login.Ui.prototype={dialog:null,isInit:!1,request:null,callback:null,initialize:function(){},login:function(callback,clearDomain,from){this.callback=callback||null,this.clearDomain=clearDomain||!1,this.from=from||null,this.initDom(),this.initEvent(),this.dialog.show(),this.dialog.setAreaLocked(!0),this.reloadName(),this.onShow(),this.focus(),"blogMove"===scope.$pageid&&($E("login_move_tip").style.display=""),$IE6&&this.initAD(),Lib.passcardOBJ.init($E("login_name_d"),{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},$E("login_pass_d"))},reloadName:function(){var defaultName=Lib.Login.info().ln;defaultName&&($E("login_name_d").value=defaultName);var alf=Utils.Cookie.getCookie("ALF");""!=alf&&$E("login_save")&&($E("login_save").checked=!0,$E("login_save_tips").style.display="none"),""!=(alf=Utils.Cookie.getCookie("LiRe"))&&$E("login_save")&&($E("login_save").checked=!0,$E("login_save_tips").style.display="none")},initDom:function(){this.dialog=winDialog.createCustomsDialog({tpl:this.tpl}),this.dialog.addEventListener("hidden",(function(){this.destroy()})),this.dialog.setContent(this.struc),this.dialog.setTitle("登录新浪博客"),this.dialog.setMiddle()},initEvent:function(){var callback=this.parse.bind2(this);this.request=new Lib.Login.LoginPost(callback,this.clearDomain,this.from),Core.Events.addEvent("login_button",this.doLogin.bind2(this)),Core.Events.addEvent("login_name_d",function(e){13==e.keyCode&&this.doLogin()}.bind2(this),"keydown"),Core.Events.addEvent("login_pass_d",function(e){13==e.keyCode&&this.doLogin()}.bind2(this),"keydown");var cancelStatus=1;Core.Events.addEvent("login_save",(function(){if($E("login_save").checked?$E("login_save_tips").style.display="":$E("login_save_tips").style.display="none",cancelStatus){var url="//control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00001&rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}}),cancelStatus=null}}))},doLogin:function(){Core.Events.stopEvent();var username=$E("login_name_d").value,password=$E("login_pass_d").value;if(""==(username=Core.String.trim(username)))return this.error("请输入登录名"),!1;if(""==password)return this.error("请输入密码"),!1;if("undefined"!=typeof sinaSSOController&&"undefined"!=typeof sinaSSOController.loginExtraQuery&&"undefined"!=typeof sinaSSOController.loginExtraQuery.door){var vcode=$E("login_vcode").value;sinaSSOController.loginExtraQuery.door=vcode||1}return $E("login_save").checked?(v7sendLog("48_01_38_1"),this.request.login(username,password,60)):(v7sendLog("48_01_38_0"),this.request.login(username,password)),!1},parse:function(loginStatus){if(loginStatus.result){Lib.checkAuthor(),$E("login_save").checked?Utils.Cookie.setCookie("LiRe",!0,2400,"/",".blog.sina.com.cn"):Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn");var date=new Date,y=date.getFullYear(),m=date.getMonth(),d=date.getDate(),time=new Date(y,m,d,24).getTime();Utils.Cookie.setCookie("onceloggedonblog",time,720,"/",".blog.sina.com.cn");var me=this;function cbreload(){if(this.callback){try{$tray.renderLogin()}catch(e){}this.callback.call()}else window.location=window.location.toString().replace(/#.*/,"")}var cbed=!1;Utils.Io.JsLoad.request("https://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent($E("login_name_d").value)+"&utf82gbk=1&callback=scope.$bindEmailAlert",{noreturn:!0,timeout:5e3,onException:function(){cbed||cbreload.call(me)}}),scope.$bindEmailAlert=function(data){if(cbed=!0,"y"!=data.ret&&"not_verify"!=data.errcode||1==Utils.Cookie.getCookie("sbr_noTBE"))cbreload.call(me);else{var dialog=winDialog.createCustomsDialog({content:['<div id="#{entityID} style="width:358px;height:144px" class="CP_layercon2 unilayer">','<div id="#{contentID}" class="CP_prompt">','<img height="50" align="absmiddle" width="50" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon201">','<table class="CP_w_ttl"><tbody><tr><td>经检测您的帐号存在一定的安全隐患！<br>建议绑定邮箱</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{bindit}" target="_blank"><cite> 绑定 </cite></a>&nbsp;&nbsp;<a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{nobind}"><cite> 暂不绑定 </cite></a></p>',"</div>",'<div class="unilayerB SG_j_linedot1">','<p class="SG_txtb"><input type="checkbox" id="#{noalertbind}"><label for="#{noalertbind}">一周内不提醒</label></p>',"</div>","</div>"].join(""),shadow:1},"bindEmail");dialog.setMiddle(),dialog.show(),dialog.nodes.btnClose.onclick=function(){cbreload.call(me),dialog.hidden()},dialog.nodes.nobind.onclick=function(){setTimeout((function(){cbreload.call(me),dialog.hidden()}),100)},dialog.nodes.bindit.href="https://login.sina.com.cn/bindmail/bindmail.php?entry=blog",dialog.nodes.bindit.onclick=function(){cbreload.call(me)},dialog.nodes.noalertbind.onclick=function(){this.checked?Utils.Cookie.setCookie("sbr_noTBE","1",168,"/",".blog.sina.com.cn"):Utils.Cookie.setCookie("sbr_noTBE","",0,"/",".blog.sina.com.cn")}}},this.dialog.hidden()}else{if("4049"===loginStatus.errno)return sinaSSOController.loginExtraQuery={door:0},$E("login_ckimg").style.display="",$E("login_vcode").value="",$E("checkImg").src="https://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0",Core.Events.addEvent($E("reloadCode"),(function(){$E("checkImg").src="https://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0",$E("login_vcode").value="",$E("login_div_error").innerHTML=""})),void this.error("");if("2070"===loginStatus.errno)return Core.Events.fireEvent($E("reloadCode"),"click"),void this.error(loginStatus.reason);if("4047"==loginStatus.errno)return void this.error(loginStatus.reason);if("4057"==loginStatus.errno)return void this.error(loginStatus.reason);if("4040"==loginStatus.errno)return void this.error(loginStatus.reason);if("50113038"==loginStatus.errno)return void this.error(loginStatus.reason);if("2102"==loginStatus.errno)return void this.error("该帐号长期未使用已被回收，建议注册一个新帐号使用");this.error("登录名或密码错误"),$E("checkImg").src="https://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0",$E("login_vcode").value=""}},friendlyTip:function(reason){var ret=reason,name=$E("login_name_d").value;if(!/[\u0391-\uFFE5]+/.test(name)&&!/^\d+$/.test(name)&&!/^@/.test(name)){var linkTpl='<a href="#" class="underline" onclick="$_RENAME(/@.*/, \'{1}\');return false">{0}{1}</a>',linkArr=["@sina.com","@sina.cn"];ret=("你的登录名可能是 "+(/@sina\.cn$/.test(name)?linkTpl.format("{0}",linkArr[0]):/@sina\.com$/.test(name)?linkTpl.format("{0}",linkArr[1]):linkTpl.format("{0}",linkArr[0])+" 或 "+linkTpl.format("{0}",linkArr[1]))).format(name.replace(/@.*/,""))}return ret},rename:(window.$_RENAME=function(reg,suf){var node=$E("login_name_d");node.value=node.value.replace(reg,"")+suf,$E("login_pass_d").focus(),$E("login_div_error").innerHTML=""},window.$_RENAME),focus:function(){var nameEl=$E("login_name_d");""==nameEl.value?nameEl.focus():$E("login_pass_d").focus()},initAD:function(){},onShow:function(){},error:function(msg){$E("login_div_error").innerHTML=msg,$E("login_pass_d").value="",this.focus()},tpl:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),struc:'\t\t<div class="CP_layercon2 passLoginItem">\t\t\t<div>\t\t\t\t<div id="login_move_tip" style="display:none;margin-bottom:12px">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>\t\t\t\t<div class="boxA">登录名：\t\t\t\t\t<input tabIndex="201" type="text" class="fm1" style="width:215px;" name="login_name" id="login_name_d" tabIndex=1/>  <a style="font-size: 12px;" href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp" target="_blank">立即注册</a>\t\t\t\t</div>\t\t\t\t<div class="boxA">密　码：\t\t\t\t\t<input tabIndex="202" type="password" class="fm1" style="width:215px;" name="login_pass" maxlength="16" id="login_pass_d" tabIndex=2/>  <a style="font-size: 12px;" href="https://login.sina.com.cn/getpass.html" target="_blank">找回密码</a>\t\t\t\t</div>\t\t\t\t<div id="login_ckimg" class="boxA" style="display:none"> <p class="p_img">验证码：                  \t<input type="text" id="login_vcode" name="login_vcode" class="fm1" size="10" maxlength="5" />                  \t<img width="100" align="absmiddle" id="checkImg" src="https://login.sina.com.cn/cgi/pin.php?r='+Core.Math.getUniqueId()+'&s=0" /> <a href="javascript:;" onclick="return false;" style="font-size: 12px;"><span id="reloadCode">换一换</span></a></p> \t\t\t    </div>\t\t\t\t<div class="ErrTips" id="login_div_error"></div>\t\t\t\t<div class="boxB"><p><input tabIndex="203" type="checkbox" value="" id="login_save" checked="checked" /><label for="login_save"> 记住登录状态</label></p><p id="login_save_tips" style="color:#999;display:none;">建议在网吧/公用电脑上取消该选项</p><p style="margin-top: 8px;"><a id="login_button" class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;" tabIndex=204><cite>登录<input type="text"/></cite></a> </p></div>\t\t\t</div>\t\t\t<div class="connect_msn" id="connect_msn" style="position:relative;display:none;">\t\t\t\t<span>使用 MSN 帐号登录博客</span>\t\t\t\t<a href="#" onclick="Lib.checkAuthor();v7sendLog(\'48_01_36\'); window.open(\'https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&response_type=code&scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails\',\'neww\',\'left='+(screen.width-440)/2+",top="+(screen.height-400)/2+',height=400,width=440\');msnrefreshWindow();" style="background:transparent url(//simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;">登录</a>\t\t\t</div>\t\t\t<a href="//blog.sina.com.cn/s/blog_4b0f52990100miil.html" target="_blank"style="left:308px;position:relative;top:-24px;display:none;">如何登录？</a>\t\t\t<div class="CP_lg_ad SG_j_linedot1">\t\t\t</div>\t\t</div>'},Core.System.winSize=function(_target){var w,h;return target=_target?_target.document:document,self.innerHeight?(target=_target?_target.self:self,w=target.innerWidth,h=target.innerHeight):target.documentElement&&target.documentElement.clientHeight?(w=target.documentElement.clientWidth,h=target.documentElement.clientHeight):target.body&&(w=target.body.clientWidth,h=target.body.clientHeight),{width:w,height:h}},Core.System.pageSize=function(_target){target=_target?_target.document:document;var xScroll,yScroll,_rootEl="CSS1Compat"==target.compatMode?target.documentElement:target.body;window.innerHeight&&window.scrollMaxY?(xScroll=_rootEl.scrollWidth,yScroll=window.innerHeight+window.scrollMaxY):_rootEl.scrollHeight>_rootEl.offsetHeight?(xScroll=_rootEl.scrollWidth,yScroll=_rootEl.scrollHeight):(xScroll=_rootEl.offsetWidth,yScroll=_rootEl.offsetHeight);var win_s=Core.System.winSize(_target);return yScroll<win_s.height?pageHeight=win_s.height:pageHeight=yScroll,xScroll<win_s.width?pageWidth=win_s.width:pageWidth=xScroll,[pageWidth,pageHeight,win_s.width,win_s.height]},function(){function LazyLoad(oObjects,oOptions){for(var key in this.node=oObjects,this.config=oOptions,this.defaultConfig)this.config[key]=this.defaultConfig[key];return this.initialize(),this}LazyLoad.prototype={defaultConfig:{preloadPixel:500},initialize:function(){this.viewableHeight=LazyLoadListener.getViewableHeight(),LazyLoadListener.enrol(this)},callback:function(nHeight){if(0!=this.node.length){this.viewableHeight=nHeight||this.viewableHeight;for(var remanent=[],i=0,len=this.node.length;i<len;i++)this.node[i]&&null==this.node[i].dom&&Core.Dom.getXY(this.node[i])[1]<this.viewableHeight+this.config.preloadPixel?(this.config.callback(this.node[i]),this.node[i]=null):this.node[i]&&this.node[i].dom&&Core.Dom.getXY(this.node[i].dom)[1]<this.viewableHeight+this.config.preloadPixel?(this.node[i].callback(this.node[i].dom),this.node[i]=null):remanent.push(this.node[i]);this.node=remanent}}};var LazyLoadListener={_isInit:null,_binder:null,_isWindow:null,_member:[],initialize:function(){var container=window,isWindow=container==window||container==document||!container.tagName||/^(?:body|html)$/i.test(container.tagName);if(isWindow){var doc=container.document;container="CSS1Compat"==doc.compatMode&&($IE||$FF||$OPERA)?doc.documentElement:doc.body;try{$CHROME&&navigator.userAgent.match(/chrome\/(\d+)/i)[1]>60&&(container=doc.documentElement)}catch(e){}}this._container=container,this._binder=isWindow?window:container,this._isWindow=isWindow,this._isInit=!0,this.delayResize(),this.bindEvent()},getViewableHeight:function(){var scrollOffset=0;0==LazyLoadListener._container.scrollTop&&(scrollOffset=document.body.scrollTop+document.documentElement.scrollTop);var eyeableHeight=scrollOffset+Core.System.winSize().height;return this.eyeableHeight=eyeableHeight,eyeableHeight},bindEvent:function(){this._isInit?(Core.Events.addEvent(this._binder,LazyLoadListener.delayLoad,"scroll"),this._isWindow&&Core.Events.addEvent(this._binder,LazyLoadListener.delayResize,"resize"),this.binded=!0):this.initialize()},unbindEvent:function(){Core.Events.removeEvent(LazyLoadListener._binder,LazyLoadListener.delayLoad,"scroll"),this._isWindow&&Core.Events.removeEvent(LazyLoadListener._binder,LazyLoadListener.delayResize,"resize"),this.binded=!1},delayLoad:function(){LazyLoadListener.scrollWatch&&clearTimeout(LazyLoadListener.scrollWatch),LazyLoadListener.scrollWatch=setTimeout((function(){LazyLoadListener.callback(),clearTimeout(LazyLoadListener.scrollWatch),LazyLoadListener.scrollWatch=null}),100)},delayResize:function(){LazyLoadListener.resizeWatch&&clearTimeout(LazyLoadListener.resizeWatch),LazyLoadListener.resizeWatch=setTimeout((function(){LazyLoadListener.callback(),clearTimeout(LazyLoadListener.resizeWatch),LazyLoadListener.resizeWatch=null}),100)},enrol:function(oLazy){LazyLoadListener._member.push(oLazy)},callback:function(){if(LazyLoadListener.getViewableHeight(),LazyLoadListener._member.length>0)for(var i=0,len=LazyLoadListener._member.length;i<len;i++)LazyLoadListener._member[i].callback(document.documentElement.scrollTop+document.body.scrollTop+Core.System.winSize().height);LazyLoadListener.eyeableHeight==Core.System.pageSize()[1]&&LazyLoadListener.unbindEvent()}};Lib.LazyLoad=function(oObjects,oOptions){1!=LazyLoadListener.binded&&LazyLoadListener.bindEvent(oObjects,oOptions),new LazyLoad(oObjects,oOptions)}}();var Layer=function(template){this.entity=null,this.ifm=null;var p,_this=this,Property={width:0,height:0,x:0,y:0,isFixed:!1,uniqueID:"",entityID:"",contentID:"",template:template,templateString:"",nodes:{}};this.getProperty=function(){return Property},(p=_this.getProperty()).uniqueID="_"+_this.getUniqueID(),p.entityID=p.uniqueID+"_entity",p.contentID=p.uniqueID+"_content",_this.setTemplate(p.template),p.width=parseInt(_this.entity.style.width),$IE6&&_this.addIframe(),document.body.appendChild(_this.entity),_this.hidden(),this._ie6Fixed=function(){_this.entity.style.left=document.documentElement.scrollLeft+_this.getProperty().x+"px",_this.entity.style.top=document.documentElement.scrollTop+_this.getProperty().y+"px",_this.ifm&&(_this.ifm.style.left=document.documentElement.scrollLeft+_this.getProperty().x+"px",_this.ifm.style.top=document.documentElement.scrollTop+_this.getProperty().y+"px")}};Layer.prototype={setTemplate:function(template){var p=this.getProperty();if(this.entity&&(this.entity.parentNode.removeChild(this.entity),this.entity=null),"object"==typeof template){if(p.nodes=template,this.entity&&(this.entity.parentNode.removeChild(this.entity),this.entity=null),this.entity=p.nodes.entity,document.body.appendChild(this.entity),!p.nodes.entity||!p.nodes.content)throw new Error("[layer.js] missing entity or content in layer nodes");return this.entity.style.position="absolute",this.entity.style.zIndex="1024",this.entity.style.left=p.x+"px",void(this.entity.style.top=p.y+"px")}p.template=template,p.templateString=p.template.match(/[^\{\}]+(?=\})/g),this.entity=$C("div");var tempEntity=$C("div"),tmp=new Ui.Template(p.template);if(tempEntity.innerHTML=tmp.evaluate(this.getNodes("i")),document.body.appendChild(tempEntity),!$E(p.entityID)||!$E(p.contentID))throw new Error("[layer.js] there missing #{entityID} or #{contentID} in layer template");this.entity=$E(p.entityID),this.entity.style.position="absolute",this.entity.style.zIndex="1024",this.entity.style.left=p.x+"px",this.entity.style.top=p.y+"px",document.body.replaceChild(this.entity,tempEntity),tempEntity=null,p.nodes=this.getNodes()},setSize:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts),opts.width&&(p.nodes.content.style.width=p.width+"px"),opts.height&&(p.nodes.content.style.height=p.height+"px"),this.updateIfmSize()},setPosition:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts),this.entity.style.left=p.x+"px",this.entity.style.top=p.y+"px",$IE6&&p.isFixed&&(this.entity.style.left=p.x+document.documentElement.scrollLeft+"px",this.entity.style.top=p.y+document.documentElement.scrollTop+"px"),this.ifm&&(this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top)},getWidth:function(){var ld=this.entity.style.display,lv=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",w=this.entity.offsetWidth,this.entity.style.display=ld,this.entity.style.visibility=lv,w},getHeight:function(){var ld=this.entity.style.display,lv=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",h=this.entity.offsetHeight,this.entity.style.display=ld,this.entity.style.visibility=lv,h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},updateIfmSize:function(){if(this.ifm){this.ifm.style.width=this.entity.offsetWidth+"px",this.ifm.style.height=this.entity.offsetHeight+"px"}},setFixed:function(isFixed){var p=this.getProperty();p.isFixed=isFixed;if($IE6)return this.entity.style.position="absolute",void(p.isFixed?(this._ie6Fixed(),Core.Events.addEvent(window,this._ie6Fixed,"scroll")):Core.Events.removeEvent(window,this._ie6Fixed,"scroll"));p.isFixed&&$FF2?this.updateFixed():this.entity.style.position=p.isFixed?"fixed":"absolute"},updateFixed:function(){var p=this.getProperty();if(p.isFixed&&$FF2){var lastX=p.x,lastY=p.y;this.entity.style.position="absolute",this.setPosition({x:p.x+document.documentElement.scrollLeft,y:p.y+document.documentElement.scrollTop}),this.entity.style.position="fixed",this.setPosition({x:lastX,y:lastY})}},show:function(){this.entity.style.display="",this.ifm&&(this.ifm.style.display="",this.updateIfmSize())},hidden:function(){this.entity.style.display="none",this.ifm&&(this.ifm.style.display="none")},addIframe:function(){this.ifm=$C("iframe"),this.ifm.style.position="absolute",this.ifm.style.zIndex="1024",this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top,document.body.appendChild(this.ifm),Core.Dom.setStyle(this.ifm,"opacity",0)},getNodes:function(mode){var i,p=this.getProperty(),m=mode||"o",nodes={},result=p.templateString;if(result)for(i=0;i<result.length;i++){var r=result[i];switch(m){case"o":nodes[r]=$E(p.uniqueID+"_"+r);break;case"i":nodes[r]=p.uniqueID+"_"+r}}return"entity"in nodes?nodes:p.nodes},getUniqueID:function(){return parseInt(1e4*Math.random()).toString()+(new Date).getTime().toString()},setContent:function(sHTML){var p=this.getProperty();sHTML&&(p.nodes.content.innerHTML=sHTML)}},function(){var transitions={simple:function(time,startValue,changeValue,duration){return changeValue*time/duration+startValue},backEaseIn:function(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backEaseOut:function(t,b,c,d,a,p){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backEaseInOut:function(t,b,c,d,a,p){var s=1.70158;return(t/=d/2)<1?c/2*(t*t*((1+(s*=1.525))*t-s))+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},bounceEaseOut:function(t,b,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},bounceEaseIn:function(t,b,c,d){return c-transitions.bounceEaseOut(d-t,0,c,d)+b},bounceEaseInOut:function(t,b,c,d){return t<d/2?.5*transitions.bounceEaseIn(2*t,0,c,d)+b:.5*transitions.bounceEaseOut(2*t-d,0,c,d)+.5*c+b},strongEaseInOut:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},regularEaseIn:function(t,b,c,d){return c*(t/=d)*t+b},regularEaseOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},regularEaseInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},strongEaseIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},strongEaseOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},strongEaseInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},elasticEaseIn:function(t,b,c,d,a,p){if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),!a||a<Math.abs(c)){a=c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b},elasticEaseOut:function(t,b,c,d,a,p){if(0==t)return b;if(1==(t/=d))return b+c;if(p||(p=.3*d),!a||a<Math.abs(c)){a=c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},elasticEaseInOut:function(t,b,c,d,a,p){if(0==t)return b;if(2==(t/=d/2))return b+c;if(!p)p=d*(.3*1.5);if(!a||a<Math.abs(c)){a=c;var s=p/4}else s=p/(2*Math.PI)*Math.asin(c/a);return t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}},getUniqueID=function(oNode){return oNode.uniqueID};function getType(oObject){try{var s=oObject.constructor.toString().toLowerCase();return s.slice(s.indexOf("function")+9,s.indexOf("()"))}finally{s=null}}function getSuffix(sValue){try{var charCase=/(-?\d.?\d*)([a-z%]*)/i.exec(sValue);return[charCase[1],charCase[2]?charCase[2]:"px"]}finally{charCase=null}}$IE||(getUniqueID=function(oNode){try{var rnd_ID;return null==oNode.getAttribute("uniqueID")?(rnd_ID="moz__id"+parseInt(100*Math.random())+"_"+(new Date).getTime(),oNode.setAttribute("uniqueID",rnd_ID),rnd_ID):oNode.getAttribute("uniqueID")}finally{rnd_ID=null}});var runList={},saveList={};function getInstance(oNode){try{var runFunc,uID=getUniqueID(oNode);return 1!=runList[uID]?(runFunc=new ancestor,saveList[uID]={node:oNode,func:runFunc},runList[uID]=!0,runFunc):saveList[uID].func}finally{uID=runFunc=null}}function ancestor(){this._timer=null}function tween(oNode,oProperty,oEndingValue,nSeconds,sAnimation,oFunc){var instance=getInstance(oNode);instance.start.apply(instance,arguments)}ancestor.prototype.start=function(oNode,oProperty,oEndingValue,nSeconds,sAnimation,oFunc){this.reset(),(oFunc=oFunc||{}).before&&(this._func.before=oFunc.before),oFunc.end&&(this._func.end=oFunc.end),oFunc.tween&&(this._func.tween=oFunc.tween);var _propertyArr=function(oProperty){return"array"!=getType(oProperty)?[oProperty]:oProperty}(oProperty),_startValueArr=function(oNode,aProperty){var i,_len,_arr=[];for(_len=aProperty.length,i=0;i<_len;i++)_arr[_arr.length]=parseFloat(Core.Dom.getStyle(oNode,aProperty[i]));return _arr}(oNode,_propertyArr),_endValueArr=function(oEndingValue,aProperty){try{var i,_len,_suffix,_type=getType(oEndingValue),_valuearray=[],_suffixarray=[];if("array"!=_type)(_suffix=getSuffix(oEndingValue))[1]="opacity"==aProperty?"":_suffix[1],_valuearray=[_suffix[0]],_suffixarray=[_suffix[1]];else for(_len=oEndingValue.length,i=0;i<_len;i++)(_suffix=getSuffix(oEndingValue[i]))[1]="opacity"==aProperty[i]?"":_suffix[1],_valuearray[_valuearray.length]=_suffix[0],_suffixarray[_suffixarray.length]=_suffix[1];return[_valuearray,_suffixarray]}finally{_type=_valuearray=_suffixarray=i=_len=_suffix=null}}(oEndingValue,_propertyArr);this._node=oNode,this._property=_propertyArr,this._endingvalue=_endValueArr[0],this._suffixvalue=_endValueArr[1],this._startvalue=_startValueArr,this._end=!1,this._fps=0,null!=nSeconds&&(this._seconds=nSeconds),null!=transitions[sAnimation]&&(this._animation=transitions[sAnimation]),this._starttime=(new Date).getTime(),this._func.before(),this._timer=setInterval(Core.Function.bind3(this.play,this),10)},ancestor.prototype.play=function(){var i,ani,nTime=((new Date).getTime()-this._starttime)/1e3,_len=this._property.length;for(nTime>this._seconds&&(nTime=this._seconds),i=0;i<_len;i++)ani=this._animation(nTime,this._startvalue[i],this._endingvalue[i]-this._startvalue[i],this._seconds),Core.Dom.setStyle(this._node,this._property[i],ani+this._suffixvalue[i]);this._fps++,this._func.tween(),nTime==this._seconds&&this.stop()},ancestor.prototype.stop=function(){clearInterval(this._timer),this._end=!0,this._func.end()},ancestor.prototype.reset=function(){clearInterval(this._timer),this._end=!1,this._node=null,this._property=[],this._startvalue=[],this._endingvalue=[],this._suffixvalue=[],this._fps=0,this._seconds=.5,this._animation=transitions.simple,this._func={end:function(){},tween:function(){},before:function(){}}},tween.stop=function(oNode){getInstance(oNode).stop()},tween.isTween=function(oNode){return!getInstance(oNode)._end},Ui.tween=tween}();var DialogDisplaySet={alpha1:{show:function(dom,offsetY,callBack){var v=0,deltaY=0,startY=parseInt(dom.style.top)-offsetY;dom.style.top=startY,Core.Dom.setStyle(dom,"opacity",v),dom.style.display="";var itvId=window.setInterval((function(){v<=1&&Core.Dom.setStyle(dom,"opacity",v),deltaY<=startY+offsetY&&(dom.style.top=startY+deltaY+"px"),deltaY+=1.5,(v+=.05)>.9&&parseInt(dom.style.top)>=startY+offsetY&&(window.clearInterval(itvId),callBack&&callBack())}),10)},hidden:function(dom,offsetY,callBack){var v=1,startY=parseInt(dom.style.top),endY=startY-offsetY,currentY=startY,itvId=window.setInterval((function(){v>=0&&Core.Dom.setStyle(dom,"opacity",v),currentY>=endY&&(dom.style.top=currentY+"px"),currentY-=1.5,(v-=.05)<=0&&currentY<endY&&(window.clearInterval(itvId),callBack&&callBack())}),10)}},alpha:{show:function(dom,offsetY,callBack){Core.Dom.setStyle(dom,"opacity",.3),dom.style.display="",dom.style.top=parseInt(dom.style.top)-offsetY+"px";var y1=parseInt(dom.style.top)+offsetY;Ui.tween(dom,["top","opacity"],[y1,.9],.4,"simple",{end:callBack})},hidden:function(dom,offsetY,callBack){var y1=parseInt(dom.style.top)-offsetY;Ui.tween(dom,["top","opacity"],[y1,0],.2,"simple",{end:callBack})}},fallDown:{show:function(dom,y0,y1,callBack){dom.style.display="",dom.style.top=y0+"px",Ui.tween(dom,"top",y1,.6,"bounceEaseOut",{end:callBack})},hidden:function(dom,y0,y1,callBack){dom.style.display="",dom.style.top=y0+"px",Ui.tween(dom,"top",y1,.6,"strongEaseIn",{end:callBack})}}};Core.Events.fixEvent=function(e){return void 0===e&&(e=window.event),e.target||(e.target=e.srcElement,e.pageX=e.x,e.pageY=e.y),"undefined"==typeof e.layerX&&(e.layerX=e.offsetX),"undefined"==typeof e.layerY&&(e.layerY=e.offsetY),e};var Drag3=function(beDragObj,movedObjs,dragMode){var _this=this;this.beDragObj=beDragObj,this.movedObjs=movedObjs||this.beDragObj,this.dragMode=dragMode||"normal",this.canDrag=!0,this.isLock=!1,this.lockArea={left:0,right:0,top:0,bottom:0},this.dragSet={normal:function(){_this.normalDrag()},border:function(){_this.borderDrag()},opacity:function(){_this.opacityDrag()}},this.dragObjsFunc=function(){_this.onDrag(),_this.dragObjs()},function(){_this.beDragObj.style.MozUserSelect="none",Core.Events.addEvent(_this.beDragObj,(function(){return!1}),"selectstart"),Core.Events.addEvent(_this.beDragObj,(function(){return!1}),"drag");for(var i=0;i<_this.movedObjs.length;i++)_this.movedObjs[i]!=_this.beDragObj&&(_this.movedObjs[i].style.position="absolute",_this.movedObjs[i].style.left||(_this.movedObjs[i].style.left=_this.movedObjs[i].offsetLeft+"px"),_this.movedObjs[i].style.top||(_this.movedObjs[i].style.top=_this.movedObjs[i].offsetTop+"px"));Core.Events.addEvent(_this.beDragObj,_this.dragSet[_this.dragMode],"mousedown"),$IE?Core.Events.addEvent(_this.beDragObj,(function(){Core.Events.removeEvent(_this.beDragObj,_this.dragObjsFunc,"mousemove"),_this.beDragObj.releaseCapture(),_this.onDragEnd()}),"mouseup"):Core.Events.addEvent(document,(function(){Core.Events.removeEvent(document,_this.dragObjsFunc,"mousemove"),_this.onDragEnd()}),"mouseup")}()};Drag3.prototype={capture:function(){this.canDrag=!0},release:function(){this.canDrag=!1},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},dragObjs:function(){e=Core.Events.getEvent();for(var i=0;i<this.movedObjs.length;i++)this.isLock?(e.clientX-this.movedObjs[i].deltaX<this.lockArea.left?this.movedObjs[i].style.left=this.lockArea.left+"px":e.clientX-this.movedObjs[i].deltaX>this.lockArea.right-this.movedObjs[i].offsetWidth?this.movedObjs[i].style.left=this.lockArea.right-this.movedObjs[i].offsetWidth+"px":this.movedObjs[i].style.left=e.clientX-this.movedObjs[i].deltaX+"px",e.clientY-this.movedObjs[i].deltaY<this.lockArea.top?this.movedObjs[i].style.top=this.lockArea.top+"px":e.clientY-this.movedObjs[i].deltaY>this.lockArea.bottom-this.movedObjs[i].offsetHeight?this.movedObjs[i].style.top=this.lockArea.bottom-this.movedObjs[i].offsetHeight+"px":this.movedObjs[i].style.top=e.clientY-this.movedObjs[i].deltaY+"px"):(this.movedObjs[i].style.left=e.clientX-this.movedObjs[i].deltaX+"px",this.movedObjs[i].style.top=e.clientY-this.movedObjs[i].deltaY+"px")},normalDrag:function(){e=Core.Events.getEvent();for(var i=0;i<this.movedObjs.length;i++)this.movedObjs[i].deltaX=e.clientX-parseInt(this.movedObjs[i].style.left),this.movedObjs[i].deltaY=e.clientY-parseInt(this.movedObjs[i].style.top);this.canDrag&&($IE?(this.beDragObj.setCapture(),Core.Events.addEvent(this.beDragObj,this.dragObjsFunc,"mousemove")):Core.Events.addEvent(document,this.dragObjsFunc,"mousemove")),this.onDragStart()},borderDrag:function(obj,borderWidth){},opacityDrag:function(obj,opacityValue){}},Ui.Drag3=Drag3;var Dialog=function(template){var _this=this;_this.entity=null,_this.ifm=null;var p,Property={id:"",x:0,y:0,width:0,height:0,isFixed:!1,layer:new Layer(template),template:template,canDrag:!1,dragEntity:null,name:"",uniqueID:"",isShow:!1,nodes:{},focusNode:null,displayMode:"normal",_modeDisplayRuning:!1,enabled:!0};this.getProperty=function(){return Property},(p=_this.getProperty()).uniqueID=p.layer.getProperty().uniqueID,p.id=p.uniqueID+"_dialog",p.nodes=_this.getNodes(),_this.entity=p.layer.entity,_this.ifm=p.layer.ifm,p.width=parseInt(_this.entity.style.width),p.nodes.titleBar&&(p.dragEntity=new Ui.Drag3(p.nodes.titleBar,_this.ifm?[_this.ifm,_this.entity]:[_this.entity]),p.nodes.titleBar.style.cursor="move",Core.Events.addEvent(p.nodes.titleBar,(function(){return!1}),"selectstart"),p.dragEntity.onDrag=function(){_this.onDrag()}),Core.Events.addEvent(window,(function(){if(p.isShow&&p.isFixed){var win=Core.System.winSize(),_x=win.width/2-_this.getWidth()/2,_y=win.height/2-_this.getHeight()/2;_x=_x<0?0:_x,_y=_y<0?0:_y,_this.setPosition({x:_x,y:_y})}}),"resize")};Dialog.prototype={setPosition:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts),this.getProperty().layer.setPosition(opts)},setSize:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts),p.layer.setSize(opts)},setFixed:function(isFixed){var p=this.getProperty();p.isFixed=isFixed,this.getProperty().layer.setFixed(p.isFixed)},setContent:function(sHTML){this.getProperty();this.getProperty().layer.setContent(sHTML)},setTemplate:function(template){var p=this.getProperty();p.template=template,p.layer.setTemplate(p.template)},setDrag:function(canDrag){var p=this.getProperty();p.canDrag=canDrag,p.canDrag?p.dragEntity.capture():p.dragEntity.release()},getWidth:function(){return this.getProperty().layer.getWidth()},getHeight:function(){return this.getProperty().layer.getHeight()},getX:function(){return this.getProperty().layer.getX()},getY:function(){return this.getProperty().layer.getY()},show:function(mode){var p=this.getProperty(),_this=this;p.isShow=!0,this.ifm&&(this.ifm.style.display=""),this.onShow(),"normal"==p.displayMode||"normal"==mode?this.entity.style.display="":(p._modeDisplayRuning=!0,p.enabled=!1,this._showWithMode((function(){p._modeDisplayRuning=!1,p.enabled=!0,_this.onDisplaied&&_this.onDisplaied()})))},close:function(mode){var _this=this,p=this.getProperty();"normal"==p.displayMode||"normal"==mode?(p.isShow=!1,p.layer.hidden(),this.destroy(),this.onClose(),_this.onDisplayFinished&&_this.onDisplayFinished()):p._modeDisplayRuning||(p._modeDisplayRuning=!0,p.enabled=!1,this._hiddenWithMode((function(){p.isShow=!1,p.layer.hidden(),p._modeDisplayRuning=!1,p.enabled=!0,_this.destroy(),_this.onClose(),_this.onDisplayFinished&&_this.onDisplayFinished()})))},hidden:function(mode){var _this=this,p=this.getProperty();"normal"==p.displayMode||"normal"==mode?(p.isShow=!1,p.layer.hidden(),this.onHidden(),_this.onDisplayFinished&&_this.onDisplayFinished()):p._modeDisplayRuning||(p._modeDisplayRuning=!0,p.enabled=!1,this._hiddenWithMode((function(){p.isShow=!1,p.layer.hidden(),_this.onHidden(),p._modeDisplayRuning=!1,p.enabled=!0,_this.onDisplayFinished&&_this.onDisplayFinished()})))},_showWithMode:function(callBack){var p=this.getProperty();Core.System.winSize();if("alpha"===p.displayMode)DialogDisplaySet.alpha.show(this.entity,20,callBack)},_hiddenWithMode:function(callBack){var p=this.getProperty();Core.System.winSize();if("alpha"===p.displayMode)DialogDisplaySet.alpha.hidden(this.entity,20,callBack)},destroy:function(){try{this.getProperty().nodes.iframe&&(this.getProperty().nodes.iframe.src="")}catch(ex){}this.entity&&this.entity.parentNode.removeChild(this.entity),this.entity=null,this.ifm&&(this.ifm.parentNode.removeChild(this.ifm),this.ifm=null)},onShow:function(){},onClose:function(){},onHidden:function(){},onDrag:function(){},onDisplaied:function(){},onDisplayFinished:function(){},setAreaLocked:function(state){this.getProperty().dragEntity.isLock=state;var _this=this;state&&(_this._updateLockArea(),Core.Events.addEvent(window,(function(){_this._updateLockArea()}),"resize"))},_updateLockArea:function(){var p=this.getProperty(),win=Core.System.winSize();p.isFixed?$IE6?(p.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+win.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+win.height},Core.Events.addEvent(window,(function(){p.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+win.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+win.height}}),"scroll"),Core.Events.addEvent(window,(function(){p.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+win.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+win.height}}),"resize")):p.dragEntity.lockArea={left:0,right:win.width,top:0,bottom:win.height}:p.dragEntity.lockArea={left:0,right:document.documentElement.scrollWidth,top:0,bottom:document.documentElement.scrollHeight}},updateFixed:function(){this.getProperty().layer.updateFixed()},getNodes:function(mode){return this.getProperty().layer.getNodes(mode)},setFocus:function(){var p=this.getProperty();if(p.focusNode&&"none"!=p.focusNode.style.display)try{p.focusNode.focus()}catch(ex){}else"none"!=this.entity.style.display&&this.entity.focus()},getUniqueID:function(){return this.getProperty().layer.getUniqueID()}},Core.String.byteLength=function(str){if(void 0===str)return 0;var aMatch=str.match(/[^\x00-\x80]/g);return str.length+(aMatch?aMatch.length:0)},Core.Array.ArrayWithout=function(){if(arguments.length<2)return 1==arguments.length?arguments[0]:null;var results=[],aa=arguments[0];if(null===aa||aa.constructor!=Array)return null;if(arguments[1].constructor==Array){var args=[];args[0]=aa,Core.Array.foreach(arguments[1],(function(v,i){args[i+1]=v}))}else args=arguments;for(var i=0;i<aa.length;i++){for(var isWithout=!0,j=1;j<args.length;j++)if(aa[i]==args[j]){isWithout=!1;break}isWithout&&results.push(aa[i])}return results},Lib.register=function(name,fn){for(var tmp,ns=name.split("."),nsobj=Lib;tmp=ns.shift();)ns.length?(nsobj[tmp]===undefined&&(nsobj[tmp]={}),nsobj=nsobj[tmp]):nsobj[tmp]===undefined&&(nsobj[tmp]=fn(Lib))},Lib.register("util.LS",(function(lib){var ls,getStorage=function(wnd){return wnd.localStorage?wnd.localStorage:wnd.sessionStorage?wnd.sessionStorage:wnd.globalStorage?wnd.globalStorage:function(wnd,undefined){var keys,localStorageName="data-sina-blog-storage",localStorageKeys="data-sina-blog-storage-keys",storageContainer=wnd.document.createElement("input"),removeArray=Core.Array.ArrayWithout,mark=function(key,isRemove,temp,reg){storageContainer.load(localStorageName),temp=storageContainer.getAttribute(localStorageKeys)||"";var hasKey=(reg=RegExp("\\b"+key+"\\b,?","i")).test(temp)?1:0;temp=isRemove?temp.replace(reg,""):hasKey?temp:""===temp?key:temp.split(",").concat(key).join(","),storageContainer.setAttribute(localStorageKeys,temp),storageContainer.save(localStorageName)},box=document.body||document.getElementsByTagName("head")[0]||document.documentElement;storageContainer.id="____storage_container_box",storageContainer.type="hidden",box.appendChild(storageContainer),storageContainer.addBehavior("#default#userData"),storageContainer.load(localStorageName);var keyStr=storageContainer.getAttribute(localStorageKeys);return{key:function(index){return isNaN(index)&&(index=0),keys[parseInt(index,10)]},getItem:function(key){return storageContainer.load(localStorageName),storageContainer.getAttribute(key)},setItem:function(key,value){storageContainer.setAttribute(key,value),storageContainer.save(localStorageName),this.length++,keys.push(key),mark(key)},removeItem:function(key){storageContainer.removeAttribute(key),storageContainer.save(localStorageName),this.length--,removeArray(keys,key),mark(key,1)},clear:function(){storageContainer.load(localStorageName);var attrs=storageContainer.getAttribute(localStorageKeys).split(","),len=attrs.length;if(""!==attrs[0]){for(var i=0;i<len;i++)storageContainer.removeAttribute(attrs[i]),storageContainer.save(localStorageName);storageContainer.setAttribute(localStorageKeys,""),storageContainer.save(localStorageName),this.length=0}},length:(keys=keyStr?keyStr.split(","):[]).length}}(wnd)},getLS=function(){return ls||(ls=getStorage(window)),ls};return{key:function(index){return getLS().key(index)},getItem:function(key){return getLS().getItem(key)},setItem:function(key,value){try{return getLS().setItem(key,value),!0}catch(e){return!1}},removeItem:function(key){return getLS().removeItem(key)},clear:function(){return getLS().clear()}}})),$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"未登录。",A00112:"博客名称超长。",A00113:"您已开通博客，请点击<a href='//control.blog.sina.com.cn/blogprofile/index.php'>个人中心</a>进入。",A00116:"不能包含 sina 等有特殊含义的字符。",A11003:"此账户已完成博客快速设置，点击确定，直接进入博客。",A44001:"博客个性地址不能为空。",A44002:"地址格式不对。",A44003:"抱歉，此地址已被占用。",A44005:"抱歉，请按照正确格式填写博客地址。"}),function(){var phoneNumReg=/^(1[0-6,8-9]\d|17[2-9])\d{8}$/;if(scope.blogOpener)scope.addBlogOpenerEvent=function(){};else{var openBlog=function(){this._hasInit=!1};openBlog.prototype={getCon:function(){return['<div class="CP_layercon8"><div class="nowOpenBlog"><strong>根据相关法律要求，请先通过手机号码实名验证</strong><div class="boxA"><label class="open-blog-label">博客名称：</label><input id="blogNameInput_t" type="text" class="ipt" /><img style="display:none" id="blogNameIcon_t" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" class="SG_icon SG_icon49 tips"><p id="blogNameError_t" class="tip">名称不能为空</p></div><div  class="boxA"> <label class="open-blog-label">隐私设置：</label><p  class="private-options"><input type="radio" name="isPrivate_t" checked id="openAll1_t" class="rd" /><label for="openAll1_t">对所有人开放</label><input type="radio" name="isPrivate_t" id="openMe1_t" class="rd" /><label for="openMe1_t">仅对自己开放，私密博客</label></p></div><div  class="boxA"><label class="open-blog-label">手机号码：</label><div class="open-blog-phone-border"><input id="blogPhoneNum_t" type="text" class="ipt" value="" placeholder="请输入手机号" /></div><p id="blogPhoneNumError_t" class="tip">名称不能为空</p></div><div class="boxA"><div id="send-msg-tip_t" class="send-msg-tip"></div></div><div style="margin-top:12px;margin-left:10px;width:304px;"><div id="checkCodeBox_open_msg1"></div></div><div id="ErrTips_t" class="ErrTips">系统繁忙，请稍后再试</div><div class="boxB"><p><a id="openBlogOkBtn_t" class="btn" href="javascript:void(0)">完成开通</a><a id="openBlogCancel" href="javascript:void(0)">取消</a></p></div></div></div>'].join("")},_initDialog:function(){var _this=this;Lib.checkAuthor((function(){_this.key=getKeyName(),_this._dialog=winDialog.createCustomsDialog({content:_this.getCon()},"openblog");blogNameEvent($E("blogNameInput_t"),$E("blogNameError_t"),[],$E("blogNameIcon_t")),openBlogPhoneEvent($E("blogPhoneNum_t"),$E("blogPhoneNumError_t"),[],$E("blogPhoneNumIcon_t"),"send-msg-tip_t"),_this.bindEvent()}),"openblog"+(new Date).getTime())},showDialog:function(callBack,needToOpen,forceOpen){needToOpen=needToOpen||!1,this._hasInit||(this._initDialog(),this._hasInit=!0);var me=this;if(scope.whenOpenBlogCallback=callBack,scope.hasOpenBlog)trace("这是已登陆的用户"),"open"==scope.hasOpenBlog?(trace("并且他开通的博客"),scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback()):($E("openblogcss")||Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"}),trace("他们没有开通博客"),this._showDialog(needToOpen));else{trace("这是一位后登陆的用户");var t=0,timmer=setInterval((function(){trace("呀，怎么还没有出结果啊--"+t),scope.hasOpenBlog&&(clearInterval(timmer),"open"==scope.hasOpenBlog?(trace("并且他开通的博客"),scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback()):(trace("他们没有开通博客"),me._showDialog(needToOpen))),10==++t&&Lib.checkAuthor((function(){trace("等不及了，自己发吧。。。"),clearInterval(timmer),new Interface("//control.blog.sina.com.cn/riaapi/profile/unread.php","jsload").request({GET:{uid:$UID,product:"blog"},onSuccess:function(data){scope.hasOpenBlog=1==data.isbloguser?"open":"no",trace("~~~~~~~~~~~~~~~~~~~"+scope.hasOpenBlog),"open"==scope.hasOpenBlog?(trace("并且他开通的博客"),scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback()):($E("openblogcss")||Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"}),trace("他们没有开通博客"),me._showDialog(needToOpen))}})}),"openblogshowDialog"+(new Date).getTime())}),10)}forceOpen&&($E("openBlogCancel").style.display="none",this._dialog.getNodes().btnClose.style.display="none")},_showDialog:function(needToOpen){$E("blogNameInput_t").value=getShotName(),hiddenError($E("blogNameError_t"),$E("blogNameIcon_t")),$E("ErrTips_t").style.visibility="hidden",$E("blogNameIcon_t").style.display="none",this._dialog.show(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle()},bindEvent:function(){var me=this;Core.Events.addEvent($E("openBlogCancel"),(function(){return me.closeDialog(),!1})),Core.Events.addEvent($E("openBlogOkBtn_t"),(function(){if(""!==$E("blogNameInput_t").value)if(Core.String.byteLength($E("blogNameInput_t").value)>24)showError($E("blogNameError_t"),"博客名称超长",$E("blogNameIcon_t"));else if(""!==$E("blogPhoneNum_t").value){if(phoneNumReg.test($E("blogPhoneNum_t").value))return whenOpenBlog({nameErrorEle:$E("blogNameError_t"),nameOkIcon:$E("blogNameIcon_t"),phoneErrorEle:$E("blogPhoneNumError_t"),phoneOkIcon:$E("blogPhoneNumIcon_t"),openName:$E("blogNameInput_t").value||getShotName(),isprivate:$E("openAll1_t").checked?0:1,phoneNum:$E("blogPhoneNum_t").value,errorEle:$E("ErrTips_t"),from:"floatingLayer",okCallback:function(res,blogInfo){scope.whenOpenBlogCallback&&scope.whenOpenBlogCallback(res,blogInfo),$E("openedBlogTray")&&"none"==$E("openedBlogTray").style.display&&($E("outOfOpenBlogTray").style.display="none",$E("noOpenedBlogTray").style.display="none",$E("openedBlogTray").style.display=""),$E("noOpendBlogSearchTip")&&"block"==$E("noOpendBlogSearchTip").style.display&&($E("noOpendBlogSearchTip").style.display="none",$E("opendBlogSearchTip").style.display="block"),scope.hasOpenBlog="open",me.closeDialog(),scope.whenOpenBlogCallback=function(){}}}),!1;showError($E("blogPhoneNumError_t"),"手机号不正确",$E("blogPhoneNumIcon_t"))}else showError($E("blogPhoneNumError_t"),"手机号不能为空",$E("blogPhoneNumIcon_t"));else showError($E("blogNameError_t"),"博客名称不能为空",$E("blogNameIcon_t"))}))},closeDialog:function(){this._dialog.hidden()}},scope.openBlogGetShotName=getShotName,scope.openBlogNameEvent=blogNameEvent,scope.openBlogPhoneEvent=openBlogPhoneEvent,showSendMsgTip=showSendMsgTip(),scope.openBlogWhenOpenBlog=whenOpenBlog,scope.blogOpener=new openBlog,scope.addBlogOpenerEvent=function(el){Core.Events.addEvent(el,(function(e){scope.blogOpener.showDialog((function(res,blogInfo){if(Lib.LocalDB.clearCache(1,"uid_"+$UID+"unread"),Lib.util.LS.removeItem("uid"+$UID),"fakeIndex"!=scope.$pageid){$E("openedBlogTray")?($E("openedBlogTray").style.display="",$E("noOpenedBlogTray").style.display="none",$E("outOfOpenBlogTray").style.display="none",blogInfo&&($E("loginBarAppMenuLabel").innerHTML=blogInfo.loginNick)):setTimeout((function(){var wnd=window;wnd.$tray&&wnd.$tray.renderLogin()}),600);var successOpenFun=function(){scope.___importV&&(scope.___importV(),scope.___openBlogFlag=1)},alertConf={subText:scope.___importV?"":['<div class="CP_w_cnt SG_txtb">欢迎您在新浪博客安家！除了写博客，看博客外，您还可以进入个人中心完善您的个人资料，更有很多有趣的应用等着您哦。</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="//control.blog.sina.com.cn/blogprofile/index.php" onclick="winDialog.getDialog(\'unregister\').hidden();" target="_blank">到博客个人中心&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",funcOk:successOpenFun,funcClose:successOpenFun,width:300};winDialog.alert("开通博客成功",alertConf,"unregister");var commentNickEl=$E("commentNick");if(commentNickEl){for(var child=commentNickEl.firstChild;child;)commentNickEl.removeChild(child),child=commentNickEl.firstChild;commentNickEl.innerHTML=blogInfo.loginNick+":"}}else window.location.href="//i.blog.sina.com.cn/blogprofile/index.php?atten=1"}),!0)}),"click")}}function getShotName(){for(var val=$nick,nameLen=Core.String.byteLength(val);nameLen>18;)val=val.substring(0,val.length-1),nameLen=Core.String.byteLength(val);return val+"的博客"}function blogNameEvent(inputEle,errEle,optArr,icon){inputEle.onfocus=function(){inputEle.className="ipt focus",styleThey(optArr,""),icon.style.display=""},inputEle.onblur=function(){inputEle.className="ipt",checkBlogName(inputEle,errEle,icon),styleThey(optArr,"none")},inputEle.onkeyup=function(){checkBlogName(inputEle,errEle,icon)}}function openBlogPhoneEvent(inputEle,errEle,optArr,icon,msgTipId){var clearMsgTip;inputEle.onfocus=function(){-1!==inputEle.parentNode.className.indexOf("open-blog-phone-border")&&(inputEle.parentNode.className="focus open-blog-phone-border")},inputEle.onblur=function(){-1!==inputEle.parentNode.className.indexOf("open-blog-phone-border")&&(inputEle.className="ipt",inputEle.parentNode.className="open-blog-phone-border")},inputEle.onkeyup=function(){inputEle.value.length<=10?hiddenError(errEle,icon):phoneNumReg.test(inputEle.value)?(hiddenError(errEle,icon),clearMsgTip=showSendMsgTip(inputEle.value,(function(code,msg){"A00016"==code&&showError(errEle,msg||"手机号码错误",icon),"A00020"==code&&showError(errEle,msg||"手机号码重复",icon),"A00021"==code&&showError(errEle,msg||"操作过于频繁，超出限制",icon),"A00022"==code&&showError(errEle,msg||"未收到短信，请稍后再试",icon),"A00013"==code&&showError(errEle,msg||"短信内容错误，请检查内容为”KTBLOG“后重新发送",icon),"AB0001"===code&&showError(errEle,msg||"博客注册功能维护中，升级后将重新开放，给您带来的不便我们深表歉意。",icon)}),msgTipId)):(showError(errEle,"手机号码不正确",icon),clearMsgTip&&clearMsgTip())}}function showSendMsgTip(){var ide;return function(phoneNum,cb,tipsId){return ide=setTimeout((function(){new Interface("//control.blog.sina.com.cn/riaapi/reg/check_blog_phone.php","ijax").request({GET:{uid:$UID,phone:phoneNum},onSuccess:function(data){var $tip=$E(tipsId);$tip.innerHTML="<p>"+data.msg+"</p>",$tip.style.display="block"},onError:function(res){$E(tipsId).style.display="none",res.data&&res.data.msg?cb(res.code,res.data.msg):cb(res.code,"")}})}),800),function(){$E(tipsId).style.display="none",clearTimeout(ide)}}}function whenOpenBlog(opt){if(opt.errorEle.style.visibility="hidden",!1!==whenOpenBlog.requestComplete){if(opt.nameErrorEle.innerHTML)return changeTextBgC(opt.nameErrorEle.parentNode),void setTimeout((function(){changeTextBgC(opt.nameErrorEle.parentNode)}),442);var targetButtonId="floatingLayer"===opt.from?"openBlogOkBtn_t":"openBlogOkBtn";$E(targetButtonId).className="loading";var blogInfo={loginName:getKeyName(),blogName:opt.openName},my_data={uid:$UID,loginname:blogInfo.loginName,blogname:blogInfo.blogName,version:7,src:"layer",phone:opt.phoneNum,isprivate:opt.isprivate};new Interface("//control.blog.sina.com.cn/riaapi/reg/open_blog.php","jsload").request({GET:my_data,onSuccess:function(res){whenOpenBlog.requestComplete=!0,scope.blogOpener.isNewArtTpl?$E(targetButtonId).className="btn_style":$E(targetButtonId).className="btn",opt.okCallback(res,blogInfo),blogInfo=null},onError:function(res){var nameErr=$E("blogNameError"),nameIcon=$E("blogNameIcon"),layerNameErr=$E("blogNameError_t"),layerNameIcon=$E("blogNameIcon_t");if(res.data&&res.data.msg)var errorMsg=res.data.msg;else errorMsg="";switch(res.code){case"A11008":case"A11010":nameErr&&nameIcon&&showError(nameErr,errorMsg||"输入内容有误，请修改",nameIcon),layerNameErr&&layerNameIcon&&showError(layerNameErr,errorMsg||"输入内容有误，请修改",layerNameIcon);break;case"A00020":opt.phoneErrorEle&&showError(opt.phoneErrorEle,errorMsg||"手机号码重复",opt.phoneOkIcon);break;case"A00022":opt.phoneErrorEle&&showError(opt.phoneErrorEle,errorMsg||"未收到短信，请稍后再试",opt.phoneOkIcon);break;case"A00013":opt.phoneErrorEle&&showError(opt.phoneErrorEle,errorMsg||"短信内容错误，请检查内容为”KTBLOG“后重新发送",opt.phoneOkIcon);break;case"A00016":opt.phoneErrorEle&&showError(opt.phoneErrorEle,errorMsg||"手机号码错误",opt.phoneOkIcon);break;case"A00021":opt.phoneErrorEle&&showError(opt.phoneErrorEle,errorMsg||"操作过于频繁，超出限制",opt.phoneOkIcon);break;case"A20003":case"A20103":showError(opt.errorEle,"验证码错误。");break;case"AB0001":showError(opt.errorEle,"博客注册功能维护中，升级后将重新开放，给您带来的不便我们深表歉意。");break;default:showError(opt.errorEle,"系统繁忙，请稍后再试。")}whenOpenBlog.requestComplete=!0,scope.blogOpener.isNewArtTpl?$E(targetButtonId).className="btn_style":$E(targetButtonId).className="btn"}})}}function changeTextBgC(ele){for(var i=1;i<=55;i++)!function(val){setTimeout((function(){ele.style.backgroundColor="rgb(255, "+ +(200+val)+", "+(200+val)+")"}),8*val)}(i)}function getKeyName(){var SUBPCookie=Utils.Cookie.getCookie("SUBP");return sinaSSOEncoder.getSUBPCookie.decode(SUBPCookie).ln}function styleThey(eleArr,str){for(var i=0;eleArr[i];i++)eleArr[i].style.display=str}function checkBlogName(inputEle,errEle,icon){var val=inputEle.value;(/^(?:\s|[　])+|(?:\s|[　])+$/.test(val)&&(inputEle.value=Core.String.trim(val),val=inputEle.value),val)?Core.String.byteLength(val)>24?showError(errEle,"博客名称超长",icon):hiddenError(errEle,icon):showError(errEle,"博客名称不能为空",icon)}function showError(ele,str,icon){ele.innerHTML=str,ele.style.display="block",ele.id.indexOf("ErrTips")>=0&&(ele.style.visibility="visible"),icon&&(icon.style.display="inline-block",icon.style.zoom="1",icon.className="SG_icon SG_icon48 tips")}function hiddenError(ele,icon){ele.innerHTML="",ele.style.display="none",icon&&(icon.style.display="none",icon.className="SG_icon SG_icon49 tips")}}(),function(){var addAttention=function(nVisitId,nUserId,addedCallBack){var i_attention=new Interface("//control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax");Lib.checkAuthor((function(){i_attention.request({POST:{uid:nVisitId||$UID,aid:nUserId||scope.$uid},onSuccess:function(){},onError:function(oData){var msg="";switch(oData.code){case"A11007":msg=$SYSMSG.A11007.replace("#{linkNewBlog}","https://login.sina.com.cn/hd/reg_sec.php?entry=blog"),winDialog.alert(msg,{funcOk:function(){window.open("https://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")}});break;case"A33003":msg=$SYSMSG.A33003.replace("#{UID}",$UID),winDialog.alert(msg);break;case"A33004":var alertConf={subText:['<div class="CP_w_cnt SG_txtb">以后对方的动态（发博文，图片，投票等），都可以在<span style="color:red">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="//control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention" onclick="winDialog.getDialog(\'attention\').hidden();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",width:300};try{var attentionButton=$E("module_901_attention");attentionButton.className="SG_aBtn SG_aBtn_dis",attentionButton.innerHTML="<cite onclick=\"Lib.Component.isAttentioned('"+$UID+"', '"+scope.$uid+"');\">已关注</cite>"}catch(e){}msg=$SYSMSG.A33004,alertConf.subText=alertConf.subText.replace(/#{UID}/g,$UID),winDialog.alert(msg,alertConf,"attention");break;default:showError(oData.code)}addedCallBack(oData.code)},onFail:function(){showError($SYSMSG.A00001)}})}),"addAttention"+(new Date).getTime())};Lib.Component.Attention=function(nVisitId,nUserId,addedCallBack){addedCallBack=addedCallBack||function(){},Lib.checkAuthor((function(){$isLogin?scope.blogOpener.showDialog((function(){addAttention(nVisitId,nUserId,addedCallBack)})):(new Lib.Login.Ui).login((function(){scope.blogOpener.showDialog((function(){Core.Function.bind3(addAttention,null,[nVisitId,nUserId,addedCallBack])()}))}),!1,"referer:"+location.hostname+location.pathname+",func:0004")}),"attention"+(new Date).getTime())},Lib.Component.deleteAttention=function(sUid,sAid){winDialog.getDialog("attention").close(),winDialog.confirm("是否要取消关注？",{funcOk:function(){new Interface("//control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload").request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var attentionButton=$E("module_901_attention");attentionButton.className="SG_aBtn",attentionButton.innerHTML="<cite onclick=\"Lib.Component.Attention('"+$UID+"', '"+scope.$uid+"');\">加关注</cite>"},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){Lib.Component.isAttentioned()},textOk:"是",textCancel:"否"})},Lib.Component.isAttentioned=function(){winDialog.alert("已关注此人！",{subText:['<ul class="CP_w_part CP_w_aLine">','<li><a href="//control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention2" onclick="winDialog.getDialog(\'attention\').close();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03"},"attention")}}(),$SetPV=function(nPv){nPv=window.parseInt(nPv),Lib.checkAuthor((function(){$E("comp_901_pv")&&($E("comp_901_pv").innerHTML="<strong>"+Core.String.formatNumber(nPv)+"</strong>")}),"SetPV"+(new Date).getTime());var grade=0,score=[0,50,100,150,200,300,500,800,1500,3e3,5e3,1e4,15e3,25e3,4e4,7e4,1e5,15e4,2e5,5e5,1e6,2e6,5e6,1e7,2e7,5e7,1e8,15e7,2e8,25e7,3e8,35e7,4e8,45e7,5e8,55e7];nPv>=5e7?grade=Math.floor(nPv/5e7)+24:(grade=-1,score=score.join(",").replace(/(\d+)/g,(function(a,b){window.parseInt(b)<=nPv&&grade++}))),"article"!==scope.$pageid&&"articleM"!==scope.$pageid&&"articletj"!==scope.$pageid||(scope.$rank=grade),grade=grade.toString().replace(/(\d)/g,(function($0,$1){return'<img src="//simg.sinajs.cn/blog7style/images/common/number/'+$1+'.gif"/>'})),$E("comp_901_grade")&&($E("comp_901_grade").innerHTML=grade)},Sina.pkg("Utils.Form"),Core.String.leftB=function(str,len){var s=str.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");return str=str.slice(0,s.slice(0,len).replace(/\*\*/g," ").replace(/\*/g,"").length),Core.String.byteLength(str)>len&&(str=str.slice(0,str.length-1)),str},Utils.Form.limitMaxLen=function(oTextNode,nMaxLen){var nValue,keyup=function(){nValue=oTextNode.value,Core.String.byteLength(nValue)>nMaxLen&&(oTextNode.value=Core.String.leftB(nValue,nMaxLen))};Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"keyup"),Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"blur"),Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"focus")},Lib.invite_tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="javascript:void(0)" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"请先登录。",A20101:"内容超长。",A20102:"请输入正确的登录名或密码。",A20103:"请输入正确的验证码。",A20104:"请把对方在黑名单中解除，再加为好友。",A20105:"你的好友数量达到上限，不能添加新好友。",A20106:"博主已设置为拒绝接受好友邀请，请不要打扰哦。",A20107:"不能加自己为好友。",A20108:"你们已经是好友。",A20109:"不能包含sina等特殊含义字符。",A23002:"您已被对方加入黑名单。",A20121:"参数格式不正确。",A20000:"参数格式不正确。",A20001:"内容超长。",A20002:"请输入正确的登录名或密码。",A20003:"请输入正确的验证码。",A20004:"不能包含sina等特殊含义字符。",A20005:"纸条内容不能为空。",A20006:"不能自己给自己发纸条",A20007:"请把对方在黑名单中解除，再发送纸条。",A20020:"给#{nick}的纸条发送失败！",A20008:"对不起，您短时间发表的纸条过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20999:"对不起，您短时间发送的好友请求过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20009:"博主已设置为拒绝接收所有纸条，请不要打扰哦。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",A20015:"发生错误，请稍作休息~",A30006:"该博主只接收来自好友的纸条，您还不是Ta的好友哦。",A30007:"该博主只接收关注的用户的纸条，该博主还没有关注您哦。",A10006:"对不起，您已被博主列入黑名单，无法发送小纸条。"}),Lib.register("blogv.getVHTML",(function(){return function(wtype,isLinked){var title,className,str;return 0==(wtype=isNaN(wtype)?-1:parseInt(wtype,10))?(title="新浪个人认证",className=" SG_icon146"):0<wtype&&8>wtype&&(title="新浪机构认证",className=" SG_icon147"),!1!==isLinked&&(isLinked=!0),(str=title?'<img class="SG_icon '+className+'" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="'+title+'" alt="'+title+'" align="absmiddle" />':"")&&isLinked&&(str='<a target="_blank" href="//blog.sina.com.cn/v/verify">'+str+"</a>"),str}})),Lib.Invite_Base=Core.Class.create();var __isPostCotent=!1;Lib.Invite_Base.prototype={html:['<div class="CP_layercon2 addFriendItem">','<div class="toWho">#{head_image}<span>#{nickname}</span></div>','<div class="formTowho">','<div class="row1" style="display:#{login};">登录名：','<input id="invite_loginname" type="text" class="fm1" style="width:80px;"/>&nbsp;&nbsp;&nbsp;','密码：<input id="invite_password" type="password" class="fm1" style="width:73px;" maxlength="16"/>','&nbsp;&nbsp;<a target="_blank" href="https://login.sina.com.cn/getpass.html">找回密码</a><em class="SG_txtc">','|</em><a target="_blank" href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp">注册</a>','<input id="saveOnline_invite" type="checkbox" checked value="" style="display:inline-block;margin-top:3px;"/><label for="saveOnline_invite" style="margin-top:10px; display:inline-block;">记住登录状态</label>','<span id="saveCaution_invite" style="color:#999; margin-left:10px; display:none;">建议在网吧/公用电脑上取消该选项</span>','</div><p id="invite_user_error" class="ErrTips" style="display:none;">请输入正确的登录名或密码</p>','<div class="row2"><textarea id="invite_content"></textarea></div>','<div class="row1"><span id="invite_limit" class="SG_floatR SG_txtc">您还可以输入#{content_length}个汉字</span>','<div id="checkCodeBox" class="check-code-box clearfix" style="padding: 29px 0px 9px;"></div>',"</div>",'<div class="btn">','<a id="invite_submit" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>',"#{dialogTitle}</cite></a>&nbsp;&nbsp;",'<a id="invite_cancel" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>取消</cite></a>',"</div>","</div>","</div>"].join(""),dialogName:"invite",initialize:function(sUid,onlineTime){this.uid=sUid,this.onlineTime=onlineTime||15,Lib.checkAuthor(),this.isAllowSend(Core.Function.bind2((function(){var data={head_image:null!=this.headImage?this.headImage:'<img src="//portrait'+(this.uid%8+1)+".sinaimg.cn/"+this.uid+'/blog/50" align="absmiddle" alt="'+scope.owenerNickName+'" title="'+scope.owenerNickName+'" />',nickname:this.title(),login:$isLogin?"none":"",checkImage:"//interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random(),content_length:this.contentLength/2,dialogTitle:this.dialogTitle},content=new Ui.Template(this.html).evaluate(data);null==this.dialog&&(window.$inviteDialog=this.dialog=winDialog.createCustomsDialog({content:"",title:this.dialogTitle,tpl:Lib.invite_tpl}),this.dialog.addEventListener("hidden",(function(){this.destroy()}))),this.dialog.setContent(content),this.dialog.setMiddle(),this.dialog.show(),this.dialog.setAreaLocked(!0),Utils.Form.limitMaxLen($E("invite_content"),this.contentLength),Core.Events.addEvent("invite_submit",Core.Function.bind2(this.checkData,this)),Core.Events.addEvent("invite_cancel",Core.Function.bind2(this.closeDailog,this)),Core.Events.addEvent("invite_content",Core.Function.bind2((function(){clearInterval(this.check),this.check=setInterval(Core.Function.bind2((function(){var lengthOfContent=Core.String.byteLength($E("invite_content").value),visibleCount=Math.max(0,Math.floor((this.contentLength-lengthOfContent)/2));$E("invite_limit").innerHTML="您还可以输入"+visibleCount+"个汉字"}),this),500)}),this),"focus"),Core.Events.addEvent("invite_content",Core.Function.bind2((function(){clearInterval(this.check),this.check=null}),this),"blur"),this.initSaveCaution(),this.reloadName()}),this))},isAllowSend:function(cb){cb()},isFriend:function(cb){new Interface("//control.blog.sina.com.cn/riaapi/profile/IsFriend.php","jsload").request({GET:{friend_uids:scope.$uid,version:7},onSuccess:function(result){for(var flag=!1,i=0,len=result.length;i<len;i++)if(result[i].uid==scope.$uid&&1==result[i].status){flag=!0;break}cb(flag)}.bind2(this),onError:function(result){}.bind2(this),onFail:function(){}.bind2(this)})},initSaveCaution:function(){var cautionCheck=$E("saveOnline_invite"),cautionTip=$E("saveCaution_invite");$isLogin||(cautionCheck[$IE?"onclick":"onchange"]=function(){cautionCheck.checked?cautionTip.style.display="inline-block":cautionTip.style.display="none";if(cancelStatus){var url="//control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00002&rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}}),cancelStatus=null}});var cancelStatus=1},reloadName:function(){var defaultName=Lib.Login.info().ln;defaultName&&($E("invite_loginname").value=defaultName)},checkData:function(){if(!$isLogin){if(this.username=Core.String.trim($E("invite_loginname").value),this.password=Core.String.trim($E("invite_password").value),""==this.username||""==this.password)return void($E("invite_user_error").style.display="");$E("invite_user_error").style.display="none"}if($isLogin){var me=this;scope.blogOpener.showDialog((function(){me.postContent()}))}else $E("saveOnline_invite").checked?v7sendLog("48_01_39_1"):v7sendLog("48_01_39_0"),this.login()},login:function(){this.request=new Lib.Login.LoginPost(Core.Function.bind2((function(loginStatus){if(loginStatus.result){if(this.postContent){var me=this;Lib.checkAuthor((function(){scope.blogOpener.showDialog((function(){me.postContent()}))}),"invite_login"+(new Date).getTime()),$tray.renderLogin()}}else trace("登陆失败 ："+loginStatus.reason),$E("invite_user_error").style.display=""}),this),!1,"referer:"+location.hostname+location.pathname+",func:000"+(/messagesend/.test(this.Interface.url.url)?"2":"3")),this.request.login(this.username,this.password,$E("saveOnline_invite").checked?this.onlineTime:null)},resultHTML:new Ui.Template(['<div class="CP_layercon1">','<div class="CP_prompt">','<img class="SG_icon #{icon}" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif"',' width="50" height="50" align="absmiddle" />','<table class="CP_w_ttl"><tr><td>#{content}</td></tr></table>','<p class="CP_w_btns_Mid"><a class="SG_aBtn SG_aBtnB" href="#" ','onclick="window.$inviteDialog && window.$inviteDialog.hidden();return false;"><cite> 确定 </cite></a></p>',"</div>","</div>"].join("")),isPostContent:!1,postContent:function(){if(!__isPostCotent){__isPostCotent=!0,$tray.renderLogin();var param,i_addInvite=this.Interface;param={tuid:this.uid,fuid:$UID,content:$E("invite_content").value,varname:"requestId_"+window.parseInt(1e8*Math.random()),version:7,rnd:(new Date).valueOf()},i_addInvite.request({GET:param,onSuccess:Core.Function.bind2((function(){__isPostCotent=!1,v7sendLog("45_01_13_"+scope.$uid);var data={icon:"SG_icon203",content:this.successMSG()};this.dialog.setContent(this.resultHTML.evaluate(data)),null!=this.afterSubmit&&this.afterSubmit()}),this),onError:Core.Function.bind2((function(oData){if(__isPostCotent=!1,"A20109"==oData.code||"A20004"==oData.code)winDialog.alert($SYSMSG[oData.code]);else if("A20003"==oData.code||"A20103"==oData.code)winDialog.alert("验证码错误");else if("A11007"==oData.code){var msg=$SYSMSG.A11007.replace("#{linkNewBlog}","//blog.sina.com.cn/u/"+$UID);winDialog.alert(msg)}else{var data={icon:"SG_icon202",content:$SYSMSG[oData.code].replace(/#{nick}/,scope.owenerNickName)};this.dialog.setContent(this.resultHTML.evaluate(data))}null!=this.afterSubmit&&this.afterSubmit()}),this),onFail:Core.Function.bind2((function(){__isPostCotent=!1;var data={icon:"SG_icon202",content:$SYSMSG.A00001};this.dialog.setContent(this.resultHTML.evaluate(data)),this.afterSubmit()}),this)})}},closeDailog:function(){this.dialog.hidden()}},Lib.Invite=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"加好友",contentLength:200,title:function(){var owenerWType=isNaN(scope.owenerWType)?-1:parseInt(scope.owenerWType),userV=Lib.blogv.getVHTML(owenerWType);return'加"'+scope.owenerNickName+userV+'"为好友'},successMSG:function(){return["邀请发送成功，请等待对方确认。",'<div class="CP_w_cnt SG_txtb" style="font-size:12px;font-weight:normal;">以后对方的动态（发博文，图片，投票等），都可以在<span style="color: red;">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a style="font-weight:normal;font-size:12px;" href="//control.blog.sina.com.cn/blogprofile/index.php?type=3&from=addfiend" target="_blank">到个人中心查看其他好友动态&gt;&gt;</a></li>',"</ul>"].join("")},Interface:new Interface("//control.blog.sina.com.cn/riaapi/profile/invitesend.php","jsload"),isAllowSend:function(cb){return scope&&scope.$private?0===(scope.$private.invitationset||0)?(cb(),!0):(winDialog.alert($SYSMSG.A20106),!1):(cb(),!0)}}),Lib.invite=function(sUid){new Lib.Invite(sUid)},Lib.invite3=function(sUid,name){scope.owenerNickName=name,new Lib.Invite(sUid)},Lib.Scrip=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"发纸条",headImage:"",contentLength:300,title:function(){return"发纸条给："+scope.owenerNickName},successMSG:function(){return"给"+scope.owenerNickName+"的纸条发送成功！"},Interface:new Interface("//control.blog.sina.com.cn/riaapi/profile/messagesend.php","jsload"),afterSubmit:function(){},isAllowSend:function(cb){return!scope||!scope.$private||(1===(scope.$private.pageset||0)?(this._showMsg("A20009"),!1):void cb())},_showMsg:function(code){winDialog.alert($SYSMSG[code])}}),Lib.scrip=function(sUid){new Lib.Scrip(sUid)},"undefined"==typeof SinaEx&&(SinaEx={}),SinaEx.findNode=function(element,direction,start){for(var node=element[start];node;node=node[direction])if(1==node.nodeType)return node;return null},SinaEx.prev=function(element){return SinaEx.findNode(element,"previousSibling","previousSibling")},SinaEx.next=function(element){return SinaEx.findNode(element,"nextSibling","nextSibling")},SinaEx.firstChild=function(element){return SinaEx.findNode(element,"nextSibling","firstChild")},SinaEx.parent=function(node,nodeName){for(nodeName=nodeName.toLowerCase();node;){if(node.nodeName.toLowerCase()===nodeName)return node;node=node.parentNode}return null},SinaEx.createNode=function(html){var node=document.createElement("div");return node.innerHTML=html,node.firstChild},SinaEx.addClass=function(node,classname){var cn=node.className;-1===(" "+cn+" ").indexOf(" "+classname+" ")&&(node.className=classname+" "+cn)},SinaEx.removeClass=function(node,classname){var cn=(" "+node.className+" ").replace(" "+classname+" "," ");node.className=cn.replace(/^\s+/,"").replace(/\s+$/,"")},document.documentElement.contains?SinaEx.contains=function(a,b){return!a.contains||a.contains(b)}:document.documentElement.compareDocumentPosition?SinaEx.contains=function(a,b){return a===b||!!(16&a.compareDocumentPosition(b))}:SinaEx.contains=function(a,b){for(;b;){if(a===b)return!0;b=b.parentNode}return!1},$registComp(901,{baseHTML:['<div class="info"><div class="info_img" id="comp_901_head"><img src="//portrait'+(1*scope.$uid%8+1)+".sinaimg.cn/"+scope.$uid+'/blog/180" id="comp_901_head_image" width="180" height="180" alt="" /></div><div class="info_txt"><div class="info_nm"><img id="comp_901_online_icon" style="display:none;" class="SG_icon SG_icon1" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" /><span class="SG_txtb"><strong id="comp_901_nickname">&nbsp;</strong></span><span class="info_into"><a class="SG_linka" href="//space.sina.com.cn/u/1406758883"><img class="SG_icon SG_icon41" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="空间" align="absmiddle" />进入我的空间</a></span><div class="clearit"></div></div><div class="info_btn1"><a href="//you.video.sina.com.cn/'+scope.$uhost+'" class="SG_aBtn SG_aBtn_ico" target="_blank"><cite><img class="SG_icon SG_icon16" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />播客</cite></a><a href="//weibo.com/'+scope.$uid+'?source=blog" class="SG_aBtn SG_aBtn_ico"><cite><img class="SG_icon SG_icon51" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />微博</cite></a><div class="clearit"></div></div><div class="SG_j_linedot"></div><div class="info_list"><ul class="info_list1"><li><span class="SG_txtc">博客等级：</span><span id="comp_901_grade">读取中…</span></li><li><span class="SG_txtc">博客积分：</span><span id="comp_901_score">读取中…</span></li></ul><ul class="info_list2"><li><span class="SG_txtc">博客访问：</span><span id="comp_901_pv">读取中…</span></li><li><span class="SG_txtc">关注人气：</span><span id="comp_901_attention">读取中…</span></li></ul></div><div class="clearit"></div></div><div class="clearit"></div></div>'].join(""),load:function(){var _this=this;null==$E("comp_901_head")&&_this.setContent(_this.baseHTML),Lib.checkAuthor((function(){if(0==$isAdmin&&$isLogin?_this.loadIsFriend():0!=$isAdmin||$isLogin?_this.isOnline=!0:(_this.isFriend=!1,_this.loadOnline()),"fakeIndex"!=scope.$pageid?Lib.Uic.getNickName([scope.$uid],(function(data){Lib.Uic.getUserPic(scope.$uid,(function(imgData){$E("comp_901_head")&&$E("comp_901_head").children.length>0&&($E("comp_901_head").children[0].src=imgData.b||"//portrait"+(1*scope.$uid%8+1)+".sinaimg.cn/"+scope.$uid+"/blog/180")}));var _trim=Core.String.trim,ownernickEl=$E("ownernick")||$E("comp_901_nickname"),nickName=_trim(ownernickEl.textContent||ownernickEl.innerText),nickHTML=_trim(ownernickEl.innerHTML);if(Core.String.byteLength(data[scope.$uid])>20)var nick=data[scope.$uid].replace(/(.{10})/g,"$1<br/>");else nick=data[scope.$uid];if(nickName||nickName==nickHTML)if(nickName&&nickName!=nickHTML)try{var imgs=ownernickEl.getElementsByTagName("a"),cons=imgs&&imgs[0].innerHTML;ownernickEl.innerHTML=nick+'&nbsp;<a href="//blog.sina.com.cn/v/verify" target="_blank">'+cons+"</a>"}catch(e){ownernickEl.innerHTML=nick}else ownernickEl.innerHTML=nick;else ownernickEl.innerHTML=nick+"&nbsp;"+nickHTML})):"fakeIndex"===scope.$pageid&&Lib.Uic.getNickName([scope.$uid],(function(data){_this.showNickName(data)})),$E("comp_901_nickname"))_this.loadNickname();else{_this.renderHead();var tmp,ownernickEl=$E("ownernick"),_trim=Core.String.trim,byteLength=Core.String.byteLength;if(ownernickEl){byteLength(tmp=_trim(ownernickEl.textContent||ownernickEl.innerText).replace(/(\r|\n)/g,""));scope.owenerNickName=tmp}}_this.loadOtherInfo(),"pageSetM"==scope.$pageid&&_this.setManage&&0==scope.$private.ad&&0==scope.$private.adver&&0==scope.$private.p4p&&_this.setManage(),_this.mapEnter()}),"comp_901"+(new Date).getTime())},fixNick:function(nick){var tmp,byteLength=Core.String.byteLength,leftB=Core.String.leftB,_trim=Core.String.trim,len=byteLength(nick);return nick=_trim(nick),22<len&&(nick=(tmp=leftB(nick,20))+"<br>"+nick.replace(tmp,"")),nick},showOnlineInfo:function(){!$isAdmin&&this.isOnline&&(Core.Dom.setStyle($E("comp_901_online_icon"),"display",""),$E("comp_901_online_icon").alt="在线",$E("comp_901_online_icon").title="在线")},showNickName:function(oResult){var nickname=oResult[scope.$uid]||"";nickname=Core.String.encodeHTML(nickname);var nickEl=$E("comp_901_nickname");nickEl.innerHTML=nickname,scope.owenerNickName=nickEl.textContent||nickEl.innerText,this.renderHead(nickname)},renderHead:function(nickname){$isAdmin?Lib.Uic.getUserPic(scope.$uid,(function(data){var userPic=data.b;$E("comp_901_head").innerHTML='<a href="//control.blog.sina.com.cn/blogprofile/nick.php" title="点击上传头像" target="_blank"><img id="comp_901_head_image" width="180" height="180" alt="点击上传头像" src="'+userPic+'" /></a>'})):nickname&&($E("comp_901_head_image").title=nickname)},loadOtherInfo:function(){this.loadPv(),this.loadGoldpan(),this.loadAttention(),"index"!=scope.$pageid&&"indexM"!=scope.$pageid&&"pageSetM"!=scope.$pageid||this.loadAdManage()},loadNewIcon:function(){var _link=$C("a");_link.href="//move.blog.sina.com.cn/",_link.target="_blank",_link.position="absolute";var _img=$C("img");_img.src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",_img.className="fiveyearsIcon",$IE6?_img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='//simg.sinajs.cn/blog7style/images/special/move/move_hz.png',sizingMethod='image')":_img.style.backgroundImage="url(//simg.sinajs.cn/blog7style/images/special/move/move_hz.png)",_img.alt="邀请MSN好友获得朋友徽章",_img.title="邀请MSN好友获得朋友徽章",_img.style.border="none",_link.appendChild(_img),$E("comp_901_head").appendChild(_link),_link.onclick=function(){Utils.Io.JsLoad.request("//control.blog.sina.com.cn/blog_rebuild/msn/api/msnGuideCount.php?type=hitMedal")},_link=null},loadPv:function(){var refer="0"==document.referrer?"":encodeURIComponent(document.referrer);if(scope.totalPv&&!isNaN(scope.totalPv))$SetPV(scope.totalPv);else{var pvurl="";if(scope.$articleid)pvurl="//comet.blog.sina.com.cn/api?maintype=hits&act=4&aid="+scope.$articleid+"&ref="+refer;else{var $uidhex=(1*scope.$uid).toString(16);$uidhex.length<8&&($uidhex=("00000000"+$uidhex).substr($uidhex.length,8)),pvurl="//comet.blog.sina.com.cn/api?maintype=hits&act=3&uid="+$uidhex+"&ref="+refer}Utils.Io.JsLoad.request(pvurl,{onComplete:function(data){data&&"undefined"!=typeof data.pv&&(scope.totalPv=data.pv,$SetPV(data.pv))},onException:function(){$SetPV(0)}})}},loadBadge:function(data){var names=["点亮荣誉勋章","新新博主","新锐博主","先锋博主","精英博主","风云博主","资深博主","元老博主",0,0,"图片博主","兑换图片博主服务","私密博文","兑换私密博文","金笔","兑换金笔"],el=$E("comp_901_badge");if(el){var badges=[];data.medal>0?(data.medal>7&&(data.medal=7),badges.push({medal:data.medal,title:names[data.medal]})):badges.push({medal:8,title:names[0]}),1==data.pic_vip?badges.push({medal:10,title:names[10]}):badges.push({medal:11,title:names[11]}),1==data["private"]?badges.push({medal:12,title:names[12]}):badges.push({medal:13,title:names[13]}),data.goldpen>0?(names[14]="现有金笔"+data.goldpen/1+"支",badges.push({medal:14,title:names[14]})):badges.push({medal:15,title:names[15]});for(var htmlStr="",i=0;i<badges.length;i++){var item=badges[i],n=item.medal<10?"0"+item.medal:item.medal;imgPath="//simg.sinajs.cn/blog7style/images/common/badge/badge"+n,htmlStr+='<a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_action.php" title="[title]"><img title="[title]" alt="[title]" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="badge" style="background-image:url([imgPath].png);_background-image: url([imgPath].gif);"></a>'.replace(/\[imgPath\]/g,imgPath).replace(/\[title\]/g,item.title)}Core.Dom.insertHTML(el,htmlStr,"beforeend")}},loadGoldpan:function(){var dEl=$E("comp_901_d_goldpen"),rEl=$E("comp_901_r_goldpen");dEl&&rEl&&Utils.Io.JsLoad.request("//comet.blog.sina.com.cn/api?maintype=goldpen&uid="+scope.$uid,{onComplete:function(data){data&&(rEl.innerHTML=data.donate,dEl.innerHTML=data.receive)},onException:function(){}})},loadScore:function(){setTimeout((function(){Utils.Io.JsLoad.request("//blogcnfv5.sinajs.cn/blogscr?uid="+scope.$uid+"&varname=blogScore&.js",{onComplete:function(){if("undefined"!=typeof blogScore||null==$E("comp_901_score")){var _a=blogScore.coefficient.a,_b=blogScore.coefficient.b,_c=blogScore.coefficient.c,_d=blogScore.coefficient.d,_score=blogScore.x*_a+blogScore.y*_b+blogScore.z*_c+blogScore.w*_d;$E("comp_901_score").innerHTML="<strong>"+Core.String.formatNumber(_score)+"</strong>"}},noreturn:!0})}),1)},loadAttention:function(){var me=this,attention=new Interface("//blogtj.sinajs.cn/api/get_attention_num.php","jsload"),getVal={uid:scope.$uid,suid:$isLogin?$UID:"0",attention:"suid",userpointuid:scope.$uid,s:"1"};if(this.mashAddFriend){var friendattuid=scope.$uid,friendattsuid=$UID;friendattuid&&friendattsuid?(getVal.friendattuid=friendattuid,getVal.friendattsuid=friendattsuid):this.mashAddFriend=!1}attention.request({GET:getVal,onSuccess:Core.Function.bind2((function(oData){if(Lib.checkAuthor(),$E("comp_901_attention")){var att_num=Core.String.formatNumber(oData.num[scope.$uid]);$E("comp_901_attention").innerHTML="<strong>"+(att_num<0?0:att_num)+"</strong>"}if(oData.is_attention&&1==oData.is_attention[scope.$uid]&&(this.isAttentioned=!0,$E("comp901_btn_follow")&&$E("comp901_btn_follow").children.length>0&&($E("comp901_btn_follow").children[0].innerHTML="已关注")),"undefined"!=typeof oData.userpoint&&$E("comp_901_score")&&($E("comp_901_score").innerHTML='<a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_action.php" title="积分"><strong>'+oData.userpoint+'</strong><img width="15" height="15" align="top" title="积分" alt="积分" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon11">'),this.mashAddFriend){var data=[{uid:scope.$uid,status:oData.friendattr}];this.friendSuccessCallback(data)}oData.svr_time&&(scope.$svr_time=oData.svr_time),this.loadBadge(oData)}),this),onError:function(){$E("comp_901_attention")&&($E("comp_901_attention").innerHTML="<strong>0</strong>"),me.mashAddFriend&&me.friendErrorCallback(),me.loadBadge()},onFail:function(){$E("comp_901_attention")&&($E("comp_901_attention").innerHTML="<strong>0</strong>"),me.mashAddFriend&&me.friendErrorCallback(),me.loadBadge()}})},loadWorldCupIcon:function(){if(1==scope.$isWorldcupUser){var _link=$C("a");_link.href="//blog.2010.sina.com.cn/yunying/2010worldcup/",_link.target="_blanks";var _img=$C("img");_img.id="comp_901_wcIcon",_img.src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",_img.className="worldcup_icon worldcup_icon_l",_img.alt="记录激动时刻，赢取超级大奖！快一起参加吧！",_img.title="记录激动时刻，赢取超级大奖！快一起参加吧！",_link.appendChild(_img),$E("comp_901_head").appendChild(_link)}},load7YearsIcon:function(){$E("comp_901_head");var medalObj={medal0:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_wmm.png",medal1:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xx.png",medal2:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xr.png",medal3:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_xf.png",medal4:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_jy.png",medal5:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_fy.png?v20120917",medal6:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_zs.png",medal7:"//simg.sinajs.cn/blog7style/images/activity/blog7year/icon_yl.png"},medalType=scope.$private.medal7;if(medalType=7<medalType?7:medalType)(_a=$C("a")).setAttribute("target","_blank"),_a.setAttribute("href","//control.blog.sina.com.cn/blog_7years/index.php"),(_img=$C("img")).src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",_img.className="sevenyearsIcon",$IE6?_img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+medalObj["medal"+medalType]+"',sizingMethod='image')":_img.style.backgroundImage="url("+medalObj["medal"+medalType]+")",_img.style.border="none",_a.appendChild(_img),$E("comp_901_head").appendChild(_a);else if(!scope.$private.medal&&$UID==scope.$uid){var _a,_img;(_a=$C("a")).setAttribute("target","_blank"),_a.setAttribute("href","//control.blog.sina.com.cn/blog_7years/index.php"),(_img=$C("img")).src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",_img.className="sevenyearsIcon",$IE6?_img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+medalObj.medal0+"',sizingMethod='image')":_img.style.backgroundImage="url("+medalObj.medal0+")",_img.style.border="none",_a.appendChild(_img),$E("comp_901_head").appendChild(_a)}},load5YearsIcon:function(){if(!scope.$private.medal7){trace("【活动】显示用户勋章。");try{var text=["纪念勋章","一","二","三","四","五"],medal=scope.$private.medal;if(medal>0||0===medal){var _a=$C("a");_a.setAttribute("target","_blank"),_a.setAttribute("href","//control.blog.sina.com.cn/blog_7years/index.php");var _img=$C("img");if(_img.src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",_img.className="fiveyearsIcon",$IE6?_img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='//simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+medal+"y.png',sizingMethod='image')":_img.style.backgroundImage="url(//simg.sinajs.cn/blog7style/images/special/fiveyears/at/"+medal+"y.png)",_img.alt=medal>0?text[medal]+"周年勋章":text[0],_img.title=medal>0?text[medal]+"周年勋章":text[0],_img.style.border="none",_a.appendChild(_img),$E("comp_901_head").appendChild(_a),$UID==scope.$uid){var _span=$C("span");_span.className="updateIcon_1",_a.appendChild(_span);var flag=0;setInterval((function(){flag%2==1?(_span.className="updateIcon_1",i=0):_span.className="updateIcon_2",flag++}),500)}trace("【活动】显示用户勋章完成。")}else trace("【活动】用户还没有获得勋章。")}catch(e){trace("【活动】显示用户勋章发生异常。")}}},loadPhotoCount:function(){},loadVideoCount:function(){},loadAdManage:function(){if($isAdmin&&null!=scope.$private&&null!=scope.$private.ad&&0!=scope.$private.ad&&null==$E("comp_901_adlink")){Debug.info("添加广告共享计划管理链接");var adHTML=['<div class="info_locate2"><div class="SG_j_linedot"/></div><div id="comp_901_adlink" class="info_AD"><a href="//share.sass.sina.com.cn/widget_ad/widget_ad_index.php" target="_blank">管理广告共享计划</a></div>'].join(""),buttonNode=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt");buttonNode&&(buttonNode=buttonNode[0].lastChild,Core.Dom.insertHTML(buttonNode,adHTML,"BeforeBegin"))}},showVisitButton:function(){if(!$isAdmin)if($E("info_locate_id")){var p=$E("comp901_btn_invite");p&&(p.href="javascript:void(0)",0==this.isFriend?(p.innerHTML="<cite>加好友</cite>",p.onclick=function(){return $isLogin||v7sendLog("48_01_28"),Lib.checkAuthor((function(){Lib.invite(scope.$uid)}),"showVisitButton_jiahaoyou"+(new Date).getTime()),!1}):p.innerHTML="<cite>已是好友</cite>");winDialog.createCustomsDialog({content:['<div class="CP_layercon2 unilayer">','<div class="CP_prompt" style="padding:0;">','<table style="width:100%;margin-bottom:40px;" class="CP_w_ttl"><tbody><tr><td style="text-align:center;"><img src="//n.sinaimg.cn/blog/0977ce10/20190801/msg-515-18.png"></td></tr><tr><td style="text-align:center;height:auto;padding:10px 0;"><span style="font-size:18px;color:#333;letter-spacing: 3px;font-weight:400;font-family: Microsoft Yahei;">下载新浪博客APP</span></td></tr><tr><td style="height:auto;text-align:center;"><span style="font-size: 14px;color:#999;letter-spacing: 2px;font-weight:400;font-family: Microsoft Yahei;">纸条升级为私信，我在APP上等你~</span></td></tr></tbody></table>',"</div>","</div>"].join(""),shadow:1},"msg-qr");if((p=$E("comp901_btn_sendpaper"))&&(p.href="javascript:void(0)",p.onclick=function(){return $isLogin||v7sendLog("48_01_27"),Lib.checkAuthor((function(){Lib.scrip(scope.$uid)}),"showVisitButton_fazhitiao"+(new Date).getTime()),!1}),(p=$E("comp901_btn_msninfo"))&&(p.onclick=function(){$isLogin||v7sendLog("48_01_29")},p.href="//blog.sina.com.cn/s/profile_"+scope.$uid+".html#write"),p=$E("comp901_btn_follow")){var self=this;this.isAttentioned?p.innerHTML="<cite>已关注</cite>":p.innerHTML="<cite>加关注</cite>",p.onclick=function(){var _selfEl=this;return self.isAttentioned?self.deleteAttention():Lib.Component.Attention(null,null,(function(code){"A33004"==code&&(_selfEl.innerHTML="<cite>已关注</cite>",self.isAttentioned=!0)})),!1}}}else{var buttonNode,inviteButtonHTML="";0==this.isFriend?inviteButtonHTML="Lib.invite("+scope.$uid+');return false;" class="SG_aBtn"><cite>加好友':inviteButtonHTML+="><cite>已是好友";var result=['<div id="info_locate_id" class="info_locate"><div class="SG_j_linedot"></div>','<div class="info_btn2">','<p><a href="#" onclick="'+inviteButtonHTML,"</cite></a>",'<a href="#" onclick="Lib.scrip('+scope.$uid+');return false;" class="SG_aBtn">',"<cite>发纸条</cite></a></p>",'<p><a href="//blog.sina.com.cn/s/profile_'+scope.$uid+'.html#write" class="SG_aBtn" target="_blank">',"<cite>写留言</cite></a>",'<a id="module_901_attention" href="#" onclick="return false;" class="SG_aBtn'+(this.isAttentioned?" SG_aBtn_dis":"")+'">','<cite onclick="Lib.Component.'+(this.isAttentioned?" isAttentioned":"Attention")+'();">'+(this.isAttentioned?"已":"加")+"关注</cite></a></p>",'<div class="clearit"></div>',"</div></div>"].join("");210==this.size?(buttonNode=Core.Dom.getElementsByClass(this.getContent(),"div","info_btn1"))&&(buttonNode=buttonNode[0],Core.Dom.insertHTML(buttonNode,result,"AfterEnd")):(buttonNode=Core.Dom.getElementsByClass(this.getContent(),"div","info_txt"))&&(buttonNode=buttonNode[0],Core.Dom.insertHTML(buttonNode,result,"BeforeEnd"))}},mapEnter:function(){var module_901=$E("module_901");if(module_901&&(info_list=function(elem,className,tagName){if(elem.querySelector){var selector=tagName?tagName+"."+className:"."+className;return elem.querySelector(selector)}for(var nodes=elem.getElementsByTagName(tagName||"*")||[],reg=new RegExp("(^|\\s)"+className+"(\\s|$)"),n=0;n<nodes.length;n++){var item=nodes[n];if(reg.test(item.className))return item}return null}(module_901,"info_list","div"),info_list)){var div=document.createElement("div");div.className="info_list",div.innerHTML='<a href="//blog.sina.com.cn/lm/map/" target="_blank" title=""><img src="//simg.sinajs.cn/blog7style/images/blog_editor/ten_map.png" alt="博客十周年地图"></a>',info_list.parentNode.insertBefore(div,info_list),Core.Events.addEvent(div.firstChild,(function(evt){v7sendLog("15_04_13_"+scope.$uid)}))}},tenyears:function(){var module_901=$E("module_901");if(module_901&&(info_list=function(elem,className,tagName){if(elem.querySelector){var selector=tagName?tagName+"."+className:"."+className;return elem.querySelector(selector)}for(var nodes=elem.getElementsByTagName(tagName||"*")||[],reg=new RegExp("(^|\\s)"+className+"(\\s|$)"),n=0;n<nodes.length;n++){var item=nodes[n];if(reg.test(item.className))return item}return null}(module_901,"info_list","div"),info_list)){var div=document.createElement("div");div.className="info_list",div.innerHTML='<a href="//blog.sina.com.cn/lm/ten" target="_blank" title=""><img src="//simg.sinajs.cn/blog7style/images/blog_editor/ten_182_48.png" alt="博客十周年"></a>',info_list.parentNode.insertBefore(div,info_list),Core.Events.addEvent(div.firstChild,(function(evt){v7sendLog("15_04_13_"+scope.$uid)}))}},deleteAttention:function(){var self=this;winDialog.confirm("是否要取消关注？",{funcOk:function(){new Interface("//control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload").request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var attentionButton=$E("comp901_btn_follow");attentionButton.className="SG_aBtn",attentionButton.innerHTML="<cite>加关注</cite>",self.isAttentioned=!1},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){},textOk:"是",textCancel:"否"})}},901),$registComp(903,{load:function(){$E("atcPicList")?this.loadPicture_new():this.loadArticle()},loadArticle:function(){var _tagcode="undefined"!=typeof $tag_code?$tag_code:"";Utils.Io.Ijax.request("//tag.blog.sina.com.cn/tag/tag_walist_v7.php",{GET:{blog_id:scope.$articleid,tag:encodeURI($tag),tag_code:_tagcode},onComplete:function(data){this.loadPicture('<div class="atcTitList relaList">'+data+"</div>")}.bind2(this),onException:function(){}})},loadPicture:function(sResult){var _pic_url="//blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(3*Math.random())+"_v7.html";Utils.Io.Ajax.request(_pic_url,{onComplete:function(data){var noPicture=/<ul>\s+<\/ul>/i.test(data);this.getContent().innerHTML=sResult.replace(/<!-- relative_pic_blog-->/,noPicture?"":data)}.bind2(this),onException:function(){}})},loadPicture_new:function(sResult){var _pic_url="//blog.sina.com.cn/lm/iframe/article/sort_"+this.articleCate[scope.$sort_id]+"_"+Math.ceil(3*Math.random())+"_v7.html";Utils.Io.Ajax.request(_pic_url,{onComplete:function(data){$E("atcPicList").innerHTML=data}.bind2(this),onException:function(){}})},articleCate:{105:"105",102:"117",104:"104",149:"149",113:"113",153:"117",111:"117",152:"122",122:"122",131:"131",127:"108",134:"149",145:"108",108:"108",130:"130",116:"116",129:"129",136:"129",125:"125",141:"108",118:"118",117:"117"}},"dymanic"),$registComp(904,{load:function(){if(Core.Dom.byClz(this.getContent(),"div","wdtLoading").length>0){var _url="//blog.sina.com.cn/main/top_new/article_sort/"+scope.$sort_id+"_day.v7.html";Utils.Io.Ajax.request(_url,{onComplete:function(data){data='<div class="atcTitList relaList">'+data+"</div>",this.setContent(data)}.bind2(this),onException:function(){this.showError()}.bind2(this)})}}},"dymanic"),Core.String.shorten=function(str,len,suffix){return Core.String.byteLength(str)<=len?str:(suffix=""!=suffix?suffix||"...":"",Core.String.leftB(str,len)+suffix)},$registComp(909,{load:function(){$E("tj_id")&&this.showTJList($E("tj_id"))},showTJList:function(_container){Utils.Io.JsLoad.request("//blogtj.sinajs.cn/api/tj/get_tj_article_info.php",{GET:{uid:scope.$uid},onComplete:function(result){var content="",data=result.data,len=result.data.length>5?5:result.data.length;if(0!==len){for(var i=0;i<len;i++){var info={};info.href="//blog.sina.com.cn/s/blog_"+data[i].blog_id+".html?tj=1",info.content=Core.String.byteLength(data[i].blog_title)>26?Core.String.shorten(data[i].blog_title,26,"…"):data[i].blog_title,info.content=Core.String.encodeHTML(info.content),info.srcHref=data[i].tj_chanel_id_url,info.src=data[i].tj_chanel_id_str,content+=new Ui.Template('<li><p><span class="SG_dot"></span><a href="#{href}" target="_blank">#{content}</a></p><div class="w_list SG_txtc"><a href="#{srcHref}" target="_blank">#{src}</a></div></li>').evaluate(info)}_container.innerHTML=content}else _container.innerHTML='<li class="no_text">暂无被推荐博文</li>'}.bind2(this),onException:function(){this.showError()}.bind2(this)})}},"dymanic"),$registComp(920,{load:function(){this.noDataTextChange()},noDataTextChange:function(){let noDataEl=this.getContainer().getElementsByClassName("notOpen_title");noDataEl.length>0&&Lib.checkAuthor(function(){$isAdmin||($isLogin?noDataEl[0].innerHTML="<strong>系统维护中，博文仅作者可见。</strong>":noDataEl[0].innerHTML="<strong>系统维护中，博文仅作者可见。登陆后可查看本人文章。</strong>",noDataEl[0].style.display="block")}.bind(this),"comp_920")}},"dynamic"),Core.String.toInt=function(str,i){return parseInt(str,i)},Core.String.a2u=function(str){return str.replace(/\\u[\da-fA-F]{4}/gi,(function(a){return a=Core.String.toInt(a.substr(2),16),String.fromCharCode(a)}))},Lib.register("util.cutNickName",(function(){return function(nickName,wtype,len){var byteLength=Core.String.byteLength,leftB=Core.String.leftB;return len=len||6,0<=wtype&&8>wtype?byteLength(nickName)>len?leftB(nickName,len-2)+"…":leftB(nickName,len):byteLength(nickName)>len+2?leftB(nickName,len)+"…":leftB(nickName,len+2)}})),$registComp("12",{Interface:new Interface("//footprint.cws.api.sina.com.cn/list.php","jsload"),PromoteUserBlogInterface:new Interface("//control.blog.sina.com.cn/riaapi/profile/AdTaskTools.php","jsload"),isDisabled:function(){var disabledStr=$_GLOBAL.disableVisitor;return!!(disabledStr&&disabledStr.indexOf("|"+this.requestParam.uid+"|")>-1)&&(this.showDisabled(),!0)},_getMessage:function(promoteUid){promoteUid||(promoteUid={});var _getVHTML=Lib.blogv.getVHTML,_cutNickName=Lib.util.cutNickName;this.Interface.request({GET:this.requestParam,onSuccess:Core.Function.bind2((function(oData){Core.Array.foreach(oData.record,Core.Function.bind2((function(oItem){oItem.vString=this.formatTime(oItem.vtime,oData.stime);var nickname=Core.String.a2u(oItem.name);isNaN(oItem.wtype)&&(oItem.wtype=-1),oItem.wtype=parseInt(oItem.wtype,13),oItem.shortName=_cutNickName(nickname,oItem.wtype,9),promoteUid[oItem.uid]&&(oItem.isPromote=!0),oItem.userV=_getVHTML(oItem.wtype),oItem.shortName=Core.String.encodeHTML(oItem.shortName)}),this)),this.cacheData=oData.record,this.total=oData.total,this["render_"+this.size](this.cacheData),promoteUid=null}),this),onError:Core.Function.bind2((function(oData){this.showError($SYSMSG[oData.code])}),this),onFail:Core.Function.bind2((function(){this.showError($SYSMSG.A80101)}),this)})},load:function(){var _this=this;null==_this.requestParam?_this.show("请提供访客组件的接口参数"):(Lib.checkAuthor((function(){$isLogin||(_this.requestParam.varname="requestId_visitor_list"),scope.unreadMsg&&0==scope.unreadMsg.foot&&(_this.requestParam.add=1),_this.isDisabled()}),"comp_12"+(new Date).getTime()),_this._getMessage({1259295385:!0}))},formatTime:function(nVisitTime,nSystemTime){var result="",nSystemDay=new Date(1e3*nSystemTime),nVisitDay=new Date(1e3*nVisitTime);if(nSystemDay.getFullYear()==nVisitDay.getFullYear()&&nSystemDay.getMonth()==nVisitDay.getMonth()&&nSystemDay.getDate()==nVisitDay.getDate()){var diffTime=Math.max(0,nSystemTime-nVisitTime);if(Debug.warning("diffTime : "+diffTime),diffTime<3600)result=Math.ceil(diffTime/60)+"分钟前";else{var visitTime=new Date(1e3*nVisitTime);result=("今天0"+visitTime.getHours()+":0"+visitTime.getMinutes()).replace(/(\d{3,3})/g,(function(a,b){return b.substr(1)}))}}else{var visitDate=new Date(1e3*nVisitTime);result=visitDate.getMonth()+1+"月"+visitDate.getDate()+"日"}return result},reload:function(sSize,bAddManage,bForceRequest){null==sSize||sSize&&(210==sSize||510==sSize||730==sSize)?(this.size=sSize||this.size,this.getContent().innerHTML='<div class="wdtLoading"><img src="//simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>',1==bForceRequest||null==this.cacheData?this.load():this["render_"+this.size]()):Debug.error("请检查传入的组件尺寸是否正确。"+sSize)}},"dynamic"),Lib.deleteVisitByUid=function(sUid,sProductId,fCallBack,sSubId){Lib.checkAuthor((function(){if($isLogin){Debug.log("删除访客："+sUid);var confirmMsg="";if($isAdmin)confirmMsg=$SYSMSG.A80203;else{if(!$isLogin)return!0;confirmMsg=$SYSMSG.A80201}winDialog.confirm(confirmMsg,{funcOk:function(){var i_deleteVisit=new Interface("//footprint.cws.api.sina.com.cn/del.php","jsload"),param={pid:sProductId,uid:scope.$uid,deleteuid:sUid};null!=sSubId&&(param.subid=sSubId),$E("comp_12_deleteToBlack")&&1==$E("comp_12_deleteToBlack").checked&&(param.inblack=1),i_deleteVisit.request({GET:param,onSuccess:function(){fCallBack?fCallBack(null,null,!0):(Debug.log("Reload page"),window.location.reload())}})},subText:$isAdmin?$SYSMSG.A80204:$SYSMSG.A80202,textOk:"是",textCancel:"否",icon:"04"})}else{(new Lib.Login.Ui).login(Core.Function.bind3(Lib.deleteWallByMsgid,null,arguments))}}),"deleteVisitByUid"+(new Date).getTime())},$SYSMSG.extend({B80001:"暂无访客",B80002:"暂无留言",B80003:"暂无博客评论",B80004:"暂无好友",B80005:"暂无图片专辑",B80006:"暂无视频",B80007:"暂无归档博文",B80101:"你确定删除此评论吗？<br/>删除后不可恢复",B80102:"你确定删除此留言吗？<br/>删除后不可恢复",B80103:['<ul class="CP_w_part SG_txtb"><li><input type="checkbox" id="comp_2_deleteToBlack" class="CP_w_fm1" /><label for="comp_2_deleteToBlack" >将此人加入黑名单</label></li></ul>'].join(""),A00101:'<div class="SG_nodata">留言板非公开</div>',B36023:"对不起，黑名单已达到上限"}),scope.getPromoteURL=function(cfg){var tempUrl="//blog.sina.com.cn/u/"+cfg.uid;(cfg.isPromote&&(tempUrl="//sina.allyes.com/main/adfclick?db=sina&bid=204720,290418,295665&cid=0,0,0&sid=288937&advid=358&camid=37389&show=ignore"+($UID?"&kv={0}|99999&url={1}".format($UID,tempUrl):"&url={0}".format(tempUrl))),1259295385==cfg.uid)&&(tempUrl="//sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url="+("//blog.sina.com.cn/u/"+cfg.uid));return tempUrl},$registComp(12,{requestParam:{uid:scope.$uid,pagesize:"18",pid:1},html:["<li ","onmouseover=\"if(this.childNodes[2].className=='del'){this.childNodes[2].style.display='';}\" ","onmouseout=\"if(this.childNodes[2].className=='del'){this.childNodes[2].style.display='none';}\">",'<span class="pt_imgs"><img class="SG_icon SG_icon35" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="#{name}" align="absmiddle" /></span>','<span class="pt_nms"><a suda-uatrack="key=blog_article&value=h_article51" href="#{uhref}" target="_blank" title="#{name}">#{shortName}</a>#{userV}</span>',"#{manage}",'<span class="pt_tms">#{vString}</span>',"</li>"].join(""),render_210:function(oData){oData=(oData=oData||this.cacheData).slice(0,12),this.parseToHTML(oData)},render_510:function(oData){oData=(oData=oData||this.cacheData).slice(0,12),this.parseToHTML(oData)},render_730:function(oData){oData=oData||this.cacheData,this.parseToHTML(oData)},parseToHTML:function(oData){var _this=this;0==oData.length?_this.showEmpty():Lib.checkAuthor((function(){Core.Array.foreach(oData,Core.Function.bind2((function(oItem){oItem.manage=oItem.uid==$UID?'<span class="del" style="display: none;" onmouseover="_this.style.display = \'\';" onmouseout="_this.style.display = \'none\';"><img class="SG_icon SG_icon6" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="删除访问记录" onclick="Lib.deleteVisitByUid(\''+oItem.uid+"', 1, Core.Function.bind2(Lib.Component.instances["+_this.compId+"].reload, Lib.Component.instances["+_this.compId+"])"+(null==scope.$articleid?"":",'"+scope.$articleid+"'")+');return false;" align="absmiddle" /></span>':"",oItem.uhref=scope.getPromoteURL(oItem)}),_this));var result='<ul class="ad_ptlist">'+new Ui.Template(_this.html).evaluateMulti(oData)+"</ul>";"indexM"!=scope.$pageid&&"pageSetM"!=scope.$pageid||1!=$isAdmin||!(_this.size<730&&_this.total>12||730==_this.size&&_this.total>18)?result+='<div class="moreLink" style="padding-top:0;"></div>':result+='<div class="moreLink SG_j_linedot1"><span class="SG_more"><a href="//control.blog.sina.com.cn/blogprofile/visitor.php?showtype=1" target="_blank">更多</a>&gt;&gt;</span></div>',_this.show(result);var linkVisited=$E("linkVisited_1062753310");linkVisited&&(linkVisited.href="//sina.allyes.com/main/adfclick?db=sina&bid=204720,256856,261931&cid=0,0,0&sid=253209&advid=358&camid=37389&show=ignore&url=//blog.sina.com.cn/u/1062753310")}),"comp_12"+(new Date).getTime()),"pageSetM"==scope.$pageid&&_this.setManage&&_this.setManage()},showEmpty:function(){this.setContent('<div class="SG_nodata">'+$SYSMSG.B80001+"</div>")},showDisabled:function(){this.setContent('<div class="SG_nodata" style="padding-left:1.5em; padding-right:1.5em; text-indent:2em; text-align:left">尊敬的用户您好，为了给大家提供更好的服务，近期访客组件进行升级维护，维护过程中将影响部分用户无法正常浏览，给您带来不便敬请谅解！感谢您对新浪博客一直以来的支持！</div>')},setManage:function(){$isAdmin&&this.getManage()&&(this.getManage().innerHTML='<span class="move"><a href="#" onclick="funcMoveUpDown.up('+this.compId+');return false;">↑</a><a href="#" onclick="funcMoveUpDown.down('+this.compId+');return false;">↓</a></span><a href="#" onclick="hiddenComponents(\''+this.compId+'\');return false;" class="CP_a_fuc">[<cite>隐藏</cite>]</a>')}},12),$registComp(47,{requestParam:{uid:scope.$uid,pagesize:"12",pid:1,subid:scope.$articleid}},12),$registComp(102,{load:function(){trace("comp_1023"),this.loadArticle()},loadArticle:function(){Utils.Io.JsLoad.request("//control.blog.sina.com.cn/riaapi/photoblog/get_hotblog_list.php",{GET:{uid:scope.$uid,version:7},onComplete:function(data){trace("---------------code:"+data.code);for(var htmlStr=['<div class="photoBlog">'],list=data.data,n=0,m=list.length;n<m;n++){var tj=list[n].tj?list[n].tj:"";htmlStr.push('<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="'),htmlStr.push(list[n].blogurl),htmlStr.push('" target="_blank"><img class="borderc" src="'),htmlStr.push(list[n].picurl),htmlStr.push('" alt="'),htmlStr.push(list[n].title),htmlStr.push('" title="'),htmlStr.push(list[n].title),htmlStr.push('"/></a></td></tr></table></div><p class="photoBlog_nm">'),htmlStr.push(tj),htmlStr.push('<a href="'),htmlStr.push(list[n].blogurl),htmlStr.push('" target="_blank">'),htmlStr.push(list[n].title),htmlStr.push("</a></p><p>阅读("),htmlStr.push(list[n].hitsnum),htmlStr.push(") 评论("),htmlStr.push(list[n].commentnum),htmlStr.push(")</p></div>")}htmlStr.push("</div>"),this.getContent().innerHTML=htmlStr.join("")}.bind2(this),onException:function(){trace("connect error")}})},tpl:'<div class="photoBlog_cell"><div class="photoBlog_view"><table><tr><td><a href="{0}" target="_blank"><img class="borderc" src="{5}" alt="{7}" title="{7}"/></a></td></tr></table></div><p class="photoBlog_nm">{6}<a href="{0}" target="_blank">{1}</a> <span class="count">({2}张)</span></p><p>阅读({3}) 评论({4})</p></div>'},"dymanic");var DialogManager={dialogs:[],activeDialog:{},backShadow:null,create:function(tpl,name){var _this=this,dialog=new Dialog(tpl);return this.dialogs.push(dialog),this.activeDialog=dialog,dialog.name=name||dialog.getUniqueID(),dialog.entity.style.zIndex=1024,dialog.onDrag=function(){$IE6?this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left)-document.documentElement.scrollLeft,y:parseInt(this.entity.style.top)-document.documentElement.scrollTop}):this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)})},dialog.onClose=function(){_this.removeDialog(this.name),_this.updateActiveDialog(),_this.updateShadow(),_this.activeDialog&&_this.activeDialog.setFocus()},dialog.onHidden=function(){this.isHidden=!0,this==_this.activeDialog&&(_this.activeDialog=null),_this.updateActiveDialog(),_this.updateShadow(),_this.activeDialog&&_this.activeDialog.setFocus()},dialog.onShow=function(){if(this.isHidden){this.isHidden=!1;var i,len=_this.dialogs.length;for(i=0;i<len;i++)_this.dialogs[i]==this&&(document.body.appendChild(_this.dialogs[i].entity),_this.dialogs.push(_this.dialogs[i]),_this.dialogs.splice(i,1));_this.activeDialog=this,_this.backShadow.show(),_this.updateShadow()}},this.backShadow.isShow?this.updateShadow():this.backShadow.show(),dialog.hidden(),dialog},getDialog:function(name){var i=0,len=this.dialogs.length;for(i=0;i<len;i++)if(this.dialogs[i].name==name)return this.dialogs[i]},removeDialog:function(name){var i=0;for(i=this.dialogs.length-1;i>=0;i--)if(this.dialogs[i].name==name){this.dialogs.splice(i,1),this.activeDialog=this.dialogs[this.dialogs.length-1];break}},updateActiveDialog:function(){var i;for(i=this.dialogs.length-1;i>=0;i--)if(!this.dialogs[i].isHidden){this.activeDialog=this.dialogs[i];break}},updateShadow:function(){this.activeDialog&&!this.activeDialog.isHidden?(this.backShadow.insertBefore(this.activeDialog.entity),this.activeDialog.updateFixed()):this.backShadow.hidden()},close:function(name){var i;if(name){for(i=this.dialogs.length-1;i>=0;i--)if(this.dialogs[i].name==name){this.dialogs[i].close();break}}else this.activeDialog&&this.activeDialog.close()}},BackShadow=function(opacity){this.entity=null,this.isShow=!1,this._ie6Fixed=function(){_this.entity&&(_this.entity.style.top=document.documentElement.scrollTop+"px",_this.entity.style.left=document.documentElement.scrollLeft+"px",_this.ifm&&(_this.ifm.style.top=_this.entity.style.top,_this.ifm.style.left=_this.entity.style.left),_this.updateSize())};var _this=this;_this.entity=$C("div"),_this.entity.style.position="absolute",_this.entity.style.width=_this.getAreaWidth()+"px",_this.entity.style.height=_this.getAreaHeight()+"px",_this.entity.style.left="0px",_this.entity.style.top="0px",_this.entity.style.zIndex=1024,_this.entity.style.backgroundColor="black",document.body.appendChild(_this.entity),_this._setOpacity(_this.entity,isNaN(opacity)?.5:opacity),$IE6&&(_this.entity.style.top=document.documentElement.scrollTop+"px",_this.addIframe()),Core.Events.addEvent(window,(function(){_this.entity&&($IE6&&_this.isShow&&(document.documentElement.scrollLeft=0,_this._ie6Fixed()),setTimeout((function(){_this.updateSize()}),1))}),"resize"),_this.setFixed(!0),_this.hidden()};function CustomsDialog(tpl,name){this.nodesPattern=/[^\{\}]+(?=\})/g,this._dialog=DialogManager.create(tpl,name),this.entity=this._dialog.entity,this.templateString="",this.nodes={};var _this=this;_this._dialog.onDrag=function(){$IE6?this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left)-document.documentElement.scrollLeft,y:parseInt(this.entity.style.top)-document.documentElement.scrollTop}):this.getProperty().isFixed&&this.setPosition({x:parseInt(this.entity.style.left),y:parseInt(this.entity.style.top)}),_this.onDrag()},_this.updateNodes(),_this.nodes.btnClose&&Core.Events.addEvent(_this.nodes.btnClose,(function(){var e=Core.Events.getEvent();e&&(e.cancelBubble=!0)}),"mousedown"),this._hiddenDialog=function(){_this.hidden()},this._closeDialog=function(){_this.close()}}BackShadow.prototype={show:function(){this.entity.style.display="",this.ifm&&(this.ifm.style.display=""),this.isShow=!0,this.onShow()},hidden:function(){this.entity.style.display="none",this.ifm&&(this.ifm.style.display="none"),this.isShow=!1,this.onHidden()},close:function(){this.hidden(),this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll"),this.entity.parentNode.removeChild(this.entity),this.entity=null,this.ifm&&(this.ifm.parentNode.removeChild(this.ifm),this.ifm=null)},addIframe:function(){this.ifm=$C("iframe"),this._setOpacity(this.ifm,0),this.ifm.style.position="absolute",this.ifm.style.zIndex=this.entity.style.zIndex,this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top,this.ifm.style.width=this.entity.style.width,this.ifm.style.height=this.entity.style.height,document.body.insertBefore(this.ifm,this.entity)},insertBefore:function(obj){document.body.insertBefore(this.entity,obj),this.ifm&&document.body.insertBefore(this.ifm,this.entity)},updateSize:function(){this.entity.style.width=this.getAreaWidth()+"px",this.entity.style.height=this.getAreaHeight()+"px",this.ifm&&(this.ifm.style.width=this.getAreaWidth()+"px",this.ifm.style.height=this.getAreaHeight()+"px")},getAreaHeight:function(){return document.documentElement.clientHeight},getAreaWidth:function(){return document.documentElement.clientWidth},setFixed:function(state){if($IE6){state?(this._ie6Fixed(),Core.Events.addEvent(window,this._ie6Fixed,"scroll")):Core.Events.removeEvent(window,this._ie6Fixed,"scroll")}else this.entity.style.position=state?"fixed":"absolute"},_setOpacity:function(obj,v){$IE&&$IE<=9?obj.style.filter="alpha(opacity="+100*v+")":obj.style.opacity=v},onShow:function(){},onHidden:function(){}},CustomsDialog.prototype={isSetMiddle:!1,setContent:function(tpl){var _contentTemplate=tpl;this.templateString=_contentTemplate.match(this.nodesPattern);var tmp=new Ui.Template(_contentTemplate);this.nodes.content.innerHTML=tmp.evaluate(this.getContentNodes("i")),this.updateNodes()},setTitle:function(title){this.nodes.titleName&&(this.nodes.titleName.innerHTML=title)},setHelp:function(helpLink){this.nodes.btnHelp&&(helpLink?this.nodes.btnHelp.href=helpLink:this.nodes.btnHelp.innerHTML="")},setClose:function(mode){if(this.nodes.btnClose)switch(mode=mode||"hidden"){case"hidden":Core.Events.addEvent(this.nodes.btnClose,this._hiddenDialog,"click");break;case"close":Core.Events.addEvent(this.nodes.btnClose,this._closeDialog,"click")}},setPosition:function(x,y){this._dialog.setPosition({x:x,y:y})},setMiddle:function(){var _x,_y,win=Core.System.winSize(),displayState=this._dialog.entity.style.display;this._dialog.setPosition({x:-1e4}),this._dialog.entity.style.display="";var titleBarOffsetHeight=this.nodes.titleBar?this.nodes.titleBar.offsetHeight:0,areaHeight=win.height-this.nodes.content.offsetHeight-titleBarOffsetHeight,goldenSection=(Math.sqrt(5)-1)/2,goldenSectionY=areaHeight*goldenSection/(goldenSection+1);_x=(_x=win.width/2-this.nodes.content.offsetWidth/2)<0?0:_x,_y=goldenSectionY<0?0:goldenSectionY,this._dialog.getProperty().isFixed||(_x+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),_y+=Math.max(document.documentElement.scrollTop,document.body.scrollTop)),this._dialog.entity.style.display=displayState,this._dialog.setPosition({x:_x,y:_y}),this.isSetMiddle=!0},setSize:function(width,height){this._dialog.setSize({width:width,height:height})},setFixed:function(state){this._dialog.setFixed(state)},setAreaLocked:function(state){this._dialog.setAreaLocked(state)},setFocusNode:function(focusNode){this._dialog.getProperty().focusNode=focusNode},setDisplayMode:function(mode){this._dialog.getProperty().displayMode=mode||"normal"},getWidth:function(){return this._dialog.getProperty().width},getHeight:function(){return this._dialog.getProperty().height},getX:function(){return this._dialog.getProperty().x},getY:function(){return this._dialog.getProperty().y},show:function(){this.isSetMiddle&&this.setMiddle(),this._dialog.show(),this.onShow()},hidden:function(){this._dialog.hidden(),this.onHidden()},close:function(){this._dialog.close(),this.onClose(),this.nodes.btnClose&&(Core.Events.removeEvent(this.nodes.btnClose,this._hiddenDialog,"click"),Core.Events.removeEvent(this.nodes.btnClose,this._CloseDialog,"click"))},updateNodes:function(){this.nodes=this._dialog.getNodes();var contentNodes=this.getContentNodes();for(k in contentNodes)this.nodes[k]=contentNodes[k]},getContentNodes:function(mode){var i,m=mode||"o",nodes={},result=this.templateString;if(result)for(i=0;i<result.length;i++){var r=result[i];switch(m){case"o":nodes[r]=$E(this.nodes.content.id+"_"+r);break;case"i":nodes[r]=this.nodes.content.id+"_"+r}}return nodes},setOnDisplaied:function(func){this._dialog.onDisplaied=func},setOnDisplayFinished:function(func){this._dialog.onDisplayFinished=func},onDrag:function(){},onShow:function(){},onHidden:function(){},onClose:function(){}};var LayerTemplate={alert:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont">\x3c!-- 内容区域 --\x3e<div class="gDialogDoc"><div class="diaBd"><div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="//simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div><div class="gDiaC2"><h5 id="#{text}"></h5><div id="#{subText}"></div><p/></div></div><div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a></div></div>\x3c!-- 内容区域 --\x3e</div></td><td class="tbgright"><div></div></td></tr></tbody></table>',confirm:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont">\x3c!-- 内容开始 --\x3e<div class="gDialogDoc"><div class="diaBd"><div class="gDiaC1"><img id="#{icon}" width="50" height="50" class="" src="//simg.sinajs.cn/tiezi/images/icon/icon.gif" alt=""/></div><div class="gDiaC2"><h5 id="#{text}"></h5><div id="#{subText}"></div><p/></div></div><div class="btnRow"><a class="gBtnb gBtnbClr" id="#{linkOk}" href="javascript:;"><cite id="#{btnOk}"><em id="#{ok}"></em></cite></a><a class="gBtnb gBtnbClr" id="#{linkCancel}" href="javascript:;"><cite id="#{btnCancel}"><em id="#{cancel}"></em></cite></a></div></div>\x3c!-- 内容结束 --\x3e</div></td><td class="tbgright"><div></div></td></tr></tbody></table>',iframe:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont"><div id="#{loadState}">Loading...</div><iframe style="width:100%;height:500px;" id="#{iframe}" src="#{iframeURL}"></iframe></div></td><td class="tbgright"><div></div></td></tr></tbody></table>',customs:'<table id="#{entity}"  class="gModLy"><thead id="#{titleBar}"><tr><td class="tbgleft"><div></div></td><td class="tdmain"><div class="gModLyHeader"><div class="gFl"><div class="gML_tit"><strong id="#{titleName}"></strong></div></div><div class="gFr"><ul><li><a href="javascript:;" id="#{btnClose}" class="iconClose"></a></li><li><a href="#" class="help" >帮助</a></li></ul></div></div></td><td class="tbgright"><div></div></td></tr></thead><tfoot><tr><td class="tbgleft"><div></div></td><td class="tdmain"></td><td class="tbgright"><div></div></td></tr></tfoot><tbody><tr><td class="tbgleft"><div></div></td><td class="tdmain" id="layer_2"><div id="#{content}" class="gModLyCont">\x3c!-- 内容区域 --\x3e\x3c!-- 内容区域 --\x3e</div></td><td class="tbgright"><div></div></td></tr></tbody></table>'};!function(){var WindowDialog=function(backShadow,objTemplate){this.template=objTemplate||{},DialogManager.backShadow=backShadow};WindowDialog.prototype={iconSet:{"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}},alert:function(text,cfg,name){cfg=cfg||{};var dialog=DialogManager.create(cfg.template||this.template.alert||LayerTemplate.alert,name),nodes=(Core.System.winSize(),dialog.getNodes());dialog.onDisplaied=cfg.funcDisplaied,dialog.onDisplayFinished=cfg.funcDisplayFinished,dialog.setSize({width:cfg.width,height:cfg.height}),dialog.setFixed(!0),this._setDialogMiddle(dialog),dialog.show(),dialog.setAreaLocked(!0),nodes.linkOk.focus(),nodes.text.innerHTML=text,nodes.titleName&&(nodes.titleName.innerHTML=cfg.title||"提示"),nodes.icon&&(nodes.icon.className=cfg.icon?this.iconSet[cfg.icon]["class"]:this.iconSet["01"]["class"],nodes.icon.alt=cfg.icon?this.iconSet[cfg.icon].alt:this.iconSet["01"].alt),nodes.ok.innerHTML=cfg.textOk||"确定",nodes.subText&&(nodes.subText.innerHTML=cfg.subText||""),dialog.getProperty().focusNode=nodes.linkOk,Core.Events.addEvent(nodes.btnOk,(function(){return cfg.funcOk&&dialog.getProperty().enabled&&(cfg.funcOk(),Core.Events.stopEvent()),dialog.close(),!1}),"click"),Core.Events.addEvent(nodes.linkOk,(function(){"13"==Core.Events.getEvent().keyCode&&(cfg.funcOk&&dialog.getProperty().enabled&&cfg.funcOk(),dialog.close())}),"keydown"),Core.Events.addEvent(nodes.btnClose,(function(){cfg.funcClose&&dialog.getProperty().enabled&&cfg.funcClose(),dialog.close()}),"click"),Core.Events.addEvent(nodes.btnClose,(function(){Core.Events.getEvent().cancelBubble=!0}),"mousedown")},newAlert:function(text,cfg,name){cfg.template=this.template.newAlert,this.alert(text,cfg,name)},confirm:function(text,cfg,name){cfg=cfg||{};var dialog=DialogManager.create(cfg.template||this.template.confirm||LayerTemplate.confirm,name),nodes=(Core.System.winSize(),dialog.getNodes());dialog.onDisplaied=cfg.funcDisplaied,dialog.onDisplayFinished=cfg.funcDisplayFinished,dialog.setSize({width:cfg.width,height:cfg.height}),dialog.setFixed(!0),this._setDialogMiddle(dialog),dialog.show(),dialog.setAreaLocked(!0),0==cfg.defaultButton?(nodes.linkCancel.focus(),dialog.getProperty().focusNode=nodes.linkCancel):(nodes.linkOk.focus(),dialog.getProperty().focusNode=nodes.linkOk),nodes.text.innerHTML=text,nodes.titleName&&(nodes.titleName.innerHTML=cfg.title||"提示"),nodes.icon&&(nodes.icon.className=cfg.icon?this.iconSet[cfg.icon]["class"]:this.iconSet["04"]["class"],nodes.icon.alt=cfg.icon?this.iconSet[cfg.icon].alt:this.iconSet["04"].alt),nodes.ok.innerHTML=cfg.textOk||"确定",nodes.cancel.innerHTML=cfg.textCancel||"取消",nodes.subText&&(nodes.subText.innerHTML=cfg.subText||""),Core.Events.addEvent(nodes.btnOk,(function(){return cfg.funcOk&&dialog.getProperty().enabled&&(cfg.funcOk(),Core.Events.stopEvent()),dialog.close(),!1}),"click"),Core.Events.addEvent(nodes.linkOk,(function(){"13"==Core.Events.getEvent().keyCode&&(cfg.funcOk&&dialog.getProperty().enabled&&cfg.funcOk(),dialog.close())}),"keydown"),Core.Events.addEvent(nodes.btnCancel,(function(){return cfg.funcCancel&&dialog.getProperty().enabled&&(cfg.funcCancel(),Core.Events.stopEvent()),dialog.close(),!1}),"click"),Core.Events.addEvent(nodes.linkCancel,(function(){"13"==Core.Events.getEvent().keyCode&&(cfg.funcCancel&&dialog.getProperty().enabled&&cfg.funcCancel(),dialog.close())}),"keydown"),Core.Events.addEvent(nodes.btnClose,(function(){return cfg.funcClose&&dialog.getProperty().enabled&&(cfg.funcClose(),Core.Events.stopEvent()),dialog.close(),!1}),"click"),Core.Events.addEvent(nodes.btnClose,(function(){Core.Events.getEvent().cancelBubble=!0}),"mousedown")},newConform:function(text,cfg,name){cfg.template=this.template.newConfirm,this.confirm(text,cfg,name)},showIframe:function(cfg,name){cfg=cfg||{};var dialog=DialogManager.create(this.template.iframe||LayerTemplate.iframe,name),win=Core.System.winSize(),nodes=dialog.getNodes();dialog.setSize({width:cfg.width||320,height:cfg.height||150});var _x=win.width/2-dialog.getProperty().width/2<0?0:win.width/2-dialog.getProperty().width/2,_y=win.height/2-dialog.getProperty().height/2<0?0:win.height/2-dialog.getProperty().height/2;cfg.fixed?dialog.setPosition({x:_x,y:_y}):dialog.setPosition({x:_x+document.documentElement.scrollLeft,y:_y+document.documentElement.scrollTop}),$IE6||(dialog.getProperty().displayMode="alpha"),dialog.setFixed(!!cfg.fixed),dialog.show(),dialog.setAreaLocked(!0),nodes.titleName.innerHTML=cfg.title||"",nodes.iframe.src=cfg.url||"about:blank",Core.Events.addEvent(nodes.iframe,(function(){nodes.iframe.style.display="",nodes.loadState.style.display="none"}),"load"),Core.Events.addEvent(nodes.btnClose,(function(){dialog.close()}),"click"),Core.Events.addEvent(nodes.btnClose,(function(){Core.Events.getEvent().cancelBubble=!0}),"mousedown")},createCustomsDialog:function(cfg,name){var customsDialog=new CustomsDialog((cfg=cfg||{}).tpl||this.template.customs||LayerTemplate.customs,name);return cfg.content&&customsDialog.setContent(cfg.content),customsDialog.setTitle(cfg.title||"提示"),customsDialog.setHelp(cfg.help||""),customsDialog.setClose("hidden"),customsDialog.setOnDisplaied(cfg.funcDisplaied),customsDialog.setOnDisplayFinished(cfg.funcDisplayFinished),customsDialog},getDialog:function(name){return DialogManager.getDialog(name)},close:function(name){DialogManager.close(name)},_setDialogMiddle:function(dialog){var _x,_y,win=Core.System.winSize(),nodes=dialog.getNodes(),displayState=dialog.entity.style.display;dialog.setPosition({x:-1e4}),dialog.entity.style.display="";var titleBarOffsetHeight=nodes.titleBar?nodes.titleBar.offsetHeight:0,areaHeight=win.height-nodes.content.offsetHeight-titleBarOffsetHeight,goldenSection=(Math.sqrt(5)-1)/2,goldenSectionY=areaHeight*goldenSection/(goldenSection+1);_x=(_x=win.width/2-nodes.content.offsetWidth/2)<0?0:_x,_y=goldenSectionY<0?0:goldenSectionY,dialog.getProperty().isFixed||(_x+=document.documentElement.scrollLeft,_y+=document.documentElement.scrollTop),dialog.entity.style.display=displayState,dialog.setPosition({x:_x,y:_y})}},Sina.Ui.WindowDialog=WindowDialog}(),Core.String.expand=function(str){return str.replace(/([\u00ff-\ufffe])/gi,"￿$1")},Core.String.collapse=function(str){return str.replace(/\uffff/gi,"")},scope.searchFilm=function(a){var loginBarSearchForm=$E("loginBarSearchForm"),url=loginBarSearchForm.action,loginBarSearchT=$E("loginBarSearchT"),loginBarSearchS=$E("loginBarSearchS"),loginBarSearchType=($E("loginBarSearchTS"),$E("loginBarSearchType")),loginBarSearchSType=$E("loginBarSearchSType"),loginBarSearchInput=$E("loginBarSearchInput"),tObj={url:url,loginBarSearchT:loginBarSearchT.value,loginBarSearchS:loginBarSearchS.value,loginBarSearchS:loginBarSearchS.value,loginBarSearchType:loginBarSearchType.value,loginBarSearchSType:loginBarSearchSType.value,loginBarSearchInput:loginBarSearchInput.value};loginBarSearchInput.value="影评 "+a,loginBarSearchT.value="blog",loginBarSearchSType.value="tag",loginBarSearchForm.action="//uni.sina.com.cn/c.php",loginBarSearchForm.submit(),loginBarSearchForm.action=tObj.url,loginBarSearchT.value=tObj.loginBarSearchT,loginBarSearchS.value=tObj.loginBarSearchS,loginBarSearchS.value=tObj.loginBarSearchS,loginBarSearchType.value=tObj.loginBarSearchType,loginBarSearchSType.value=tObj.loginBarSearchSType,loginBarSearchInput.value=tObj.loginBarSearchInput},$registComp(122,{getLatestComm:new Interface("//control.blog.sina.com.cn/riaapi/film/get_latest_filmcomment.php","jsload"),load:function(){this.getLatestComm.request({onSuccess:Core.Function.bind2((function(oData){trace("---------ok----------"),this.cacheData=oData,this.toHTML(this.cacheData)}),this),onError:Core.Function.bind2((function(oData){trace("---------error----------"),this.showError(oData.code)}),this),onFail:Core.Function.bind2((function(oData){this.showError($SYSMSG.A80101)}),this)})},toHTML:function(data){if(0!=data.length){for(var i=0,len=data.length;i<len;i++){var filmname=data[i].filmname;data[i].filmname_limit=filmname;for(var j=0,length=data[i].comment.length;j<length;j++)data[i].comment[j].title_limit=checkStrLen(data[i].comment[j].title,12);data[i].num=Core.String.formatNumber(data[i].num)}for(var html="",m=0,mlen=data.length;m<mlen;m++){var url="//data.ent.sina.com.cn/"+(2==data[m].type?"movie":"tv")+"/"+data[m].filmid+".html";filmname=data[m].filmname,data[m].filmname_limit;html+=['<li class="cur">','<a href="'+url+'" target="_blank" title="'+filmname+'"><img alt="'+filmname+'" src="'+data[m].imgurl+'"></a>','<p>共<strong><a href="javascript:void(0);" onclick="scope.searchFilm(\''+filmname+"')\">"+data[m].num+"</a></strong>篇</p>","<ul>"].join("");for(var n=0,nlen=data[m].comment.length;n<nlen;n++)html+='<li><a title="'+data[m].comment[n].title+'" href="'+data[m].comment[n].url+'" target="_blank">'+data[m].comment[n].title_limit+"</a></li>";html+=["</ul>",m==mlen-1?"":'<div class="SG_j_linedot"></div>','<div class="clearit"></div>',"</li>"].join("")}var innerHTML=['<div class="hotmovies">',"<ul>",html,"</ul>",'</div><div class="clearit"></div>'].join("");this.setContent(innerHTML)}else this.handleEmpty();function checkStrLen(str,max){var temp=Core.String.expand(str);return temp.length>max&&(temp=temp.substr(0,max)),temp=Core.String.collapse(temp)}},handleEmpty:function(){trace("没有最新影评数据");var innerHTML=['<div class="SG_nodata">',"<p>还没有影评。</p>","</div>"].join("");this.setContent(innerHTML)}},"dynamic"),Lib.Component.renderByList=function(arrDefaultList){Core.Array.foreach(arrDefaultList,(function(oItem){try{if(null!=$E("module_"+oItem)){var comp=Lib.Component.instances[oItem]||new Lib.Component["Comp_"+oItem](oItem);if(null!=comp.size&&null!=comp.load){comp.size=Lib.Component.compSize[oItem];try{comp.load()}catch(e){}Debug.log("组件："+oItem+" 初始化成功")}else Debug.error("组件："+oItem+" 初始化失败，组件尺寸信息不存在")}else Debug.error("组件："+oItem+" 初始化失败，页面内缺少组件的HTML节点")}catch(e){Debug.error(e.message||"组件："+oItem+" 初始化失败，请确认该组件类是否定义过")}}))},Lib.Component.lazyRenderByList=function(arrDefaultList){var lazyList=[];Core.Array.foreach(arrDefaultList,(function(oItem){try{if(null!=$E("module_"+oItem)){var comp=Lib.Component.instances[oItem]||new Lib.Component["Comp_"+oItem](oItem);if(null!=comp.size&&null!=comp.load){comp.size=Lib.Component.compSize[oItem];try{lazyList.push({dom:$E("module_"+oItem),callback:Lib.Component.instances[oItem].load.bind2(Lib.Component.instances[oItem])})}catch(e){}Debug.log("组件："+oItem+" 初始化成功")}else Debug.error("组件："+oItem+" 初始化失败，组件尺寸信息不存在")}else Debug.error("组件："+oItem+" 初始化失败，页面内缺少组件的HTML节点")}catch(e){Debug.error(e.message||"组件："+oItem+" 初始化失败，请确认该组件类是否定义过")}})),Lib.LazyLoad(lazyList,{})},$registJob("articleComp1",(function(){var list=[901,102,122,920];null!==Lib.Component.getInitCompSize()?(trace("文章页组件渲染列表: "+list.toString()),Lib.Component.renderByList(list)):Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。")})),$registJob("articleComp2",(function(){var list=[903,904,909,47];null!==Lib.Component.getInitCompSize()?(trace("文章页组件渲染列表: "+list.toString()),Lib.Component.lazyRenderByList(list)):Debug.error("无法获得页面内组件的尺寸，请检查页面内输出的组件配置信息是否存在。。。")})),$SYSMSG.extend({1103:"抱歉您所在的IP已经被封了，请稍后再试！",1104:"抱歉您的账号异常，请稍后再试！",1105:"抱歉您的账户昵称不合符规范，<br>请修改后再试！",1106:"发表成功，稍后显示。",1107:"网络繁忙！",2e3:"评论内容不能重复！",2004:"涉政地区频次限制",2005:"涉政uid频次限制",2006:"留言板关闭",2100:"发送频率过高，请稍后再试！",4001:"发表成功，稍后显示。",A00111:"抱歉，该文章禁止评论！",A00110:"抱歉，该文章禁止评论！",A00103:"抱歉，您已被对方加入黑名单！",A00208:"博主设置仅粉丝可以评论",A00209:"博主设置仅博主关注的用户可以评论"}),Ui.Pagination={config:{pageNode:null,nodeClassNamePrefix:"CP",curPage:1,maxPage:1,minPage:1,pageTpl:"@page@.html",type:1,showPrevNext:!0,viewSize:5,dotIsPage:!1,dotRate:5,showGoto:!1,countTpl:"",language:"zh-cn",theme:1,showLastPage:!0,showTotal:!1},_list:{},_resource:{"en-us":["Pages (@data@): ","Go to First Page","Go to Previous Page (@data@)","Go to Page @data@","Go to Next Page (@data@)","Go to Last Page","Current Page in View"],"zh-cn":["共 @data@ 页","跳转至第一页","跳转至前 @data@ 页","跳转至第 @data@ 页","跳转至后 @data@ 页","跳转至最后一页","当前所在页"]},_template:'<li class="#{class}" title="#{title}">#{link}</li>',init:function(oOption){var node=$E(oOption.pageNode);if(null!=node){Ui.Pagination._list[node.id]={};var hash=Ui.Pagination._list[node.id];for(var key in this.config)hash[key]=oOption[key]===undefined?this.config[key]:oOption[key];return 2==hash.type&&(hash.viewSize=4),hash.minPage=1*Math.min(hash.minPage,hash.maxPage),hash.maxPage=1*Math.max(hash.minPage,hash.maxPage),hash.curPage=hash.curPage>hash.maxPage?hash.minPage:hash.curPage,hash.curPage=1*hash.curPage,hash.curPage+hash.viewSize>=100&&(hash.viewSize=3),this._cache_node=hash,this}trace("分页指定的父容器不存在")},show:function(oNode,nCurPage){nCurPage*=1;var hash=this._cache_node;null!=oNode&&(this._cache_node=hash=Ui.Pagination._list[oNode.id],hash.curPage=nCurPage);var ambit=[];2*hash.viewSize+1>=hash.maxPage?(ambit[1]=hash.minPage,ambit[2]=hash.maxPage):hash.curPage<=hash.minPage+hash.viewSize?(ambit[1]=hash.minPage,ambit[2]=hash.minPage+(2*hash.viewSize-1),ambit[3]=hash.maxPage):hash.curPage>=hash.maxPage-hash.viewSize?(ambit[0]=hash.minPage,ambit[1]=hash.maxPage-(2*hash.viewSize-1),ambit[2]=hash.maxPage):(ambit[0]=hash.minPage,ambit[1]=hash.curPage-(hash.viewSize-1),ambit[2]=hash.curPage+(hash.viewSize-1),ambit[3]=hash.maxPage);var result=[];if(null!=hash.countTpl&&result.push(this._createPage("","","","",hash.countTpl)),2!=hash.type&&hash.curPage!=hash.minPage&&(3==hash.type?result.push(this._createPage(hash.nodeClassNamePrefix+"_s_pgprev",hash.curPage-1,3,hash.curPage-1,"上页")):result.push(this._createPage(hash.nodeClassNamePrefix+"_pgprev",hash.curPage-1,3,hash.curPage-1,"< 上一页"))),3!=hash.type){if(null!=ambit[0]){var str=ambit[0]==hash.curPage?this._createPage(hash.nodeClassNamePrefix+"_pgon",1,6,"",ambit[0]):this._createPage("",1,1,ambit[0],ambit[0]);result.push(str)}1==hash.type&&null!=ambit[0]&&result.push(this._createPage(hash.nodeClassNamePrefix+"_pgelip","","","","..."));for(var i=ambit[1];i<=ambit[2];i++)if(i==ambit[1]&&i!=hash.minPage&&2==hash.type){var LS=hash.curPage-hash.dotRate;LS=LS<hash.minPage?hash.minPage:LS,result.push(this._createPage(hash.nodeClassNamePrefix+"_pgelip",hash.viewSize+1,2,hash.curPage-hash.viewSize-1,"..."))}else if(i==ambit[2]&&i!=hash.maxPage&&2==hash.type){var RS=hash.curPage+hash.dotRate;RS=RS>hash.maxPage?hash.maxPage:RS,result.push(this._createPage(hash.nodeClassNamePrefix+"_pgelip",hash.viewSize+1,4,hash.curPage+hash.viewSize+1,"..."))}else str=i==hash.curPage?this._createPage(hash.nodeClassNamePrefix+"_pgon",1,6,"",i):this._createPage("",i,3,i,i),result.push(str);1==hash.type&&null!=ambit[3]&&result.push(this._createPage(hash.nodeClassNamePrefix+"_pgelip","","","","...")),null!=ambit[3]&&hash.showLastPage&&(str=ambit[3]==hash.curPage?this._createPage(hash.nodeClassNamePrefix+"_pgon",hash.curPage-1,3,"",ambit[3]):this._createPage("",1,5,ambit[3],ambit[3]),result.push(str))}else result.push(this._createPage(hash.nodeClassNamePrefix+"_s_pgnum","","","","<strong>"+hash.curPage+"</strong>/"+hash.maxPage));2!=hash.type&&hash.curPage!=hash.maxPage&&(3==hash.type?result.push(this._createPage(hash.nodeClassNamePrefix+"_s_pgnext",hash.curPage+1,3,hash.curPage+1,"下页")):result.push(this._createPage(hash.nodeClassNamePrefix+"_pgnext",hash.curPage+1,3,hash.curPage+1,"下一页 >"))),1==hash.showTotal&&result.push(this._createPage(hash.nodeClassNamePrefix+"_pgttl","","","","共"+hash.maxPage+"页")),$E(hash.pageNode).innerHTML='<ul class="'+hash.nodeClassNamePrefix+'_pages">'+result.join("")+"</ul>"},_createPage:function(sClass,sTipPage,nTipIndex,nHrefPage,sHrefText){if(""==sHrefText)return"";var sTitle=""===sTipPage||""==nTipIndex?"":this._getTips(sTipPage,nTipIndex),sLink=""!==nHrefPage?"<a "+this._getUrl(nHrefPage)+">"+sHrefText+"</a>":sHrefText;return this._template.replace(/(#\{\w+\})/g,(function(a,b){switch(b){case"#{class}":return sClass;case"#{title}":return sTitle;case"#{link}":return sLink}}))},showPage:function(sParentNodeID,nCurPage){this._cache_node=Ui.Pagination._list[sParentNodeID],0!=this._cache_node.pageTpl(nCurPage)&&Ui.Pagination.show($E(sParentNodeID),nCurPage)},_getUrl:function(idx){return"string"==typeof this._cache_node.pageTpl?'href="'+this._cache_node.pageTpl.replace(/@page@/,idx)+'"':"href=\"javascript:Ui.Pagination.showPage('"+this._cache_node.pageNode+"',"+idx+');"'},_getTips:function(nPage,nIndex){return this._resource[this._cache_node.language][nIndex].replace(/@data@/g,nPage)}},Lib.register("Listener",(function(){var _this={listeners:{}};return{add:function(name){if(_this.listeners[name])throw new Error("listener '"+name+"' has registed!");_this.listeners[name]=[]},remove:function(name){return!!_this.listeners[name]&&(_this.listeners[name]=null,!0)},notify:function(name,data){var listeners=_this.listeners[name],handle=null;if(listeners)for(var i=0,len=listeners.length;i<len;i++)(handle=listeners[i]).callBack.call(handle.scope,data)},on:function(o){for(var args=arguments,handle=null,i=0,len=args.length;i<len;i++)handle=args[i],this.isListen(handle)||(_this.listeners[handle.name]||(_this.listeners[handle.name]=[]),_this.listeners[handle.name].push(handle))},off:function(o){var handlers=_this.listeners[o.name];if(!handlers)return!0;for(var handle=null,i=0,len=handlers.length;i<len;i++)(handle=handlers[i]).callBack==o.callBack&&handle.scope==o.scope&&handlers.splice(i,1)},isListen:function(listener){var handlers=_this.listeners[listener.name],handle=null;if(!handlers)return!1;for(var i=0,len=handlers.length;i<len;i++)if((handle=handlers[i]).callBack==listener.callBack&&handle.scope==listener.scope)return!0;return!1}}}));var CommentV2={getConfigInfo:function(config){for(var result,reg=/&*([^=]*)=([^&]*)/g,info={};result=reg.exec(config);)info[result[1]]=decodeURIComponent(result[2]);return info}};Utils.Json={eval:function(str){return eval("("+str+")")},flatten:function(x){var self=Utils.Json;return null==x?null:x.constructor.toString()==String?self.str2json(x):x.constructor.toString()==Array?self.arr2json(x):x.constructor.toString()==Object?self.obj2json(x):x.constructor.toString()==Boolean?self.bool2json(x):x.constructor.toString()==Number?self.num2json(x):x.constructor.toString()==Date?self.date2json(x):null},arr2json:function(x){for(var t,self=Utils.Json,p=[],l=x.length,i=0;i<l;++i)(t=self.flatten(x[i]))&&p.push(t);return"["+p.join(",")+"]"},obj2json:function(x){var t,self=Utils.Json,p=[];for(var i in x)(t=self.flatten(x[i]))&&p.push(self.flatten(i)+":"+t);return"{"+p.join(",")+"}"},date2json:function(x){function f(n){return n<10?"0"+n:n}return'"'+x.getFullYear()+"-"+f(x.getMonth()+1)+"-"+f(x.getDate())+"T"+f(x.getHours())+":"+f(x.getMinutes())+":"+f(x.getSeconds())+'"'},stringify:function(jsonObject){return Utils.Json.flatten(jsonObject)},parse:function(jsonStr){return Utils.Json.eval(jsonStr)},num2json:function(x){return x?String(x):"0"},bool2json:function(x){return String(x)},str2json:function(x){var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(x)?'"'+x.replace(/([\x00-\x1f\\"])/g,(function(a,b){var c=m[b];return c||(c=b.charCodeAt(),"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16))}))+'"':'"'+x+'"'}},$SYSMSG.extend({B36001:"操作失败，此博文不存在或被删除。",B36002:"验证码错误，请重新输入。",B36003:"请输入昵称。",B36004:"登录名或密码错误。",B36005:"呢称不能使用此类特殊词汇，请重新输入。",B36006:"昵称必须是8个中文或16个字符以内，且不能为纯数字，请重新输入。",B36007:"呢称不能使用此类特殊词汇，请重新输入。",B36008:"不能3秒内连续发评论，请梢后再试。",B36009:"不能发内容重复的评论。",B36020:"暂无评论。",B36021:"暂无评论。",B36022:"评论内容必须是1000中文或2000字符以内，请重新输入。",B36023:"对不起，黑名单已达到上限",B36024:"对方拒绝了你的评论。",B36031:"操作失败，此评论不存在或被删除。",B36032:"操作失败，此评论不存在或被删除。",B36033:"操作失败，此评论不存在或被删除。",B36041:"请输入回复内容。",B36042:"回复内容必须是1000中文或2000字符以内，请重新输入。",B36043:"操作失败，自己不能回复自己的评论。",B36101:"操作失败，此博文不存在或被删除。",B36102:"评论发布失败，此博文设置不允许评论。",B36103:"操作失败，此评论不存在或被删除。",B36104:"评论已发布，需要审核后才能显示，请稍候…",B36113:"博主已关闭匿名评论，请登录后再评论",B36105:"请输入评论内容。",B36106:"请输入验证码。",B36107:"请输入登录名。",B36108:"请输入密码。",B36109:"读取中，请稍候…",B36110:"读取失败，请刷新。",B36111:"确定要删除此评论吗？删除后不可恢复。",B36112:"确定要删除此回复吗？删除后不可恢复。",B36115:"请点击按钮进行验证",B36201:"确定要删除此评论吗？删除后不可恢复。",B36202:"确定要删除此回复吗？删除后不可恢复。",B36203:"请选择要删除的内容。",B36204:"已回复该评论，请勿重复提交。",B36998:"系统维护中，服务暂不可用",B36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",36999:"对不起，您短时间发表的评论过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",B36205:"请登录后在回复评论",B36206:"对不起，您已被对方列入黑名单，无法发评论。",B36207:"请登录后在删除评论",B36208:"评论内容必须是140中文或280字符以内，请重新输入",B36209:"此条评论已被原博主删除",B36210:"博主已关闭评论功能",B36211:"此博文已被博主设为私密",B11113:"积分不足，神回复失败",B11114:"操作失败，神回复不合法"}),CommentV2.List=function(opt){this.containerNode="",this.type="",this.operation="",this.data="",this.page=1,this.total=0,this.url="",this.trim=Core.String.trim,this.jsonUtil=Utils.Json,this.init(opt)}.$define({init:function(opt){trace("super init"),this.__merge(opt),this.load(this.page)},__merge:function(opt){for(var index in opt)this[index]=opt[index]},load:function(page){},render:function(){},bindEvent:function(){scope.commentlistIsBind||(this.addEvent(this.containerNode,this.delegate.bind2(this),"click"),this.onListener()),scope.commentlistIsBind=!0},delegate:function(e){trace("CommentV2.CommentList.delegate");var node,actionType,type,operation,dataObj,tar=(e=e||window.event).target||e.srcElement;if((node=this.getTarget(tar,this.containerNode))&&(actionType=this.getType(node)))if(type=actionType.split("_")[0],operation=actionType.split("_")[1],dataObj=this.str2obj(this.getData(node)),"comment"==type){var containerNode=$E("comment_"+dataObj.commentid);this[operation]({type:type,operation:operation,articleid:scope.$articleid,data:dataObj,containerNode:containerNode,node:node})}else{containerNode=$E("reply_"+dataObj.id);this.replyList[dataObj.stair_cms_id][operation]({type:type,operation:operation,articleid:scope.$articleid,data:dataObj,containerNode:containerNode,node:node})}},onListener:function(){Lib.Listener.on({name:"commentlist-commentadd",callBack:this.add,scope:this}),Lib.Listener.on({name:"reload-cnmt-list",callBack:this.reloadCnmtList,scope:this}),Lib.Listener.on({name:"update-total-num",callBack:this.updateTotalNum,scope:this})},updateTotalNum:function(){},removeEvent:function(){trace("CommentV2.CommentList.removeEvent"),this.removeEvent(this.containerNode,this.delegate,"click")},toggle:function(){this.isDisplay()?this.hide():this.show()},show:function(){this.containerNode.style.display=""},hide:function(){this.containerNode.style.display="none"},isDisplay:function(){return!!this.containerNode&&"none"!==this.containerNode.style.display},error:function(code){this.containerNode.innerHTML='<li class="CP_litem"><div class="CP_cmt_none">'+$SYSMSG[code]+"</div></li>"},paging:function(){},add:function(){},del:function(){},reloadCnmtList:function(){},report:function(){},reply:function(){},share:function(){},obj2str:function(obj){return encodeURIComponent(this.jsonUtil.flatten(obj))},str2obj:function(str){return this.jsonUtil.eval(decodeURIComponent(str))},getTarget:function(node,parent){for(;node&&node!==parent;){if("a"==node.tagName.toLowerCase())return node;node=node.parentNode}return null},getType:function(node){return node&&node.getAttribute("action-type")},getData:function(node){return node&&node.getAttribute("action-data")}}),Core.Dom.getElementsByAttr=function(node,attname,attvalue){for(var nodes=[],i=0,l=node.childNodes.length;i<l;i++)1==node.childNodes[i].nodeType&&(node.childNodes[i].getAttribute(attname)==attvalue&&nodes.push(node.childNodes[i]),node.childNodes[i].childNodes.length>0&&(nodes=nodes.concat(arguments.callee.call(null,node.childNodes[i],attname,attvalue))));return nodes},function(){var utils={},ds=document.selection;utils.selectionStart=function(oElement){if(!ds)try{return oElement.selectionStart}catch(e){return 0}var er=ds.createRange(),s=0,er1=document.body.createTextRange();try{er1.moveToElementText(oElement)}catch(e){}for(;er1.compareEndPoints("StartToStart",er)<0;s++)er1.moveStart("character",1);return s},utils.selectionBefore=function(oElement){return oElement.value.slice(0,utils.selectionStart(oElement))},utils.selectText=function(oElement,nStart,nEnd){if(oElement.focus(),ds){var c=oElement.createTextRange();c.collapse(1),c.moveStart("character",nStart),c.moveEnd("character",nEnd-nStart),c.select()}else oElement.setSelectionRange(nStart,nEnd)},utils.insertText=function(oElement,sInsertText,nStart,nLen){if(oElement.focus(),nLen=nLen||0,!ds){var text=oElement.value,start=nStart-nLen,end=start+sInsertText.length;return oElement.value=text.slice(0,start)+sInsertText+text.slice(nStart,text.length),void utils.selectText(oElement,end,end)}var c=ds.createRange();c.moveStart("character",-nLen),c.text=sInsertText},utils.replaceText=function(oElement,sInsertText){oElement.focus();var text=oElement.value,selectedText=utils.getSelectedText(oElement),dl=selectedText.length;if(0==selectedText.length)utils.insertText(oElement,sInsertText,utils.getCursorPos(oElement));else{var start=utils.getCursorPos(oElement);if(!ds){selectedText.length;return oElement.value=text.slice(0,start)+sInsertText+text.slice(start+dl,text.length),void utils.setCursor(oElement,start+sInsertText.length)}ds.createRange().text=sInsertText,utils.setCursor(oElement,start+sInsertText.length)}},utils.getCursorPos=function(obj){var CaretPos=0;if($IE){obj.focus();var range=null,stored_range=(range=ds.createRange()).duplicate();stored_range.moveToElementText(obj),stored_range.setEndPoint("EndToEnd",range),obj.selectionStartIE=stored_range.text.length-range.text.length,obj.selectionEndIE=obj.selectionStartIE+range.text.length,CaretPos=obj.selectionStartIE}else(obj.selectionStart||"0"==obj.selectionStart)&&(CaretPos=obj.selectionStart);return CaretPos},utils.getSelectedText=function(obj){return window.getSelection?function(e){return e.selectionStart!=undefined&&e.selectionEnd!=undefined?e.value.substring(e.selectionStart,e.selectionEnd):""}(obj):ds.createRange().text},utils.setCursor=function(obj,pos,coverlen){if(pos=null==pos?obj.value.length:pos,coverlen=null==coverlen?0:coverlen,obj.focus(),obj.createTextRange){var range=obj.createTextRange();range.move("character",pos),range.moveEnd("character",coverlen),range.select()}else obj.setSelectionRange(pos,pos+coverlen)},utils.unCoverInsertText=function(obj,str,pars){(pars=null==pars?{}:pars).rcs=null==pars.rcs?obj.value.length:1*pars.rcs,pars.rccl=null==pars.rccl?0:1*pars.rccl;var text=obj.value,fstr=text.slice(0,pars.rcs),lstr=text.slice(pars.rcs+pars.rccl,""==text?0:text.length);obj.value=fstr+str+lstr,this.setCursor(obj,pars.rcs+(null==str?0:str.length))},CommentV2.TextAreaUtils=utils}(),window.WEIBOFACEDATA=[{phrase:"[神兽羊驼]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_thumb.gif",value:"[神兽羊驼]",picid:""},{phrase:"[神马]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_thumb.gif",value:"[神马]",picid:""},{phrase:"[浮云]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]",picid:""},{phrase:"[给力]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_thumb.gif",value:"[给力]",picid:""},{phrase:"[围观]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_thumb.gif",value:"[围观]",picid:""},{phrase:"[威武]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_thumb.gif",value:"[威武]",picid:""},{phrase:"[熊猫]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_thumb.gif",value:"[熊猫]",picid:""},{phrase:"[兔子]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_thumb.gif",value:"[兔子]",picid:""},{phrase:"[奥特曼]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]",picid:""},{phrase:"[囧]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_thumb.gif",value:"[囧]",picid:""},{phrase:"[互粉]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_thumb.gif",value:"[互粉]",picid:""},{phrase:"[礼物]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_thumb.gif",value:"[礼物]",picid:""},{phrase:"[呵呵]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]",picid:""},{phrase:"[嘻嘻]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_thumb.gif",value:"[嘻嘻]",picid:""},{phrase:"[哈哈]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",value:"[哈哈]",picid:""},{phrase:"[可爱]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_thumb.gif",value:"[可爱]",picid:""},{phrase:"[可怜]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_thumb.gif",value:"[可怜]",picid:""},{phrase:"[挖鼻屎]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_thumb.gif",value:"[挖鼻屎]",picid:""},{phrase:"[吃惊]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_thumb.gif",value:"[吃惊]",picid:""},{phrase:"[害羞]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_thumb.gif",value:"[害羞]",picid:""},{phrase:"[挤眼]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_thumb.gif",value:"[挤眼]",picid:""},{phrase:"[闭嘴]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_thumb.gif",value:"[闭嘴]",picid:""},{phrase:"[鄙视]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_thumb.gif",value:"[鄙视]",picid:""},{phrase:"[爱你]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_thumb.gif",value:"[爱你]",picid:""},{phrase:"[泪]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_thumb.gif",value:"[泪]",picid:""},{phrase:"[偷笑]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_thumb.gif",value:"[偷笑]",picid:""},{phrase:"[亲亲]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_thumb.gif",value:"[亲亲]",picid:""},{phrase:"[生病]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_thumb.gif",value:"[生病]",picid:""},{phrase:"[太开心]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_thumb.gif",value:"[太开心]",picid:""},{phrase:"[懒得理你]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_thumb.gif",value:"[懒得理你]",picid:""},{phrase:"[右哼哼]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_thumb.gif",value:"[右哼哼]",picid:""},{phrase:"[左哼哼]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_thumb.gif",value:"[左哼哼]",picid:""},{phrase:"[嘘]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_thumb.gif",value:"[嘘]",picid:""},{phrase:"[衰]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",value:"[衰]",picid:""},{phrase:"[委屈]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_thumb.gif",value:"[委屈]",picid:""},{phrase:"[吐]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_thumb.gif",value:"[吐]",picid:""},{phrase:"[打哈欠]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_thumb.gif",value:"[打哈欠]",picid:""},{phrase:"[抱抱]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_thumb.gif",value:"[抱抱]",picid:""},{phrase:"[怒]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_thumb.gif",value:"[怒]",picid:""},{phrase:"[疑问]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_thumb.gif",value:"[疑问]",picid:""},{phrase:"[馋嘴]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_thumb.gif",value:"[馋嘴]",picid:""},{phrase:"[拜拜]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_thumb.gif",value:"[拜拜]",picid:""},{phrase:"[思考]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_thumb.gif",value:"[思考]",picid:""},{phrase:"[汗]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_thumb.gif",value:"[汗]",picid:""},{phrase:"[困]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_thumb.gif",value:"[困]",picid:""},{phrase:"[睡觉]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_thumb.gif",value:"[睡觉]",picid:""},{phrase:"[钱]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_thumb.gif",value:"[钱]",picid:""},{phrase:"[失望]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_thumb.gif",value:"[失望]",picid:""},{phrase:"[酷]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_thumb.gif",value:"[酷]",picid:""},{phrase:"[花心]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_thumb.gif",value:"[花心]",picid:""},{phrase:"[哼]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_thumb.gif",value:"[哼]",picid:""},{phrase:"[鼓掌]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_thumb.gif",value:"[鼓掌]",picid:""},{phrase:"[晕]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_thumb.gif",value:"[晕]",picid:""},{phrase:"[悲伤]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_thumb.gif",value:"[悲伤]",picid:""},{phrase:"[抓狂]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_thumb.gif",value:"[抓狂]",picid:""},{phrase:"[黑线]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_thumb.gif",value:"[黑线]",picid:""},{phrase:"[阴险]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_thumb.gif",value:"[阴险]",picid:""},{phrase:"[怒骂]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_thumb.gif",value:"[怒骂]",picid:""},{phrase:"[心]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_thumb.gif",value:"[心]",picid:""},{phrase:"[伤心]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",value:"[伤心]",picid:""},{phrase:"[猪头]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",value:"[猪头]",picid:""},{phrase:"[ok]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_thumb.gif",value:"[ok]",picid:""},{phrase:"[耶]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_thumb.gif",value:"[耶]",picid:""},{phrase:"[good]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_thumb.gif",value:"[good]",picid:""},{phrase:"[不要]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_thumb.gif",value:"[不要]",picid:""},{phrase:"[赞]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_thumb.gif",value:"[赞]",picid:""},{phrase:"[来]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_thumb.gif",value:"[来]",picid:""},{phrase:"[弱]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_thumb.gif",value:"[弱]",picid:""},{phrase:"[钟]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_thumb.gif",value:"[钟]",picid:""},{phrase:"[话筒]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_thumb.gif",value:"[话筒]",picid:""},{phrase:"[微博益起来]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/yiqilai_thumb.gif",value:"[微博益起来]",picid:""},{phrase:"[微公益爱心]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/11/lxhgongyi_thumb.gif",value:"[微公益爱心]",picid:""},{phrase:"[笑哈哈]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/32/lxhwahaha_thumb.gif",value:"[笑哈哈]",picid:""},{phrase:"[转发]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/02/lxhzhuanfa_thumb.gif",value:"[转发]",picid:""},{phrase:"[得意地笑]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d4/lxhdeyidixiao_thumb.gif",value:"[得意地笑]",picid:""},{phrase:"[moc转发]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/cb/moczhuanfa_thumb.gif",value:"[moc转发]",picid:""},{phrase:"[劲能样]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/jingnengyang_thumb.gif",value:"[劲能样]",picid:""},{phrase:"[bm可爱]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/95/bmkeai_thumb.gif",value:"[bm可爱]",picid:""},{phrase:"[xkl转圈]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/xklzhuanquan_thumb.gif",value:"[xkl转圈]",picid:""},{phrase:"[ppb鼓掌]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7e/ppbguzhang_thumb.gif",value:"[ppb鼓掌]",picid:""},{phrase:"[din推撞]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dd/dintuizhuang_thumb.gif",value:"[din推撞]",picid:""},{phrase:"[xb压力]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e0/xbyali_thumb.gif",value:"[xb压力]",picid:""},{phrase:"[放假啦]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/37/lxhfangjiale_thumb.gif",value:"[放假啦]",picid:""},{phrase:"[国旗]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/dc/flag_thumb.gif",value:"[国旗]",picid:""},{phrase:"[带着微博去旅行]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f5/weitripballoon_thumb.gif",value:"[带着微博去旅行]",picid:""},{phrase:"[玩去啦]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/92/weitrip_thumb.gif",value:"[玩去啦]",picid:""},{phrase:"[ali哇]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/de/aliwanew_thumb.gif",value:"[ali哇]",picid:""},{phrase:"[酷库熊顽皮]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/46/kxwanpi_thumb.gif",value:"[酷库熊顽皮]",picid:""},{phrase:"[BOBO爱你]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/74/boaini_thumb.gif",value:"[BOBO爱你]",picid:""},{phrase:"[偷乐]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/fa/lxhtouxiao_thumb.gif",value:"[偷乐]",picid:""},{phrase:"[泪流满面]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/64/lxhtongku_thumb.gif",value:"[泪流满面]",picid:""},{phrase:"[lt切克闹]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/ltqiekenao_thumb.gif",value:"[lt切克闹]",picid:""},{phrase:"[江南style]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_org.gif",hot:!0,common:!1,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/67/gangnamstyle_thumb.gif",value:"[江南style]",picid:""}],function(){var date=new Date,year=date.getFullYear();date.getTime()>new Date(year+"/6/3 20:00").getTime()&&date.getTime()<new Date(year+"/6/5 20:00").getTime()||(window.WEIBOFACEDATA.push({phrase:"[蜡烛]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_org.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_thumb.gif",value:"[蜡烛]",picid:""}),window.WEIBOFACEDATA.push({phrase:"[蛋糕]",type:"face",url:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",hot:!1,common:!0,category:"",icon:"//img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",value:"[蛋糕]",picid:""}))}(),document.documentElement.contains?Core.Dom.contains=function(oParentNode,oNode){return!oParentNode.contains||oParentNode.contains(oNode)}:document.documentElement.compareDocumentPosition?Core.Dom.contains=function(oParentNode,oNode){return oParentNode===oNode||!!(16&oParentNode.compareDocumentPosition(oNode))}:Core.Dom.contains=function(oParentNode,oNode){for(;oNode;){if(oParentNode===oNode)return!0;oNode=oNode.parentNode}return!1};var Tabs=Core.Class.create();Tabs.prototype={initialize:function(container,option){var className=(option=option||{}).className||"";this.tabsArr=[],this.htmlEle=$C("ul"),this.htmlEle.className=className,container.appendChild(this.htmlEle)},add:function(tab){this.tabsArr.push(tab),this.htmlEle.appendChild(tab.element),Core.Events.addEvent(tab.element,Core.Function.bind3(this.swapTags,this,[tab]))},swapTags:function(tab){if(0==tab.isFocus){for(var i=0;i<this.tabsArr.length;i++)this.tabsArr[i].setAbort();tab.setFocus()}}};var Tab=Core.Class.create();if(Tab.prototype={isShow:!0,initialize:function(title,option){this.id=Core.Math.getUniqueId(),this.option=option||{};var isFocus=option.isFocus||!1;this.className=option.className||"",this.focus=option.onfocus?[option.onfocus]:[],this.abotrts=option.onabort?[option.onabort]:[],this.element=$C("li"),option.cls&&(this.element.className=option.cls),isFocus?this.setFocus():this.setAbort(),this.element.innerHTML=title},setAbort:function(){0!=this.isFocus&&(this.option.cls?this.element.className=this.option.cls:this.element.className="",this.isFocus=!1,this.onabort())},setFocus:function(){this.element.className=this.className,this.isFocus=!0,this.onfocus()},onabort:function(){for(var i=0;i<this.abotrts.length;i++)this.abotrts[i]()},onfocus:function(){for(var i=0;i<this.focus.length;i++)this.focus[i]()},addOnAbort:function(abortFunc){this.abotrts.push(abortFunc)},addOnFocus:function(focusFunc){this.focus.push(focusFunc)},hidden:function(){this.element.style.display="none"},hidden:function(){this.element.style.display="none",this.isShow=!1},show:function(){this.element.style.display="block",this.isShow=!0}},Lib.register("util.JSON",(function(lib){var wnd;return(wnd=window).JSON?wnd.JSON:{parse:function(sJSON){return new Function("return "+sJSON)()},stringify:function(vContent){if(vContent instanceof Object){var sOutput="";if(vContent.constructor===Array){for(var nId=0;nId<vContent.length;sOutput+=this.stringify(vContent[nId])+",",nId++);return"["+sOutput.substr(0,sOutput.length-1)+"]"}if(vContent.toString!==Object.prototype.toString)return'"'+vContent.toString().replace(/"/g,"\\$&")+'"';for(var sProp in vContent)sOutput+='"'+sProp.replace(/"/g,"\\$&")+'":'+this.stringify(vContent[sProp])+",";return"{"+sOutput.substr(0,sOutput.length-1)+"}"}return"string"==typeof vContent?'"'+vContent.replace(/"/g,"\\$&")+'"':String(vContent)}}})),CommentV2.FaceDialog=Core.Class.create(),CommentV2.FaceDialog.prototype={initialize:function(srcEl,tarea){this._src=srcEl,this._tarea=tarea,this._json=Lib.util.JSON,this.dialog=new Dialog(this._tpl),this.dialogNodes=this.dialog.getNodes();var pos=this.getSrcPos(srcEl);this.faceDatas={},this.generaFaces=[],this.hotFaces=[],this.dialog.setPosition(pos),this.dialog.show(),this.initTab(),this._bindEvents()},_tpl:['<table class="CP_w" id="#{entity}">',"<thead>","<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong>插入表情</strong><cite><a href="#" id="#{close}"class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemList" id="#{facelistbox}">','<div class="CP_w_tag" id="#{facetabs}" style="display:none"></div>','<div id="#{general}">','<div class="tab_subsort" id="#{generaltabs}" style="display:none"></div>','<div class="details">','<ul class="face_tp face_lt" id="#{hotFace}"></ul>','<ul class="face_tp" id="#{inner}"></ul>','<div class="SG_page" id="#{page}"><ul id="#{pagelist}" class="SG_pages"></ul></div>',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),_bindEvents:function(){var _this=this;Core.Events.addEvent(this.dialogNodes.close,(function(e){e=Core.Events.getEvent();Core.Events.stopEvent(e),_this.dialog.hidden()}),"click"),Core.Events.addEvent(document.body,(function(e){var target=(e=Core.Events.getEvent()).target||e.srcElement;Core.Dom.contains(_this.dialogNodes.entity,target)||target==_this._src||_this.dialog.hidden()}),"click"),this.bindDelegateAction()},getSrcPos:function(){var srcEl=this._src,spos=Core.Dom.getXY(srcEl),height=srcEl.offsetHeight,pos={};return pos.x=spos[0],pos.y=spos[1]+height+5,pos},show:function(){this.dialog.show()},initTab:function(){this.tab=new Tabs(this.dialogNodes.facetabs,{}),highTab=new Tab("<div><em>常用表情</em></div>",{isFocus:!0,className:"cur"}),highTab.addOnFocus(Core.Function.bind3(this.initGeneralFace,this)),this.tab.add(highTab),this.initGeneralFace()},getFaceData:function(fun){if(!this.faceDatas.face){var _this=this;if(window.WEIBOFACEDATA)this.faceDatas.face=_this.formartFaceData(window.WEIBOFACEDATA),fun();else{window.jsonpfacedata=function(result){1==result.code&&result.data&&(window.WEIBOFACEDATA=result.data,_this.faceDatas.face=_this.formartFaceData(result.data),fun())},Utils.Io.JsLoad.request("//i2.api.weibo.com/2/emotions.json?source=1617465124&type=face&language=cnname&callback=jsonpfacedata",{onComplete:function(result){}.bind2(this),charset:"UTF-8"})}}},formartFaceData:function(data){for(var _data={},i=0,len=data.length;i<len;i++){var item=data[i];item.category||(item.category="默认"),item.hot?this.hotFaces.push(item):(_data[item.category]||(_data[item.category]=[],this.generaFaces.push(item.category)),_data[item.category].push(item))}return _data},initGeneralFace:function(){this.getFaceData(this.initGeneralTab.bind2(this))},initGeneralTab:function(){var tabs=this.initGeneralTabList();this.initGeneralTabPage(tabs)},initGeneralTabList:function(){var tabs=new Tabs(this.dialogNodes.generaltabs,{});tabs.add=function(tab){this.tabsArr.push(tab),this.htmlEle.appendChild(tab.element);var _this=this;Core.Events.addEvent(tab.element,(function(e){e=Core.Events.getEvent();Core.Events.stopEvent(e),_this.swapTags(tab)}))}.bind2(tabs);for(var i=0,len=this.generaFaces.length;i<len;i++){var itme=this.generaFaces[i],isFocus=!1;0==i&&(isFocus=!0);var tabitem=new Tab('<a href="#">'+itme+"</a>",{isFocus:isFocus,className:"cur"});tabitem.addOnFocus(Core.Function.bind3(this.showGeneralFaces,this,[itme])),i>4&&tabitem.hidden(),tabs.add(tabitem),0==i&&this.showGeneralFaces(itme)}return tabs},initGeneralTabPage:function(tabs){Core.Dom.insertHTML(this.dialogNodes.generaltabs,'<div class="btn_func" ><a href="#" node-type="generalTabPagePre" class="arrow_preview"></a><a href="#" node-type="generalTabPageNext" class="arrow_next"></a></div>',"BeforeEnd");var pre=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPagePre")[0],next=Core.Dom.getElementsByAttr(this.dialogNodes.generaltabs,"node-type","generalTabPageNext")[0],focuspage=1,preTabArr=[],focusTabArr=tabs.tabsArr.slice(focuspage-1,5),total=this.generaFaces.length,remainder=total%5,totalpage=remainder>0?(total-remainder)/5+1:total/5;function setpage(){preTabArr=focusTabArr,focusTabArr=tabs.tabsArr.length>=5*focuspage-1?tabs.tabsArr.slice(5*(focuspage-1),5*focuspage):tabs.tabsArr.slice(5*(focuspage-1));for(var prelen=preTabArr.length-1;prelen>=0;--prelen){preTabArr[prelen].hidden()}for(var focuslen=focusTabArr.length-1;focuslen>=0;--focuslen){focusTabArr[focuslen].show()}}Core.Events.addEvent(pre,(function(e){e=Core.Events.getEvent();Core.Events.stopEvent(e),focuspage<=1?focuspage=1:(focuspage--,setpage())})),Core.Events.addEvent(next,(function(e){e=Core.Events.getEvent();Core.Events.stopEvent(e),focuspage>=totalpage?focuspage=totalpage:(focuspage++,setpage())}))},showTheHotFace:function(){if(this.hotFaces){var data=this.hotFaces.slice(0,12);this.setHotFaceList(data)}},memoryFocusTab:function(tabname){this.dialogNodes.generaltabs.setAttribute("data-focustab",tabname)},showGeneralFaces:function(tabname){if(this.memoryFocusTab(tabname),this.faceDatas.face&&this.faceDatas.face[tabname]){this.dialogNodes.hotFace.style.display="默认"==tabname?"block":"none";var data=this.faceDatas.face[tabname];this.setGeneralFaceList(data)}},setHotFaceList:function(data){var tpl=this.getFaceItemsTpl(data);this.dialogNodes.hotFace.innerHTML=tpl},setGeneralFaceList:function(data){var page=this.getFaceListPageData(data);this.initFaceListPage(page),this.updateGeneralFaceList(data,page)},updateGeneralFaceList:function(data,page){data=this.getFaceListData(data,page);var tpl=this.getFaceItemsTpl(data);this.dialogNodes.inner.innerHTML=tpl},getFaceItemsTpl:function(data){for(var list=[],i=0,len=data.length;i<len;i++){var item=data[i];list.push('<li action-type="insert" action-data="'+item.phrase+'"><img src="'+item.icon+'" alt="'+item.phrase+'" title="'+item.phrase+'"></li>')}return list.join("")},getFaceListPageData:function(data){var page={step:72,focus:1};return page.total=data.length,page.totalpage=page.total>page.step?page.total%page.step>0?(page.total-page.total%page.step)/page.step+1:page.total/page.step:1,this.dialogNodes.page.setAttribute("data-page",this._json.stringify(page)),page},initFaceListPage:function(page){var pgtpl=[];if(page.totalpage>1){this.dialogNodes.page.style.display="block";for(var i=1;i<=page.totalpage;i++)i==page.focus?pgtpl.push('<li class="SG_pgon">'+i+"</li>"):pgtpl.push('<li><a href="#" action-type="facePageNums">'+i+"</a></li>");this.dialogNodes.pagelist.innerHTML=pgtpl.join("")}else this.dialogNodes.page.style.display="none"},getFaceListData:function(data,page){var step=page.step,total=page.total,totalpage=page.totalpage,focus=page.focus;return focus<1&&(focus=1),focus>totalpage&&(focus=totalpage),step<total?data.slice((focus-1)*step,focus*step):data},bindDelegateAction:function(){Core.Events.addEvent(this.dialogNodes.facelistbox,(function(e){!function(e){var datas=Lib.util.getActionData(e,"insert");if(datas){var text=datas.data,index=CommentV2.TextAreaUtils.selectionStart(_this._tarea);CommentV2.TextAreaUtils.insertText(_this._tarea,text,index),_this.dialog.hidden()}}(e),function(e){var datas=Lib.util.getActionData(e,"facePageNums");if(datas){Core.Events.stopEvent(e);var focus=datas.targetEl.innerHTML,page=_this._json.parse(_this.dialogNodes.page.getAttribute("data-page"));page.focus=focus-0,_this.dialogNodes.page.setAttribute("data-page",_this._json.stringify(page)),_this.initFaceListPage(page);var tabname=_this.dialogNodes.generaltabs.getAttribute("data-focustab"),data=_this.faceDatas.face[tabname];_this.updateGeneralFaceList(data,page)}}(e)}));var _this=this;Core.Events.addEvent(this.dialogNodes.facelistbox,(function(e){!function(e){var datas=Lib.util.getActionData(e,"insert");datas&&(datas.targetEl.className="hover")}(e)}),"mouseover"),Core.Events.addEvent(this.dialogNodes.facelistbox,(function(e){!function(e){var datas=Lib.util.getActionData(e,"insert");datas&&(datas.targetEl.className="")}(e)}),"mouseout")}},CommentV2.autoHeightTextArea=function(option){var getStyle=Core.Dom.getStyle,addEvent=Core.Events.addEvent;var listener,textArea=option.textArea,maxHeight=option.maxHeight,inputListener=option.inputListener,textStyle=textArea.style;(listener=function(){"function"==typeof inputListener&&inputListener(),setTimeout((function(){var nSnapHeight=function(el){var snapHeight;if(el.defaultHeight||(el.defaultHeight=parseInt(getStyle(el,"height"),10)||parseInt(el.offsetHeight,10)||20),$IE){var paddingHeight=parseInt(getStyle(el,"paddingTop"),10)+parseInt(getStyle(el,"paddingBottom"),10);snapHeight=Math.max(el.scrollHeight-paddingHeight,el.defaultHeight)}else{paddingHeight=$MOZ?0:parseInt(getStyle(el,"paddingTop"),10)+parseInt(getStyle(el,"paddingBottom"),10);var textArea=$E("_____textarea_____");if(textArea||((textArea=$C("textarea")).id="_____textarea_____",document.body.appendChild(textArea)),textArea.currentTarget!=el){var cssText=[];cssText.push("width:"+getStyle(el,"width")),cssText.push("font-size:"+getStyle(el,"fontSize")),cssText.push("font-family:"+getStyle(el,"fontFamily")),cssText.push("line-height:"+getStyle(el,"lineHeight")),cssText.push("padding-left:"+getStyle(el,"paddingLeft")),cssText.push("padding-right:"+getStyle(el,"paddingRight")),cssText.push("padding-top:"+getStyle(el,"paddingTop")),cssText.push("padding-bottom:"+getStyle(el,"paddingBottom")),cssText.push("top:-1000px"),cssText.push("height:0px"),cssText.push("position:absolute"),cssText.push("overflow:hidden"),cssText.push(""),cssText=cssText.join(";"),textArea.style.cssText=cssText}textArea.value=el.value,snapHeight=Math.max(textArea.scrollHeight-paddingHeight,el.defaultHeight),textArea.currentTarget=el}return snapHeight}(textArea)||0,temp=nSnapHeight>(maxHeight=maxHeight||nSnapHeight);textStyle.overflowY=temp?"auto":"hidden",textStyle.height=Math.min(maxHeight,nSnapHeight)+"px"}),0)})(),textArea.binded||(addEvent(textArea,listener,"keyup"),addEvent(textArea,listener,"focus"),addEvent(textArea,listener,"blur"),textArea.binded=!0,textArea.style.overflow="hidden")},CommentV2.CommentArea=Core.Class.create(),CommentV2.CommentArea.prototype={initialize:function(option){this._container=option.container,this._place=option.place||"BeforeEnd",this._maxtext=2*(option.maxtext||140),this._sid=option.sid||(new Date).getTime(),option.shownum=option.shownum||"yes",this._shownum="yes"==option.shownum?1:0,option.autolineheight=option.autolineheight||"no",this._autolineheight="no"==option.autolineheight?0:1,option.alertnotice=option.alertnotice||"yes",this._alertnotice="yes"==option.alertnotice?1:0,this._maxheight=option.maxheight||100,this._okhandler=option.okhandler||function(){},this._initTareBox(),this._initDom(),this._bindEvent(),this._clock=null},setReplyData:function(plugs,opt){this._plugs=plugs,this._replaydata=opt},setValues:function(option){var value=option.comment,index=CommentV2.TextAreaUtils.selectionStart(this._tarea);this._tarea.value="",CommentV2.TextAreaUtils.insertText(this._tarea,value,index),CommentV2.TextAreaUtils.setCursor(this._tarea,0),this._checkNum()},getValue:function(){return this._tarea.value},_setTpl:function(argument){this.tpl=['<div id="tare'+this._sid+'">','<div class="count" node-type="num">您还能输入'+this._maxtext/2+"字</div>",'<textarea  node-type="textEl"></textarea>','<div class="func"> <a href="#" class="fico" node-type="faceBtn"></a>','<div class="fr">','<label style="display:none;">','<input node-type="shareIpt" type="checkbox">',"将评论分享到微博 </label>",'<a href="#" class="SG_aBtn btn_reply" node-type="subtnEl"><cite>回复</cite></a></div>',"</div>","</div>"].join("")},_initTareBox:function(){this._setTpl(),Core.Dom.insertHTML(this._container,this.tpl,this._place),this._selfcontainer=$E("tare"+this._sid)},_initDom:function(){var container=this._selfcontainer;container&&(this._tarea=Core.Dom.getElementsByAttr(container,"node-type","textEl")[0],this._num=Core.Dom.getElementsByAttr(container,"node-type","num")[0],this._subtn=Core.Dom.getElementsByAttr(container,"node-type","subtnEl")[0],this._facebtn=Core.Dom.getElementsByAttr(container,"node-type","faceBtn")[0],this._shareitp=Core.Dom.getElementsByAttr(container,"node-type","shareIpt")[0],this._shareitp.checked=!1,this._shownum||(this._num.style.display="none"))},_bindEvent:function(){var _this=this;Core.Events.addEvent(this._shareitp,(function(e){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_09"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_13")}),"click"),Core.Events.addEvent(this._tarea,this._checkNum.bind2(this),"keydown"),Core.Events.addEvent(this._tarea,(function(e){_this._checkNum();(e=Core.Events.getEvent()).target||e.srcElement;_this._checkValue()}),"keyup"),Core.Events.addEvent(this._tarea,this._bindKeyEvent.bind2(this),"keydown"),Core.Events.addEvent(this._subtn,(function(e){(e=Core.Events.getEvent()).preventDefault?e.preventDefault():e.returnValue=!1,_this._submitForm()}),"click"),Core.Events.addEvent(this._facebtn,(function(e){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_11"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_15"),(e=Core.Events.getEvent()).preventDefault?e.preventDefault():e.returnValue=!1,_this._showFacePanel()}),"click"),this._autolineheight&&CommentV2.autoHeightTextArea({textArea:this._tarea,maxHeight:this._maxheight,inputListener:function(){trace("--autoHeightTextArea--")}})},_checkValue:function(){},_checkNum:function(){var num=this._getUnoccupiedNum();if(this._shownum){var showtext=num>=0?"还可以输入"+num+"字":'<em class="red">已超出'+-num+"字</em>";this._num.innerHTML=showtext}},_jsOverflow:function(){return this._getUnoccupiedNum()<0},_getUnoccupiedNum:function(){var text=this._tarea.value,textlen=this._getLen(text),max=this._maxtext;return(max-textlen)%2==0?(max-textlen)/2:(max-textlen-1)/2},_getLen:function(a){if(!a)return 0;var b=a.match(/[^\x00-\xff]/g);return a.length+(b?b.length:0)},_bindKeyEvent:function(e){13==e.keyCode&&e.ctrlKey&&this._submitForm()},_validate:function(){var _this=this;return""==Core.String.trim(this._tarea.value)?(winDialog.alert($SYSMSG.B36041,{icon:"01",funcOk:function(){_this._tarea.focus()}}),!1):!this._jsOverflow()||(winDialog.alert($SYSMSG.B36208,{icon:"01",funcOk:function(){_this._tarea.focus()}}),!1)},_submitForm:function(){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_10"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_14"),this._validate()&&this._plugs&&(this._replaydata.reply_content=Core.String.trim(this._tarea.value),this._replaydata.is_t=this._shareitp.checked?1:0,this._setShareWbSign(),this._plugs.add(this._replaydata,this.successFun.bind2(this),this.errorFun.bind2(this)))},_setShareWbSign:function(){this._shareitp&&(this._shareitp.checked?$E("bb")&&($E("bb").checked=!0):$E("bb")&&($E("bb").checked=!1))},successFun:function(data){this._tarea.value="",this._checkNum();var _this=this;this._alertnotice&&winDialog.alert("发布成功",{icon:"03",funcOk:function(){_this._plugs.sucOkFun&&_this._plugs.sucOkFun()}}),this._okhandler()},errorFun:function(data){"blog7"==scope.$PRODUCT_NAME&&v7sendLog("32_01_12"),"blog7icp"==scope.$PRODUCT_NAME&&v7sendLog("32_01_16");var errorinfo=data?$SYSMSG[data.code]:"发布失败，请稍后再试";winDialog.alert(errorinfo,{icon:"01",funcOk:function(){_this._plugs.errOkFun&&_this._plugs.errOkFun()}})},_showFacePanel:function(){this.facedialog?this.facedialog.show():this.facedialog=new CommentV2.FaceDialog(this._facebtn,this._tarea)}},function(){function CutString(string,limit){this.tempDiv=document.createElement("div"),this.tempDiv.id="TempNodeForTest",this.tempDiv.innerHTML=string,this.charCount=0,this.limit=limit}CutString.prototype.cut=function(){var newDiv=document.createElement("div");return this.searchEnd(this.tempDiv,newDiv),newDiv.innerHTML},CutString.prototype.searchEnd=function(parseDiv,newParent){for(var ele,newEle,j=0;j<parseDiv.childNodes.length;j++)if(3==(ele=parseDiv.childNodes[j]).nodeType){if(Core.String.byteLength(ele.nodeValue)+this.charCount>=this.limit)return(newEle=ele.cloneNode(!0)).nodeValue=ele.nodeValue.substr(0,this.limit-this.charCount),newParent.appendChild(newEle),!0;newEle=ele.cloneNode(!0),newParent.appendChild(newEle),this.charCount+=Core.String.byteLength(ele.nodeValue)}else{if(newEle=ele.cloneNode(!0),newParent.appendChild(newEle),0===ele.childNodes.length)continue;newEle.innerHTML="";var res=this.searchEnd(ele,newEle);if(res)return res}return!1},Core.String.cutHtmlString=function($string,$limit){return new CutString($string,$limit).cut()}}(),Lib.HtmlTemplate=function(tmpl,uniqueID){this.uniqueID=uniqueID}.$extends(Ui.Template).$define({getHtmlString:function(){return this._htmlStr||(this._htmlStr=this.evaluate(this.getNodeIds())),this._htmlStr},getNodeIds:function(){if(!this._nodes){var i,rets,r,nodes={},uniqueID=this._getUniqueID();if(this.__templateNodesIDs=this.tmpl.match(/\{[^\}]+(?=\})/g),rets=this.__templateNodesIDs)for(i=rets.length;i--;)nodes[r=rets[i].replace("{","")]="_"+uniqueID+"_"+r;this._nodes=nodes}return this._nodes},getNodeId:function(name){return this._nodes||this.getNodeIds(),this._nodes[name]},getNode:function(name){var id=this.getNodeId(name);return id?$E(id):null},_getUniqueID:function(){return this.uniqueID||(this.uniqueID=parseInt(1e3*Math.random()).toString()+(new Date).getTime().toString()),this.uniqueID}}),CommentV2.decodeReplyContent=function(str){try{str=decodeURIComponent(str)}catch(e){}var _userContent=str.replace(/\r\n|\n/gi,"###line-return###");return _userContent=(_userContent=(_userContent=Core.String.encodeHTML(_userContent)).replace(/\[([^\]]*)\]/g,(function(matchVal){for(var result="",i=0;i<WEIBOFACEDATA.length;i++)matchVal===WEIBOFACEDATA[i].value&&(result='<img src="'+WEIBOFACEDATA[i].icon+'" title="'+WEIBOFACEDATA[i].value+'">');return result||matchVal}))).replace(/###line-return###/gi,"<br/>")},CommentV2.needAuthTrueName=function(code){return"1005"==code&&(winDialog.confirm("抱歉，您还没有认证实名，<br>请点击确认认证后，继续发表评论！",{icon:"01",funcOk:function(){window.open("https://security.sina.com.cn/account/index?entry=sina_shiming","_blank")}}),!0)},CommentV2.isAllowSubmit=function(code){return"A00006"===code||"A00102"===code||(winDialog.alert($SYSMSG[code]||$SYSMSG.A00001),!1)},Utils.Io.Ijax2={request:function(url,option){this.ifrId||(this.ifrId=this.initIframe());var callbackName="iJaxCallback_"+(new Date).getTime();option.POST.callback=callbackName,window[callbackName]=function(data){try{delete window[callbackName]}catch(error){}option.onComplete(data)},this.initForm(url,option)},initIframe:function(){var iframe=$C("iframe"),ifrId="requestIjax_"+(new Date).getTime();return iframe.id=ifrId,iframe.name=ifrId,iframe.style.display="none",iframe.className="invisible",document.body.appendChild(iframe),ifrId},initForm:function(_url,option){var oIjaxForm=$C("form");for(var oItem in oIjaxForm.id="IjaxForm2",oIjaxForm.action=_url,oIjaxForm.method="post",oIjaxForm.target=this.ifrId,option.POST){var value;value=option.noEncode?Core.String.encodeDoubleByte(option.POST[oItem]):option.POST[oItem];var oInput=$C("input");oInput.type="hidden",oInput.name=oItem,oInput.value=value,oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm),oIjaxForm.submit()}},CommentV2.Add=function(opt){opt=opt||{};this.tpl=opt.tpl||"",this.url=opt.url||"",this.type=opt.type||"comment",this.data=opt.data||"",this.jsonUtil=Utils.Json,this.leftB=Core.String.leftB,this.cutHtmlString=Core.String.cutHtmlString,this.loader=new Interface(this.url,"ijax"),this.init()}.$define({init:function(){trace("CommentV2.Add.Init"),this.tpl||(this.tpl=this.getTpl()),Lib.checkAuthor()},post:function(data,sucFn,errFn){var __this=this;$isLogin?(trace("CommentV2.Add.Post"),trace(data),Lib.Uic.getNickName([$UID],(function(names){var blogerPic,blogerName=names[$UID];Lib.Uic.getUserPic($UID,(function(data){blogerPic=data.s})),Utils.Io.Ijax2.request("//comment5.news.sina.com.cn/cmnt/submit",{POST:{channel:"blog",parent:data.id,newsid:data.articleid,content:data.reply_content,usertype:"blogpc",ie:"utf-8",oe:"utf-8",share_url:1===data.is_t?"//blog.sina.com.cn/s/blog_"+data.articleid+".html":"",ispost:1===data.is_t?1:0},returnType:"json",onComplete:function(_data){if("20003"!=_data.result.status.code&&"10013"!=_data.result.status.code){if(!CommentV2.isAllowSubmit(_data.result.blog_code))return!1;if(0===_data.result.status.code){if(!CommentV2.needAuthTrueName(_data.result.filter_code))switch(_data.result.filter_code){case"1103":case"1104":case"1105":case"1107":case"1106":case"2000":case"2004":case"2005":case"2006":case"2100":case"4001":winDialog.alert($SYSMSG[_data.result.filter_code]);break;case"4000":case"4002":var tmp={stair_cms_id:data.stair_cms_id||data.id,id:_data.result.id,cms_body:data.reply_content,fromProduct:"blog",articleid:data.articleid,source_id:data.id,source_uid:data.comm_uid,source_uname:data.uname,source_ria_index_url:"//blog.sina.com.cn/u/"+data.comm_uid,comm_uid:$UID,uname:blogerName||_data.result.user.nick,user_image:blogerPic||"//portrait3.sinaimg.cn/"+$UID+"/blog/50",ria_index_url:"//blog.sina.com.cn/u/"+$UID,cms_pubdate:_data.result.time},item=tmp;item.action_data=__this.obj2str(tmp);var li=__this.render(item,-1,data.cms_reply_num);__this.appendItem(li,item.stair_cms_id),sucFn&&"function"==typeof sucFn&&sucFn(_data.result);break;default:winDialog.alert($SYSMSG.A00001)}}else winDialog.alert("未知错误，请稍后再试!",{icon:"02"})}else winDialog.alert("您还没有开通微博，请先开通，再进行评论同步到微博操作！",{icon:"02"})}.bind2(this),onException:function(){}.bind2(this)})}))):(new Lib.Login.Ui).login((function(){scope.blogOpener.showDialog((function(){data.uid=$UID,data.login_name=scope.$loginNick||$nick,__this.post(data,sucFn,errFn)}))}))},render:function(item,index,len){var html,tmp,li=$C("li");if(li.className="SG_j_linedot1",item.vimg=item.vimg?item.vimg:"",item.source_vimg=item.source_vimg?item.source_vimg:"",item.from="","weibo"==item.fromProduct){item.user_from_weibo='来自<a target="_blank" href="'+item.ulink+'"><img height="15" align="absmiddle" width="15" class="SG_icon SG_icon51" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif">'+item.weibo_uname+"</a>的评论"}if(0==item.cms_reply_num?item.cms_reply_num="("+item.cms_reply_num+")":item.cms_reply_num=item.cms_reply_num?"("+item.cms_reply_num+")":"",item.show_more="none",item.moreInfo="","comment"===this.type){if(item.cms_body=CommentV2.decodeContent(item.cms_body),item.god_comment=1==item.god?'<span class="god_reply">神评</span>':"",li.id="cmt_"+item.id,0===index&&(li.className=""),0==item.comm_uid?(item.user_image_place='<img src="'+item.user_image+'">',item.user_nick_place=item.uname):(item.user_image_place='<a href="'+item.ria_index_url+'" target="_blank"><img src="'+item.user_image+'"></a>',item.user_nick_place='<a href="'+item.ria_index_url+'">'+item.uname+"</a>"),"blog"===item.fromProduct){this.__getLen((html=item.cms_body,(tmp=document.createElement("DIV")).innerHTML=html,tmp.textContent||tmp.innerText||""))>280&&(item.show_more="",item.moreInfo='<div class="SG_revert_Inner SG_txtb" id="body_cmt_full_'+item.id+'" style="display:none;">'+item.cms_body+'<a href="javascript:void(0);" class="btn_artsq" style="display:"";" action-type="comment_more" action-data="'+item.action_data+'"></a></div>',item.cms_body=this.cutHtmlString(item.cms_body,280))}}else"reply"===this.type&&(li.id="reply_"+item.id,item.cms_body=CommentV2.decodeReplyContent(item.cms_body),len>=1&&index===len-1&&(li.className=""),0==len&&-1==index&&(li.className=""),0==item.source_uid?item.soure_user_info="&nbsp;"+item.source_uname+"&nbsp;：":item.soure_user_info='&nbsp;<a href="'+item.source_ria_index_url+'" target="_blank">'+item.source_uname+"</a>"+item.source_vimg+"：");!$UID||item.comm_uid!=$UID&&scope.$uid!=$UID?item.show_del="none":item.show_del="","qing"!=item.fromProduct?item.show_report="":item.show_report="none";var severtime=new Date,commtime=new Date(item.cms_pubdate.replace(/-/g,"/"));item._cms_pubdate=this.dateFormat(severtime,commtime);var htmlStr=new Lib.HtmlTemplate(this.tpl).evaluate(item);return li.innerHTML=htmlStr,li},appendItem:function(node,id){var parent=$E("comment_"+id+"_replylist");parent.insertBefore(node,parent.firstChild),parent.style.display=""},getTpl:function(){return"comment"===this.type?'<div class="SG_revert_Left">#{user_image_place}</div><div class="SG_revert_Cont"><p><span class="SG_revert_Tit">#{user_nick_place}#{god_comment}</span>#{vimg}</p><div class="SG_revert_Inner SG_txtb" id="body_cmt_#{id}">#{cms_body}<a href="javascript:void(0);" class="btn_artzk" style="display:#{show_more}" action-type="comment_more" action-data="#{action_data}"></a></div>#{moreInfo}<p class="myReFrom"><em class="SG_txtc">#{_cms_pubdate}</em>#{user_from_weibo}<span class="SG_revert_Func"><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_report" action-data="#{action_data}" style="display:#{show_report}"><cite>举报</cite></a><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_del" action-data="#{action_data}" style="display:#{show_del}">删除</a><a href="javascript:void(0);" class="SG_a_fuc" action-type="comment_share" action-data="#{action_data}" style="display:#{show_share}"><cite>分享</cite></a><a href="javascript:void(0);" class="SG_a_fucs" action-type="comment_reply" action-data="#{action_data}" style="display:#{show_reply}"><cite>回复#{cms_reply_num}</cite></a></span></p><div class="SG_reply" id="comment_#{id}" style="display:none;"></div></div>':'<div class="img"><a href="#{ria_index_url}" target="_blank"><img src="#{user_image}"></a></div><div class="txt"><p'+($FF,' style="white-space:pre-wrap;"><a href="#{ria_index_url}" target="_blank">#{uname}</a>#{vimg}&nbsp;回复#{soure_user_info}#{cms_body}(#{_cms_pubdate})</p></div><div class="links"><a href="javascript:void(0);" action-type="reply_report" action-data="#{action_data}" style="display:#{show_report}">举报</a><a href="javascript:void(0);" action-type="reply_del" action-data="#{action_data}" style="display:#{show_del}">删除</a><a href="javascript:void(0);" action-type="reply_share" action-data="#{action_data}" style="display:#{show_share}">分享</a><a href="javascript:void(0);" class="links_s" action-type="reply_reply" action-data="#{action_data}" style="display:#{show_reply}">回复</a></div>')},__getLen:function(a){if(!a)return 0;var b=a.match(/[^\x00-\xff]/g);return a.length+(b?b.length:0)},obj2str:function(obj){return encodeURIComponent(this.jsonUtil.flatten(obj))},str2obj:function(str){return this.jsonUtil.eval(decodeURIComponent(str))},dateFormat:function(dServerTime,dFeedTime){var server_year=dServerTime.getFullYear(),feed_year=dFeedTime.getFullYear(),server_month=dServerTime.getMonth()+1,feed_month=dFeedTime.getMonth()+1,server_day=dServerTime.getDate(),feed_day=dFeedTime.getDate(),server_hour=dServerTime.getHours(),feed_hour=dFeedTime.getHours();feed_hour<10&&(feed_hour="0"+feed_hour),feed_hour="&nbsp;"+feed_hour;var feed_minute=dFeedTime.getMinutes();feed_minute<10&&(feed_minute="0"+feed_minute);var diff_time=dServerTime-dFeedTime;return diff_time=diff_time>0?diff_time:0,diff_time/=1e3,server_year!=feed_year?feed_year+"-"+feed_month+"-"+feed_day+" "+feed_hour+":"+feed_minute:server_month!=feed_month||server_day!=feed_day?feed_month+"月"+feed_day+"日"+feed_hour+":"+feed_minute:server_hour!=feed_hour&&diff_time>3600?"今天"+feed_hour+":"+feed_minute:diff_time<51?(diff_time=diff_time<1?1:diff_time,Math.floor((diff_time-1)/10)+1+"0秒前"):Math.floor(diff_time/60+1)+"分钟前"}}),Core.Dom.opacity=function(elm,value){(elm="string"==typeof elm?$E(elm):elm).style.filter="alpha(opacity="+value+")",elm.style.opacity=value/100},Core.Dom.insertAfter=function(newElement,targetElement){if(targetElement){var parent=targetElement.parentNode;return parent.lastChild==targetElement?parent.appendChild(newElement):parent.insertBefore(newElement,targetElement.nextSibling),newElement}},Core.Dom.wrap=function(elm,tagName){var wrapper=$C(tagName);if(Core.Dom.insertAfter(wrapper,elm),elm)return wrapper.appendChild(elm),wrapper},Ui.Slide=Core.Class.create(),Ui.Slide.prototype={node:null,container:null,status:"show",offset:0,onSlideIn:new Function,onSlideOut:new Function,initialize:function(node,options){options=options||{};this.node=$E(node),this.container=Core.Dom.wrap(this.node,"div"),this.container.style.overflow="hidden",this.offset=this.node.offsetHeight,this.opacity=!0,this.animation=options.animation||"strongEaseOut",this.duration=options.duration||1,this.container.style.height=this.offset+"px",this.node.style.marginTop="0px"},slideIn:function(opt){opt=opt||{},this.opacity&&new Ui.tween(this.node,"opacity",1,this.duration,this.animation,{}),new Ui.tween(this.container,"height",this.offset,this.duration,this.animation,opt),new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(x){}.bind2(this),end:this.onSlideIn})},slideOut:function(opt){opt=opt||{},this.opacity&&new Ui.tween(this.node,"opacity",0,this.duration,this.animation,{}),new Ui.tween(this.container,"height",0,this.duration,this.animation,opt),new Ui.tween(this.node,"marginTop",-this.offset,this.duration,this.animation,{end:this.onSlideOut})},show:function(){this.opacity,this.container.style.height=this.offset+"px",this.node.style.marginTop="0px"},hide:function(){this.opacity,this.container.style.height="0px",this.node.style.marginTop=-this.offset+"px"}},CommentV2.inblack=function(uid,targetUid){new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/deleblackuid.php","jsload").request({GET:{uid:uid,friend_uid:targetUid,inblack:1},onSuccess:function(){},onError:function(res){"blacklist_full"==res.code?winDialog.alert("抱歉！您的黑名单已经满了",{icon:"02"}):winDialog.alert($SYSMSG.A00001||"系统繁忙，请稍候再试。",{icon:"02"})}})},CommentV2.Delete=function(opt){Lib.checkAuthor()}.$define({deleteComment:function(opt,delSucc){trace("CommentV2.CommentDel.deleteComment");var __this=this,data=opt.data,styleState="",subText="";$UID!=data.comm_uid&&0!=data.comm_uid||(styleState=' style="display:none" '),"qing"!==data.fromProduct&&(subText="<div "+styleState+'><input id="cbAddToBlock_'+data.commentid+'" type="checkbox"/><label for="cbAddToBlock_'+data.commentid+'">将此人加入黑名单</label></div>'),winDialog.confirm("确认需要删除此条评论？<br/>删除后不可恢复。",{subText:subText,textOk:"删除",funcOk:function(){var inBlack=""===styleState&&$E("cbAddToBlock_"+data.commentid).checked;Utils.Io.Ajax.request("//comment5.news.sina.com.cn/api/cmnt/delete",{POST:{channel:"blog",newsid:scope.$articleid,mid:data.id,opertype:$UID==data.comm_uid||0==data.comm_uid?0:1},returnType:"json",onComplete:function(result){if(0===result.result.status.code){inBlack&&CommentV2.inblack($UID,data.comm_uid);var node=$E("body_cmt_"+data.commentid).parentNode.parentNode,slide=new Ui.Slide(node);if(slide.onSlideOut=function(){Core.Dom.removeNode(node)},slide.slideOut(),delSucc&&"function"==typeof delSucc){for(var replyBtn,tmpNode=opt.node,replyNum=0;replyBtn=tmpNode.nextSibling;){if(replyBtn&&"comment_reply"===replyBtn.getAttribute("action-type")){var _tmpNumStr=replyBtn.innerHTML;/\d+/.test(_tmpNumStr)&&(replyNum=/\d+/.exec(_tmpNumStr)[0]-0);break}tmpNode=tmpNode.nextSibling}delSucc({cms_reply_num:replyNum})}}else __this.showError()}.bind2(this),onException:function(){__this.showError()}.bind2(this)})}})},deleteReply:function(opt,delSucc){trace("CommentV2.CommentDel.deleteReply");var __this=this,data=opt.data,styleState="",subText="";$UID==data.comm_uid&&(styleState=' style="display:none" '),"qing"!==data.fromProduct&&(subText="<div "+styleState+'><input id="cbAddToBlock_'+data.id+'" type="checkbox"/><label for="cbAddToBlock_'+data.id+'">将此人加入黑名单</label></div>'),winDialog.confirm("确认需要删除此条回复？<br/>删除后不可恢复。",{subText:subText,textOk:"删除",funcOk:function(){var inBlack=""===styleState&&$E("cbAddToBlock_"+data.id).checked;Utils.Io.Ajax.request("//comment5.news.sina.com.cn/api/cmnt/delete",{POST:{channel:"blog",newsid:scope.$articleid,mid:data.id,opertype:$UID==data.comm_uid||0==data.comm_uid?0:1},returnType:"json",onComplete:function(result){0===result.result.status.code?(inBlack&&CommentV2.inblack($UID,data.comm_uid),setTimeout((function(){var node=$E("reply_"+data.id),slide=new Ui.Slide(node);slide.onSlideOut=function(){Core.Dom.removeNode(node)},slide.slideOut(),delSucc&&"function"==typeof delSucc&&delSucc()}),100)):__this.showError()}.bind2(this),onException:function(){__this.showError()}.bind2(this)})}})},showError:function(){winDialog.alert("删除失败，请重试",{icon:"02"})}}),Core.String.decodeHTML=function(str){var div=document.createElement("div");return div.innerHTML=str,div.innerText==undefined?div.textContent:div.innerText},Utils.Form.Radio={},Utils.Form.Radio.get=function(radioObj){if(!radioObj)return"";var radioLength=radioObj.length;if(radioLength==undefined)return radioObj.checked?radioObj.value:"";for(var i=0;i<radioLength;i++)if(radioObj[i].checked)return radioObj[i].value;return""},Utils.Form.Radio.set=function(radioObj,newValue){if(radioObj){var radioLength=radioObj.length;if(radioLength!=undefined)for(var i=0;i<radioLength;i++)radioObj[i].checked=!1,radioObj[i].value==newValue.toString()&&(radioObj[i].checked=!0);else radioObj.checked=radioObj.value==newValue.toString()}},scope.reportMainTpl=['<div id="#{entity}" class="blog_report">','<div id="#{titleBar}" class="BRpt_topTit" style="background:url(http://simg.sinajs.cn/blog7style/images/common/report/bg_toptit.gif) no-repeat left top;" >','<a href="#" onclick="return false;" id="#{btnClose}" title=""><img src="//simg.sinajs.cn/blog7style/images/common/report/icon_clo.gif" /></a>',"</div>",'<div id="#{content}" class="BRpt_mid">',"</div>","</div>"].join(""),scope.reportStartTpl=['<div class="BRpt_Mtop" style="background:url(http://simg.sinajs.cn/blog7style/images/common/report/bg_top.gif) no-repeat left top;" >',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_RtConn">','<p id="#{resumeInfo}" class="Brpt_RtInf"></p>','<textarea id="#{resumeContent}" readonly="readonly" class="Brpt_RtTxt"></textarea>','<p class="Brpt_Rhost"><input type="checkbox" id="#{cbBlogHost}" /><label for="#{cbBlogHost}">同时举报博主</label></p>','<div class="clear"></div>','<div class="Brpt_choCla">','<p class="claTit">请选择您举报类别（<span class="cho">必选</span>）：</p>','<p class="cla_conn">','<input id="ero" value="1" type="radio" name="chocla" /><label for="ero">色情</label>','<input id="pol" value="2" type="radio" name="chocla" /><label for="pol">涉政</label>','<input id="adv" value="5" type="radio" name="chocla" /><label for="adv">广告</label>','<input id="dubo" value="6" type="radio" name="chocla" /><label for="dubo">赌博</label>',"<br>",'<input id="zhapian" value="7" type="radio" name="chocla" /><label for="zhapian">诈骗</label>','<input id="yanlungongji" value="8" type="radio" name="chocla" /><label for="yanlungongji">言论攻击</label>','<input id="oth" value="4" type="radio" name="chocla" /><label for="oth">其他</label>',"</p>",'<p>对部分内容(个人侵权、企业侵权等)的举报投诉，请拨打新浪网客服电话4000520066，转人工服务、索取《新浪网删帖申请文档》并提供相关证明材料。<br/><span style="color:red;">新浪网删帖不收取任何费用</span></p>',"<p><br></p>",'<p class="Brpt_RtInf"><b>如遇著作权问题，请点击链接：<a target="_blank" href="//control.blog.sina.com.cn/html/law.html">权利保护声明/Notice to Right Holders</a></b></p>',"</div>",'<p class="Brpt_othInt">您可以填写更多举例说明：</p>','<textarea id="#{reportReason}" class="Brpt_RtTxt"></textarea>',"</div>",'<div class="Brpt_RCBtn">','<a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a>','<a class="BRpt_btn" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>取消</span></a>','<div class="clearit"></div>',"</div>"].join(""),scope.reportBadTpl=['<div class="BRpt_Mtop" style="background:url(http://simg.sinajs.cn/blog7style/images/common/report/bg_top.gif) no-repeat left top;">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_exclt">','<p class="Brpt_extP1">您已经成功举报了该信息，工作人员会尽快处理。</p>','<p class="Brpt_extP2">再次感谢您对新浪博客的支持！</p>','<div class="Brpt_extBtn"><a class="BRpt_btn" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>',"</div>"].join(""),scope.reportSuccessTpl=['<div class="BRpt_Mtop" style="background:url(http://simg.sinajs.cn/blog7style/images/common/report/bg_top.gif) no-repeat left top;">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_extRst">','<p class="Brpt_eRTit">举报完成！感谢您对我们工作的支持，我们将在24小时内处理。</p>','<div class="Brpt_eRmtd">','<p class="tit">您还可以：</p>','<div class="conn">','<p class="mtd">','<input type="checkbox" id="#{cbCustom}"/>','<label for="#{cbCustom}">我是新浪博客用户，我要接收处理结果</label><span id="#{guestText}">(您还没有登录)</span>',"</p>","</div>",'<div class="conn2">','<p class="mtd"><input type="checkbox" id="#{cbOtherMethod}" /><label for="#{cbOtherMethod}">我要通过其他方式接收处理结果</label></p>','<div id="#{userForm}" style="display:none;">','<p class="perInf"><span>您的姓名：</span><input id="#{userName}" type="text" /></p>','<p class="perInf"><span>您的邮箱：</span><input id="#{userEmail}" type="text" /></p>','<p class="perInf"><span>您的电话：</span><input id="#{userTel}" type="text" /></p>',"</div>","</div>","</div>",'<div class="Brpt_eRBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>'].join(""),scope.reportFinishedTpl=['<div class="BRpt_Mtop" style="background:url(http://simg.sinajs.cn/blog7style/images/common/report/bg_top.gif) no-repeat left top;">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_thx">',"<p>再次感谢您对新浪博客举报的大力支持！</p>",'<div class="Brpt_thxBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>关闭</span></a></div>',"</div>"].join(""),scope.GeneralReport=Core.Class.create(),scope.GeneralReport.prototype={type:"",_hashType:{comment:{"class":"2",initFunction:null},blog:{"class":"1",initFunction:null},guestBook:{"class":"3",initFunction:null},friend:{"class":"4",initFunction:null},photoComment:{"class":"5",initFunction:null},paperlist:{"class":"6",initFunction:null}},dataInterface:null,canSubmit:!0,bodyID:"",reportUID:"",userNameInfo1:"",userNameInfo2:"",titleInfo:"",nickName:"",contentInfo:"",tUID:"",_isInitDialog:!1,_dialog:null,initialize:function(){this.dataInterface=new Interface("//control.blog.sina.com.cn/admin/advice/impeach_post_content.php?version=7","ijax"),this._hashType.comment.initFunction=this._commentInit,this._hashType.blog.initFunction=this._blogInit,this._hashType.guestBook.initFunction=this._guestBookInit,this._hashType.friend.initFunction=this._friendInit,this._hashType.photoComment.initFunction=this._photoCommentInit,this._hashType.paperlist.initFunction=this._paperlistInit},show:function(){!this._isInitDialog&&this._initDialog(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle(),this._dialog.show(),this._isInitDialog=!0,this._hashType[this.type].initFunction.call(this)},hidden:function(){this._dialog.hidden()},clear:function(){var nd=this._dialog.nodes;nd.resumeInfo.innerHTML="",nd.resumeContent.value="",nd.cbBlogHost.checked=!1,Utils.Form.Radio.set($N("chocla"),""),nd.reportReason.value=""},submit:function(){var me=this;"comment"!==this.type?this.dataInterface.request({POST:{body_id:me.bodyID,"class":me._hashType[me.type]["class"],type:Utils.Form.Radio.get($N("chocla")),fnickname:me.nickName,fuid:me.reportUID,tuid:me.tUID,reason:me._dialog.nodes.reportReason.value,is_report:me._dialog.nodes.cbBlogHost.checked},onSuccess:function(data){me.canSubmit=!0,me.onSuccessed(data)},onError:function(err){me.canSubmit=!0,me.onError(err)},onFail:function(){me.canSubmit=!0}}):Utils.Io.Ijax2.request("//comment5.news.sina.com.cn/cmnt/submit",{POST:{channel:"feedback",newsid:"2",content:"channel=blog&newsid="+/[^_]*/.exec(me.bodyID)[0]+"&mid="+/_(.*)/.exec(me.bodyID)[1]+"&type="+Utils.Form.Radio.get($N("chocla"))+"&fnickname="+me.nickName+"&body_id="+me.bodyID+"&fuid="+me.reportUID+"&tuid="+me.tUID+"&is_report="+me._dialog.nodes.cbBlogHost.checked+"&content="+me._dialog.nodes.reportReason.value,usertype:"blogpc",ie:"utf-8",oe:"utf-8"},returnType:"json",onComplete:function(_data){if(me.canSubmit=!0,"1005"==_data.result.filter_code)return me.hidden(),void CommentV2.needAuthTrueName(_data.result.filter_code);0===_data.result.status.code?me.onSuccessed():me.onError()},onException:function(){me.canSubmit=!0,me.onError()}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportStartTpl});var me=this,nd=this._dialog.nodes;Core.Events.addEvent(nd.btnOk,(function(){me.canSubmit&&(me.canSubmit=!1,me.submit())}),"click"),Core.Events.addEvent(nd.btnCancel,(function(){me._dialog.hidden(),me.clear()}),"click"),Core.Events.addEvent(nd.btnClose,(function(){me.clear()}),"click"),Utils.Form.limitMaxLen(nd.reportReason,400)},_commentInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在博文"+this.titleInfo+"中发表的评论，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_blogInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"发表的"+this.titleInfo+"，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_guestBookInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在"+this.userNameInfo2+"博客的留言，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_friendInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"给您发的好友申请，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!0},_photoCommentInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"在图片"+this.titleInfo+"中发表的评论，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},_paperlistInit:function(){this._dialog.nodes.resumeInfo.innerHTML="您要举报的是"+this.userNameInfo1+"给您发送的纸条，摘要如下：",this._dialog.nodes.resumeContent.value=this.contentInfo,this._dialog.nodes.cbBlogHost.checked=!1},onSuccessed:function(data){},onError:function(err){}},Utils.Form.inputListen=function(el,nLen,oOption){if(el=$E(el),void 0!==nLen&&(nLen=isNaN(nLen)?null:1*nLen),null==el||null==nLen||1!=el.nodeType)return!1;var limitRe=(oOption=oOption||{}).limitRe,doubleByte=oOption.doubleByte;doubleByte=null==doubleByte||doubleByte;var userinput=function(){try{var evt=Core.Events.getEvent();if(evt){var keyCode=evt.which||evt.keyCode;if(37==keyCode||39==keyCode)return!1}}catch(e){}for(var nLength=el.max;null!=limitRe&&limitRe.test(el.value);)el.value=el.value.replace(limitRe,"");if(1==doubleByte)if(Core.String.byteLength(el.value)>nLength){for(var str=el.value.substr(0,nLength);Core.String.byteLength(str)>nLength;)str=str.replace(/.$/,"");el.value=str,el.maxLength=str.length}else el.maxLength=nLength-el.value.replace(/[\x00-\xff]/g,"").length;else el.maxLength=nLength;nLength<el.value&&(el.value=el.value.substr(0,nLength))};el.max=nLen,el.maxLength=nLen,userinput(),null==el.beWatched&&(el.beWatched=!0,$IE?(Core.Events.addEvent(el,userinput,"keyup"),Core.Events.addEvent(el,userinput,"keypress"),Core.Events.addEvent(el,userinput,"mouseout")):Core.Events.addEvent(el,userinput,"input"),Core.Events.addEvent(el,(function(){null!=limitRe&&limitRe.test(el.value)&&(el.value=el.value.replace(limitRe,""))}),"blur"))},scope.SuccessedReport=Core.Class.create(),scope.SuccessedReport.prototype={loginUI:null,_isInitDialog:!1,canSubmit:!0,dataInterface:null,dataID:"",bodyID:"",userInfo:{nickName:""},initialize:function(){this.dataInterface=new Interface("//control.blog.sina.com.cn/admin/advice/impeach_post_userinfo.php?version=7","ijax"),this.loginUI=new Lib.Login.Ui},show:function(){!this._isInitDialog&&this._initDialog(),this._dialog.setAreaLocked(!0),this._dialog.setMiddle(),this._dialog.show(),this._isInitDialog=!0},displayUserInfo:function(state){this._dialog.nodes.userForm.style.display=!1===state?"none":""},login:function(){var me=this;this.loginUI.login((function(){me.submit()}))},clear:function(){var nd=this._dialog.nodes;nd.cbCustom.checked=!1,nd.cbOtherMethod.checked=!1,nd.userForm.style.display="none",nd.userName.value="",nd.userEmail.value="",nd.userTel.value=""},hidden:function(){this._dialog.hidden()},submit:function(){var me=this,nd=this._dialog.nodes;Lib.checkAuthor((function(){me.canSubmit=!1,me.dataInterface.request({POST:{id:me.dataID,body_id:me.bodyID,nickname:"undefined"==typeof $nick?"":$nick,name:nd.userName.value,email:nd.userEmail.value,phone:nd.userTel.value,uid:$UID,is_login:nd.cbCustom.checked?"1":"0"},onSuccess:function(data){me.canSubmit=!0,me.onSuccessed(data)},onError:function(err){me.canSubmit=!0,me.onError(err)},onFail:function(){me.canSubmit=!0}})}),"SuccessedReport"+(new Date).getTime())},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportSuccessTpl});var me=this,nd=this._dialog.nodes;this._dialog.addEventListener("hidden",(function(){me.clear()})),Lib.checkAuthor((function(){nd.guestText.style.display=$isLogin?"none":""}),"SuccessedReport"+(new Date).getTime()),Core.Events.addEvent(nd.btnOk,(function(){me.canSubmit&&Lib.checkAuthor((function(){!$isLogin&&nd.cbCustom.checked?me.login():me.submit()}),"SuccessedReport"+(new Date).getTime())}),"click"),Core.Events.addEvent(nd.cbOtherMethod,(function(){me.displayUserInfo(nd.cbOtherMethod.checked)}),"click"),Utils.Form.inputListen(nd.userName,100),Utils.Form.inputListen(nd.userEmail,200),Utils.Form.inputListen(nd.userTel,100)},onSuccessed:function(data){},onError:function(err){}},$SYSMSG.extend({B04102:"您输入的电子邮件格式错误，请重新输入",B04105:"很抱歉，您输入的内容过多，请删减后重新提交",B04107:"您要举报的内容已经不存在，感谢您的支持",B04108:"举报分类错误",B04109:"您还没有选择举报类别，请选择后继续操作",B04110:"您的昵称为空，请输入后继续操作",B04111:"系统繁忙，请稍后再试",B04112:"您已经举报过该用户，再次感谢您的支持",B04113:"系统繁忙，请稍后再试",B04114:"系统繁忙，请稍后再试",B04115:"系统繁忙，请稍后再试",B04116:"系统繁忙，请稍后再试"}),Lib.BlogReport=Core.Class.create(),Lib.BlogReport.prototype={generalReport:null,successedReport:null,badReport:null,finishedReport:null,isBRInit:!1,isFRInit:!1,initialize:function(){this.generalReport=new scope.GeneralReport,this.successedReport=new scope.SuccessedReport},start:function(type,nickName,bodyID,reportUID,userNameInfo1,userNameInfo2,titleInfo,contentInfo,tUID){var me=this,gr=this.generalReport;contentInfo=Core.String.decodeHTML(contentInfo),gr.nickName=nickName,gr.type=type,gr.reportUID=reportUID,gr.userNameInfo1=userNameInfo1,gr.userNameInfo2=userNameInfo2,gr.titleInfo=titleInfo,gr.contentInfo=Core.String.byteLength(contentInfo)>800?Core.String.shorten(contentInfo,800):contentInfo,gr.bodyID=bodyID,gr.tUID=tUID||"",gr.onSuccessed=function(data){if("comment"===gr.type)return this.hidden(),void me.finished();me.reportSuccess(nickName,bodyID,data.dataID),this.hidden()},gr.onError=function(err){"B04112"===err.code?(me.showBad(),this.hidden()):winDialog.alert($SYSMSG[err.code])},gr.show()},showBad:function(){var me=this;this.isBRInit||(this.badReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportBadTpl}),Core.Events.addEvent(this.badReport.nodes.btnOk,(function(){me.badReport.hidden()}),"click")),this.badReport.setAreaLocked(!0),this.badReport.setMiddle(),this.badReport.show()},reportSuccess:function(nickName,bodyID,dataID){var me=this,sr=this.successedReport;sr.bodyID=bodyID,sr.dataID=dataID,sr.userInfo.nickName=nickName,sr.onSuccessed=function(data){me.finished(),this.hidden()},sr.onError=function(err){winDialog.alert($SYSMSG[err.code])},sr.show()},finished:function(){var me=this;this.isFRInit||(this.finishedReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportFinishedTpl}),Core.Events.addEvent(this.finishedReport.nodes.btnCancel,(function(){me.finishedReport.hidden()}),"click")),this.finishedReport.setAreaLocked(!0),this.finishedReport.setMiddle(),this.finishedReport.show()}},CommentV2.decodeContent=function(str,type){try{str=decodeURIComponent(str)}catch(e){}var imgPath="//www.sinaimg.cn/uc/myshow/blog/misc/gif/";"god"==type&&(imgPath="//simg.sinajs.cn/blog7style/images/common/godreply/");var _userContent=str.replace(/\r\n|\n/gi,"###line-return###").replace(/\\n/g,"###line-return###"),_html='<img src="'+imgPath+'$1T.gif" style="margin:1px;" border="0" title="$2" />',_magichtml='<img src="'+imgPath+'$1T.gif" style="margin:1px;" border="0" title="$3" width="50" height="50"/>';return _userContent=(_userContent=(_userContent=(_userContent=Core.String.encodeHTML(_userContent)).replace(/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,_html)).replace(/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi,_magichtml)).replace(/###line-return###/gi,"<br/>")},CommentV2.Report=function(){this.BR=new Lib.BlogReport}.$define({commentReport:function(data){trace("CommentV2.Report.commentReport");var param={cms_id:data.commentid,uid:data.src_uid,decode:CommentV2.decodeContent};this.setReport(data,param)},showError:function(){winDialog.alert($SYSMSG.A00001,{icon:"01"})},replyReport:function(data){trace("CommentV2.Report.replyReport");var param={cms_id:data.id,uid:data.source_uid,decode:CommentV2.decodeReplyContent};this.setReport(data,param)},setReport:function(data,param){var __this=this,bID=scope.$articleid,bodyID=bID+"_"+param.cms_id,nickName=data.uname,reportUID=param.cms_id,userNameInfo1="",titleInfo='<a target="_blank" href="//blog.sina.com.cn/s/blog_'+bID+'.html">'+$E("t_"+bID).innerHTML+"</a>";data.ulink=data.ulink?data.ulink:"//blog.sina.com.cn/u/"+data.comm_uid,userNameInfo1=0!=data.comm_uid?'<a href="'+data.ulink+'" target="_blank">'+nickName+"</a>":"<strong>"+nickName+"</strong>",Utils.Io.JsLoad.request("//comment5.news.sina.com.cn/cmnt/info",{GET:{channel:"blog",newsid:data.articleid,mid:param.cms_id,_:(new Date).getTime(),callback:"reportComment",varname:"reportComment",ie:"utf-8",oe:"utf-8"},returnType:"jsonp",onComplete:function(_data){if(_data.result&&_data.result.status&&4==_data.result.status.code)setTimeout(function(){__this.setReport(data,param)}.bind2(this),1e3);else{if(0!==_data.result.status.code)return void this.showError();var contentInfo=param.decode(_data.result.cmntlist[param.cms_id].content);__this.BR.start("comment",nickName,bodyID,reportUID,userNameInfo1,"举报",titleInfo,contentInfo)}}.bind2(this),onException:function(){this.showError()}.bind2(this)})}}),CommentV2.Share=function(){trace("CommentV2.Share"),this.shorten=Core.String.shorten,this.getInterface=new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php","jsload"),this.getWeiboNameInterface=new Interface("//i2.api.weibo.com/2/users/show.json","jsload")}.$define({commentShare:function(data){this.data=data||{},this.__commentShare()},replyShare:function(data){this.data=data||{},this.type="reply";var cms_id=this.data.id;this.__getCmsBody(cms_id,$UID,data.articleid)},__getCmsBody:function(cms_id,uid,articleid){var param={cms_id:cms_id,uid:uid,origin:1,article_id:articleid};this.getInterface.request({GET:param,onSuccess:this.__getWeiboName.bind2(this),onError:function(_data){},onFail:function(){}})},__getWeiboName:function(result){var __this=this;this.body=result.cms_body,this.uid=result.uid,this.src_title=result.src_title,window.jsonpweiboname=function(res){1==res.code&&res.data?__this.name=encodeURIComponent("@"+res.data.name):__this.name=encodeURIComponent(" "+__this.data.uname)||"",__this.__share()};var param={uid:this.uid,source:"1617465124",callback:"jsonpweiboname"};this.getWeiboNameInterface.request({GET:param,onSuccess:function(){},onError:function(){},onFail:function(){}})},__share:function(){var body=this.body;if("comment"===this.type)if("blog"===this.data.fromProduct){body=(body=body.replace(/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,"[$2]")).replace(/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi,"[$3]")}else{body=body.replace(/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/gi,"[$1]")}body=encodeURIComponent(this.shorten(body,100));encodeURIComponent(location.href);var blogTitle=encodeURIComponent(this.src_title)||encodeURIComponent($E("t_"+scope.$articleid).innerHTML),content="分享"+this.name+" 对博文【"+blogTitle+"】的评论："+body+" 查看原文：",u="//v.t.sina.com.cn/share/share.php?searchPic=false&title="+encodeURIComponent(content)+"&url="+encodeURIComponent(document.location)+"&source=新浪-博客&sourceUrl="+encodeURIComponent("//blog.sina.com.cn")+"&content=utf-8&appkey=1617465124";window.open(u,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)},__commentShare:function(){var title=$E("t_"+scope.$articleid).innerHTML;title=title.replace(/\&nbsp\;/g," ");var body,name,bodyNode=$E("body_cmt_"+this.data.commentid);if(body="string"==typeof bodyNode.innerText?bodyNode.innerText:bodyNode.textContent,"blog"===this.data.fromProduct){body=(body=body.replace(/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,"[$2]")).replace(/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi,"[$3]"),name=" "+this.data.uname}else{body=body.replace(/<img\s[\S]*\salt=[\]["][^-]*[-]?([\S]*)[\]["]\s?[\][/]>/gi,"[$1]"),name="@"+this.data.uname}body=this.shorten(body,100),title=this.shorten(title,60);var u="//v.t.sina.com.cn/share/share.php?searchPic=false&title="+encodeURIComponent("分享"+name+" 对博文【"+title+"】的评论："+body+" 查看原文：")+"&url="+encodeURIComponent(document.location)+"&source=新浪-博客&sourceUrl="+encodeURIComponent("//blog.sina.com.cn")+"&content=utf-8&appkey=1617465124";window.open(u,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}}),CommentV2.ReplyList=function(opt){this.type="reply",this.cmtAdd=new CommentV2.Add({type:this.type,url:"//control.blog.sina.com.cn/admin/comment_new/cms_usereply_post.php?domain=2",tpl:opt.replyTpl||""}),this.ownerNickName=opt.data.ownerNickName||"",this.cmtDel=new CommentV2.Delete,this.cmtReport=new CommentV2.Report,this.cmtShare=new CommentV2.Share,this._openAreas={}}.$extends(CommentV2.List).$define({load:function(page){var __this=this;this.initContainerAndTextArea(),this.show(),0!=this.data.cms_reply_num&&(this.showLoading(),setTimeout((function(){__this.renderList(__this.subReplyList)}),300))},render:function(result){this.renderList(result)},initContainerAndTextArea:function(argument){if(!this.containerIsReady){var str='<div class="SG_reply_con borderc"><div class="bd"><div id="comment_'+this.data.commentid+'_textarea"></div><div class="reply_list"><ul id="comment_'+this.data.commentid+'_replylist" style="display:none;"></ul></div><div class="rp2" id="loading_'+this.data.commentid+'" style="display:none"><div class="SG_reply_con"><div class="bd"><div class="loading"><span class="ico_loading"></span><p>正在加载，请稍后...</p></div></div></div></div><div class="SG_page" style="display:none;"><ul class="SG_pages" id="comment_'+this.data.commentid+'_pages"></ul></div></div></div>';this.containerNode.innerHTML=str,this.renderTextArea(),this.containerIsReady=1}},renderTextArea:function(){var commentArea=new CommentV2.CommentArea({container:$E("comment_"+this.data.commentid+"_textarea")}),item=this.data,ownernickEl=$E("ownernick");ownernickEl&&this.trim(ownernickEl.innerHTML);commentArea.setReplyData(this,{stair_cms_id:item.id,id:item.id,articleid:item.articleid,source_id:item.id,blog_title:$E("t_"+item.articleid)?this.trim($E("t_"+item.articleid).innerHTML):"",comm_uid:item.comm_uid,uname:item.uname,is_t:0})},renderList:function(resultData){var li,oFragment=document.createDocumentFragment();this.hideLoading();for(var len=resultData.length,i=0;i<len;i++){var item=resultData[i];item.action_data=this.obj2str({stair_cms_id:item.stair_cms_id,id:item.id,fromProduct:item.fromProduct,articleid:item.articleid,source_id:item.source_id,source_uid:item.source_uid,source_uname:item.source_uname,source_ria_index_url:item.source_ria_index_url,comm_uid:item.comm_uid,uname:item.uname,user_image:item.user_image,ria_index_url:item.ria_index_url,cms_pubdate:item.cms_pubdate}),li=this.cmtAdd.render(item,i,len),oFragment.appendChild(li)}$E("comment_"+this.data.commentid+"_replylist").appendChild(oFragment),$E("comment_"+this.data.commentid+"_replylist").style.display="",location.hash="cmt_"+this.data.commentid},show:function(){CommentV2.ReplyList.$super.show.call(this),v7sendLog("32_01_01");var strHtml=this.node.innerHTML;strHtml=strHtml.replace(/回复|取消回复/,"取消回复"),this.node.innerHTML=strHtml},hide:function(){CommentV2.ReplyList.$super.hide.call(this),v7sendLog("32_01_02");var strHtml=this.node.innerHTML;strHtml=strHtml.replace("取消",""),this.node.innerHTML=strHtml},showLoading:function(){$E("comment_"+this.data.commentid+"_replylist").innerHTML="",$E("loading_"+this.data.commentid).style.display=""},hideLoading:function(){$E("loading_"+this.data.commentid).style.display="none"},paging:function(){var __this=this,paging=$E("comment_"+this.data.commentid+"_pages");if(paging){var pages=0;pages=this.total%20==0?Math.ceil(this.total/20):Math.floor(this.total/20)+1,this.total>20?(paging.parentNode.style.display="block",paging.style.display="block",Ui.Pagination.init({pageNode:"comment_"+__this.data.commentid+"_pages",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:pages,pageTpl:function(page){__this.load(page),location.hash=""}}).show()):paging.parentNode.style.display="none"}},setSrcComment:function(id,uid,commentArea){Utils.Io.JsLoad.request("//comment5.news.sina.com.cn/cmnt/info",{returnType:"jsonp",GET:{channel:"blog",newsid:scope.$articleid,mid:id,ie:"utf-8",oe:"utf-8",callback:"getSingleCnmt",_:(new Date).getTime()},onComplete:function(data){if(data.result&&data.result.status&&4==data.result.status.status)setTimeout(function(){this.setSrcComment(id,uid,commentArea)}.bind2(this),1e3);else{var cnmtInfo=data.result.cmntlist[id],cms_body=cnmtInfo.content,configInfo=CommentV2.getConfigInfo(cnmtInfo.config),nick_name=scope.$loginNick||scope.nickname||$UID,source_uname=configInfo.wb_screen_name||cnmtInfo.nick;if(configInfo.wb_user_id===$UID&&Lib.Uic.getNickName([$UID],(function(data){source_uname=data[$UID]})),cms_body){var comment="//@"+nick_name+" 回复 @"+source_uname+" :"+cms_body;commentArea.setValues({comment:comment})}}}.bind2(this),onException:function(){}.bind2(this)})},reply:function(opt){if(opt.containerNode.isInited){var replyCon=$E("reply_"+opt.data.id+"_textcon");"none"==replyCon.style.display?(v7sendLog("32_01_05"),replyCon.style.display="",""==this._openAreas[opt.data.id].getValue()&&this.setSrcComment(opt.data.id,opt.data.src_uid,this._openAreas[opt.data.id]),opt.node.innerHTML="<cite>取消回复</cite>"):(replyCon.style.display="none",opt.node.innerHTML="<cite>回复</cite>")}else{v7sendLog("32_01_05"),opt.node.innerHTML="<cite>取消回复</cite>";var str='<div class="SG_reply_con"><div class="bd" id="reply_'+opt.data.id+'_textarea"></div></div>',div=document.createElement("div");div.className="SG_reply borderc rp2",div.innerHTML=str,div.id="reply_"+opt.data.id+"_textcon",opt.containerNode.appendChild(div),opt.containerNode.isInited=!0;var replyArea=$E("reply_"+opt.data.id+"_textarea"),item=opt.data;this._openAreas[opt.data.id]=new CommentV2.CommentArea({container:replyArea,autolineheight:"yes",sid:(new Date).getTime(),shownum:"no",okhandler:function(){var replyCon=$E("reply_"+opt.data.id+"_textcon");replyCon&&(replyCon.style.display="none",opt.node.innerHTML="<cite>回复</cite>")}}),this._openAreas[opt.data.id].setReplyData(this,{id:opt.data.id,articleid:opt.data.articleid,source_id:opt.data.source_id,source_uid:opt.data.source_uid,source_uname:opt.data.source_uname,source_ria_index_url:opt.data.source_ria_index_url,stair_cms_id:opt.data.stair_cms_id,blog_title:$E("t_"+opt.articleid).innerHTML,comm_uid:opt.data.comm_uid,uname:opt.data.uname,is_t:0}),this.setSrcComment(item.id,item.src_uid,this._openAreas[opt.data.id])}},add:function(data,sucFn,errFn){trace("CommentV2.ReplyList.add"),trace(data),this.cmtAdd.post(data,function(){Lib.Listener.notify("update-total-num",{type:"add",num:1}),this.total++;var str=this.node.innerHTML;this.node.innerHTML=str.replace(/(\d+)/,this.total);str=$E("c_"+this.articleid).innerHTML;var num=parseInt(/(\d+)/.exec(str)[0],10);num++,$E("c_"+this.articleid).innerHTML="("+num+")",sucFn()}.bind2(this),errFn)},share:function(opt){trace("CommentV2.ReplyList.share"),v7sendLog("32_01_06"),this.cmtShare.replyShare(opt.data)},del:function(opt){trace("CommentV2.ReplyList.del"),v7sendLog("32_01_08"),this.cmtDel.deleteReply(opt,this.delSucc.bind2(this))},delSucc:function(res){this.total=this.total--?this.total:0,Lib.Listener.notify({type:"reduce",num:1});var str=this.node.innerHTML;this.node.innerHTML=str.replace(/(\d+)/,this.total);str=$E("c_"+this.articleid).innerHTML;var num=parseInt(/(\d+)/.exec(str)[0],10);num=num--?num:0,$E("c_"+this.articleid).innerHTML="("+num+")",0==this.total&&($E("comment_"+this.data.stair_cms_id+"_replylist").style.display="none")},report:function(opt){trace("CommentV2.ReplyList.report"),v7sendLog("32_01_07"),this.cmtReport.replyReport(opt.data)}}),CommentV2.CommentList=function(opt){this.ownerNickName="",this.type="comment",this.defaultAnchor="#comment",this.replyList={},this.replyCache={},this.addEvent=Core.Events.addEvent,this.removeEvent=Core.Events.removeEvent,this.anchorEnAble=!1,this.cmtAdd=new CommentV2.Add({type:this.type,tpl:opt.commentTpl||""}),this.cmtDel=new CommentV2.Delete,this.cmtReport=new CommentV2.Report,this.cmtShare=new CommentV2.Share,this.bindEvent(),this.initPageNew()}.$extends(CommentV2.List).$define({load:function(page){this.replyList={};var __this=this;this.page=page,$UID?Lib.Uic.getNickName([$UID],(function(data){__this.loginBlogName=data[$UID],Lib.Uic.getUserPic($UID,(function(picInfo){__this.loginBlogPic=picInfo.s})),__this.fetchData()})):__this.fetchData()},fetchData:function(){var __this=this;Utils.Io.JsLoad.request(__this.url,{returnType:"jsonp",GET:{callback:"getCmntList",_:(new Date).getTime(),page:__this.page,page_size:50,oe:"utf-8",score:0,fake:1,thread:1,list:"asc",t_size:1e3},onComplete:function(result){console.log("##",result),result.result&&result.result.status&&4==result.result.status.code?(console.log("### try again"),setTimeout((function(){__this.fetchData()}),1e3)):__this.render.bind2(__this)(result)},onException:function(){this.error("B36110")}.bind2(this)})},updateTotalNum:function(data){switch(data.type){case"add":this.total+=data.num-0;break;case"reduce":this.total-=data.num-0,this.total<0&&(this.total=0)}},render:function(result){var _this=this;result=result.result,Lib.checkAuthor((function(){if(1==_this.page&&(_this.containerNode.innerHTML=""),0==result.status.code){var li,item,_renderItem,_tmp,oFragment=document.createDocumentFragment();_this.total=result.count.show,0==_this.total&&_this.renderNoComment();for(var i=0,len=result.cmntlist.length;i<len;i++){_renderItem={},_tmp={},item=result.cmntlist[i];var _selfInfo=CommentV2.getConfigInfo(item.config);_tmp={id:item.mid,commentid:item.mid,articleid:item.newsid,cms_body:item.content,fromProduct:item.channel||"blog",comm_uid:item.uid,uname:item.uid===$UID?_this.loginBlogName:_selfInfo.wb_screen_name||item.nick||"用户"+item.uid,src_uid:scope.$uid,cms_pubdate:item.time,ria_index_url:"blog"===item.channel?"//blog.sina.com.cn/u/"+item.uid:"//weibo.com/u/"+item.uid,user_image:"//portrait3.sinaimg.cn/"+item.uid+"/blog/50",source_ria_index_url:"//blog.sina.com.cn/u/"+item.uid},result.threaddict[item.mid]?(_this.replyCache[item.mid]=_this.reInitSubList(item,result.threaddict[item.mid].list),_tmp.cms_reply_num=result.threaddict[item.mid].count):_tmp.cms_reply_num=0,(_renderItem=_tmp).action_data=_this.obj2str(_tmp),li=_this.cmtAdd.render(_renderItem,i),oFragment.appendChild(li)}_this.containerNode.appendChild(oFragment),_this.pagingMore(result.cmntlist.length),_this.anchorEnAble||(_this.anchorEnAble=!0),_this.sendEvents(result)}else _this.error($isAdmin?"B36021":"B36020")}),"CommentList"+(new Date).getTime())},findParent:function(mid,rootParent,list){if(mid===rootParent.mid)return rootParent;for(var i=0;i<list.length;i++)if(mid===list[i].mid)return list[i]},reInitSubList:function(parent,subList){for(var list=[],i=0;i<subList.length;i++){var item=subList[i],configInfo=CommentV2.getConfigInfo(item.config),_item={stair_cms_id:parent.mid,id:item.mid,cms_body:item.content,fromProduct:item.channel||"blog",articleid:item.newsid,source_id:item.parent,source_uid:item.parent_uid,source_uname:item.parent_uid===$UID?this.loginBlogName:configInfo.p_nick||item.parent_nick||"用户"+item.parent_uid,source_ria_index_url:"//blog.sina.com.cn/u/"+item.parent_uid,comm_uid:item.uid,uname:item.uid===$UID?this.loginBlogName:configInfo.wb_screen_name||item.nick||"用户"+item.uid,user_image:item.uid===$UID?this.loginBlogPic:configInfo.wb_profile_img||item.profile_img,ria_index_url:"//blog.sina.com.cn/u/"+item.uid,cms_pubdate:item.time};list.push(_item)}return list},sendEvents:function(data){Lib.Listener.notify("commentlist-isready",data),scope.$commentlistIsReady=1},dictCnmt:function(list,item){for(var pushFlag=!0,i=0;i<list.length;i++){if(list[i].id===item.id){pushFlag=!1;break}}pushFlag&&list.push(item)},renderNoComment:function(){this.containerNode.innerHTML='<li><div class="noCommdate"><span class="SG_txtb">做第一个评论者吧！ <img class="SG_icon SG_icon134" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="" align="absmiddle"><a href="#post">抢沙发&gt;&gt;</a></span></div></li>'},add:function(data){data.item;(0,data.fun)(this.cmtAdd.render(data.item))},reloadCnmtList:function(){this.load(1),winDialog.alert("发帖成功",{icon:"03"})},del:function(opt){trace("CommentV2.CommentList.del"),this.cmtDel.deleteComment(opt,this.delSucc.bind2(this))},delSucc:function(res){this.total=this.total-res.cms_reply_num-1,this.total=this.total<=0?0:this.total;var str=$E("c_"+scope.$articleid).innerHTML,num=parseInt(/(\d+)/.exec(str)[0],10);num=num-res.cms_reply_num-1?num-res.cms_reply_num-1:0,$E("c_"+scope.$articleid).innerHTML="("+num+")",0==this.total?this.renderNoComment():0==this.containerNode.getElementsByTagName("li").length&&(this.page--,this.load(this.page))},reply:function(opt){trace("CommentV2.CommentList.reply");var that=this,subReplyList=this.replyCache[opt.data.id];subReplyList=subReplyList||[],Lib.Uic.getNickName([scope.$uid],(function(data){that.ownerNickName=data[scope.$uid]||"",opt.replyTpl=that.replyTpl||"",opt.data.ownerNickName=that.ownerNickName,opt.subReplyList=subReplyList,opt.total=opt.data.cms_reply_num,opt.data.stair_cms_id=opt.data.id;var id=opt.data.id;that.replyList[id]?that.replyList[id].toggle():that.replyList[id]=new CommentV2.ReplyList(opt)}))},report:function(opt){trace("CommentV2.CommentList.report"),this.cmtReport.commentReport(opt.data)},share:function(opt){trace("CommentV2.CommentList.share"),this.cmtShare.commentShare(opt.data)},more:function(opt){trace("CommentV2.CommentList.more");var id=opt.data.commentid,partCmsNode=$E("body_cmt_"+id),fullCmsNode=$E("body_cmt_full_"+id);"btn_artzk"==opt.node.className?(v7sendLog("32_01_03"),partCmsNode&&(partCmsNode.style.display="none"),fullCmsNode&&(fullCmsNode.style.display="")):"btn_artsq"==opt.node.className&&(v7sendLog("32_01_04"),partCmsNode&&(partCmsNode.style.display=""),fullCmsNode&&(fullCmsNode.style.display="none"))},initPageNew:function(){var paging=$E("commentPaging");paging.style.display="none",paging.style.textAlign="center",paging.innerHTML='<a href="javascript:void(0);" style="">点击加载更多</a>',this.addEvent(paging.children[0],function(){this.load(this.page+1)}.bind2(this),"click")},pagingMore:function(len){var paging=$E("commentPaging");len>=50?(paging.parentNode.style.display="block",paging.style.display="block"):(paging.parentNode.style.display="none",paging.style.display="none")},paging:function(){var __this=this,paging=$E("commentPaging");if(paging){var pages=0;pages=this.total%50==0?Math.ceil(this.total/50):Math.floor(this.total/50)+1,this.total>50?(paging.parentNode.style.display="block",$E("commentPaging").style.display="block",Ui.Pagination.init({pageNode:"commentPaging",nodeClassNamePrefix:"SG",curPage:this.page,maxPage:pages,pageTpl:function(page){__this.load(page)}}).show(),paging.onclick=this.sudaClick):paging.parentNode.style.display="none"}},sudaClick:function(event){var target=event&&event.target||window.event&&window.event.srcElement;target&&target.tagName&&"a"==target.tagName.toLowerCase()&&Lib.sendSuda((function(){try{SUDA.log("","blog_blogcomment_page")}catch(e){}}))},anchor:function(posId){var url=window.location.href;this.anchorEnAble&&(window.location.href=url.replace(location.hash,"")+"#"+posId)},showError:function(result){winDialog.alert($SYSMSG[code],{icon:"02"})}}),Sina.pkg("Utils.Flash"),void 0===deconcept)var deconcept=new Object;"undefined"==typeof deconcept.util&&(deconcept.util=new Object),"undefined"==typeof deconcept.SWFObjectUtil&&(deconcept.SWFObjectUtil=new Object),deconcept.SWFObject=function(swf,id,w,h,ver,c,quality,xiRedirectUrl,redirectUrl,detectKey){if(document.getElementById){this.DETECT_KEY=detectKey||"detectflash",this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY),this.params=new Object,this.variables=new Object,this.attributes=new Array,swf&&this.setAttribute("swf",swf),id&&this.setAttribute("id",id),w&&this.setAttribute("width",w),h&&this.setAttribute("height",h),ver&&this.setAttribute("version",new deconcept.PlayerVersion(ver.toString().split("."))),this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion(),!window.opera&&document.all&&this.installedVer.major>7&&(deconcept.SWFObject.doPrepUnload=!0),c&&this.addParam("bgcolor",c);var q=quality||"high";this.addParam("quality",q),this.setAttribute("useExpressInstall",!1),this.setAttribute("doExpressInstall",!1);var xir=xiRedirectUrl||window.location;this.setAttribute("xiRedirectUrl",xir),this.setAttribute("redirectUrl",""),redirectUrl&&this.setAttribute("redirectUrl",redirectUrl)}},deconcept.SWFObject.prototype={useExpressInstall:function(path){this.xiSWFPath=path||"expressinstall.swf",this.setAttribute("useExpressInstall",!0)},setAttribute:function(name,value){this.attributes[name]=value},getAttribute:function(name){return this.attributes[name]},addParam:function(name,value){this.params[name]=value},getParams:function(){return this.params},addVariable:function(name,value){this.variables[name]=value},getVariable:function(name){return this.variables[name]},getVariables:function(){return this.variables},getVariablePairs:function(){var key,variablePairs=new Array,variables=this.getVariables();for(key in variables)variablePairs[variablePairs.length]=key+"="+variables[key];return variablePairs},getSWFHTML:function(){var swfNode="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","PlugIn"),this.setAttribute("swf",this.xiSWFPath)),swfNode='<embed pluginspage="//www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"',swfNode+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var params=this.getParams();for(var key in params)swfNode+=[key]+'="'+params[key]+'" ';(pairs=this.getVariablePairs().join("&")).length>0&&(swfNode+="flashvars="+pairs+'&realfull=1&moz=1"'),swfNode+="/>"}else{this.getAttribute("doExpressInstall")&&(this.addVariable("MMplayerType","ActiveX"),this.setAttribute("swf",this.xiSWFPath)),swfNode='<object id="'+this.getAttribute("id")+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">',swfNode+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var pairs;params=this.getParams();for(var key in params)swfNode+='<param name="'+key+'" value="'+params[key]+'" />';(pairs=this.getVariablePairs().join("&")).length>0&&(swfNode+='<param name="flashvars" value="'+pairs+'" />'),swfNode+="</object>"}return swfNode},write:function(elementId){if(this.getAttribute("useExpressInstall")){var expressInstallReqVer=new deconcept.PlayerVersion([6,0,65]);this.installedVer.versionIsValid(expressInstallReqVer)&&!this.installedVer.versionIsValid(this.getAttribute("version"))&&(this.setAttribute("doExpressInstall",!0),this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl"))),document.title=document.title.slice(0,47)+" - Flash Player Installation",this.addVariable("MMdoctitle",document.title))}this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))||""!=this.getAttribute("redirectUrl")&&document.location.replace(this.getAttribute("redirectUrl"));var n="string"==typeof elementId?document.getElementById(elementId):elementId,oldTitle=document.title;return n.innerHTML=this.getSWFHTML(),oldTitle!==document.title&&(document.title=oldTitle),!0}},deconcept.SWFObjectUtil.getPlayerVersion=function(){var PlayerVersion=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];x&&x.description&&(PlayerVersion=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0)for(var axo=1,counter=3;axo;)try{counter++,axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+counter),PlayerVersion=new deconcept.PlayerVersion([counter,0,0])}catch(e){axo=null}else{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");PlayerVersion=new deconcept.PlayerVersion([6,0,21]),axo.AllowScriptAccess="always"}catch(e){if(6==PlayerVersion.major)return PlayerVersion}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}null!=axo&&(PlayerVersion=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(",")))}return PlayerVersion},deconcept.PlayerVersion=function(arrVersion){this.major=null!=arrVersion[0]?parseInt(arrVersion[0]):0,this.minor=null!=arrVersion[1]?parseInt(arrVersion[1]):0,this.rev=null!=arrVersion[2]?parseInt(arrVersion[2]):0},deconcept.PlayerVersion.prototype.versionIsValid=function(fv){return!(this.major<fv.major)&&(this.major>fv.major||!(this.minor<fv.minor)&&(this.minor>fv.minor||!(this.rev<fv.rev)))},deconcept.util={getRequestParameter:function(param){var q=document.location.search||document.location.hash;if(null==param)return q;if(q)for(var pairs=q.substring(1).split("&"),i=0;i<pairs.length;i++)if(pairs[i].substring(0,pairs[i].indexOf("="))==param)return pairs[i].substring(pairs[i].indexOf("=")+1);return""}},deconcept.SWFObjectUtil.cleanupSWFs=function(){for(var objects=document.getElementsByTagName("OBJECT"),i=objects.length-1;i>=0;i--)for(var x in objects[i].style.display="none",objects[i])"function"==typeof objects[i][x]&&(objects[i][x]=function(){})},deconcept.SWFObject.doPrepUnload&&(deconcept.unloadSet||(deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){},window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload),deconcept.unloadSet=!0)),!document.getElementById&&document.all&&(document.getElementById=function(id){return document.all[id]});var getQueryParamValue=deconcept.util.getRequestParameter,FlashObject=deconcept.SWFObject;Utils.Flash.swfObject=deconcept.SWFObject,Core.Dom.getTop=function(element){var top=0,el=$E(element);if("unknown"!=typeof el.offsetParent)for(;el.offsetParent;)top+=el.offsetTop,el=el.offsetParent;else el.y&&(top+=el.y);return top},Core.Dom.getLeft=function(element){var left=0,el=$E(element);if("unknown"!=typeof el.offsetParent)for(;el.offsetParent;)left+=el.offsetLeft,el=el.offsetParent;else el.x&&(left+=el.x);return left},Lib.applyIf=function(o,s,defaults){if(defaults&&Lib.applyIf(o,defaults),o&&s&&Lib.isObject(s))for(var p in s)s.hasOwnProperty(p)&&!o[p]&&(o[p]=s[p]);return o},Lib.isObject=function(o){return"[object Object]"===Object.prototype.toString.call(o)},Lib.apply=function(o,ref,defaults,deep,original){for(var p in defaults&&Lib.applyIf(o,defaults),ref)original&&o[p]&&!Lib.isObject(o[p])||ref.hasOwnProperty(p)&&(deep&&Lib.isObject(ref[p])?o[p]=Lib.apply(o[p]||{},ref[p],deep,original):o[p]=ref[p]);return o},Lib.Panel=Core.Class.create(),Lib.Panel.prototype={noIframe:!1,isPostion:!0,appendTo:null,entity:null,backIframe:null,uniqueID:null,isFixed:!1,isShow:!1,isHidden:!0,x:0,y:0,template:"",initialize:function(cfg){Lib.apply(this,cfg);var _this=this;this.uniqueID=this._getUniqueID(),this._ie6Fixed=function(){_this.entity&&(_this.entity.style.left=document.documentElement.scrollLeft+_this.x+"px",_this.entity.style.top=document.documentElement.scrollTop+_this.y+"px"),_this.backIframe&&(_this.backIframe.style.left=_this.entity.style.left,_this.backIframe.style.top=_this.entity.style.top)}},getNode:function(name){return this.tpl.getNode(name)},setTemplate:function(template){this.template=template,this.entity&&this.entity.parentNode&&(this.entity.parentNode.removeChild(this.entity),this.backIframe&&this.backIframe.parentNode.removeChild(this.backIframe)),this.entity=$C("div");var tempEntity=$C("div"),tmp=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=tmp,tempEntity.innerHTML=tmp.getHtmlString(),tempEntity.style.display="none",this.appendTo?$E(this.appendTo).appendChild(tempEntity):document.body.appendChild(tempEntity),this.entity=$E("_"+this.uniqueID+"_panel"),this.isPostion&&(this.entity.style.position="absolute"),this.entity.style.display="none",this.appendTo?$E(this.appendTo).replaceChild(this.entity,tempEntity):document.body.replaceChild(this.entity,tempEntity),tempEntity=null,this.noIframe||(this.backIframe=$C("iframe"),this.backIframe.style.display="none",this.backIframe.style.border="none",this.backIframe.style.zIndex=this.entity.style.zIndex-1,document.body.appendChild(this.backIframe),this._updateBackIframe())},setPosition:function(x,y){this.x=x,this.y=y,this.entity.style.left=x+"px",this.entity.style.top=y+"px",$IE6&&this.isFixed&&(this.entity.style.left=x+document.documentElement.scrollLeft+"px",this.entity.style.top=y+document.documentElement.scrollTop+"px"),this.backIframe&&(this.backIframe.style.left=this.entity.style.left,this.backIframe.style.top=this.entity.style.top)},setFixed:function(state){if(this.isFixed=state,$IE6){return this.entity.style.position="absolute",void(this.isFixed?(this._ie6Fixed(),Core.Events.addEvent(window,this._ie6Fixed,"scroll")):Core.Events.removeEvent(window,this._ie6Fixed,"scroll"))}this.entity.style.position=this.isFixed?"fixed":"absolute",this.backIframe&&(this.backIframe.style.position=this.entity.style.position)},show:function(){this.entity.style.display="",this.isHidden=!1,this.isShow=!0,this.backIframe&&(this._updateBackIframe(),this.backIframe.style.display="")},hidden:function(){this.hide()},hide:function(){this.entity.style.display="none",this.isHidden=!0,this.isShow=!1,this.backIframe&&(this.backIframe.style.display="none")},close:function(){this.hidden(),this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll"),this.entity.parentNode.removeChild(this.entity),this.entity=null,this.backIframe&&(this.backIframe.parentNode.removeChild(this.backIframe),this.backIframe=null)},showWithDom:function(dom,offsetLeft,offsetTop){var x=Core.Dom.getLeft(dom)+dom.offsetWidth+offsetLeft,y=Core.Dom.getTop(dom)+dom.offsetHeight+offsetTop;$IE6&&this.isFixed&&(x-=document.documentElement.scrollLeft,y-=document.documentElement.scrollTop),this.setPosition(x,y),this.show()},getWidth:function(){var ld=this.entity.style.display,lv=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",w=this.entity.offsetWidth,this.entity.style.display=ld,this.entity.style.visibility=lv,w},getHeight:function(){var ld=this.entity.style.display,lv=this.entity.style.visibility;return this.entity.style.visibility="hidden",this.entity.style.display="",h=this.entity.offsetHeight,this.entity.style.display=ld,this.entity.style.visibility=lv,h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},getNodes:function(mode){var i,m=mode||"o",nodes={},result=this.template.match(/[^\{\}]+(?=\})/g);if(result)for(i=0;i<result.length;i++){var r=result[i];switch(m){case"o":nodes[r]=$E("_"+this.uniqueID+"_"+r);break;case"i":nodes[r]="_"+this.uniqueID+"_"+r}}return nodes},_updateBackIframe:function(){Core.Dom.setStyle(this.backIframe,"opacity",0),this.backIframe.style.display="",this.backIframe.style.position=this.entity.style.position,this.backIframe.style.width=this.entity.offsetWidth+"px",this.backIframe.style.height=this.entity.offsetHeight+"px",this.backIframe.style.left=this.entity.style.left,this.backIframe.style.top=this.entity.style.top},_getUniqueID:function(){return parseInt(1e3*Math.random()).toString()+(new Date).getTime().toString()}};var showUpTips=function(){winDialog.alert('您可以在<a href="//get.adobe.com/flashplayer/" target="_blank">此处下载免费的Adobe flash player installer</a>。成功安装程序后，可返回此处查看。',{icon:"01"})};if(scope.magicCfg={},window.$magicFacePlay=function(swfName){if(scope.flashVersion||(scope.flashVersion=deconcept.SWFObjectUtil.getPlayerVersion()),scope.flashVersion.major<9)showUpTips();else{Core.Events.stopEvent();var cfg_containerDiv="magicFaceCon",layer=['<div id="magicFaceCon" title="" alt="" style="height:360px; width:360px;">',"</div>"].join("");scope.magicCfg.layer=new Lib.Panel,scope.magicCfg.layer.setTemplate('<div style="position:absolute;z-index:2000;" id="#{panel}" title="" alt="">'+layer+"</div>"),scope.magicCfg.layer.show();var removeSwf=function(){trace("swf remove!!!");var con=$E(cfg_containerDiv);con&&(con.innerHTML=""),window.clearInterval(timer),Core.Events.removeEvent(document,escDown,"keydown");try{scope.magicCfg.shadow.close(),scope.magicCfg.layer.close(),Core.Events.stopEvent()}catch(e){}$E("___flashOverlay")&&document.body.removeChild($E("___flashOverlay"))},escDown=function(e){if(27===(e.keyCode||e.which||e.charCode))return removeSwf(),Core.Events.removeEvent(document,escDown,"keydown"),Core.Events.stopEvent(),!1};!function(){scope.magicCfg.shadow=new BackShadow(.4),scope.magicCfg.shadow.entity.setAttribute("title","点击关闭动画"),scope.magicCfg.shadow.entity.setAttribute("alt","点击关闭动画"),scope.magicCfg.shadow.entity.onclick=removeSwf,Core.Events.addEvent(document,escDown,"keydown"),scope.magicCfg.shadow.show();var win=Core.System.winSize(),scroll=Core.System.getScrollPos(document),_x=win.width/2-180+scroll[1],_y=win.height/2-180+scroll[0];scope.magicCfg.layer.setPosition(_x,_y);var overlayDiv=document.createElement("div");overlayDiv.id="___flashOverlay",overlayDiv.style.cssText="cursor:pointer;visibility:hidden;background:white;;z-index:3000;position:absolute;width:360px;height:360px;top:"+_y+"px;left:"+_x+"px",document.body.appendChild(overlayDiv),document.all?overlayDiv.style.filter="Alpha(Opacity=0)":overlayDiv.style.opacity=0,overlayDiv.style.visibility="visible",Core.Events.addEvent(overlayDiv,(function(){window.open("//blog.sina.com.cn/myshow2010")})),overlayDiv=null;var FlashPlayer=new Utils.Flash.swfObject("//www.sinaimg.cn/uc/myshow/blog/misc/gif/"+swfName+"?t="+Core.Math.getUniqueId(),"magicFace",360,360,9,"#FFFFFF");FlashPlayer.addParam("quality","high"),FlashPlayer.addParam("wmode","transparent"),FlashPlayer.addParam("allowScriptAccess","always"),FlashPlayer.write(cfg_containerDiv)}();var timer=window.setInterval((function(){trace("……追踪 进度……");var swf=$E("magicFace"),snap=0;if(swf&&100==swf.PercentLoaded()){swf.onclick=function(){Core.Events.stopEvent()},trace("swf 加载完毕了………………");var con=swf.parentNode,scroll=Core.System.getScrollPos(document),win=Core.System.winSize(),_x=win.width/2-con.offsetWidth/2+scroll[1],_y=win.height/2-con.offsetHeight/2+scroll[0];scope.magicCfg.layer.setPosition(_x,_y),scope.magicCfg.layer.show(),trace("flash size x="+con.offsetWidth+"  y="+con.offsetHeight),window.clearInterval(timer),timer=window.setInterval((function(){var total,curr=swf.CurrentFrame();try{total=swf.TotalFrames()}catch(e){total=swf.TotalFrames}curr<0||(curr<total&&snap<=curr?snap=curr:removeSwf())}),80)}}),100)}},$registJob("articleCommentV2",(function(){if(!scope.$comment_is_load_page_1&&1!=scope.$private.cms&&1!=scope.$isCommentAllow)new CommentV2.CommentList({url:"//comment5.news.sina.com.cn/page/info?channel=blog&newsid="+scope.$articleid,containerNode:$E("article_comment_list")})})),void 0===App)var App={};$ScriptLoader={callback:{},response:function(sId,oData){var sUidHex=(1*scope.$uid).toString(16),sUidLen=sUidHex.length;if(8>sUidLen)for(var i=0,len=8-sUidLen;i<len;i++)sUidHex="0"+sUidHex;var result={};for(var key in oData)result[sUidHex+"01"+key]=oData[key];this.callback[sId].func(result);var pageId=scope.$pageid;if("article_new"==pageId||"articleM_new"==pageId||"article"==pageId||"articleM"==pageId||!pageId.indexOf("articletj")){var func=scope.useNewInterfaceToGetNum;func||(scope.useNewInterfaceToGetNum={},func=scope.useNewInterfaceToGetNum);var diggerNum=0;for(var x in oData){diggerNum=oData[x].d;break}if(func){var diggNumStr="digg_m_"+scope.$articleid,obj={};if(obj[diggNumStr]=diggerNum,func.onSuccess)func.onSuccess(obj);else var count=0,timmer=setInterval((function(){if(count>300)return clearInterval(timmer),void(func&&func.onException&&func.onException(obj));func&&func.onSuccess&&(clearInterval(timmer),func.onSuccess(obj)),count++}),100)}}}},App.getArticlesDetailNumber=function(sUid,aArticleLists,fCallBack){if(null==aArticleLists||0==aArticleLists.length)return{};sUid=sUid||scope.$uid;var sUidHex=(1*scope.$uid).toString(16),sUidLen=sUidHex.length;if(8>sUidLen)for(var i=0,len=8-sUidLen;i<len;i++)sUidHex="0"+sUidHex;var aids=[];Core.Array.foreach(aArticleLists,(function(oItem){aids.push(oItem.replace(sUidHex+"01",""))}));for(var js=$C("script"),random=Math.ceil(1e4*Math.random());null!=$ScriptLoader.callback[random];)random=Math.ceil(1e4*Math.random());var requestId="aritlces_number_"+random;$ScriptLoader.callback[requestId]={func:fCallBack,uid:sUid};var src="//comet.blog.sina.com.cn/api?maintype=num&uid="+sUidHex+"&aids="+aids.join(",")+"&requestId="+requestId;"indexM"!=scope.$pageid&&"index"!=scope.$pageid||(src+="&fetch=r,c,z,f"),"articlelist"!=scope.$pageid&&"articlelistM"!=scope.$pageid||(src+="&fetch=c,r"),js.src=src,js.charset="utf-8",js.onload=js.onerror=js.onreadystatechange=Core.Function.bind2((function(){js&&js.readyState&&"loaded"!=js.readyState&&"complete"!=js.readyState||(js.onload=js.onreadystatechange=js.onerror=null,js.src="",js.parentNode.removeChild(js),js=null)}),this),document.getElementsByTagName("head")[0].appendChild(js)},$registJob("articleNumberV2",(function(){Lib.checkAuthor((function(){if("1"==scope.$pn_x_rank&&!$isAdmin)return!1;var uid=scope.$uid,articleid=scope.$articleid;App.getArticlesDetailNumber(uid,[articleid],(function(x){var data=x[articleid];for(var i in data)if(scope.$pageid,$E(i+"_"+articleid)&&($E(i+"_"+articleid).innerHTML="("+data[i]+")"),"c"===i&&$E("blog_comments_num")){var num=data[i]||0;num=num>999?"999+":num,$E("blog_comments_num").innerHTML=num}"articleM"===scope.$pageid&&data.z&&$E("quote_sign_count")&&($E("quote_sign_count").innerHTML=data.z)}))}),"articleNumberV2"+(new Date).getTime())})),Core.Events.fireEvent=function(oElement,sEvent){var evt;(oElement=$E(oElement)).fireEvent?oElement.fireEvent("on"+sEvent):((evt=$MOBILE?document.createEvent("HTMLEvents"):document.createEvent("MouseEvents")).initEvent(sEvent,!0,!0),oElement.dispatchEvent(evt))},scope.faceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),Lib.Face=Core.Class.create(),Lib.Face.prototype={dialog:null,dialogNodes:null,tabs:null,faceConfig:null,template:null,txtContentArea:null,x:0,y:0,isShowed:!1,_isInitDialog:!1,insertImageFile:"",initialize:function(txtContentArea,tpl){var _this=this;this.txtContentArea=txtContentArea,this.template=tpl,window.$insertFace=function(code,name){_this.insertFace(code,name)}},load:function(){var _this=this;this.dialog=new Dialog(this.template||scope.faceTemplate),this.dialogNodes=this.dialog.getNodes(),this.tabs=new Tabs(this.dialogNodes.faceTab),Core.Events.addEvent(this.dialog.entity,(function(){Core.Events.stopEvent()}),"mousedown"),Core.Events.addEvent(document.body,(function(){_this.hidden()}),"mousedown"),this.initFaceConfig((function(){_this.tabs.tabsArr[0]&&_this.tabs.tabsArr[0].setFocus(),Core.Events.addEvent(_this.dialogNodes.btnClose,(function(){_this.hidden()}),"mousedown"),_this.onInitialized()})),this._isInitDialog=!0},initFaceConfig:function(callBack){var _this=this;Utils.Io.JsLoad.request("//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig&"+(new Date).getTime(),{onComplete:function(data){_this.faceConfig=data,_this.initFaceData(),callBack&&callBack()},charset:"gb2312"})},initFaceData:function(){var k;for(k in this.faceConfig)this.addTab(k,this.faceConfig[k].name,this.faceConfig[k].data)},onInitialized:function(){},textWatchOn:function(){var _oTextNode=this.txtContentArea,getPos=function(){_oTextNode.createTextRange&&(_oTextNode.caretPos=document.selection.createRange().duplicate())};Core.Events.addEvent(_oTextNode,getPos,"keyup"),Core.Events.addEvent(_oTextNode,getPos,"focus"),Core.Events.addEvent(_oTextNode,getPos,"select"),Core.Events.addEvent(_oTextNode,getPos,"click")},addTab:function(key,tabName,contentData){var _this=this,tab=new Tab('<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+key+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+tabName+"</a></span><em>("+contentData.length+")</em>",{isFocus:!1,className:"cur"});tab.addOnAbort((function(){tab.content.style.display="none"})),tab.addOnFocus((function(){tab.isShowed||(tab.isShowed=!0,tab.content=$C("ul"),tab.content.innerHTML=_this._getTabContent(key,contentData),_this.dialogNodes.faceContent.appendChild(tab.content)),tab.content.style.display=""})),this.tabs.add(tab)},_getTabContent:function(key,contentData){var faceName,i,str=[],len=contentData.length;for(i=0;i<len;i++)faceName=contentData[i].name,faceName=Core.String.byteLength(faceName)>8?Core.String.leftB(faceName,6)+"...":faceName,str.push("<li><a onclick=\"$insertFace('"+contentData[i].code+"','"+contentData[i].name+'\');return false;" href="#"><img style="width:50px;height:50px;" title="'+contentData[i].name+'" src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+contentData[i].code+'T.gif"/></a><span>'+faceName+"</span></li>");return str.join("")},insertFace:function(code,name){if(this.insertImageFile=code+"T.gif",this.onInsert(),this.txtContentArea){var faceValue="[emoticons="+code+"]"+name+"[/emoticons]";if($IE)if(this.txtContentArea.createTextRange&&this.txtContentArea.caretPos){var caretPos=this.txtContentArea.caretPos;caretPos.text=" "==caretPos.text.charAt(caretPos.text.length-1)?faceValue+" ":faceValue,this.txtContentArea.focus()}else this.txtContentArea.value+=faceValue,this.txtContentArea.focus();else if(this.txtContentArea.setSelectionRange){var rangeStart=this.txtContentArea.selectionStart,rangeEnd=this.txtContentArea.selectionEnd,tempStr1=this.txtContentArea.value.substring(0,rangeStart),tempStr2=this.txtContentArea.value.substring(rangeEnd);this.txtContentArea.value=tempStr1+faceValue+tempStr2}else this.txtContentArea.value+=faceValue;return this.hidden(),!1}},onInsert:function(){},setPosition:function(x,y){this.x=x,this.y=y,this.dialog.setPosition({x:x,y:y})},show:function(){!this._isInitDialog&&this.load(),this.dialog.show(),this.isShowed=!0},hidden:function(){this.isShowed=!1,this.dialog.hidden()}},Core.Dom.addHTML=function(oParentNode,sHTML){oParentNode.insertAdjacentHTML("beforeend",sHTML)},$C("div").insertAdjacentHTML||(Core.Dom.addHTML=function(oParentNode,sHTML){var oRange=oParentNode.ownerDocument.createRange();oRange.setStartBefore(oParentNode);var oFrag=oRange.createContextualFragment(sHTML);oParentNode.appendChild(oFrag)}),App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>','<li class="play" id="#{magicTip}">点击<img align="absmiddle" src="//simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif">预览动画效果</li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join(""),App.smilesDialog2=Core.Class.create(),App.smilesDialog2.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(oOption){for(var key in this.option=oOption||{},this.defaultConfig)null==this.option[key]&&(this.option[key]=this.defaultConfig[key]);if(this.dialog=new Dialog(this.option.htmlTpl),this.dialog.setAreaLocked(!0),this.dialogNodes=this.dialog.getNodes(),this.getKeyWord(),null!=scope.smilesData)this.data=scope.smilesData,this.dataSettle(),this.eventListen();else{var __this=this;Utils.Io.JsLoad.request([{url:"//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(oData){scope.smilesData=oData,__this.data=oData,__this.dataSettle(),__this.eventListen()},onException:function(){}})}return this},dataSettle:function(oData,nCount){for(var key in oData=oData||this.data,nCount=nCount||9,this.tabsData=[],this.allData=[],oData){var _item=oData[key];_item.sortId=key,this.tabsData.push(_item);for(var i=0,len=_item.data.length;i<len;i++)_item.data[i].sid=key,_item.data[i].sname=_item.name;this.allData=this.allData.concat(_item.data)}null==this.allDataBack&&(this.allDataBack=this.allData.slice(0)),this.showTab(1,nCount),0==this.dialogNodes.smileList.childNodes.length&&this.showAll()},children:function(chs){for(var cArr=[],i=0;chs[i];i++)1==chs[i].nodeType&&cArr.push(chs[i]);return cArr},showTab:function(nPage,nCount){nPage=nPage||1,nCount=nCount||9,this.dialogNodes.sortList.innerHTML="",this.dialogNodes.smileList.innerHTML="",Core.Dom.setStyle(this.dialogNodes.sortList,"height",9==nCount?"279px":"217px"),this.tabs=new Tabs(this.dialogNodes.sortList),this.tabsObject={};for(var _this=this,i=0;i<nCount;i++){var _indexBase=(nPage-1)*nCount;if(null==this.tabsData[_indexBase+i])break;var _sortId=this.tabsData[_indexBase+i].sortId,_name=this.tabsData[_indexBase+i].name,_data=this.tabsData[_indexBase+i].data,tab=new Tab('<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_sortId+'.gif" height="20" width="20" align="absmiddle"><div><span><a href="#" onclick="return false;" title="'+_name+'">'+_name+"</a></span><em>("+_data.length+")</em></div>",{isFocus:!1,className:"cur"});tab.addOnAbort(Core.Function.bind3((function(tab){}),null,[tab])),tab.addOnFocus(Core.Function.bind3((function(tab,key,data,sid){if(_this.showSmile(data,1,_this.pageSize),_this.currentTab=tab,_this.dialogNodes.allSort.style.fontWeight=400,!_this.isFromUp){var pId=scope.$pageid;if(pId){var isComm=scope.isFromtheCommonhzh;isComm&&v7sendLog($_GLOBAL.faceChooseTable[pId][isComm]+"_16_020_"+sid,pId,"")}}_this.isFromUp=null}),null,[tab,_indexBase+i,_data,_sortId])),this.tabsObject[_sortId]=tab,this.tabs.add(tab)}var _tabPageCount=Math.ceil(this.tabsData.length/nCount);_tabPageCount>0?this.showTabPage(nPage||1,_tabPageCount,nCount):this.dialogNodes.sortCtrl.innerHTML=""},showSmile:function(oData,nPage,nCount){nCount=nCount||this.pageSize;var _pageLink,__this=this,_smiles=oData,_count=_smiles.length,_totalPages=Math.ceil(_count/nCount),_smilesDom=document.createDocumentFragment();this.dialogNodes.smileList.innerHTML="",this.dialogNodes.magicTip.style.cssText="display:none;";for(var i=0;i<nCount;i++){var _smile=_smiles[(nPage-1)*nCount+i];if(null==_smile)break;var _li=$C("li"),_a=$C("a");_a.href="#",_a.onclick=function(){return!1},_a.onmousedown=Core.Function.bind3((function(nCode,sName,swfName){__this.hide(),__this.option.callback(nCode,sName,swfName)}),null,[_smile.code,_smile.name,_smile.swf||null]),_a.innerHTML='<img style="width:50px;height:50px;" src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_smile.code+'T.gif" alt="'+_smile.name+'" title="'+_smile.name+'" />',_li.appendChild(_a),_a.setAttribute("key",_smile.code);var _span=$C("span");if(_span.title=_smile.name,_span.innerHTML=Core.String.byteLength(_smile.name)>8?Core.String.leftB(_smile.name,6)+"…":_smile.name,_li.appendChild(_span),_smile.swf){var _div=$C("div");_div.innerHTML='<a href="#"   onclick="window.$magicFacePlay(\''+_smile.swf+'\');return false;"><img height="13" title="播放表情" align="absmiddle" width="14" alt="" src="//simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif"></a>',_div.className="arr_r",_li.appendChild(_div),this.dialogNodes.magicTip.style.cssText="display:block;"}_smilesDom.appendChild(_li),Core.Events.addEvent(_a,function(ele){return function(){var pId=scope.$pageid;if(pId){var isComm=scope.isFromtheCommonhzh;isComm&&v7sendLog($_GLOBAL.faceChooseTable[pId][isComm]+"_16_010_"+ele.getAttribute("key"),pId,"")}}}(_a),"mousedown")}this.dialogNodes.smileList.appendChild(_smilesDom),_count>nCount?(1==nPage?this.dialogNodes.smilePagePrev.innerHTML="上一页":(this.dialogNodes.smilePagePrev.innerHTML="",(_pageLink=$C("a")).href="#",_pageLink.onclick=function(){return!1},_pageLink.onmousedown=function(){__this.showSmile(_smiles,nPage-1,nCount)},_pageLink.innerHTML="上一页",this.dialogNodes.smilePagePrev.appendChild(_pageLink)),this.dialogNodes.smilePageShow.innerHTML=nPage+"/"+_totalPages,nPage>=_totalPages?this.dialogNodes.smilePageNext.innerHTML="下一页":(this.dialogNodes.smilePageNext.innerHTML="",(_pageLink=$C("a")).href="#",_pageLink.onclick=function(){return!1},_pageLink.onmouseup=function(){__this.showSmile(_smiles,nPage+1,nCount)},_pageLink.innerHTML="下一页",this.dialogNodes.smilePageNext.appendChild(_pageLink))):(this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="")},showTabPage:function(nPageNum,nPageCount,nTabsPerPage){this.dialogNodes.sortCtrl.innerHTML="",this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="";var _arrow,__this=this;1==nPageNum?nPageNum!=nPageCount&&(this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>',(_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向下",_arrow.className="down",_arrow.onmousedown=function(){__this.showTab(nPageNum+1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow)):nPageNum<nPageCount?((_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向上",_arrow.className="up",_arrow.onmousedown=function(){__this.showTab(nPageNum-1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow),(_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向下",_arrow.className="down",_arrow.onmousedown=function(){__this.showTab(nPageNum+1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow)):((_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向上",_arrow.className="up",_arrow.onmousedown=function(){__this.showTab(nPageNum-1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow),Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>'))},eventListen:function(){var __this=this,_searchText=__this.dialogNodes.searchText,_searchBtn=__this.dialogNodes.searchBtn,_keywordBack=__this.dialogNodes.keyCtrlBack,_allSort=__this.dialogNodes.allSort,_smileEmptyBack=__this.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,(function(cls){var _event=Core.Events.getEvent(),_eventTarget=$IE?_event.srcElement:_event.target;null==__this.dialogNodes.entity||0!=Core.Dom.contains(__this.dialogNodes.entity,_eventTarget)&&1!=cls||__this.hide()})),Core.Events.addEvent(this.dialogNodes.btnClose,(function(){__this.hide()})),Core.Events.addEvent(_searchText,(function(){"输入关键字、动漫形象"==Core.String.trim(_searchText.value)&&(_searchText.value="",_searchText.style.color="#000"),_searchText.select()}),"focus"),Core.Events.addEvent(_searchText,(function(){""==Core.String.trim(_searchText.value)&&(_searchText.value="输入关键字、动漫形象",_searchText.style.color="#9b9b9a")}),"blur"),Core.Events.addEvent(_searchText,(function(e){var _evt=Core.Events.getEvent(),_key=_evt.which||_evt.keyCode,_keyword=Core.String.trim(_searchText.value);13==_key&&""!=_keyword&&__this.searchKey(_keyword)}),"keydown"),Utils.Form.limitMaxLen(_searchText,20),Core.Events.addEvent(_searchBtn,(function(){"输入关键字、动漫形象"==_searchText.value||""==_searchText.value||(__this.searchKey(_searchText.value),_searchText.focus())}));var _backHome=function(){__this.dataSettle(__this.data,9),__this.dialogNodes.keyCtrl.style.display="none",__this.dialogNodes.smileEmpty.style.display="none",__this.dialogNodes.smileList.style.display="",__this.dialogNodes.searchText.value="输入关键字、动漫形象",__this.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(_keywordBack,_backHome),Core.Events.addEvent(_smileEmptyBack,_backHome),Core.Events.addEvent(_allSort,(function(){__this.showAll()}))},showAll:function(){this.showSmile(this.allData,1,this.pageSize),this.dialogNodes.allSort.style.fontWeight=600,null!=this.currentTab&&this.currentTab.setAbort()},setSort:function(sId,fCallback){this.isFromUp=sId,this.option.sortId=sId,this.option.callback=fCallback,0==sId?(this.dialogNodes.allSort.style.fontWeight=600,this.dataSettle()):(this.dataSettle(),this.tabs.swapTags(this.tabsObject[sId]))},getKeyWord:function(){if(null==this.keywordData){var __this=this;Utils.Io.JsLoad.request("//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig",{onComplete:function(oData){__this.keywordData=oData;for(var _hotkey=oData.E___00000000000||"顶|路过|哭|啦啦|美女",_hotDom=document.createDocumentFragment(),i=0,len=(_hotkey=_hotkey.split("|")).length;i<len;i++){var _link=$C("a");if(_link.href="#",_link.onclick=function(){return!1},_link.onmousedown=Core.Function.bind3((function(sHotkey){__this.searchKey(sHotkey)}),null,[_hotkey[i]]),_link.innerHTML=_hotkey[i],"魔法表情"==_hotkey[i]){var img=$C("img");img.style.cssText="height:15px; width:15px;",img.setAttribute("align","absmiddle"),img.src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",img.className="SG_icon SG_icon68 img_m",_hotDom.appendChild(img)}_hotDom.appendChild(_link)}""==__this.dialogNodes.hotKeyword.innerHTML&&__this.dialogNodes.hotKeyword.appendChild(_hotDom);var _hotKeyAll="";for(var key in oData)"E___00000000000"!=key&&(_hotKeyAll+="∑"+key+"§"+oData[key]);__this.keywordStr=_hotKeyAll},onException:function(){}})}},searchKey:function(sHotkey){var _regSearchKey=sHotkey.replace(/([\\^$*+?{}.|])/gi,"\\$1"),searchReg=new RegExp("∑([^§]+)§[^∑]*"+_regSearchKey+"[^∑]*","gi"),_resultArray=[];this.keywordStr.replace(searchReg,(function(a,b){_resultArray.push(b)})),_resultArray=_resultArray.join(",");for(var _result={},_allData=this.allDataBack,_len=_allData.length,_count=0,i=0;i<_len;i++)-1==_resultArray.indexOf(_allData[i].code)&&-1==_allData[i].sname.indexOf(sHotkey)&&-1==_allData[i].name.indexOf(sHotkey)||(null==_result[_allData[i].sid]&&(_result[_allData[i].sid]={name:_allData[i].sname,data:[]}),_result[_allData[i].sid].data.push(_allData[i]),_count++);var isComm,pid=scope.$pageid;0==_count?(this.dialogNodes.smileEmpty.style.display="",this.dialogNodes.smileList.style.display="none",pid&&(isComm=scope.isFromtheCommonhzh)&&v7sendLog($_GLOBAL.faceChooseTable[pid][isComm]+"_16_030_"+encodeURIComponent(sHotkey),pid,"")):(this.dialogNodes.smileList.style.display="",this.dialogNodes.smileEmpty.style.display="none",pid&&(isComm=scope.isFromtheCommonhzh)&&v7sendLog($_GLOBAL.faceChooseTable[pid][isComm]+"_16_031_"+encodeURIComponent(sHotkey),pid,""));this.dataSettle(_result,7),this.dialogNodes.keyCtrl.style.display="",this.dialogNodes.keyWord.innerHTML=sHotkey.split("").join("<wbr/>"),Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(x,y){this.x=x,this.y=y,this.dialog.setPosition({x:x,y:y})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象",this.dialogNodes.searchText.style.color="#9b9b9a",this.dialog.show()},hide:function(){this.dialog.hidden(),this.dialogNodes.keyCtrl.style.display="none"}},scope.smilesDataV2={302:{name:"小新小浪",contract:"GY00000001",data:[{name:"灌水",code:"E___0173EN00SIG"},{name:"赞",code:"E___0480ZH00SIG"},{name:"美好",code:"E___0305EN00SIG"},{name:"顶",code:"E___0022EN00SIG"},{name:"顶",code:"E___0088EN00SIG"},{name:"顶",code:"E___0472ZH00SIG"},{name:"开心",code:"E___0092EN00SIG"},{name:"路过",code:"E___0177EN00SIG"}]}},App.insertSmilesForm2=Core.Class.create(),App.insertSmilesForm2.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(oOption){if(this.option=oOption||{},null!=this.option.sortNode){for(var key in this.defalutConfig)null==this.option[key]&&(this.option[key]=this.defalutConfig[key]);null==scope.smilesDataV2?this.getSmilesData():(this.data=scope.smilesDataV2,this.renderUI())}},getSmilesData:function(){var __this=this;Utils.Io.JsLoad.request([{url:"//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(oData){scope.smilesData=oData,__this.data=oData,__this.renderUI()},onException:function(){}})},renderUI:function(){var firstSort,__this=this,_fragement=document.createDocumentFragment();$C("div"),$C("span"),$C("div");if(firstSort=this.data&&this.data[302]&&this.data[302].data,null!=$E(this.option.recommNode)){_fragement=document.createDocumentFragment();for(var i=0;i<this.option.recommCount;i++){_title=firstSort[i].name;var _code=firstSort[i].code,_swfName=firstSort[i].swf;node=$C("li"),function(val){node.onclick=Core.Function.bind3((function(key,title,swfName){__this.option.clickCallback(key,title,swfName),v7sendLog("32_01_20");var pid=scope.$pageid;return pid&&(val=1==(val+="").length?"0"+val:val,v7sendLog($_GLOBAL.faceCountRecommLinkTable[pid]+"_"+val+"_010_"+key,pid,"")),Core.Events.stopEvent(),!1}),null,[_code,_title,_swfName])}(i+8),node.hideFocus=!0;var tempHTML='<a href="#"><img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_code+'T.gif" alt="'+_title+'" title="'+_title+'" height="50" width="50"/></a>';_swfName&&(tempHTML=tempHTML+'<div class="arr"><a href="#" onclick="window.$magicFacePlay(\''+_swfName+'\');return false;" ><img src="//simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif" width="14" height="13" title="播放表情" alt="" align="absmiddle" /></a></div>'),node.innerHTML=tempHTML,_fragement.appendChild(node)}$E(this.option.recommNode).appendChild(_fragement)}firstSort=_fragement=_morelink=_code=key=_title=node=null}},Lib.children=function(chs){for(var cArr=[],i=0;chs[i];i++)1==chs[i].nodeType&&cArr.push(chs[i]);return cArr},App.insertSmilesDialog2=function(sSortId,fCallback,sPositionNode,arrPosiPix){App.insertSmilesDialog2.callback=fCallback,null==scope.smileDialog&&(scope.smileDialog=new App.smilesDialog2),scope.smileDialog.setSort(sSortId,fCallback);var xy=Core.Dom.getXY($E(sPositionNode)),x=xy[0]+arrPosiPix[0],y=xy[1]+arrPosiPix[1];scope.smileDialog.setPosition(x,y),scope.smileDialog.show()},App.formInsertSmile2=function(sTextarea,sSortNode,sRecommNode,fCallBack,sPositionNode,arrPix,sFrame,opt_evnets,cfg){var _oTextNode=$E(sTextarea);cfg=cfg||{};var getPos=function(){_oTextNode.createTextRange&&(_oTextNode.caretPos=document.selection.createRange().duplicate())};scope.commEditor||(scope.commEditor=new commEditor),scope.commEditor.append(sFrame,sTextarea,opt_evnets),Core.Events.addEvent(_oTextNode,getPos,"keyup"),Core.Events.addEvent(_oTextNode,getPos,"focus"),Core.Events.addEvent(_oTextNode,getPos,"select"),Core.Events.addEvent(_oTextNode,getPos,"click");var smileCfg={sortNode:sSortNode,clickCallback:function(nCode,sName,swfname){setTimeout((function(){var tempHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+nCode+'T.gif" alt="'+sName+'" title="'+sName+'"width="50" height="50" />';swfname&&(tempHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+nCode+'T.gif" alt="'+sName+'" title="'+sName+'" swfname="'+swfname+'"  width="50" height="50" />'),scope.commEditor.insertHTML(sFrame,tempHTML)}),20),fCallBack&&fCallBack()},recommNode:sRecommNode,positionNode:sPositionNode||sSortNode,arrPosPix:arrPix||[0,0],sortCount:cfg.sortCount||6,recommCount:cfg.recommCount||8};new App.insertSmilesForm2(smileCfg)};var commEditor=function(frame,area){this.fids=[],this.areas={},this.wins={},this.docs={},this.intervals={},this.actions={}};commEditor.prototype={init:function(sFrame){var doc=this.docs[sFrame];try{doc.body.designMode="on"}catch(e){}doc.open(),doc.writeln(this.getEditorHTML("")),doc.body.contentEditable=!0;var win=doc.parentWindow;Lib.checkAuthor((function(){doc.body.onkeydown=function(e){try{if(9==(e||win.event).keyCode)return $E("login_"+($isLogin?"check":"name")).focus(),!1}catch(err){}},doc.close()}),"insertSmilesFormInitV2"+(new Date).getTime())},lazyInit:function(fId){var me=this;return function(){var cDoc=me.docs[fId];cDoc.body.getAttribute("inited")||(trace("执行一次:"+fId),me.init(fId),me.bindListener(fId),cDoc.body.setAttribute("inited","yes"))}},append:function(sFrame,sTextarea,actions){(actions=actions||{}).interval||(actions.interval={}),actions.interval.before||(actions.interval.before=function(){}),actions.interval.after||(actions.interval.after=function(){});var frame=$E(sFrame);this.wins[sFrame]=frame.contentWindow,this.actions[sFrame]=actions;var me=this;!function getDoc(){try{me.docs[sFrame]=frame.contentWindow.document,me.areas[sFrame]=$E(sTextarea),$IE?me.docs[sFrame].body.onclick=me.lazyInit(sFrame):me.lazyInit(sFrame)()}catch(e){setTimeout(getDoc,150)}}()},frameFilter:function(body){var val=body.innerHTML;val=(val=(val=(val=(val=val.replace(/<script[\s\S]*<\/script>/gi,"")).replace(/<style[\s\S]*<\/style>/gi,"")).replace(/<!-{2,}[\s\S]*?-{2,}>/g,"")).replace(/<([^>]+).*?>/gi,(function(all,str){switch(str.split(" ")[0].toLowerCase()){case"/p":return"<br>";case"br":return all;case"img":return all.toLowerCase().indexOf("//www.sinaimg.cn/uc/myshow/blog")>0||all.toLowerCase().indexOf("//simg.sinajs.cn/blog7style/images/common")>0?-1==all.toLowerCase().indexOf("t.gif")&&-1==all.toLowerCase().indexOf("img_arrow_r.gif")?"":all:"";default:return""}}))).replace(/\n/g,""),body.innerHTML=val},bindListener:function(sFrame){var frameBody,doc=this.docs[sFrame],area=this.areas[sFrame],win=this.wins[sFrame],actions=this.actions[sFrame],me=this;if($IE&&(doc.onkeydown=function(){var event=win.event;if(8==event.keyCode){var ele=me.getFocusElement(sFrame);ele&&"IMG"==ele.tagName.toUpperCase()&&(ele.parentNode.removeChild(ele),event.keyCode=0,event.returnValue=!1)}}),Core.Events.addEvent(doc.body,(frameBody=doc.body,function(e){me.intervals[sFrame]=setInterval((function(){actions.interval.before(sFrame,area),me.clearFrameHTML(frameBody);for(var imgs=frameBody.getElementsByTagName("img"),i=0;imgs[i];i++)imgs[i].removeAttribute("style"),imgs[i].removeAttribute("height"),imgs[i].removeAttribute("width");actions.interval.after(sFrame,area)}),400)}),"focus"),Core.Events.addEvent(doc.body,(doc.body,function(e){clearInterval(me.intervals[sFrame])}),"blur"),actions.normal)for(var event in actions.normal)Core.Events.addEvent(doc.body,actions.normal[event],event)},clearFrameHTML:function(frameBody){for(var arr=["a","input"],needIt=!1,i=0;arr[i];i++)if(frameBody.getElementsByTagName(arr[i]).length>0){needIt=!0;break}if(needIt)this.frameFilter(frameBody);else{var imgs=frameBody.getElementsByTagName("img");for(i=0;imgs[i];i++){var srcInd=imgs[i].src.indexOf("//www.sinaimg.cn/uc/myshow/blog"),tInd=imgs[i].src.toLowerCase().indexOf("t.g"),playButton=imgs[i].src.indexOf("//simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif");if((-1==srcInd||-1==tInd)&&-1==playButton){this.frameFilter(frameBody);break}}}},getFocusElement:function(fid){if($IE)return(range=this.docs[fid].selection.createRange()).item?range.item(0):range.parentElement();var range,elm=(range=this.win.getSelection().getRangeAt(0)).commonAncestorContainer;return elm.tagName&&"body"==elm.tagName.toLowerCase()?elm:range.collapsed||range.startContainer!=range.endContainer&&range.startContainer!=range.endContainer.parentNode||(range.startOffset,range.endOffset,!range.startContainer.hasChildNodes())?elm.parentNode:range.startContainer.childNodes[range.startOffset]},clearHTML:function(fId){var doc=this.docs[fId];doc.body.innerHTML="",doc.body.setAttribute("contenteditable",!1),doc.body.setAttribute("contenteditable",!0)},insertHTML:function(fId,s_html){$IE&&this.lazyInit(fId)();var win=this.wins[fId],doc=this.docs[fId];if($IE)try{win.focus();var oRang=doc.selection.createRange();if("control"==doc.selection.type.toLowerCase()){var tempRange=doc.body.createTextRange();tempRange.moveToElementText(oRang.item(0)),oRang=tempRange}oRang.pasteHTML(s_html),oRang.collapse(!1),oRang.select()}catch(e){}else!$CHROME&&!$SAFARI||"%0A"!=encodeURIComponent(doc.body.innerHTML)&&""!=doc.body.innerHTML||doc.body.focus(),this.execCommand("insertHTML",s_html,fId),$CHROME||$SAFARI||doc.body.focus()},execCommand:function(cmd,value,fId){var win=this.wins[fId],doc=this.docs[fId];win.focus(),doc.execCommand(cmd,"",value),win.focus()},handleChange:function(fId){var body=this.docs[fId].body;this.areas[fId].value=this.getHandledStr(body)},getHandledStr:function(body){var strArr=[];if(body.hasChildNodes()){body=body.childNodes;for(var i=0;body[i];i++)strArr.push(this.handleDom(body[i]))}else strArr.push(this.handleDom(body));return strArr.join("").replace(/\u00A0/gi," ")},handleDom:function(ele){if(3==ele.nodeType){var val=ele.nodeValue;return Core.String.trim(val)?this.reEscapeHTML(val):""}if(1==ele.nodeType){if(ele.hasChildNodes()&&(1!=ele.childNodes.length||1==ele.childNodes.length&&ele.childNodes[0].tagName)){var strArr=[];if(ele.tagName)"DIV"!=(tN=ele.tagName.toUpperCase())&&"P"!=tN||strArr.push("\n");ele=ele.childNodes;for(var i=0;ele[i];i++)strArr.push(this.handleDom(ele[i]));return strArr.join("")}var tN;if("IMG"!=(tN=ele.tagName.toUpperCase())){if("BR"==tN)return"\n";if("DIV"==tN||"P"==tN){val=ele.innerHTML||"";return"\n"+this.reEscapeHTML(val)}return"SCRIPT"==tN||"STYLE"==tN?"":(val=ele.innerHTML||ele.value||"",this.reEscapeHTML(val))}if(-1==ele.src.indexOf("//www.sinaimg.cn/uc/myshow/blog"))return"";if(-1==ele.src.indexOf("T.g"))return"";var nCode=ele.src.split("T.g")[0];nCode=nCode.substring(nCode.lastIndexOf("/")+1,nCode.length);var sName=ele.getAttribute("title"),swfname=ele.getAttribute("swfname");if(swfname||"W"!=nCode[0]||(swfname=nCode+"S.swf"),sName)return swfname?"[magicemoticons="+nCode+" swfname="+swfname+"]"+sName+"[/magicemoticons]":"[emoticons="+nCode+"]"+sName+"[/emoticons]"}return""},reEscapeHTML:function(str){return str=(str=(str=(str=(str=(str=str.replace(/\n/g,"")).replace(/&nbsp;/g," ")).replace(/&quot;/g,'"')).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&")},getEditorHTML:function(sContent){var html="";return html+="<html>",html+="<head>",html+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',html+="<style>\t\tp {\t\t\t*margin:0.2em auto;\t\t}\t\tbody {\t\t\tmargin: 0;\t\t\tscrollbar-face-color: #ffffff;\t\t\tscrollbar-highlight-color: #ffffff;\t\t\tscrollbar-shadow-color: #c0c1bb;\t\t\tscrollbar-3dlight-color: #c0c1bb;\t\t\tscrollbar-arrow-color: #c9cbb6;\t\t\tscrollbar-track-color: #f4f5f0;\t\t\tscrollbar-darkshadow-color: #ffffff;\t\t\tscrollbar-base-color: #ffffff;\t\t\tpadding: 10px;\t\t\tword-wrap: break-word;\t\t\toverflow: scroll;\t\t\toverflow-x: auto;\t\t\theight: 90%;\t\t\tfont-size: 14px;\t\t}\t\tbody, td, textarea, input, br, div, span{\t\t\tfont-family: '', Verdana,Arial, Helvetica, sans-serif;\t\t\tline-height:1.5;\t\t}\t\timg{\t\t\tborder: 0;\t\t}\t\thtml{\t\t\theight: 100%;\t\t\tcursor: text;\t\t}\t\tpre{\t\t\twhite-space:normal;\t\t}\t\tform{margin: 0;}\t\tbody table{font-size: 14px;}\t\t.border{ border:1px dashed #cfcfcf;}\t\t</style>\t\t<script>document.domain='sina.com.cn';<\/script>\t\t",html+="</head>",html+="<body>",html+=sContent,html+="</body>",html+="</html>"}},App.insertSmilesForm2=Core.Class.create(),App.insertSmilesForm2.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(oOption){if(this.option=oOption||{},null!=this.option.sortNode){for(var key in this.defalutConfig)null==this.option[key]&&(this.option[key]=this.defalutConfig[key]);null==scope.smilesData?this.getSmilesData():(this.data=scope.smilesData,this.renderUI())}},getSmilesData:function(){var __this=this;Utils.Io.JsLoad.request([{url:"//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig8.js?varname=smileConfig"}],{onComplete:function(oData){scope.smilesData=oData,__this.data=oData,__this.renderUI()},onException:function(){}})},renderUI:function(){var firstSort,__this=this,count=1,_fragement=document.createDocumentFragment(),_sorts=$C("div"),_more=$C("span"),_clearit=$C("div");for(var key in _sorts.className="facestyle",this.data){if(1==count&&(firstSort=(firstSort=this.data[key]||{data:{}}).data),!(count<=this.option.sortCount))break;var _title=this.data[key].name,node=$C("a");node.href="#",node.setAttribute("key",key),node.onclick=function(){return Core.Events.stopEvent(),!1},node.onmousedown=Core.Function.bind3((function(key){App.insertSmilesDialog2(key,__this.option.clickCallback,__this.option.positionNode,__this.option.arrPosPix)}),null,[key]),node.hideFocus=!0,node.innerHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+key+'-25.gif" alt="'+_title+'" title="'+_title+'" />',_sorts.appendChild(node),count++}var timpStamp=(new Date).getTime();_sorts.id="recomm_"+timpStamp,_fragement.appendChild(_sorts),_more.className="SG_more";var ele,_morelink=$C("a");if(_morelink.href="#",_morelink.onclick=function(){return Core.Events.stopEvent(),!1},_morelink.onmousedown=(ele=_morelink,function(){App.insertSmilesDialog2(0,__this.option.clickCallback,__this.option.positionNode,__this.option.arrPosPix);var pid=scope.$pageid;if(pid){var ppId=ele.parentNode.parentNode.id.split("_")[0];ppId&&(scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[pid][ppId][1],v7sendLog($_GLOBAL.faceCountMoreLinkTable[pid][ppId][0]+"_07_000_000",pid,""))}}),_morelink.innerHTML="更多>>",_more.appendChild(_morelink),_fragement.appendChild(_more),_clearit.className="clearit",_fragement.appendChild(_clearit),$E(this.option.sortNode).appendChild(_fragement),null!=$E(this.option.recommNode)){_fragement=document.createDocumentFragment();for(var i=0;i<this.option.recommCount;i++){_title=firstSort[i].name;var _code=firstSort[i].code,_swfName=firstSort[i].swf;node=$C("li"),function(val){node.onclick=Core.Function.bind3((function(key,title,swfName){__this.option.clickCallback(key,title,swfName);var pid=scope.$pageid;return pid&&(val=1==(val+="").length?"0"+val:val,v7sendLog($_GLOBAL.faceCountRecommLinkTable[pid]+"_"+val+"_010_"+key,pid,"")),Core.Events.stopEvent(),!1}),null,[_code,_title,_swfName])}(i+8),node.hideFocus=!0;var tempHTML='<a href="#"><img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_code+'T.gif" alt="'+_title+'" title="'+_title+'" height="50" width="50"/></a>';_swfName&&(tempHTML=tempHTML+'<div class="arr"><a href="#" onclick="window.$magicFacePlay(\''+_swfName+'\');return false;" ><img src="//simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif" width="14" height="13" title="播放表情" alt="" align="absmiddle" /></a></div>'),node.innerHTML=tempHTML,_fragement.appendChild(node)}$E(this.option.recommNode).appendChild(_fragement)}var _sChildren=Lib.children($E("recomm_"+timpStamp).childNodes);for(i=0;_sChildren[i];i++)Core.Events.addEvent(_sChildren[i],function(ele,val){return function(){var pid=scope.$pageid;if(pid){var ppId=ele.parentNode.parentNode.id.split("_")[0];ppId&&(scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[pid][ppId][1],v7sendLog($_GLOBAL.faceCountMoreLinkTable[pid][ppId][0]+"_0"+val+"_020_"+ele.getAttribute("key"),pid,""))}}}(_sChildren[i],i+1),"mousedown");count=firstSort=_fragement=_sorts=_more=_morelink=_clearit=_code=key=_title=node=null}},Lib.children=function(chs){for(var cArr=[],i=0;chs[i];i++)1==chs[i].nodeType&&cArr.push(chs[i]);return cArr},App.insertSmilesDialog2=function(sSortId,fCallback,sPositionNode,arrPosiPix){App.insertSmilesDialog2.callback=fCallback,null==scope.smileDialog&&(scope.smileDialog=new App.smilesDialog2),scope.smileDialog.setSort(sSortId,fCallback);var xy=Core.Dom.getXY($E(sPositionNode)),x=xy[0]+arrPosiPix[0],y=xy[1]+arrPosiPix[1];scope.smileDialog.setPosition(x,y),scope.smileDialog.show()},App.formInsertSmile2=function(sTextarea,sSortNode,sRecommNode,fCallBack,sPositionNode,arrPix,sFrame,opt_evnets,cfg){var _oTextNode=$E(sTextarea);cfg=cfg||{};var getPos=function(){_oTextNode.createTextRange&&(_oTextNode.caretPos=document.selection.createRange().duplicate())};scope.commEditor||(scope.commEditor=new commEditor),scope.commEditor.append(sFrame,sTextarea,opt_evnets),Core.Events.addEvent(_oTextNode,getPos,"keyup"),Core.Events.addEvent(_oTextNode,getPos,"focus"),Core.Events.addEvent(_oTextNode,getPos,"select"),Core.Events.addEvent(_oTextNode,getPos,"click");var smileCfg={sortNode:sSortNode,clickCallback:function(nCode,sName,swfname){setTimeout((function(){var tempHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+nCode+'T.gif" alt="'+sName+'" title="'+sName+'"width="50" height="50" />';swfname&&(tempHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+nCode+'T.gif" alt="'+sName+'" title="'+sName+'" swfname="'+swfname+'"  width="50" height="50" />'),scope.commEditor.insertHTML(sFrame,tempHTML)}),20),fCallBack&&fCallBack()},recommNode:sRecommNode,positionNode:sPositionNode||sSortNode,arrPosPix:arrPix||[0,0],sortCount:cfg.sortCount||6,recommCount:cfg.recommCount||8};new App.insertSmilesForm2(smileCfg)};var commEditor=function(frame,area){this.fids=[],this.areas={},this.wins={},this.docs={},this.intervals={},this.actions={}};commEditor.prototype={init:function(sFrame){var doc=this.docs[sFrame];try{doc.body.designMode="on"}catch(e){}doc.open(),doc.writeln(this.getEditorHTML("")),doc.body.contentEditable=!0;var win=doc.parentWindow;Lib.checkAuthor((function(){doc.body.onkeydown=function(e){try{if(9==(e||win.event).keyCode)return $E("login_"+($isLogin?"check":"name")).focus(),!1}catch(err){}},doc.close()}),"insertSmilesFormInit"+(new Date).getTime())},lazyInit:function(fId){var me=this;return function(){var cDoc=me.docs[fId];cDoc.body.getAttribute("inited")||(trace("执行一次:"+fId),me.init(fId),me.bindListener(fId),cDoc.body.setAttribute("inited","yes"))}},append:function(sFrame,sTextarea,actions){(actions=actions||{}).interval||(actions.interval={}),actions.interval.before||(actions.interval.before=function(){}),actions.interval.after||(actions.interval.after=function(){});var frame=$E(sFrame);this.wins[sFrame]=frame.contentWindow,this.actions[sFrame]=actions;var me=this;!function getDoc(){try{me.docs[sFrame]=frame.contentWindow.document,me.areas[sFrame]=$E(sTextarea),$IE?me.docs[sFrame].body.onclick=me.lazyInit(sFrame):me.lazyInit(sFrame)()}catch(e){setTimeout(getDoc,150)}}()},frameFilter:function(body){var val=body.innerHTML;val=(val=(val=(val=(val=val.replace(/<script[\s\S]*<\/script>/gi,"")).replace(/<style[\s\S]*<\/style>/gi,"")).replace(/<!-{2,}[\s\S]*?-{2,}>/g,"")).replace(/<([^>]+).*?>/gi,(function(all,str){switch(str.split(" ")[0].toLowerCase()){case"/p":return"<br>";case"br":return all;case"img":return all.toLowerCase().indexOf("//www.sinaimg.cn/uc/myshow/blog")>0||all.toLowerCase().indexOf("//simg.sinajs.cn/blog7style/images/common")>0?-1==all.toLowerCase().indexOf("t.gif")&&-1==all.toLowerCase().indexOf("img_arrow_r.gif")?"":all:"";default:return""}}))).replace(/\n/g,""),body.innerHTML=val},bindListener:function(sFrame){var frameBody,doc=this.docs[sFrame],area=this.areas[sFrame],win=this.wins[sFrame],actions=this.actions[sFrame],me=this;if($IE&&(doc.onkeydown=function(){var event=win.event;if(8==event.keyCode){var ele=me.getFocusElement(sFrame);ele&&"IMG"==ele.tagName.toUpperCase()&&(ele.parentNode.removeChild(ele),event.keyCode=0,event.returnValue=!1)}}),Core.Events.addEvent(doc.body,(frameBody=doc.body,function(e){me.intervals[sFrame]=setInterval((function(){actions.interval.before(sFrame,area),me.clearFrameHTML(frameBody);for(var imgs=frameBody.getElementsByTagName("img"),i=0;imgs[i];i++)imgs[i].removeAttribute("style"),imgs[i].removeAttribute("height"),imgs[i].removeAttribute("width");actions.interval.after(sFrame,area)}),400)}),"focus"),Core.Events.addEvent(doc.body,(doc.body,function(e){clearInterval(me.intervals[sFrame])}),"blur"),actions.normal)for(var event in actions.normal)Core.Events.addEvent(doc.body,actions.normal[event],event)},clearFrameHTML:function(frameBody){for(var arr=["a","input"],needIt=!1,i=0;arr[i];i++)if(frameBody.getElementsByTagName(arr[i]).length>0){needIt=!0;break}if(needIt)this.frameFilter(frameBody);else{var imgs=frameBody.getElementsByTagName("img");for(i=0;imgs[i];i++){var srcInd=imgs[i].src.indexOf("//www.sinaimg.cn/uc/myshow/blog"),tInd=imgs[i].src.toLowerCase().indexOf("t.g"),playButton=imgs[i].src.indexOf("//simg.sinajs.cn/blog7style/images/common/img_arrow_r.gif");if((-1==srcInd||-1==tInd)&&-1==playButton){this.frameFilter(frameBody);break}}}},getFocusElement:function(fid){if($IE)return(range=this.docs[fid].selection.createRange()).item?range.item(0):range.parentElement();var range,elm=(range=this.win.getSelection().getRangeAt(0)).commonAncestorContainer;return elm.tagName&&"body"==elm.tagName.toLowerCase()?elm:range.collapsed||range.startContainer!=range.endContainer&&range.startContainer!=range.endContainer.parentNode||(range.startOffset,range.endOffset,!range.startContainer.hasChildNodes())?elm.parentNode:range.startContainer.childNodes[range.startOffset]},clearHTML:function(fId){var doc=this.docs[fId];doc.body.innerHTML="",doc.body.setAttribute("contenteditable",!1),doc.body.setAttribute("contenteditable",!0)},insertHTML:function(fId,s_html){$IE&&this.lazyInit(fId)();var win=this.wins[fId],doc=this.docs[fId];if($IE)try{win.focus();var oRang=doc.selection.createRange();if("control"==doc.selection.type.toLowerCase()){var tempRange=doc.body.createTextRange();tempRange.moveToElementText(oRang.item(0)),oRang=tempRange}oRang.pasteHTML(s_html),oRang.collapse(!1),oRang.select()}catch(e){}else!$CHROME&&!$SAFARI||"%0A"!=encodeURIComponent(doc.body.innerHTML)&&""!=doc.body.innerHTML||doc.body.focus(),this.execCommand("insertHTML",s_html,fId),$CHROME||$SAFARI||doc.body.focus()},execCommand:function(cmd,value,fId){var win=this.wins[fId],doc=this.docs[fId];win.focus(),doc.execCommand(cmd,"",value),win.focus()},handleChange:function(fId){var body=this.docs[fId].body;this.areas[fId].value=this.getHandledStr(body)},getHandledStr:function(body){var strArr=[];if(body.hasChildNodes()){body=body.childNodes;for(var i=0;body[i];i++)strArr.push(this.handleDom(body[i]))}else strArr.push(this.handleDom(body));return strArr.join("").replace(/\u00A0/gi," ")},handleDom:function(ele){if(3==ele.nodeType){var val=ele.nodeValue;return Core.String.trim(val)?this.reEscapeHTML(val):""}if(1==ele.nodeType){if(ele.hasChildNodes()&&(1!=ele.childNodes.length||1==ele.childNodes.length&&ele.childNodes[0].tagName)){var strArr=[];if(ele.tagName)"DIV"!=(tN=ele.tagName.toUpperCase())&&"P"!=tN||strArr.push("\n");ele=ele.childNodes;for(var i=0;ele[i];i++)strArr.push(this.handleDom(ele[i]));return strArr.join("")}var tN;if("IMG"!=(tN=ele.tagName.toUpperCase())){if("BR"==tN)return"\n";if("DIV"==tN||"P"==tN){val=ele.innerHTML||"";return"\n"+this.reEscapeHTML(val)}return"SCRIPT"==tN||"STYLE"==tN?"":(val=ele.innerHTML||ele.value||"",this.reEscapeHTML(val))}if(-1==ele.src.indexOf("//www.sinaimg.cn/uc/myshow/blog"))return"";if(-1==ele.src.indexOf("T.g"))return"";var nCode=ele.src.split("T.g")[0];nCode=nCode.substring(nCode.lastIndexOf("/")+1,nCode.length);var sName=ele.getAttribute("title"),swfname=ele.getAttribute("swfname");if(swfname||"W"!=nCode[0]||(swfname=nCode+"S.swf"),sName)return swfname?"[magicemoticons="+nCode+" swfname="+swfname+"]"+sName+"[/magicemoticons]":"[emoticons="+nCode+"]"+sName+"[/emoticons]"}return""},reEscapeHTML:function(str){return str=(str=(str=(str=(str=(str=str.replace(/\n/g,"")).replace(/&nbsp;/g," ")).replace(/&quot;/g,'"')).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&")},getEditorHTML:function(sContent){var html="";return html+="<html>",html+="<head>",html+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',html+="<style>\t\tp {\t\t\t*margin:0.2em auto;\t\t}\t\tbody {\t\t\tmargin: 0;\t\t\tscrollbar-face-color: #ffffff;\t\t\tscrollbar-highlight-color: #ffffff;\t\t\tscrollbar-shadow-color: #c0c1bb;\t\t\tscrollbar-3dlight-color: #c0c1bb;\t\t\tscrollbar-arrow-color: #c9cbb6;\t\t\tscrollbar-track-color: #f4f5f0;\t\t\tscrollbar-darkshadow-color: #ffffff;\t\t\tscrollbar-base-color: #ffffff;\t\t\tpadding: 10px;\t\t\tword-wrap: break-word;\t\t\toverflow: scroll;\t\t\toverflow-x: auto;\t\t\theight: 90%;\t\t\tfont-size: 14px;\t\t}\t\tbody, td, textarea, input, br, div, span{\t\t\tfont-family: '', Verdana,Arial, Helvetica, sans-serif;\t\t\tline-height:1.5;\t\t}\t\timg{\t\t\tborder: 0;\t\t}\t\thtml{\t\t\theight: 100%;\t\t\tcursor: text;\t\t}\t\tpre{\t\t\twhite-space:normal;\t\t}\t\tform{margin: 0;}\t\tbody table{font-size: 14px;}\t\t.border{ border:1px dashed #cfcfcf;}\t\t</style>\t\t<script>document.domain='sina.com.cn';<\/script>\t\t",html+="</head>",html+="<body>",html+=sContent,html+="</body>",html+="</html>"}},App.smilesTemplate=['<table id="#{entity}" class="CP_w faceItemContent" style="visibility: visible;">','<thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">插入表情</strong><cite><a id="#{btnClose}"',' href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th></tr></thead>','<tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td>','<td class="tRight"><span></span></td></tr></tfoot>',"<tbody><tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="insertface">','<div class="insertface_top">','<h3>热门动漫表情</h3><div class="insertface_search">','<input id="#{searchText}" type="text" class="SG_input" value="输入关键字、动漫形象"',' style="color:#9b9b9a;" maxlength="20" /><a id="#{searchBtn}" href="#" onclick="return false;" ','hidefocue="true" class="SG_aBtn SG_aBtnB"><cite>查找表情</cite></a></div>','<div class="clearit"></div>',"</div>",'<div class="insertface_hot">','<span class="insertface_keyword">热门关键字：<span id="#{hotKeyword}"></span></span>','<span class="insertface_hotslider"></span>',"</div>",'<div class="bigface">','<div class="faceSidebar">','<div id="#{keyCtrl}" class="facekeyword" style="display:none;">','<p><< <a id="#{keyCtrlBack}" href="#" onclick="return false;">返回全部关键字</a></p>','<p>关键字：<span id="#{keyWord}"></span></p></div>','<h3 id="#{allSort}" class="facetitle" style="font-weight:600;"><a href="#"',' onclick="return false;">全部</a></h3>','<div id="#{sortList}" class="facelist"></div>','<div id="#{sortCtrl}" class="facearrow"></div>',"</div>",'<div class="faceShowAll">','<div id="#{smileEmpty}" class="faceShownone" style="display:none;"><p>找不到和关键字相符的表情。','<br /><br /><a id="#{smileEmptyBack}" href="#" onclick="return false;">&lt;&lt;返回首页</a></p></div>','<ul class="faceShowAll_list" id="#{smileList}"></ul>','<div class="SG_page"><ul class="SG_pages">','<li id="#{smilePagePrev}" class="SG_s_pgprev"></li>','<li id="#{smilePageShow}" class="SG_s_pgnum"></li>','<li id="#{smilePageNext}" class="SG_s_pgnext"></li>',"</ul></div>","</div>","</div>","</div>",'</td><td class="tRight"><span></span></td>',"</tr></tbody></table>"].join(""),App.smilesDialog=Core.Class.create(),App.smilesDialog.prototype={pageSize:24,defaultConfig:{sortId:"0",htmlTpl:App.smilesTemplate,callback:function(){}},initialize:function(oOption){for(var key in this.option=oOption||{},this.defaultConfig)null==this.option[key]&&(this.option[key]=this.defaultConfig[key]);if(this.dialog=new Dialog(this.option.htmlTpl),this.dialogNodes=this.dialog.getNodes(),this.getKeyWord(),null!=scope.smilesData)this.data=scope.smilesData,this.dataSettle(),this.eventListen();else{var __this=this;Utils.Io.JsLoad.request([{url:"//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(oData){scope.smilesData=oData,__this.data=oData,__this.dataSettle(),__this.eventListen()},onException:function(){}})}return this},dataSettle:function(oData,nCount){for(var key in oData=oData||this.data,nCount=nCount||9,this.tabsData=[],this.allData=[],oData){var _item=oData[key];_item.sortId=key,this.tabsData.push(_item);for(var i=0,len=_item.data.length;i<len;i++)_item.data[i].sid=key,_item.data[i].sname=_item.name;this.allData=this.allData.concat(_item.data)}null==this.allDataBack&&(this.allDataBack=this.allData.slice(0)),this.showTab(1,nCount),0==this.dialogNodes.smileList.childNodes.length&&this.showAll()},children:function(chs){for(var cArr=[],i=0;chs[i];i++)1==chs[i].nodeType&&cArr.push(chs[i]);return cArr},showTab:function(nPage,nCount){nPage=nPage||1,nCount=nCount||9,this.dialogNodes.sortList.innerHTML="",this.dialogNodes.smileList.innerHTML="",Core.Dom.setStyle(this.dialogNodes.sortList,"height",9==nCount?"279px":"217px"),this.tabs=new Tabs(this.dialogNodes.sortList),this.tabsObject={};for(var _this=this,i=0;i<nCount;i++){var _indexBase=(nPage-1)*nCount;if(null==this.tabsData[_indexBase+i])break;var _sortId=this.tabsData[_indexBase+i].sortId,_name=this.tabsData[_indexBase+i].name,_data=this.tabsData[_indexBase+i].data,tab=new Tab('<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_sortId+'.gif" height="20" width="20" align="absmiddle"><span><a href="#" onclick="return false;">'+_name+"</a></span><em>("+_data.length+")</em>",{isFocus:!1,className:"cur"});tab.addOnAbort(Core.Function.bind3((function(tab){}),null,[tab])),tab.addOnFocus(Core.Function.bind3((function(tab,key,data,sid){if(_this.showSmile(data,1,_this.pageSize),_this.currentTab=tab,_this.dialogNodes.allSort.style.fontWeight=400,!_this.isFromUp){var pId=scope.$pageid;if(pId){var isComm=scope.isFromtheCommonhzh;isComm&&v7sendLog($_GLOBAL.faceChooseTable[pId][isComm]+"_16_020_"+sid,pId,"")}}_this.isFromUp=null}),null,[tab,_indexBase+i,_data,_sortId])),this.tabsObject[_sortId]=tab,this.tabs.add(tab)}var _tabPageCount=Math.ceil(this.tabsData.length/nCount);_tabPageCount>0?this.showTabPage(nPage||1,_tabPageCount,nCount):this.dialogNodes.sortCtrl.innerHTML=""},showSmile:function(oData,nPage,nCount){nCount=nCount||this.pageSize;var _pageLink,__this=this,_smiles=oData,_count=_smiles.length,_totalPages=Math.ceil(_count/nCount),_smilesDom=document.createDocumentFragment();this.dialogNodes.smileList.innerHTML="";for(var i=0;i<nCount;i++){var _smile=_smiles[(nPage-1)*nCount+i];if(null==_smile)break;var _li=$C("li"),_a=$C("a");_a.href="#",_a.onclick=function(){return!1},_a.onmousedown=Core.Function.bind3((function(nCode,sName){__this.option.callback(nCode,sName),__this.hide()}),null,[_smile.code,_smile.name]),_a.innerHTML='<img style="width:50px;height:50px;" src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_smile.code+'T.gif" alt="'+_smile.name+'" title="'+_smile.name+'" />',_li.appendChild(_a),_a.setAttribute("key",_smile.code);var _span=$C("span");_span.title=_smile.name,_span.innerHTML=Core.String.byteLength(_smile.name)>8?Core.String.leftB(_smile.name,6)+"…":_smile.name,_li.appendChild(_span),_smilesDom.appendChild(_li),Core.Events.addEvent(_a,function(ele){return function(){var pId=scope.$pageid;if(pId){var isComm=scope.isFromtheCommonhzh;isComm&&v7sendLog($_GLOBAL.faceChooseTable[pId][isComm]+"_16_010_"+ele.getAttribute("key"),pId,"")}}}(_a),"mousedown")}this.dialogNodes.smileList.appendChild(_smilesDom),_count>nCount?(1==nPage?this.dialogNodes.smilePagePrev.innerHTML="上一页":(this.dialogNodes.smilePagePrev.innerHTML="",(_pageLink=$C("a")).href="#",_pageLink.onclick=function(){return!1},_pageLink.onmousedown=function(){__this.showSmile(_smiles,nPage-1,nCount)},_pageLink.innerHTML="上一页",this.dialogNodes.smilePagePrev.appendChild(_pageLink)),this.dialogNodes.smilePageShow.innerHTML=nPage+"/"+_totalPages,nPage>=_totalPages?this.dialogNodes.smilePageNext.innerHTML="下一页":(this.dialogNodes.smilePageNext.innerHTML="",(_pageLink=$C("a")).href="#",_pageLink.onclick=function(){return!1},_pageLink.onmouseup=function(){__this.showSmile(_smiles,nPage+1,nCount)},_pageLink.innerHTML="下一页",this.dialogNodes.smilePageNext.appendChild(_pageLink))):(this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="")},showTabPage:function(nPageNum,nPageCount,nTabsPerPage){this.dialogNodes.sortCtrl.innerHTML="",this.dialogNodes.smilePagePrev.innerHTML="",this.dialogNodes.smilePageShow.innerHTML="",this.dialogNodes.smilePageNext.innerHTML="";var _arrow,__this=this;1==nPageNum?nPageNum!=nPageCount&&(this.dialogNodes.sortCtrl.innerHTML='<a href="#" onclick="return false;" title="向上" class="up_off"></a>',(_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向下",_arrow.className="down",_arrow.onmousedown=function(){__this.showTab(nPageNum+1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow)):nPageNum<nPageCount?((_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向上",_arrow.className="up",_arrow.onmousedown=function(){__this.showTab(nPageNum-1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow),(_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向下",_arrow.className="down",_arrow.onmousedown=function(){__this.showTab(nPageNum+1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow)):((_arrow=$C("a")).href="#",_arrow.onclick=function(){return!1},_arrow.title="向上",_arrow.className="up",_arrow.onmousedown=function(){__this.showTab(nPageNum-1,nTabsPerPage),__this.showAll()},this.dialogNodes.sortCtrl.appendChild(_arrow),Core.Dom.addHTML(this.dialogNodes.sortCtrl,'<a href="#" onclick="return false;" title="向下" class="down_off"></a>'))},eventListen:function(){var __this=this,_searchText=__this.dialogNodes.searchText,_searchBtn=__this.dialogNodes.searchBtn,_keywordBack=__this.dialogNodes.keyCtrlBack,_allSort=__this.dialogNodes.allSort,_smileEmptyBack=__this.dialogNodes.smileEmptyBack;Core.Events.addEvent(document.body,(function(cls){var _event=Core.Events.getEvent(),_eventTarget=$IE?_event.srcElement:_event.target;null==__this.dialogNodes.entity||0!=Core.Dom.contains(__this.dialogNodes.entity,_eventTarget)&&1!=cls||__this.hide()})),Core.Events.addEvent(this.dialogNodes.btnClose,(function(){__this.hide()})),Core.Events.addEvent(_searchText,(function(){"输入关键字、动漫形象"==Core.String.trim(_searchText.value)&&(_searchText.value="",_searchText.style.color="#000"),_searchText.select()}),"focus"),Core.Events.addEvent(_searchText,(function(){""==Core.String.trim(_searchText.value)&&(_searchText.value="输入关键字、动漫形象",_searchText.style.color="#9b9b9a")}),"blur"),Core.Events.addEvent(_searchText,(function(e){var _evt=Core.Events.getEvent(),_key=_evt.which||_evt.keyCode,_keyword=Core.String.trim(_searchText.value);13==_key&&""!=_keyword&&__this.searchKey(_keyword)}),"keydown"),Utils.Form.limitMaxLen(_searchText,20),Core.Events.addEvent(_searchBtn,(function(){"输入关键字、动漫形象"==_searchText.value||""==_searchText.value||(__this.searchKey(_searchText.value),_searchText.focus())}));var _backHome=function(){__this.dataSettle(__this.data,9),__this.dialogNodes.keyCtrl.style.display="none",__this.dialogNodes.smileEmpty.style.display="none",__this.dialogNodes.smileList.style.display="",__this.dialogNodes.searchText.value="输入关键字、动漫形象",__this.dialogNodes.searchText.style.color="#9b9b9a"};Core.Events.addEvent(_keywordBack,_backHome),Core.Events.addEvent(_smileEmptyBack,_backHome),Core.Events.addEvent(_allSort,(function(){__this.showAll()}))},showAll:function(){this.showSmile(this.allData,1,this.pageSize),this.dialogNodes.allSort.style.fontWeight=600,null!=this.currentTab&&this.currentTab.setAbort()},setSort:function(sId,fCallback){this.isFromUp=sId,this.option.sortId=sId,this.option.callback=fCallback,0==sId?(this.dialogNodes.allSort.style.fontWeight=600,this.dataSettle()):(this.dataSettle(),this.tabs.swapTags(this.tabsObject[sId]))},getKeyWord:function(){if(null==this.keywordData){var __this=this;Utils.Io.JsLoad.request("//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileKeywordConfig.js?varname=smileKeywordConfig&rnd="+Math.random(),{onComplete:function(oData){__this.keywordData=oData;for(var _hotkey=oData.E___00000000000||"顶|路过|哭|啦啦|美女",_hotDom=document.createDocumentFragment(),i=0,len=(_hotkey=_hotkey.split("|")).length;i<len;i++){var _link=$C("a");_link.href="#",_link.onclick=function(){return!1},_link.onmousedown=Core.Function.bind3((function(sHotkey){__this.searchKey(sHotkey)}),null,[_hotkey[i]]),_link.innerHTML=_hotkey[i],_hotDom.appendChild(_link)}""==__this.dialogNodes.hotKeyword.innerHTML&&__this.dialogNodes.hotKeyword.appendChild(_hotDom);var _hotKeyAll="";for(var key in oData)"E___00000000000"!=key&&(_hotKeyAll+="∑"+key+"§"+oData[key]);__this.keywordStr=_hotKeyAll},onException:function(){}})}},searchKey:function(sHotkey){var _regSearchKey=sHotkey.replace(/([\\^$*+?{}.|])/gi,"\\$1"),searchReg=new RegExp("∑([^§]+)§[^∑]*"+_regSearchKey+"[^∑]*","gi"),_resultArray=[];this.keywordStr.replace(searchReg,(function(a,b){_resultArray.push(b)})),_resultArray=_resultArray.join(",");for(var _result={},_allData=this.allDataBack,_len=_allData.length,_count=0,i=0;i<_len;i++)-1==_resultArray.indexOf(_allData[i].code)&&-1==_allData[i].sname.indexOf(sHotkey)&&-1==_allData[i].name.indexOf(sHotkey)||(null==_result[_allData[i].sid]&&(_result[_allData[i].sid]={name:_allData[i].sname,data:[]}),_result[_allData[i].sid].data.push(_allData[i]),_count++);var isComm,pid=scope.$pageid;0==_count?(this.dialogNodes.smileEmpty.style.display="",this.dialogNodes.smileList.style.display="none",pid&&(isComm=scope.isFromtheCommonhzh)&&v7sendLog($_GLOBAL.faceChooseTable[pid][isComm]+"_16_030_"+encodeURIComponent(sHotkey),pid,"")):(this.dialogNodes.smileList.style.display="",this.dialogNodes.smileEmpty.style.display="none",pid&&(isComm=scope.isFromtheCommonhzh)&&v7sendLog($_GLOBAL.faceChooseTable[pid][isComm]+"_16_031_"+encodeURIComponent(sHotkey),pid,""));this.dataSettle(_result,7),this.dialogNodes.keyCtrl.style.display="",this.dialogNodes.keyWord.innerHTML=sHotkey.split("").join("<wbr/>"),Core.Dom.setStyle(this.dialogNodes.sortList,"height","217px")},setPosition:function(x,y){this.x=x,this.y=y,this.dialog.setPosition({x:x,y:y})},show:function(){this.dialogNodes.searchText.value="输入关键字、动漫形象",this.dialogNodes.searchText.style.color="#9b9b9a",this.dialog.show()},hide:function(){this.dialog.hidden(),this.dialogNodes.keyCtrl.style.display="none"}},App.insertSmilesForm=Core.Class.create(),App.insertSmilesForm.prototype={defalutConfig:{sortCount:6,clickCallback:function(){},recommCount:8},initialize:function(oOption){if(this.option=oOption||{},null!=this.option.sortNode){for(var key in this.defalutConfig)null==this.option[key]&&(this.option[key]=this.defalutConfig[key]);null==scope.smilesData?this.getSmilesData():(this.data=scope.smilesData,this.renderUI())}},getSmilesData:function(){var __this=this;Utils.Io.JsLoad.request([{url:"//www.sinaimg.cn/uc/myshow/blog/misc/gif/smileConfig.js?varname=smileConfig",charset:"GBK"}],{onComplete:function(oData){scope.smilesData=oData,__this.data=oData,__this.renderUI()},onException:function(){}})},renderUI:function(){var firstSort,__this=this,count=1,_fragement=document.createDocumentFragment(),_sorts=$C("div"),_more=$C("span"),_clearit=$C("div");for(var key in _sorts.className="facestyle",this.data){if(1==count&&(firstSort=(firstSort=this.data[key]||{data:{}}).data),!(count<=this.option.sortCount))break;var _title=this.data[key].name,node=$C("a");node.href="#",node.setAttribute("key",key),node.onclick=function(){return Core.Events.stopEvent(),!1},node.onmousedown=Core.Function.bind3((function(key){App.insertSmilesDialog(key,__this.option.clickCallback,__this.option.positionNode,__this.option.arrPosPix)}),null,[key]),node.hideFocus=!0,node.innerHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+key+'-25.gif" alt="'+_title+'" title="'+_title+'" />',_sorts.appendChild(node),count++}var timpStamp=(new Date).getTime();_sorts.id="recomm_"+timpStamp,_fragement.appendChild(_sorts),_more.className="SG_more";var ele,_morelink=$C("a");if(_morelink.href="#",_morelink.onclick=function(){return Core.Events.stopEvent(),!1},_morelink.onmousedown=(ele=_morelink,function(){App.insertSmilesDialog(0,__this.option.clickCallback,__this.option.positionNode,__this.option.arrPosPix);var pid=scope.$pageid;if(pid){var ppId=ele.parentNode.parentNode.id.split("_")[0];ppId&&(scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[pid][ppId][1],v7sendLog($_GLOBAL.faceCountMoreLinkTable[pid][ppId][0]+"_07_000_000",pid,""))}}),_morelink.innerHTML="更多>>",_more.appendChild(_morelink),_fragement.appendChild(_more),_clearit.className="clearit",_fragement.appendChild(_clearit),$E(this.option.sortNode).appendChild(_fragement),null!=$E(this.option.recommNode)){_fragement=document.createDocumentFragment();for(var i=0;i<this.option.recommCount;i++){_title=firstSort[i].name;var _code=firstSort[i].code;(node=$C("a")).href="#",function(val){node.onclick=Core.Function.bind3((function(key,title){__this.option.clickCallback(key,title);var pid=scope.$pageid;return pid&&(val=1==(val+="").length?"0"+val:val,v7sendLog($_GLOBAL.faceCountRecommLinkTable[pid]+"_"+val+"_010_"+key,pid,"")),Core.Events.stopEvent(),!1}),null,[_code,_title])}(i+8),node.hideFocus=!0,node.innerHTML='<img src="//www.sinaimg.cn/uc/myshow/blog/misc/gif/'+_code+'T.gif" alt="'+_title+'" title="'+_title+'" />',_fragement.appendChild(node)}$E(this.option.recommNode).appendChild(_fragement)}var _sChildren=Lib.children($E("recomm_"+timpStamp).childNodes);for(i=0;_sChildren[i];i++)Core.Events.addEvent(_sChildren[i],function(ele,val){return function(){var pid=scope.$pageid;if(pid){var ppId=ele.parentNode.parentNode.id.split("_")[0];ppId&&(scope.isFromtheCommonhzh=$_GLOBAL.faceCountMoreLinkTable[pid][ppId][1],v7sendLog($_GLOBAL.faceCountMoreLinkTable[pid][ppId][0]+"_0"+val+"_020_"+ele.getAttribute("key"),pid,""))}}}(_sChildren[i],i+1),"mousedown");count=firstSort=_fragement=_sorts=_more=_morelink=_clearit=_code=key=_title=node=null}},Lib.children=function(chs){for(var cArr=[],i=0;chs[i];i++)1==chs[i].nodeType&&cArr.push(chs[i]);return cArr},App.insertSmilesDialog=function(sSortId,fCallback,sPositionNode,arrPosiPix){App.insertSmilesDialog.callback=fCallback,null==scope.smileDialog&&(scope.smileDialog=new App.smilesDialog),scope.smileDialog.setSort(sSortId,fCallback);var xy=Core.Dom.getXY($E(sPositionNode)),x=xy[0]+arrPosiPix[0],y=xy[1]+arrPosiPix[1];scope.smileDialog.setPosition(x,y),scope.smileDialog.show()},App.formInsertSmile=function(sTextarea,sSortNode,sRecommNode,fCallBack,sPositionNode,arrPix){var _oTextNode=$E(sTextarea),getPos=function(){_oTextNode.createTextRange&&(_oTextNode.caretPos=document.selection.createRange().duplicate())};Core.Events.addEvent(_oTextNode,getPos,"keyup"),Core.Events.addEvent(_oTextNode,getPos,"focus"),Core.Events.addEvent(_oTextNode,getPos,"select"),Core.Events.addEvent(_oTextNode,getPos,"click"),new App.insertSmilesForm({sortNode:sSortNode,clickCallback:function(nCode,sName){var faceValue="[emoticons="+nCode+"]"+sName+"[/emoticons]";if($IE)if(_oTextNode.createTextRange&&_oTextNode.caretPos){var caretPos=_oTextNode.caretPos;caretPos.text=" "==caretPos.text.charAt(caretPos.text.length-1)?faceValue+" ":faceValue,_oTextNode.focus()}else _oTextNode.value+=faceValue,_oTextNode.focus();else if(_oTextNode.setSelectionRange){var rangeStart=_oTextNode.selectionStart,rangeEnd=_oTextNode.selectionEnd,tempStr1=_oTextNode.value.substring(0,rangeStart),tempStr2=_oTextNode.value.substring(rangeEnd);_oTextNode.value=tempStr1+faceValue+tempStr2}else _oTextNode.value+=faceValue;fCallBack&&fCallBack()},recommNode:sRecommNode,positionNode:sPositionNode||sSortNode,arrPosPix:arrPix||[0,0]})},Core.Dom.removeParentNode=function(node){var parentNode=(node=$E(node)).parentNode;Core.Dom.insertAfter(node,parentNode),parentNode.parentNode.removeChild(parentNode)},TweenStrategyEx=function(startValue,endValue,duration,motion){this.startValue=startValue||[],this.endValue=endValue||[],this.duration=duration||0,this.motion=motion||Ui.Transition.simple,this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:!1,addEventListener:function(type,handle){return this.__eventDispatcher.addEventListener(type,handle),this},removeEventListener:function(type,handle){return this.__eventDispatcher.removeEventListener(type,handle),this},start:function(){if(!this._isTweenning){this._isTweenning=!0;var t,me=this,sv=this.startValue,ev=this.endValue,d=this.duration,value=[],startTime=(new Date).getTime();return this._itvID=window.setInterval((function(){(t=((new Date).getTime()-startTime)/1e3)>me.duration&&(t=me.duration);for(var i=0;i<sv.length;i++)value[i]=me.motion(t,sv[i],ev[i]-sv[i],d);me.onTween&&me.onTween(value),me.__eventDispatcher.dispatchEvent("tween",value),t==me.duration&&me.stop()}),25),this}},stop:function(){return window.clearInterval(this._itvID),this._isTweenning=!1,this.onEnd&&this.onEnd(),this.__eventDispatcher.dispatchEvent("end"),this},onTween:function(value){},onEnd:function(){}}),Core.Events.getEventTarget=function(ev){return ev=ev||Core.Events.getEvent(),Core.Events.fixEvent(ev),ev.target},Comment2TSina=Core.Class.create(),Comment2TSina.prototype={anonyous:!1,data:null,initialize:function(anonyous,data){this.anonyous=anonyous||!1,this.data=data||{},scope.$temp_commCtt=this.data.weibo_content,scope.$temp_commId=this.data.blog_id},writeCommTips:function(){if($E("bb")){var tips=$E("writeComm_tips");if(!tips){var tips_box=$C("div");tips_box.className="writeComm_tips_box",tips_box.style.display="none",tips_box.innerHTML='<span class="writeComm_tips" id="writeComm_tips"><strong></strong><cite><a href="javascript:;">关闭</a></cite></span>';var writeComm=Core.Dom.byClz(document,"div","writeComm");if(!writeComm)return;writeComm[0].insertBefore(tips_box,writeComm[0].childNodes[0]),tips=tips_box.firstChild,Core.Events.addEvent(tips.lastChild,(function(){tips_box.style.display="none"}),"click"),this.bindTipsEvents(tips)}var tbox=tips.parentNode,content=tips.firstChild;tbox.style.display="none",this.anonyous||$E("anonymity")&&$E("anonymity").checked||"no_blog"===this.data.re_weibo?(content.innerHTML='评论发表成功，<a href="javascript:void(0);">点此还可以同步到微博，分享给我的粉丝。</a>',tbox.style.display="block"):"success"===this.data.re_weibo?(content.innerHTML='评论成功同步到微博，<a href="//weibo.com/'+this.data.t_sina+'/profile" target="_blank">点此查看</a>',tbox.style.display="block"):"no_bind"===this.data.re_weibo&&(content.innerHTML='评论分享失败，您需要先<a href="javascript:void(0);">绑定微博</a>',tbox.style.display="block")}},bindTipsEvents:function(tips){Core.Events.addEvent(tips.firstChild,function(event){if(Core.Events.stopBubble(event),"a"==Core.Events.getEventTarget(event).tagName.toLowerCase()){var txt=tips.firstChild.lastChild.innerHTML;"点此查看"===txt?tips.parentNode.style.display="none":"绑定微博"===txt?($E("writeComm_tips").parentNode.style.display="none",this.bindToTSina()):1==checkUserProduct.flag?this.openStep():this.shareToT()}}.bind2(this),"click")},openStep:function(){var me=this;Utils.Io.Ijax.request("//control.blog.sina.com.cn/riaapi/tshow/send_cms_weibo.php",{POST:{uid:$UID,blog_id:scope.$temp_commId,content:scope.$temp_commCtt,isphoto:0},onComplete:function(data){if(data=eval("("+data+")")||{},"A00006"===data.code){var tips=$E("writeComm_tips");tips.parentNode.style.display="block",tips.firstChild.innerHTML='评论成功同步到微博，<a href="//weibo.com/'+data.data+'/profile" target="_blank">点此查看</a>'}else"B00001"===data.code?winDialog.alert("您的博客还未绑定新浪微博，现在绑定？",{icon:"04",funcOk:function(){me.bindToTSina()}}):"A00004"===data.code||"A11007"===data.code?me.shareToT():winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})},onException:function(msg,url){winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}})},bindToTSina:function(){var me=this,url="//control.blog.sina.com.cn/t_sina_blog/bind_weibo_form.php?from=js&domain="+document.domain;window.open(url,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),window.tOkBack=function(){trace("微博绑定回调ok函数！"),winDialog.alert("绑定微博成功",{icon:"03",funcOk:function(){me.openStep()},funcClose:function(){me.openStep()}})},window.tFailBack=function(){trace("微博绑定 fail"),winDialog.alert("网络繁忙，请稍后再试。",{icon:"01"})}},shareToT:function(){var shareWord=scope.$temp_commCtt;if(shareWord){var u="//v.t.sina.com.cn/share/share.php?searchPic=false&title="+encodeURIComponent(shareWord)+"&url="+encodeURIComponent(document.location)+"&source=新浪-博客&sourceUrl="+encodeURIComponent("//blog.sina.com.cn")+"&content=utf-8&appkey=1617465124";window.open(u,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2)}else winDialog.alert("分享的内容不能为空",{icon:"01"});$E("writeComm_tips").parentNode.style.display="none"}};var checkUserProduct={isinit:!1,func:null,product:"",flag:!0,getReturn:function(name){this.flag=!0,this.func()},check:function(name,func){this.product=name,this.func=func||function(){},this.getReturn(name)}};function rockIt(node,startPos,endPos,rounds,duration,mode,func){if(node){var uid=_getNodeUid(node);uid||node.setAttribute("rotationId",uid=_getNodeUid());var inst=rockIt.instances||(rockIt.instances={});inst[uid]&&_destroy(uid);var transitions=Ui.Transition;window.$transitions=transitions,"function"==typeof func.begin&&func.begin(),node.style.position="absolute",document.body.appendChild(node),inst[uid]={node:node,startPos:startPos,endPos:endPos,round:rounds,func:func,sTime:+new Date,duration:duration,mode:mode||"simple",degree:0,timer:0},inst[uid].timer=setInterval((function(){var dt=+new Date;inst[uid].sTime+inst[uid].duration<dt?(_renderNode(uid,inst[uid].duration),"function"==typeof func.end&&func.end({clear:_clearStyle}),_destroy(uid)):_renderNode(uid,dt-inst[uid].sTime)}),15)}function _getNodeUid(node){return node?node.getAttribute("rotationId"):parseInt(1e4*Math.random())+ +new Date}function _destroy(uid){for(var key in clearInterval(inst[uid].timer),inst[uid])delete inst[uid][key];delete inst[uid]}function _renderNode(uid,t){var trans=transitions[inst[uid].mode],obj=inst[uid],nodeStyle=obj.node.style,d=obj.duration,b=obj.startPos[0],c=obj.endPos[0]-obj.startPos[0];nodeStyle.left=trans(t,b,c,d)+"px",b=obj.startPos[1],c=obj.endPos[1]-obj.startPos[1],nodeStyle.top=trans(t,b,c,d)+"px",b=0,c=0==obj.round||t==d?0:2*Math.PI*obj.round,function(node,deg){costheta=Math.cos(deg),sintheta=Math.sin(deg),$IE?node.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+costheta+",M12="+-sintheta+",M21="+sintheta+",M22="+costheta+',SizingMethod="auto expand")':$FF?node.style.MozTransform="matrix("+costheta+", "+sintheta+", "+-sintheta+", "+costheta+", 0, 0)":/WebKit/i.test(navigator.userAgent)&&(node.style.WebkitTransform="matrix("+costheta+", "+sintheta+", "+-sintheta+", "+costheta+", 0, 0)")}(obj.node,trans(t,b,c,d))}function _clearStyle(){var style=inst[uid].node.style;style.position="",style.left="",style.top=""}}CommentV2.formatTime=function(time){var s=new Date;time&&s.setTime(s);var month=s.getMonth()+1>=10?s.getMonth()+1:"0"+(s.getMonth()+1),date=s.getDate()>=10?s.getDate():"0"+s.getDate();time=(new Date).toTimeString().split(" ")[0];return s.getFullYear()+"-"+month+"-"+date+" "+time},CommentV2.Post=Core.Class.create(),CommentV2.Post.prototype={articleid:0,totle:0,anonyous:!1,onSuccess:new Function,onError:new Function,initialize:function(){},post:function(data){try{this.data=data,this.data.article_id=this.articleid,this.data.uid=$isLogin?$UID:"",this.data.fromtype="commentadd",this.data.anonymity=this.data.anonymity||this.anonyous||!1,this.data.anonymity&&(this.data.login_name=this.data.comment_anonyous);var _this=this;Lib.checkAuthor((function(){$isLogin?(_this.data.login_name=$nick,_this.postComment(_this.data)):_this.anonyous?_this.postComment(_this.data):($E("login_remember")&&(_this.data.login_remember?v7sendLog("48_01_37_1"):v7sendLog("48_01_37_0")),new Lib.Login.LoginPost(function(res){Lib.checkAuthor((function(){if($isLogin)_this.data.login_name=$nick,_this.postComment(_this.data),_this.renderLogin();else{if(res&&res.errno&&("4049"===res.errno||"2070"===res.errno))return void _this.loginNeedSafeCode(res);winDialog.alert(res&&res.reason||"登录名或密码错误！",{icon:"02"}),_this.refreshCKIMG(),$E("commentloginM").style.display="none",$E("commentlogin").style.display="block",$E("commentNick").style.display="",$E("commentNick").innerHTML="",$E("anonymity_cont")&&($E("anonymity").checked=!1,$E("anonymity_cont").style.display="none")}}),"post"+(new Date).getTime())}.bind2(_this),!1,"referer:"+location.hostname+location.pathname+",func:0001").login(data.login_name,data.login_pass,1==data.login_remember?15:0))}),"post"+(new Date).getTime())}catch(e){trace(e)}},renderLogin:function(){$tray.renderLogin(),$E("commentlogin").style.display="none";var _this=this,commentNick=$E("commentNick"),showNickPlace=function(){1==checkUserProduct.flag?scope.setNickTime=setInterval((function(){var vHTML=Lib.blogv.getVHTML(scope.loginUserWtype);"undefined"==typeof scope.$loginNick?(Lib.Uic.getNickName([$UID],(function(oResult){for(var key in oResult)scope.$loginNick=oResult[key],commentNick.innerHTML=scope.$loginNick+"&nbsp;"+vHTML+":",commentNick.style.display=""})),clearInterval(scope.setNickTime)):commentNick.innerHTML=scope.$loginNick+"&nbsp;"+vHTML+":"}),500):_this._showOpenBlogInfo()};""==commentNick.innerHTML&&(0==checkUserProduct.isinit?window.checkuserinterval=setInterval((function(){0==checkUserProduct.isinit?checkUserProduct.check("blog",showNickPlace):clearInterval(window.checkuserinterval)}),500):showNickPlace()),$E("anonymity_cont")&&($E("anonymity_cont").style.display="")},_showOpenBlogInfo:function(){for(var child=$E("commentNick").firstChild;child;child=child.nextSibling)$E("commentNick").removeChild(child);$E("commentNick").style.display="",$E("commentNick").innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>',scope.addBlogOpenerEvent($E("openblog-li")),$E("anonymity")&&($E("commentloginM").style.display="",$E("anonymity").checked=!0,$E("quote_comment_p").style.display="none");var nickNameTime=setInterval((function(){scope.nickname&&($E("openblog-nickname").innerHTML=scope.nickname+"：",clearInterval(nickNameTime))}),500)},postComment:function(data){v7sendLog("32_01_19");var startTime=(new Date).getTime(),_this=this;(function(result){if("string"==typeof result&&(result=result.replace(/;$/,"")),null==(result="string"==typeof result&&/\s*{/.test(result)?Core.String.j2o(result):result)||"undefined"!=typeof result.code){var _this=this;if("A00006"==result.code){if(v7sendLog("45_01_12_"+scope.$uid),result=result.data,data.is_mobile){"N"===result.insertid.charAt(0)&&(result.insertid=result.insertid.slice(1));var tsina=result.t_sina;tsina&&"N"===tsina.charAt(0)&&(result.t_sina=tsina.slice(1))}Lib.checkAuthor((function(){var str=$E("c_"+scope.$articleid).innerHTML,num=parseInt(/(\d+)/.exec(str)[0],10);num++,$E("c_"+_this.articleid).innerHTML="("+num+")",$isLogin&&_this.renderLogin(),_this.addNewComment(data,result);var c2s=new Comment2TSina(_this.anonyous,result);$E("bb")&&$E("bb").checked&&v7sendLog("32_01_18"),c2s.writeCommTips(),_this.onSuccess(),$E("comment_get_vcode")&&Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}),"post_option"+(new Date).getTime())}else v7sendLog("32_01_21"),this.refreshCKIMG(),"B36113"==result.code?winDialog.alert("博主已关闭匿名评论，请登录后再评论",{funcOk:function(){$E("anonymity_cont")&&($E("anonymity_cont").checked=!1,$E("anonymity_cont").style.display="none"),$E("commentlogin").style.display="",$E("commentloginM").style.display="none"}}):"B36002"==result.code?winDialog.alert($SYSMSG.B36002,{funcOk:function(){$E("login_check").value="",$E("login_check").focus()}}):showError(result.code),null!=result.code&&Lib.checkAuthor((function(){$isLogin||($E("anonymity_cont")&&($E("anonymity").checked=!1,$E("anonymity_cont").style.display="none"),1==$E("anonymity").checked?($E("commentloginM").style.display="block",$E("anonymity").checked="checked"):($E("commentloginM").style.display="none",$E("commentlogin").style.display="block"),$E("commentNick").innerHTML="",$isLogin=!1,_this.anonyous=!0)}),"post_option"+(new Date).getTime())}else trace("接口数据异常："+this.url,"#F00")}).bind2(this),function(result){var nTime;v7sendLog("32_01_21"),(nTime=-1)||(nTime=(new Date).getTime()-startTime),Utils.Io.JsLoad.request("//control.blog.sina.com.cn/admin/article/ria_debug.php",{GET:{type:"addBlogComment",usetime:nTime},noreturn:!0}),trace("post comment error"),winDialog.alert($SYSMSG[result.code]||"发评论失败！请重试。",{icon:"02"})}.bind2(this);Utils.Io.Ijax2.request("//comment5.news.sina.com.cn/cmnt/submit",{POST:{channel:"blog",newsid:data.article_id,content:data.comment,usertype:"blogpc",ie:"utf-8",oe:"utf-8",share_url:1===data.is_t?location.href.replace(/\.html.*$/,".html"):"",ispost:1===data.is_t?1:0,iframe:1},returnType:"json",onComplete:function(data){if(!CommentV2.isAllowSubmit(data.result.blog_code))return!1;if("20003"!=data.result.status.code&&"10013"!=data.result.status.code)if(0===data.result.status.code){if(!CommentV2.needAuthTrueName(data.result.filter_code))switch(data.result.filter_code){case"1103":case"1104":case"1105":case"1107":case"1106":case"2000":case"2004":case"2005":case"2006":case"2100":winDialog.alert($SYSMSG[data.result.filter_code]);break;case"4001":try{$E("postCommentIframe").contentWindow.document.body.innerHTML=""}catch(e){}winDialog.alert($SYSMSG[data.result.filter_code]);break;case"4000":case"4002":v7sendLog("45_01_12_"+scope.$uid),setTimeout((function(){Lib.Listener.notify("reload-cnmt-list"),Lib.Listener.notify("update-total-num",{type:"add",num:1})}),500);var str=$E("c_"+scope.$articleid).innerHTML,num=parseInt(/(\d+)/.exec(str)[0],10);num++,$E("c_"+scope.$articleid).innerHTML="("+num+")",_this.onSuccess();break;default:winDialog.alert($SYSMSG.A00001)}}else winDialog.alert("未知错误，请稍后再试!",{icon:"02"});else winDialog.alert("您还没有开通微博，请先开通，再进行评论同步到微博操作！",{icon:"02"})}.bind2(this),onException:function(data){v7sendLog("32_01_21"),trace("post comment error"),winDialog.alert($SYSMSG[result.code]||"发评论失败！请重试。",{icon:"02"})}.bind2(this)})},refreshCKIMG:function(){$E("comment_check_img")&&($E("comment_check_img").src="//interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+(new Date).valueOf()),$E("comment_get_vcode")&&Lib.AudioCheck.render($E("comment_get_vcode").parentNode,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())},addNewComment:function(data,cId){var _this=this;Lib.checkAuthor((function(){_this.getPostTemplet(data,cId)}),"post"+(new Date).getTime())},commentTween:function(li){var beginEl,me=this,commentContent=$E("article_comment_list");if(-1===scope.$pageid.indexOf("articletj"))commentContent.appendChild(li),beginEl=$E("postCommentIframe");else{var firstLi=$T(commentContent,"li")[0];firstLi?(firstLi.className="SG_j_linedot1",commentContent.insertBefore(li,firstLi)):commentContent.appendChild(li),beginEl=$E("postcommentid")}var endPos=Core.Dom.getXY(li),beginPos=Core.Dom.getXY(beginEl);new rockIt(li,beginPos,endPos,0,300,"elasticEaseInOut",{end:function(o){o.clear(),Core.Dom.opacity(li,0),-1===scope.$pageid.indexOf("articletj")?(commentContent.appendChild(li),beginEl=$E("postCommentIframe")):(commentContent.insertBefore(li,commentContent.firstChild),beginEl=$E("postcommentid"));var opacVal=0,opTimer=setInterval((function(){Core.Dom.opacity(li,opacVal),100==opacVal&&(clearInterval(opTimer),opacVal=0),opacVal+=20}),10),real=me.getScollTop(),posY=Core.Dom.getXY(li)[1];if(!(posY>real)){var sReal=Math.abs(real);sReal<=100?(sReal==real?1:-1,sReal):real/100;var _start=+new Date,timer=setInterval((function(){var func=window.$transitions.regularEaseOut,now=+new Date;if(now-_start<500)var pass=now-_start;else{pass=500;clearInterval(timer)}me.setScollTop(func(pass,real,posY-real,500))}),15)}}})},getScollTop:function(){var scrOfY=0;return document.body&&(document.body.scrollLeft||document.body.scrollTop)?(scrOfY=document.body.scrollTop,document.body.scrollLeft):document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(scrOfY=document.documentElement.scrollTop,document.documentElement.scrollLeft),scrOfY},setScollTop:function(val){document.body&&(document.body.scrollLeft||document.body.scrollTop)?document.body.scrollTop=val:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(document.documentElement.scrollTop=val)},getPostTemplet:function(data,cId){var __this=this,res=(cId.isworldcup,cId),item=(cId=res.insertid||cId,{});if(item.id=cId,item.user_image=res.user_img,item.src_uid=scope.$uid,data.anonymity)item.uname=data.comment_anonyous,item.comm_uid=0;else{item.ulink="//blog.sina.com.cn/u/"+(data.uid||$UID),item.ria_index_url=item.ulink;var vHTML=Lib.blogv.getVHTML(scope.loginUserWtype);item.uname=scope.nickname||data.login_name,vHTML&&(item.vimg=vHTML),item.comm_uid=$UID}1==data.god?(item.god=1,item.cms_body=this.changeToContent(data.comment,"god")):item.cms_body=this.changeToContent(data.comment),item.cms_pubdate=CommentV2.formatTime(),item.fromProduct=res.from_product,item.cms_reply_num="0",item.action_data=encodeURIComponent(Utils.Json.flatten({commentid:item.id,articleid:res.blog_id,fromProduct:res.from_product,comm_uid:item.comm_uid,uname:item.uname,ulink:item.ulink,src_uid:scope.$uid,cms_reply_num:item.cms_reply_num}));var lisData={};lisData.item=item,lisData.fun=function(li){__this.commentTween(li)},Lib.Listener.notify("commentlist-commentadd",lisData);var noComm=this.isNoCotent();scope&&scope.$pageid;noComm&&noComm.parentNode.removeChild(noComm)},isNoCotent:function(){for(var li=$E("article_comment_list").getElementsByTagName("li"),i=0;li[i];i++)for(var div=li[i].getElementsByTagName("div"),j=0;div[j];j++)if(-1!=div[j].className.toUpperCase().indexOf("NOCOMMDATE"))return li[i];return null},changeToContent:function(str,type){var imgPath="//www.sinaimg.cn/uc/myshow/blog/misc/gif/";"god"==type&&(imgPath="//simg.sinajs.cn/blog7style/images/common/godreply/");var _userContent=str.replace(/\r\n|\n/gi,"###line-return###"),_html='<img src="'+imgPath+'$1T.gif" style="margin:1px;" border="0" title="$2" />',_magichtml='<img src="'+imgPath+'$1T.gif" style="margin:1px;" border="0" title="$3" width="50" height="50"/>';return _userContent=(_userContent=(_userContent=(_userContent=Core.String.encodeHTML(_userContent)).replace(/\[emoticons=(E___\w*)\]([^[]*)\[\/emoticons\]/gi,_html)).replace(/\[magicemoticons=([E|W]___\w*)\&nbsp\;swfname=(\w+\.swf)\]([^[]*)\[\/magicemoticons\]/gi,_magichtml)).replace(/###line-return###/gi,"<br/>")},loginNeedSafeCode:function(res){var that=this,tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite><a title="关闭" class="CP_w_shut"  id="#{btnClose}" href="javascript:;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="" style="width:auto;" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");"undefined"==typeof scope.xssSafeCodeDiag&&(scope.xssSafeCodeDiag=winDialog.createCustomsDialog({tpl:tpl,title:"提示",content:'<div class="CP_layercon1"><div class="verifyPrompt"><p>为了保护你的账号安全，请输入验证码进行登录</p><div class="row1"><strong>验证码：</strong><input type="text" maxlength="5" id="xssSafeCodeDiag_checkword" class="fm1"><img width="100" align="absmiddle" src="https://login.sina.com.cn/cgi/pin.php?r=11681364785467546&amp;s=0" maxlength="5" id="xssSafeCodeDiag_safeimg"><a id="" href="javascript:void(0); return false;" onclick="scope.xssSafeCodeDiag.changeSafeCode();">换一换</a></div><p class="CP_w_btns"><a id="" href="javascript:void(0); return false;" class="CP_a_btn2" onclick="scope.xssSafeCodeDiag.ok();"><cite><span>登录</span></cite></a><span style="display:none" id="xssSafeCodeDiag_ErrTips" class="ErrTips"></span></p></div></div>',width:282,height:180,funcDisplayFinished:function(){}},"note"),scope.xssSafeCodeDiag.changeSafeCode=function(){$E("xssSafeCodeDiag_checkword").value="",$E("xssSafeCodeDiag_safeimg").src="https://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0"},scope.xssSafeCodeDiag.ok=function(){var v=$E("xssSafeCodeDiag_checkword").value;if(""===v)return $E("xssSafeCodeDiag_ErrTips").innerHTML="请输入验证码",void($E("xssSafeCodeDiag_ErrTips").style.display="");"undefined"!=typeof sinaSSOController&&"undefined"!=typeof sinaSSOController.loginExtraQuery&&"undefined"!=typeof sinaSSOController.loginExtraQuery.door&&(sinaSSOController.loginExtraQuery.door=v||1),sinaSSOController.loginExtraQuery.door=v||1,that.post(that.data),scope.xssSafeCodeDiag.hidden()},scope.xssSafeCodeDiag.displayError=function(res){"4049"!==res.errno?($E("xssSafeCodeDiag_ErrTips").innerHTML=res.reason,$E("xssSafeCodeDiag_ErrTips").style.display=""):$E("xssSafeCodeDiag_ErrTips").style.display="none"}),scope.xssSafeCodeDiag.show(),scope.xssSafeCodeDiag.setMiddle(),scope.xssSafeCodeDiag.changeSafeCode(),scope.xssSafeCodeDiag.displayError(res)}},CommentV2.commentFaceTemplate=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">插入表情</strong>','<cite><a id="#{btnClose}" href="javascript:;" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">','<div class="faceItemContent">','<div class="bigface">','<div id="#{faceTab}" class="faceSidebar">',"</div>",'<div id="#{faceContent}" class="faceShowAll">',"</div>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),CommentV2.count=function(num){return num%50==0?Math.ceil(num/50):Math.floor(num/50)+1};var Comment={};CommentV2.insertSmile=Core.Class.create(),CommentV2.insertSmile.prototype={initialize:function(){},show:function(){this.btnShowFaceEditor=$E("article_comment_insertSmile"),this.txtComment=$E("commentArea"),this.faceEditor=new Lib.Face(this.txtComment);this.bindFace()},bindFace:function(){var _this=this;Core.Events.addEvent(this.btnShowFaceEditor,(function(){if(_this.faceEditor.isShowed)_this.faceEditor.hidden();else{_this.faceEditor.isLoad||(_this.faceEditor.load(),_this.initFace(),_this.faceEditor.isLoad=!0);var x=Core.Dom.getLeft(_this.btnShowFaceEditor)-450,y=Core.Dom.getTop(_this.btnShowFaceEditor)+_this.btnShowFaceEditor.offsetHeight;_this.faceEditor.setPosition(x,y),_this.faceEditor.show()}Core.Events.stopEvent()}),"mousedown")},initFace:function(){var _this=this;Core.Events.addEvent(this.faceEditor.dialogNodes.btnClose,(function(){_this.faceEditor.hidden()}),"mousedown"),Core.Events.addEvent(document.body,(function(){_this.faceEditor.hidden()}),"mousedown"),Core.Events.addEvent(this.faceEditor.dialog.entity,(function(){Core.Events.stopEvent()}),"mousedown")}},$SYSMSG.extend({B119001:"不能转载自己的文章!",B119002:"转帖功能为新版博客专属功能，点击确认立即升级你的博客吧！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='//blog.sina.com.cn/lm/iframe/xhtml/2010/blogspread.html'>了解新版博客详情</a></span>",B119003:"被转载文章不存在!",B119004:"请访问原文进行转载！",B119005:"对不起，博主设置不允许转载该文章",B119006:"对不起，博主设置不允许转载其文章",B119007:"很抱歉，转载失败，请稍后再试",B119008:"已经转载很多啦，看看其他的精彩文章",B119009:"您短时间转载过多，请稍后再试"}),App.getArticlesSort=function(fCallBack,uid){uid=uid||scope.$uid;var js=$C("script"),_this=this;Lib.checkAuthor((function(){js.src="//comet.blog.sina.com.cn/api?maintype=acate&varname=x&uid="+uid,js.charset="utf-8",js.onload=js.onerror=js.onreadystatechange=Core.Function.bind2((function(){js&&js.readyState&&"loaded"!=js.readyState&&"complete"!=js.readyState||(App.ArticlesSort=x,null!=fCallBack&&fCallBack(App.ArticlesSort),js.onload=js.onreadystatechange=js.onerror=null,js.src="",js.parentNode.removeChild(js),js=null)}),_this),document.getElementsByTagName("head")[0].appendChild(js)}),"getArticlesSort"+(new Date).getTime())},$SYSMSG.extend({B18001:"请输入分类名称。",B18002:"确实要删除此分类吗？删除后不可恢复。",B18003:"已达分类数10条上限，不能继续创建。",B18004:"分类必须是中文、英文或数字，请重新输入。",B18005:"非法数据，提交失败。",B18008:"是否保存此更改？",B18009:"博文存在敏感词，请修改后提交。"});var cateDialog=Core.Class.create();cateDialog.prototype={uid:"",initialize:function(action){this.action=action||!1},show:function(uid){this.uid=uid||scope.$uid,this.initDialog(),this.dialog.show(),this.dialog.setFixed(!0),this.dialog.setAreaLocked(!0),this.dialog.setMiddle()},initDialog:function(){var me=this,data={width:492,height:0,url:"//control.blog.sina.com.cn/admin/article/article_class_list.php?"+(this.action?"action=editor":"")};me.url="//control.blog.sina.com.cn/admin/article/article_class_save2.php?uid="+$UID+(me.action?"&action=editor":""),me.id=Core.Math.getUniqueId(),me.manage=null,me.manage=new cateMng(me.id,me.itemTpl,me.uid),me.manage.onSuccess=function(list){me.onSuccess(list)};var obj={ad:!1,drag:!0,title:"分类管理",content:new Ui.Template("<div style='width: #{width}px; height: #{height}px;' id='category_"+me.id+"'></div>").evaluate(data),shadow:1,width:data.width,height:data.height},dialog=winDialog.createCustomsDialog(obj,{});me.dialog=dialog,$E("category_"+me.id).innerHTML=me.tpl.join(""),me.dialog.nodes.btnClose.href="javascript:;",me.dialog.nodes.btnClose.onclick=function(){me.manage.getEdit()?winDialog.confirm("是否保存此更改？",{funcOk:function(){me.manage.saveHandler(me.url)},funcCancel:function(){me.close()},funcClose:function(){me.dialog.show()},textOk:"是",textCancel:"否"}):me.close()},me.initEvent()},initEvent:function(){this.manage.nameEvent(),this.manage.createEvent(),this.manage.dataProvider(),this.manage.saveEvent(this.url)},hidden:function(){this.dialog.hidden()},close:function(){this.dialog.hidden(),this.dialog.destroy()},showOld:function(){this.dialog.show()},reset:function(){window.CateDialog.dialog.setCloseEvent(!0),window.CateDialog.dialog.hidden(),window.CateDialog.dialog=null,window.CateDialog.init=!1},setSize:function(nWidth,nHeight){var ele=this.dialog.nodes.content.firstChild;this.dialog.setSize(nWidth,nHeight),ele.style.width=nWidth+"px",ele.style.height=nHeight+"px"},setCloseEvent:function(bClose){},getDialog:function(){return this.dialog},getId:function(){return this.id},getDataList:function(){return this.manage.list},onSuccess:function(res){},init:!1,dialog:null,tpl:['<div id="categoryBody">','<div id="categoryTitle">',"</div>",'<div id="categoryHead">',"<table>","<tr>",'<td><input type="text" maxlength="28" value="最多可输入14个中文字符" id="categoryName"/></td>','<td width="80"><a id="categoryCreate" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>创建分类</cite></a></td>','<td><span class="SG_txtc">请用中文、英文或数字。</span></td>',"</tr>","</table>",'<div id="errTips"></div>',"</div>",'<form method="post" id="categoryForm" name="form">','<div id="categoryList">','<ul class="clearfix" id="datalist">&nbsp;</ul>','<div class="SG_j_linedot"></div>',"</div>",'<div id="categoryBottom" style="text-align:center">','<a id="categorySave" href="javascript:void(0);" class="SG_aBtn SG_aBtnB SG_aBtn_sub"><cite>保存设置<input type="button" value="保存设置"/></cite></a>',"</div>","</form>","</div>"],itemTpl:['<li class="{class}">','<span class="htit" style="color:#000000" id="cate_{index}">{cate}</span>','<input type="hidden" value="{cate}" name="typename[]" class="catName"/>','<input type="hidden" value="{id}" name="number[]"/>','<span id="ctrl_{index}" class="control">','<div class="manage">','<a class="CP_a_fuc" id="edit_{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.editCate(this);">[<cite>编辑</cite>]</a>','<a class="CP_a_fuc" id="del_{index}" index="{index}" href="javascript:;" onclick="javascript:window.CateDialog.manage.delCate(this);">[<cite>删除</cite>]</a>',"</div>",'<div class="arrow">','<a id="up_{index}" class="{up_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.upHandler(this);"/>','<a id="down_{index}" class="{down_class}" href="javascript:;" onclick="javascript:window.CateDialog.manage.downHandler(this);"/>',"</div>","</span>",'<div id="editctrl_{index}" class="writeinfo" style="display:none">','<input id="new_{index}" type="text" value="" /><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>',"<div/>","</li>"]};var cateMng=Core.Class.create();cateMng.prototype={list:null,orilen:0,edit:!1,uid:null,initialize:function(id,itemTpl,uid){this.uid=uid||scope.$uid,this.id=id,this.itemTpl=itemTpl,Array.prototype.remove=function(dx){if(isNaN(dx)||dx>this.length)return!1;this.splice(dx,1)}},nameEvent:function(){var _this=this;$E("categoryName").onfocus=function(){"最多可输入14个中文字符"==this.value&&(this.value="")},$E("categoryName").onblur=function(){this.value=this.value.replace(/[ ><\\\'\;\"`\|\t\r\n|\u3000]/gi,""),""==Core.String.trim($E("categoryName").value)?(this.value="最多可输入14个中文字符",this.edit=!1):this.edit=!0,_this.showTips("")},$E("categoryName").onkeyup=function(){var value=Core.String.trim(this.value);Core.String.byteLength(value)>28?this.value=Core.String.leftB(value,28):value!=this.value&&(this.value=value)},_this.showTips("")},createEvent:function(){var _this=this,code="";$E("categoryCreate").onclick=function(){if(function(){var value=Core.String.trim($E("categoryName").value);code="",""==value||"最多可输入14个中文字符"==value?code="分类名称不能为空":-1!=value.indexOf("&")||-1!=value.indexOf("＆")?code="分类名称不能包含&符号":_this.list.length>=15?code="抱歉！最多可创建15条分类":Core.String.byteLength(value)>28&&(code="最多可输入14个中文字符");for(var i=0;i<_this.list.length;i++)if(_this.list[i].name==value){code="您已经添加过此分类";break}return""==code}()&&$E("categoryName").edit){var obj={id:-1,name:$E("categoryName").value};$E("categoryName").value="最多可输入14个中文字符",$E("categoryName").edit=!1,_this.list.push(obj),_this.update()}_this.showTips(code)}},saveEvent:function(url){Core.Events.stopEvent();var _this=this;$E("categorySave").onclick=function(){_this.saveHandler(url)}},saveHandler:function(url){var _this=this,length=_this.list.length;if(_this.orilen-length>2)winDialog.confirm("您本次删除的博文分类太多，确定删除？",{funcOk:function(){_this.orilen=length,$E("categorySave").onclick()}});else{for(var cateName=[],cateId=[],i=0;i<length;i++){var item=_this.list[i];cateName.push(item.name),cateId.push(item.id)}Utils.Io.Ijax.request(url+"&r="+Math.random(),{POST:{typename:cateName.join("|"),number:cateId.join("|")},onComplete:function(res){eval("var result = "+res);try{if("A00006"!==result.code&&"B18008"!==result.code)return winDialog.alert($SYSMSG[result.code]||"未知错误",{icon:"01"}),void window.CateDialog.close()}catch(error){}try{try{$E("module_3")&&Lib.Component.refresh(3,{width:scope.catedialogwidth||210}),$E("module_7")&&location.reload()}catch(error){trace(error)}try{window.ArticleCateFuncs.reloadCate(result.msg)}catch(error){}window.CateDialog.close()}catch(e){}var r;eval("r="+res),_this.onSuccess(r.msg)},onException:function(res){console.log("error",res)}})}},editCate:function(dom){var _this=this,index=dom.id.split("_")[1],old=$E("cate_"+index).innerHTML,li=$E("cate_"+index).parentNode;$E("ctrl_"+index).className="control hide",li.className=index%2==0?"editName":"cline editName";var tpl='<div id="editctrl_'+index+'" class="writeinfo"><input id="new_'+index+'" type="text" value="'+old+'"><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>确定</cite></a><a class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;"><cite>取消</cite></a></div>';function setName(nvl,type){var value=nvl,code="";if(Core.String.byteLength(value)>28&&(value=Core.String.leftB(value,28)),1==type)for(var i=0;i<_this.list.length;i++)if(_this.list[i].name==value){code="您已经添加过此分类";break}if(""!=code)$E("err_"+index)?$E("err_"+index).value=code:(Core.Dom.addHTML($E("editctrl_"+index),'<div id="err_'+index+'" class="errTips">'+code+"</div>"),li.style.height="60px");else{_this.list[index].name=value;var tpl=_this.itemTpl.join("");tpl=(tpl=tpl.replace('<li class="{class}">',"")).replace("</li>");var item=_this.list[index];tpl=(tpl=(tpl=(tpl=(tpl=tpl.replace(/\{cate\}/gi,item.name)).replace(/\{id\}/gi,item.id)).replace(/\{index\}/gi,index)).replace(/\{up_class\}/,0==index?"up_disabled":"up")).replace(/\{down_class\}/,index==_this.list.length-1?"down_disabled":"down"),li.innerHTML=tpl,li.className=index%2==0?"":"cline",li.style.height="30px",1==type&&(_this.edit=!0)}code=""}li.innerHTML=tpl,$E("new_"+index).onkeyup=function(){var value=Core.String.trim(this.value.replace(/[ >&<\\\'\,\;\"`\|\t\r\n|\u3000]/gi,""));value!=this.value&&(this.value=value),$E("editctrl_"+index).childNodes[1].disabled=""==value},$E("new_"+index).onblur=function(){Core.String.byteLength(this.value)>=28&&(this.value=Core.String.leftB(this.value,28))},$E("editctrl_"+index).childNodes[1].onclick=function(){$E("new_"+index).value==old?setName(old,2):setName($E("new_"+index).value,1)},$E("editctrl_"+index).childNodes[2].onclick=function(){setName(old,2)}},delCate:function(dom){var _this=this,index=dom.id.split("_")[1];winDialog.confirm("确实要删除此分类吗？删除后不可恢复。",{funcOk:function(){_this.list.remove(index),_this.update()}})},upHandler:function(dom){var index=dom.id.split("_")[1];if(index>0){var temp=this.list[index];this.list[index]=this.list[index-1],this.list[index-1]=temp,this.update()}},downHandler:function(dom){var index=dom.id.split("_")[1];if(index<this.list.length-1){var next=1*index+1,temp=this.list[next];this.list[next]=this.list[index],this.list[index]=temp,this.update()}},showTips:function(code){$E("errTips").innerHTML=code},dataProvider:function(){var _this=this;App.getArticlesSort((function(data){_this.list=data.data,_this.orilen=_this.list.length,$E("datalist").innerHTML="";for(var i=0;i<_this.list.length;i++){var tpl=_this.itemTpl.join(""),item=_this.list[i];tpl=(tpl=(tpl=(tpl=(tpl=(tpl=tpl.replace(/\{cate\}/gi,item.name)).replace(/\{class\}/gi,i%2==0?"":"cline")).replace(/\{id\}/gi,item.id)).replace(/\{index\}/gi,i)).replace(/\{up_class\}/,0==i?"up_disabled":"up")).replace(/\{down_class\}/,i==_this.list.length-1?"down_disabled":"down"),Core.Dom.addHTML($E("datalist"),tpl)}}),this.uid)},update:function(){$E("datalist").innerHTML="";for(var i=0;i<this.list.length;i++){var tpl=this.itemTpl.join(""),item=this.list[i];tpl=(tpl=(tpl=(tpl=(tpl=(tpl=tpl.replace(/\{cate\}/gi,item.name)).replace(/\{class\}/gi,i%2==0?"":"cline")).replace(/\{id\}/gi,item.id)).replace(/\{index\}/gi,i)).replace(/\{up_class\}/,0==i?"up_disabled":"up")).replace(/\{down_class\}/,i==this.list.length-1?"down_disabled":"down"),Core.Dom.addHTML($E("datalist"),tpl)}this.edit||(this.edit=!0)},getEdit:function(){return this.edit},onSuccess:function(res){}};var QuoteSuccess=Core.Class.create();QuoteSuccess.prototype={interfaceSave:null,_isDialogInit:!1,_dialog:null,memoNullText:"说点什么...",articleID:"",_cateList:[],initialize:function(){var _this=this;Lib.checkAuthor((function(){_this.interfaceSave=new Interface("//control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax"),!window.CateDialog&&(window.CateDialog=new cateDialog)}),"quote_Success"+(new Date).getTime())},show:function(articleID){var _this=this;Lib.checkAuthor((function(){!_this._isDialogInit&&_this._initDialog(),_this.articleID=articleID||"",_this._dialog.show(),_this._dialog.setFixed(!0),_this._dialog.setMiddle(),_this._dialog.setAreaLocked(!0)}),"quote_Success"+(new Date).getTime())},save:function(){var me=this,nodes=this._dialog.nodes;this.interfaceSave.request({POST:{new_cat:nodes.selCate.value,blog_id:me.articleID,reship:nodes.txtMemo.value===me.memoNullText?"":nodes.txtMemo.value},onSuccess:function(data){me.onSuccess(data),me.close()},onError:function(err){me.onError(err)},onFail:function(){}})},close:function(){this._dialog.hidden(),this.clear()},_initDialog:function(){var me=this;this._dialog=winDialog.createCustomsDialog({content:['<div class="CP_layercon6">','<div class="turnBox">','<p class="turnTxt">','<img class="SG_icon SG_icon203" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<span class="txt1">转载成功！</span>你还可以写评论...',"</p>","<ul>",'<li><span class="a">评论：</span><span class="b"><textarea id="#{txtMemo}" style="color:#c8c8c8;max-width:400px;" cols="" rows="3" class="SG_textarea">'+this.memoNullText+"</textarea></span></li>","<li>",'<span class="a">分类：</span>','<span class="b"><select id="#{selCate}" name=""><option value="00">默认文章分类</option></select>&nbsp;&nbsp;<a id="#{btnShowCate}" href="#" onclick="return false;">创建分类</a></span>',"</li>","</ul>",'<div class="clearit"></div>','<div class="butt">','<a href="#" id="#{btnSave}" onclick="return false;" class="SG_aBtn SG_aBtnB"><cite>保存</cite></a>&nbsp;&nbsp;<a id="#{btnCancel}" onclick="return false;" href="#" class="SG_aBtn SG_aBtnB "><cite>关闭</cite></a>','<a style="visibility:hidden" target="_blank" href="//blog.sina.com.cn/admin/advice/advice_list.php" class="link">改进建议</a>',"</div>","</div>",'<div class="clearit"></div>',"</div>"].join("")}),Core.Events.addEvent(this._dialog.nodes.btnSave,(function(){me._dialog.nodes.txtMemo.value===me.memoNullText&&0===me._dialog.nodes.selCate.selectedIndex?me.close():me.verified()&&me.save()}),"click"),Core.Events.addEvent(this._dialog.nodes.btnCancel,(function(){me.close()}),"click"),Core.Events.addEvent(this._dialog.nodes.btnShowCate,(function(){window.CateDialog.onSuccess=function(res){me._dialog.nodes.selCate.length=1;var i,list=res||[],len=list.length;for(i=0;i<len;i++)me.addCate(list[i].value,list[i].label);me.addCate("0","私密博文")},window.CateDialog.show($UID)}),"click"),this._dialog.addEventListener("hidden",(function(){me.clear(),me.onClose()})),this._dialog.nodes.txtMemo.onblur=function(){""===this.value.replace(/\s/g,"")&&(this.style.color="#c8c8c8",this.value=me.memoNullText)},this._dialog.nodes.txtMemo.onfocus=function(){this.value===me.memoNullText&&(this.style.color="#000000",this.value="")},this._initCateList(),this._isDialogInit=!0},verified:function(){var nodes=this._dialog.nodes;return!(Core.String.byteLength(nodes.txtMemo.value)>2e3)||(winDialog.alert("评论内容必须是1000中文或2000字符以内，请重新输入。"),!1)},_initCateList:function(){var nodes=this._dialog.nodes,me=this;nodes.selCate.length=1,Lib.checkAuthor((function(){App.getArticlesSort((function(){var i,list=x.data,len=list.length;for(i=0;i<len;i++)me.addCate(list[i].id,list[i].name);me.addCate("0","私密博文")}),$UID)}),"quote_Success_initCateList"+(new Date).getTime())},_getFaceURL:function(uid){return"//portrait"+(parseInt(uid)%8+1)+".sinaimg.cn/"+uid+"/blog/50"},addCate:function(id,name){var sel=this._dialog.nodes.selCate,op=$C("option");op.value=id,op.innerHTML=name,sel.appendChild(op)},clear:function(){var nodes=this._dialog.nodes;nodes.txtMemo.style.color="#c8c8c8",nodes.txtMemo.value=this.memoNullText},onSuccess:function(data){},onError:function(err){},onClose:function(){}};var Quote=Core.Class.create();Quote.prototype={quoteSuccess:null,saving:!1,articleID:"",initialize:function(ele_id){this.quoteSuccess=new QuoteSuccess,this.initInterface(),this.bindEvent(ele_id),this.articleID=scope.$articleid},bindEvent:function(ele_id){var me=this;ele_id&&Core.Events.addEvent($E(ele_id),(function(){me.check()}))},initInterface:function(){this._interface=new Interface("//control.blog.sina.com.cn/admin/article/article_quote.php","ijax")},check:function(articleID,commentText,isComment,moreCallBack){this.articleID=articleID||scope.$articleid,moreCallBack=moreCallBack||function(){};var me=this;Lib.checkAuthor((function(){$isLogin?scope.blogOpener.showDialog((function(){me.save(commentText,isComment),moreCallBack()})):(v7sendLog("48_01_33"),(new Lib.Login.Ui).login((function(){scope.blogOpener.showDialog((function(){me.save.bind2(me)(),moreCallBack()}))})))}),"quote"+(new Date).getTime())},save:function(commentText,isComment){if(!this.saving){this.saving=!0;var param={version:7,blog_id:this.articleID,comment:isComment||"",reship:commentText||""};this._interface.request({POST:param,onSuccess:function(_data){this.numAdd(),this.saving=!1;var aID=_data.url.split("/").pop().split("_")[1].split(".")[0];commentText||(this.quoteSuccess.onSuccess=function(){winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+_data.url+"'>查看转载博文>></a></span>",{icon:"03"})},this.quoteSuccess.show(aID)),this.onSuccess(aID,_data.url||"")}.bind2(this),onError:function(_data){if(this.saving=!1,"B119007"==_data.code||"B119008"==_data.code)return winDialog.alert($SYSMSG[_data.code],{icon:"01",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1"),Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,(function(){window.location.href=window.location.href.replace(/#.*$/,"")}),"click"),void this.onError();_data.code&&"P00001"===_data.code?winDialog.confirm($SYSMSG[_data.code],{icon:"01",funcOk:function(){location.href="https://security.sina.com.cn/account/index?entry=sina_shiming"}}):("B119002"==_data.code?winDialog.alert($SYSMSG[_data.code],{icon:"01",funcOk:function(){window.location.href="//control.blog.sina.com.cn/upgrade/upgrade_show.php?version=7"}}):(winDialog.alert($SYSMSG[_data.code],{icon:"02",funcOk:function(){window.location.href=window.location.href.replace(/#.*$/,"")}},"alert1"),Core.Events.addEvent(winDialog.getDialog("alert1").getNodes().btnClose,(function(){window.location.href=window.location.href.replace(/#.*$/,"")}),"click")),this.onError())}.bind2(this),onFail:function(){this.saving=!1}.bind2(this)})}},numAdd:function(){var num,ele=$E("quote_sign")||$E("quote_sign_"+this.articleID)||$E("z_"+this.articleID);ele&&(ele.innerHTML.replace(/(\d+)/,(function(a,b){num=b})),ele.innerHTML="("+(parseInt(num)+1)+")")},onSuccess:function(aID){},onError:function(){}};var CommentQuote=Core.Class.create();CommentQuote.prototype={_isInitTip:!1,_tip:null,quote:null,commentText:"",articleID:"",interfaceSave:null,initialize:function(){this.interfaceSave=new Interface("//control.blog.sina.com.cn/riaapi/article/edit_cat.php","ijax"),this._initQuote()},_initQuote:function(){var me=this;this.quote=new Quote,this.quote.onSuccess=function(aID,url){me.hideTip(),winDialog.alert("博文已成功转载！<br/><span style='font-weight: 100; font-size: 12px;'><a target='_blank' href='"+url+"'>查看转载博文>></a></span>",{icon:"03"}),me.onSuccess()},this.quote.onError=function(){me.hideTip()}},showTip:function(text){var tp,win=Core.System.winSize();!this._isInitTip&&this._initTip(),(tp=this._tip).getNodes().content.innerHTML=text,tp.visibility="hidden",tp.show(),tp.setPosition(win.width/2-+tp.entity.offsetWidth/2,win.height/2-+tp.entity.offsetHeight/2),tp.visibility="",tp.setFixed(!0)},check:function(articleID,commentText){this.articleID=articleID,this.commentText=commentText,this.quote.check(articleID,commentText,"1")},hideTip:function(){this._tip&&this._tip.hidden()},_initTip:function(){this._tip=new Lib.Panel,this._tip.setTemplate(['<div id="#{panel}" style="z-index:512;border:1px solid #CC9933; background:#FFFFCC; padding:20px;">','<div id="#{content}"></div>',"</div>"].join("")),this._isInitTip=!0},onSuccess:function(){}},scope.bindEmailPanel=Core.Class.define((function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(['<div id="#{panel}" style="z-index:512; width:200px" class="tb_layer_Y tb_layer_w5">','<div class="tb_layer_Y_main tip_layer_main">','<div class="tip_ps" style="width:auto;float:right">','<a id="closeBindEmail" title="关闭提示" class="tb_friend_inputDel" href="#" onclick="return false"></a>',"</div>",'<div style="padding:6px">为了您的账号安全，请<a id="linkBindEmail" href="#" target="_blank">绑定邮箱</a></div>',"</div>",'<div class="tb_layer_arrow tip_arrow"></div>',"</div>"].join(""))}),Lib.Panel,{initUserInfo:function(uid){this.getNodes()}}),$registJob("articleCommentPostV2",(function(){Lib.checkAuthor((function(){var commentQuote=new CommentQuote;function showAnonymityTip(){var nickEl=$E("commentNick");if(nickEl){for(var child=nickEl.firstChild;child;child=child.nextSibling)nickEl.removeChild(child);nickEl.innerHTML='<div id="openblog-li" style="cursor:pointer;"><a href="javascript:void(0);"><span id="openblog-nickname"></span>您还未开通博客，点击一秒开通。</a></div>',scope.addBlogOpenerEvent($E("openblog-li"));var nickNameTime=setInterval((function(){scope.nickname&&($E("openblog-nickname").innerHTML=scope.nickname+"：",clearInterval(nickNameTime))}),100)}}if(commentQuote.onSuccess=function(){$E("cbCommentQuote")&&($E("cbCommentQuote").checked=!1)},1!=scope.$private.cms&&1!=scope.$isCommentAllow){var CommentPost=new CommentV2.Post,showNickPlace=function(){$E("commentNick").style.display="",1==checkUserProduct.flag?scope.setNickTime=setInterval((function(){var vHTML=Lib.blogv.getVHTML(scope.loginUserWtype);"undefined"==typeof scope.$loginNick?(Lib.Uic.getNickName([$UID],(function(oResult){for(var key in oResult)scope.$loginNick=oResult[key],$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+vHTML+":"})),clearInterval(scope.setNickTime)):$E("commentNick").innerHTML=scope.$loginNick+"&nbsp;"+vHTML+":"}),500):showAnonymityTip()};if($isLogin)0==checkUserProduct.isinit?setTimeout((function(){checkUserProduct.check("blog",showNickPlace)}),10):Lib.checkAuthor((function(){showNickPlace()}),"articleCommentPostV2"+(new Date).getTime());else{$E("commentlogin").style.display="block";var defaultName=Utils.Cookie.getCookie("remberloginname");""!=defaultName&&""!=defaultName&&($E("login_name").value=unescape(unescape(defaultName))),""!=Utils.Cookie.getCookie("ALF")&&$E("login_remember")&&($E("login_remember").checked=!0),""!=Utils.Cookie.getCookie("LiRe")&&$E("login_remember")&&($E("login_remember").checked=!0),$E("anonymity_cont")&&($E("anonymity")&&($E("anonymity").checked=!1),$E("anonymity_cont").style.display="none")}$E("bb")&&($E("bb").checked=!1);Lib.checkAuthor((function(){var cautionCheck=$E("login_remember");if(cautionCheck){cautionCheck.checked=!0,$isLogin||(cautionCheck.onclick=function(){if(cancelStatus){var url="//control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00003&rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}}),cancelStatus=null}});var cancelStatus=1}}),"articleCommentPostV2"+(new Date).getTime()),$E("anonymity")&&$E("anonymity").checked&&(CommentPost.anonyous=!0,$E("commentlogin").style.display="none",$E("commentloginM").style.display=""),Core.Events.addEvent($E("comment_anonyous"),(function(){$E("anonymity")&&$E("anonymity").checked&&"新浪网友"==Core.String.trim($E("comment_anonyous").value)&&($E("comment_anonyous").value="")}),"focus"),Core.Events.addEvent($E("comment_anonyous"),(function(){$E("anonymity")&&$E("anonymity").checked&&""==Core.String.trim($E("comment_anonyous").value)&&($E("comment_anonyous").value="新浪网友")}),"blur");var bindEmailPanel=new scope.bindEmailPanel;Core.Events.addEvent($E("login_name"),(function(){bindEmailPanel.hidden()}),"focus"),Core.Events.addEvent($E("login_name"),(function(){var name=$E("login_name").value;name&&function(name){Utils.Io.JsLoad.request("https://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(name)+"&utf82gbk=1&callback=scope.$bindEmailTip",{noreturn:!0})}(name)}),"blur"),scope.$bindEmailTip=function(data){if("y"==data.ret||"not_verify"==data.errcode){var node=$E("login_name");bindEmailPanel.showWithDom(node,-150,-55),$E("linkBindEmail").href="https://login.sina.com.cn/bindmail/signin.php?entry=blog&utf82gbk=1&username="+encodeURIComponent(node.value)}else bindEmailPanel.hidden()},Core.Events.addEvent($E("closeBindEmail"),(function(){bindEmailPanel.hidden()})),Core.Events.addEvent("postcommentid",(function(){try{bindEmailPanel.hidden()}catch(e){}})),CommentPost.articleid=scope.$articleid,CommentPost.onSuccess=function(){scope.commEditor&&scope.commEditor.clearHTML("postCommentIframe");var cbCommentQuote=$E("cbCommentQuote");cbCommentQuote&&cbCommentQuote.checked&&commentQuote.check($r_quote_bligid,$E("commentArea").value),$E("commentArea").value="",is_mobile&&mbCmtTa&&(mbCmtTa.value="")},CommentPost.onError=function(){},$E("anonymity")&&Core.Events.addEvent("anonymity",(function(){Lib.checkAuthor((function(){var commentNick=$E("commentNick");v7sendLog("32_01_17");var isOpenBlog=checkUserProduct.flag&&checkUserProduct.isinit||!1;if(isOpenBlog&&$isLogin&&commentNick&&(commentNick.style.display=""),$E("anonymity").checked)CommentPost.anonyous=!0,$E("commentlogin").style.display="none",$E("commentloginM").style.display="block",$E("cbCommentQuote")&&($E("cbCommentQuote").checked=!1),commentNick&&(commentNick.innerHTML="你正以匿名身份发表评论:");else{var vHTML=Lib.blogv.getVHTML(scope.loginUserWtype);CommentPost.anonyous=!1,$E("commentlogin").style.display=$isLogin?"none":"block",$E("commentloginM").style.display="none",isOpenBlog?commentNick&&(commentNick.innerHTML=(scope.$loginNick||scope.nickname)+"&nbsp;"+vHTML+":"):showAnonymityTip()}$E("cbCommentQuote")&&($E("cbCommentQuote").disabled=$E("anonymity").checked),$E("quote_comment_p")&&($E("quote_comment_p").style.display=$E("anonymity").checked?"none":"")}),"atricleCommentPost"+(new Date).getTime())})),$E("bb")&&Core.Events.addEvent($E("bb"),(function(){v7sendLog("32_01_18")})),$E("postCommentIframe");var is_mobile=/Mobile/i.test(navigator.userAgent),mbCmt=$E("mobileComment"),mbCmtTa=$E("mbCommentTa");if(is_mobile&&mbCmt){$E("commonComment").style.display="none",$E("faceWrap").style.display="none",mbCmt.style.display="";var anoc=$E("anonymity_cont");anoc&&(anoc.style.cssFloat="left")}var savefunc=function(){if(Core.Events.getEvent()){var e=Core.Events.getEvent();if("keydown"==e.type&&13!=e.keyCode)return;"keydown"==e.type&&13==e.keyCode&&scope.commEditor&&scope.commEditor.handleChange("postCommentIframe"),Core.Events.stopEvent()}if(!$isLogin&&$E("anonymity")&&0==$E("anonymity").checked){if(""==Core.String.trim($E("login_name").value))return void showError($SYSMSG.B36107);if(""==Core.String.trim($E("login_pass").value))return void showError($SYSMSG.B36108)}if(is_mobile&&mbCmtTa&&($E("commentArea").value=mbCmtTa.value),$E("anonymity")&&1==$E("anonymity").checked&&""==Core.String.trim($E("comment_anonyous").value))showError($SYSMSG.B36003);else if(""==Core.String.trim($E("commentArea").value))showError($SYSMSG.B36105);else{var data={comment:$E("commentArea").value,login_name:$E("login_name").value,login_pass:$E("login_pass").value,comment_anonyous:$E("comment_anonyous").value,anonymity:$E("anonymity")&&$E("anonymity").checked,is_mobile:+is_mobile,is_t:0};$E("login_remember")&&(data.login_remember=$E("login_remember").checked,data.login_remember?Utils.Cookie.setCookie("LiRe",!0,2400,"/",".blog.sina.com.cn"):Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")),$E("bb")&&($E("bb").checked?data.is_t=1:data.is_t=0),CommentPost.post(data)}};if(Core.Events.addEvent($E("commentArea"),(function(){var e=Core.Events.getEvent();e.ctrlKey&&13===e.keyCode&&savefunc()}),"keydown"),Core.Events.addEvent("postcommentid",(function(){scope.commEditor&&scope.commEditor.handleChange("postCommentIframe"),savefunc()})),Core.Events.addEvent($E("postcommentid").parentNode,(function(){scope.commEditor&&scope.commEditor.handleChange("postCommentIframe"),savefunc()}),"keydown"),null==$E("smilesSortShow")){$E("commentArea").style.width="680px",(new CommentV2.insertSmile).show()}else{var cfg,arrPix=[-325,40+($IE?-2:0)];if(-1!==scope.$pageid.indexOf("articletj")&&(cfg={sortCount:4,recommCount:6}),$E("postCommentIframe")){App.formInsertSmile2("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",arrPix,"postCommentIframe",{normal:{focus:function(){}}},cfg)}else App.formInsertSmile("commentArea","smilesSortShow","smilesRecommended",null,"smilesSortShow",arrPix,null,null,cfg)}}}),"articleCommentPostV2"+(new Date).getTime())})),Core.Dom.getChildrenByClass=function(el,clz){for(var rs=[],cldr=el.childNodes||el.children,len=(clz=" "+clz+" ",cldr.length),i=0;i<len;++i){var o=cldr[i];-1!=(" "+o.className+" ").indexOf(clz)&&(rs[rs.length]=o)}return rs},Lib.jumpLogin=function(){const blogUrl=window.location.href;window.location.href="https://passport.weibo.com/sso/signin?entry=homepage&source=sinafloatlayer&url="+blogUrl},Lib.pkg("util"),Lib.util.hoverJq=function(conf){var _default={elm:document.body,mouseenter:function(evt,el,index){},mouseleave:function(evt,el,index){},delay:0};conf=Lib.apply(_default,conf);var enterType=$IE?"mouseenter":"mouseover",leaveType=$IE?"mouseleave":"mouseout";if("length"in conf.elm)try{conf.elm=Array.prototype.slice.call(conf.elm,0)}catch(e){for(var tmpArr=[],i=0,len=conf.elm.length;i<len;i++)tmpArr.push(conf.elm[i]);conf.elm=tmpArr}else conf.elm=[conf.elm];Core.Array.foreach(conf.elm,(function(one,index){Core.Events.removeEvent(one,enterType),Core.Events.removeEvent(one,leaveType),Core.Events.addEvent(one,function(el,func,i){return function(evt){evt=evt||window.event,$IE?func.apply(el,[evt,el,i]):withinElement(evt,"mouseenter",el,i)}}(one,conf[enterType],index),enterType),Core.Events.addEvent(one,function(el,func,i){return function(event){$IE?func.apply(el,[event,el,i]):withinElement(event,"mouseleave",el,i)}}(one,conf[leaveType],index),leaveType)}));var withinElement=function(event,mouseType,elm,i){var parent=event.relatedTarget;try{if(parent&&parent!==document&&!parent.parentNode)return;for(;parent&&parent!==elm;)parent=parent.parentNode;parent!==elm&&conf[mouseType].apply(elm,[event,elm,i])}catch(e){}return!1}},Lib.register("tray.tpl.loginMemu",(function(){return['<div class="ntopbar_menu" id="#{panel}">','<div id="#{openBlog}" style="display:none;">','<span class="link"><a href="//www.sina.com.cn" target="_blank" suda-uatrack="key=sinahome_from_blog&value=sinahome_from_blogpage"><i class="SG_bkhome"></i>新浪首页</a></span>','<span class="link" id="#{userMenu}"><a id="#{userNick}" onclick="v7sendLog(\'40_01_21\');return false;" href="###">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span id="#{msnHolder}" class="ico_msn" style="display:none"><a id="#{msnLink}" href="//control.blog.sina.com.cn/blogprofile/msnbind.php?c=" target="_blank"><img height="18" width="18" align="absmiddle" class="SG_icon SG_icon136" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif"></a></span>','<span class="line_s"></span>','<span class="link"><a onclick="v7sendLog(\'40_01_27\')" href="//i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<em id="#{newFeed}" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>','<span class="link" id="#{blogMenu}"><a target="_blank" onclick="v7sendLog(\'40_01_24\')" href="//control.blog.sina.com.cn/admin/article/article_add.php">发博文</a><a id="#{addArticle}" onclick="v7sendLog(\'40_01_25\');return false;" href="###" class="link_arrow"></a></span>','<span class="line_s"></span>','<span class="link" id="#{trayMsg}" msg-panel-show-state="0"><a onclick="v7sendLog(\'40_01_30\');return false;" href="###">消息</a><a href="javascript:return false;" class="link_arrow" title=""></a></span>','<em id="#{newTips}" onclick="v7sendLog(\'40_01_29\')" class="mtip" style="left:341px;display:none;cursor:pointer;"></em>',"</div>",'<div id="#{noOpenBlog}" style="display:none;">','<span class="link"><a id="#{ssoNick}" onclick="v7sendLog(\'40_01_40\');return false;" href="###">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a id="#{ssoLoginOut}" onclick="v7sendLog(\'40_01_41\');return false;" href="###">退出</a></span>','<div class="ntopbar_login" style="float:left;"><a id="#{openBlogBtn}" onclick="v7sendLog(\'40_01_42\')" class="login" href="###"><span>立即拥有一个新博客</span></a></div>',"</div>","</div>"].join("")})),Lib.register("tray.tpl.loginOutMemu",(function(){var regLink="https://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+(scope.$uid||"")+"&src=";return 2==scope.$channel?regLink+="baby":regLink+="blogicp",['<div id="#{panel}" class="ntopbar_login">','<span class="link bk_home"><a href="//www.sina.com.cn" target="_blank" suda-uatrack="key=sinahome_from_blog&value=sinahome_from_blogpage"><i class="SG_bkhome"></i>新浪首页</a></span>','<a class="login" onclick="v7sendLog(\'40_01_38\');return false;" href="###" action-type="tray-login-btn"><span>登录</span></a>','<a class="register" onclick="v7sendLog(\'40_01_39\')" target="_blank" href="',regLink,'">注册</a></div>'].join("")})),Lib.register("tray.tpl.userMenu",(function(){return['<div id="#{panel}" class="mUserMenu">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon15" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle">博客</a></span>','<span class="rlink"><a target="_blank" onclick="v7sendLog(\'40_01_22\')" id="#{linkPostBlog}" href="//control.blog.sina.com.cn/admin/article/article_add.php">发博文</a></span>',"</li>",'<li style="display:none;"> <span class="tb_ps_nm"><a id="#{linkPhoto}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon18" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle">相册</a></span> <span class="rlink"><a target="_blank" id="#{linkPostPhoto}" onclick="v7sendLog(\'40_01_22\')" href="//photo.blog.sina.com.cn/upload/upload.php">发图片</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{miniblog}" onclick="v7sendLog(\'40_01_22\')" href="###" target="_blank"><img class="SG_icon SG_icon110" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="17" title="微博" align="absmiddle">微博</a></span> </li>','<li style="display:none;" id="#{mail}"> <span class="tb_ps_nm"><a id="#{bindEmail}" target="_blank" href="//mail.sina.com.cn/?s=2" onclick="v7sendLog(\'40_01_22\')"><img class="SG_icon SG_icon212" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="邮件" align="absmiddle">邮件</a></span> </li>','<li> <span class="tb_ps_nm"><a id="#{mySpace}" onclick="v7sendLog(\'40_01_22\')" href="###"><img class="SG_icon SG_icon41" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle">关于我</a></span> </li>',"</ul>",'<div class="links">','<p><a target="_blank" id="#{linkChangeFace}" onclick="v7sendLog(\'40_01_22\')" href="###">修改头像昵称&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkChangePassword}" onclick="v7sendLog(\'40_01_22\')" href="###">修改登录密码&gt;&gt;</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" onclick="v7sendLog(\'40_01_22\')" href="###">帐号安全设置&gt;&gt;</a></p>','<p><a id="#{loginOut}" onclick="v7sendLog(\'40_01_23\');return false;" href="#">退出&gt;&gt;</a></p>',"</div>","</div>"].join("")})),Lib.register("tray.loginOut",(function(lib){var ls=lib.Listener;return function(cb,reload){var _curHref=encodeURIComponent(window.location.href),res={code:"A00006",data:""};ls.notify("global-login-out",res),cb&&cb(res),reload&&(window.location.href="https://login.sina.com.cn/cgi/login/logout.php?r="+_curHref)}})),Lib.register("tray.UserMenuPanel",(function(lib){var userMenu=Core.Class.define((function(){lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(lib.tray.tpl.userMenu)}),lib.Panel,{initUserInfo:function(uid){var nodes=this.getNodes();nodes.linkBlog.href="//blog.sina.com.cn/u/"+uid,nodes.linkPhoto.href="//photo.blog.sina.com.cn/u/"+uid,nodes.miniblog.href="//control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+uid,nodes.mySpace.href="//blog.sina.com.cn/s/profile_"+uid+".html",nodes.linkChangeFace.href="//control.blog.sina.com.cn/blogprofile/nick.php",nodes.linkChangePassword.href="https://security.sina.com.cn/account/security?option=chgpwd&entry=blog",nodes.linkAccountSetup.href="https://security.sina.com.cn/account/security",this.initLoginOut(nodes.loginOut)},initLoginOut:function(outBtn){outBtn.onclick=function(){return!1},Core.Events.addEvent(outBtn,(function(){lib.tray.loginOut(null,!0)}))}});return userMenu})),Lib.register("tray.tpl.blogMenu",(function(){return['<div id="#{panel}" class="wrtBlog_sub">','<div class="wrtBlog_sub3">','<p><a target="_blank" onclick="v7sendLog(\'40_01_26\')" href="//control.blog.sina.com.cn/admin/article/article_add.php?tag365">写365</a></p>',"</div>","</div>"].join("")})),Lib.register("tray.BlogMenuPanel",(function(lib){var blogMenu=Core.Class.define((function(){lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(lib.tray.tpl.blogMenu)}),lib.Panel,{});return blogMenu})),Lib.register("tray.tpl.searchForm",(function(){return['<div class="ntopbar_input" id="#{panel}">','<form id="#{searchForm}" method="get" target="_blank" action="//search.sina.com.cn">','<input id="#{queryTxt}" class="ntopbar_txt" type="text" name="q" autocomplete="off"/>','<input id="#{submit}" type="submit" onclick="v7sendLog(\'40_01_44\')" class="ntopbar_searchBtn" value=""/>','<input type="hidden" name="ie" value="utf-8"/>','<input type="hidden" name="e" value="utf-8"/>','<input id="#{range}" type="hidden" name="range" value="article"/>','<input id="#{t}" type="hidden" name="t" value=""/>','<input id="#{s}" type="hidden" name="s" value="sup"/>','<input id="#{by}" type="hidden" name="by" value="all"/>','<input id="#{type}" type="hidden" name="type" value=""/>','<input id="#{stype}" type="hidden" name="stype" value="1"/>','<input id="#{c}" type="hidden" name="c" value="blog"/>',"</form>","</div>"].join("")})),Core.Dom.addClass=function(obj,className){var _trim=Core.String.trim;if(!(className=_trim(className)))return obj;var oldClz=_trim((obj=$E(obj)).className||""),tmpOldClz=" "+oldClz+" ";if(!oldClz)return obj.className=_trim(className),obj;for(var uClz,uClzs=className.split(" "),newClzs=[],i=0;i<uClzs.length;i++)(uClz=uClzs[i])&&-1===tmpOldClz.indexOf(" "+uClz+" ")&&newClzs.push(uClz);return obj.className=oldClz+" "+newClzs.join(" "),obj},Core.Dom.removeClass=function(obj,className){(obj=$E(obj)).className=obj.className.replace(new RegExp("\\s*\\b"+className+"\\b"),"")},Lib.util.getActionData=function(evt,actionType,typeAttrName,dataAttrName){if(!actionType)throw"[Lib.util.getActionData] param actionType is undefined!";evt=evt||window.event;var tEl,delegateEl,types,data;typeAttrName=typeAttrName||"action-type",dataAttrName=dataAttrName||"action-data";for(tEl=(0,Core.Events.getEventTarget)(evt),delegateEl=evt.currentTarget||document.documentElement||document.body;tEl&&tEl!=delegateEl;){for(var i=0,len=(types=(tEl.getAttribute(typeAttrName)||"").split(",")).length;i<len;i++)if(actionType===types[i])return data=tEl.getAttribute(dataAttrName),{actionType:actionType,targetEl:tEl,data:data};tEl=tEl.parentNode}return null},Lib.register("tray.tpl.cateSearch",(function(){return['<div id="#{panel}" class="mCatSearch">',"<ul>",'<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="article" class="current">含“<span id="#{article}"></span>”的博文</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="bloger">含“<span id="#{bloger}"></span>”的博主</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="music">含“<span id="#{music}"></span>”的音乐</li>','<li action-type="tray-search" onclick="v7sendLog(\'40_01_43\')" action-data="video">含“<span id="#{video}"></span>”的视频</li>',"</ul>","</div>"].join("")})),Lib.register("tray.CateSearchPanel",(function(lib){var _addEvt=Core.Events.addEvent,leftB=Core.String.leftB,byteLength=Core.String.byteLength,catePanel=Core.Class.define((function(){lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(lib.tray.tpl.cateSearch),this.initEvt()}),lib.Panel,{initEvt:function(){var nodes=this.getNodes(),$lis=$T(nodes.panel,"li");lib.util.hoverJq({elm:$lis,mouseenter:function(evt,el,index){Core.Dom.addClass(el,"current")},mouseleave:function(evt,el,index){Core.Dom.removeClass(el,"current")},delay:50}),_addEvt(nodes.panel,(function(evt){evt=evt||window.event;var searchData=lib.util.getActionData(evt,"tray-search");searchData&&lib.Listener.notify("tray-categroy-search",searchData.data)}))},updateSearch:function(v){5<byteLength(v)&&(v=leftB(v,4)+"...");var value=v.replace(/(<|>)/g,(function($1){return"<"===$1?"&lt;":"&gt;"})),nodes=this.getNodes();nodes.article.innerHTML=value,nodes.bloger.innerHTML=value,nodes.music.innerHTML=value,nodes.video.innerHTML=value}});return catePanel})),Lib.register("tray.SearchFormPanel",(function(lib){var _addEvt=Core.Events.addEvent,_trim=Core.String.trim,searchForm=Core.Class.define((function(cfg){lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(lib.tray.tpl.searchForm),this.initEvt(),this.catePanel=new lib.tray.CateSearchPanel,this.catePanel.entity.style.zIndex=512,lib.Listener.on({name:"tray-categroy-search",callBack:this.search,scope:this})}),lib.Panel,{initEvt:function(){var me=this,$queryTxt=this.getNode("queryTxt");_addEvt($queryTxt,(function(evt){var target=(evt=evt||window.event).target||evt.srcElement,offset=target.offsetWidth;me.showCateSearch(target,offset,target.value)}),"input"),_addEvt($queryTxt,(function(evt){if("value"===(evt=evt||window.event).propertyName){var target=evt.target||evt.srcElement,offset=target.offsetWidth;me.showCateSearch(target,offset,target.value)}}),"propertychange"),_addEvt($queryTxt,(function(evt){var target=(evt=evt||window.event).target||evt.srcElement,offset=target.offsetWidth;me.showCateSearch(target,offset,target.value)}),"focus"),_addEvt(this.getNode("searchForm"),(function(evt){var form=(evt=evt||window.event).target||evt.srcElement;me.checkValidate(form)?setTimeout((function(){me.hideCateSearch(),me.resetForm()}),100):Core.Events.stopEvent(evt)}),"submit"),_addEvt(window,(function(){if(me.catePanel.isShow){var offset=$queryTxt.offsetWidth;me.catePanel.showWithDom($queryTxt,-offset,4)}}),"resize")},checkValidate:function(form){return!("q"in form&&!_trim(form.q.value))&&!("k"in form&&!_trim(form.k.value))},setForm:function(url,cfg){var defaultValue={queryTxt:"q",ie:"utf-8",range:"",t:"",s:"",by:"",type:"",stype:"",e:"utf-8",c:""};this.getNode("searchForm").action=url,lib.apply(defaultValue,cfg);var attr,$query,$queryTxt=this.getNode("queryTxt");for(var p in $queryTxt.name=defaultValue.queryTxt,delete defaultValue.queryTxt,defaultValue)"string"==typeof(attr=defaultValue[p])&&($query=this.getNode(p))&&($query.value=attr)},resetForm:function(){this.setForm("//search.sina.com.cn",{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})},search:function(type){this.getNode("searchForm");switch(type){case"video":this.setForm("//video.sina.com.cn/search/index.php",{queryTxt:"k",s:"sup",type:"boke",stype:"1"});break;case"bloger":this.setForm("//search.sina.com.cn",{queryTxt:"q",range:"author",s:"sup",by:"all",stype:"1",c:"blog"});break;case"music":this.setForm("//music.sina.com.cn/yueku/search/s.php",{queryTxt:"k",t:"song"});break;default:this.setForm("//search.sina.com.cn",{queryTxt:"q",range:"article",s:"sup",by:"all",stype:"1",c:"blog"})}$IE?this.getNode("submit").click():Core.Events.fireEvent(this.getNode("submit"),"click")},showCateSearch:function($withEl,offset,v){var catePanel=this.catePanel;v&&catePanel.isHidden?catePanel.showWithDom($withEl,-offset,4):v||this.hideCateSearch(),catePanel.updateSearch(v)},hideCateSearch:function(){var catePanel=this.catePanel;catePanel.hide(),catePanel.updateSearch("")}});return searchForm})),Lib.register("tray.loadUserInfo",(function(lib){var LS=lib.util.LS,JSON=lib.util.JSON;return function(uid,cb,froceSever){var nickInfo=LS.getItem("uid"+uid);if(!froceSever&&nickInfo&&(nickInfo=JSON.parse(nickInfo),(new Date).getTime()/1e3-nickInfo.time<240&&nickInfo.nickname))return void cb(nickInfo);!function(uid,cb){Utils.Io.JsLoad.request("//interface.blog.sina.com.cn/riaapi/profile/getNickName.php",{GET:{uid:uid},onComplete:function(r){if(r&&"A00006"===r.code){r.data.nickname,r.data.full_nickname||(r.data.full_nickname="用户"+r.data.uid),r.data.nickname||(r.data.nickname="用户"+r.data.uid);var saveObj={time:(new Date).getTime()/1e3};lib.apply(saveObj,r.data),LS.setItem("uid"+uid,JSON.stringify(saveObj)),cb(saveObj)}},onException:function(){},timeout:1e4})}(uid,cb)}})),Lib.register("tray.MsgLoader",(function(lib){var FlaDom,addFlash=function($flash){var $wrapper=$C("div");$wrapper.style.cssText="position:absolute;top:-1000px;left:-1000px;",document.body.appendChild($wrapper),$flash.write($wrapper)},random="";return(window.$Maxthon||window.$360||window.$TT)&&(random="?t="+Core.Math.getUniqueId()),function(cfg){if(lib.apply(this,cfg),!FlaDom)try{var FlashPlayer=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"blogMessageReminding.swf"+random,"__msgTipsPlayer","1px","1px","9","#00ff00");FlashPlayer.addParam("quality","high"),FlashPlayer.addParam("wmode","transparent"),FlashPlayer.addParam("allowScriptAccess","always"),FlashPlayer.addParam("freeTime",27e3),"complete"===document.readyState?(addFlash(FlashPlayer),FlaDom=$E("__msgTipsPlayer")):_addEvt(window,(function(){addFlash(FlashPlayer),FlaDom=$E("__msgTipsPlayer")}),"load")}catch(e){}}.$define({time:30,url:"//comet.blog.sina.com.cn/api?maintype=notice",getFlaDom:function(){return FlaDom},play:function(){if($_GLOBAL.msgPlaySound&&FlaDom&&FlaDom.PlaySound)try{FlaDom.PlaySound()}catch(e){}},load:function(uid,cb){var blogid=scope.$articleid||"";uid&&Utils.Io.JsLoad.request(this.url,{GET:{uid:uid||"",blogid:blogid},onComplete:function(r){if(r&&"A00006"==r.code){var d,articleMsg;if(uid&&(d=r.data[uid])){var userMsg={sum:0};for(var k in d)userMsg[k]=d[k],userMsg.sum+=d[k];userMsg.blogrecomment=userMsg.blogrecomment?userMsg.blogrecomment:0,lib.Listener.notify("tray-newmsg-loaded",userMsg)}blogid&&(articleMsg=r.data[blogid])&&lib.Listener.notify("article-msg-loaded",articleMsg)}},onException:function(){},timeout:1e4})}})})),Lib.register("tray.tpl.notice",(function(){return['<div id="#{panel}" class="horn">','<div id="#{tj}" class="horn_con" style="display:none;">推荐：<a id="#{noticeAd1}" target="_blank" href="#"></a><a id="#{noticeAd2}" target="_blank" href="#"></a></div>','<div id="#{announce}" class="horn_con" style="display:none;"><p id="#{announceCon}">公告：<em>请您及时更换请请请您正在使用的模版将于2周后被下线，请您及时更换</em></p></div>','<a class="close" title="关闭" id="#{close}" style="float:none;">×</a>',"</div>"].join("")})),Lib.register("tray.BlogNotice",(function(lib){var _addEvt=Core.Events.addEvent,setCookie=Utils.Cookie.setCookie,pageId=scope.$pageid,notice=Core.Class.define((function(){lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(lib.tray.tpl.notice),this.initEvt()}),lib.Panel,{initEvt:function(){var $this=this;_addEvt(this.getNode("close"),(function(evt){evt=evt||window.event,setCookie("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn"),lib.Listener.notify("tray-announce-close",{}),$this.destroy()}))},update:function(json){var $tj=this.getNode("tj"),$announce=this.getNode("announce"),sourceArr=["SLOT_58","SLOT_59","SLOT_98","SLOT_99","SLOT_100","SLOT_101","SLOT_102"],reqdata={id:sourceArr};if("undefined"!=typeof scope&&(reqdata.blogeruid=scope.$uid),$UID&&(reqdata.loginuid=$UID),$isLogin&&json.announce.result&&("indexM"===pageId||"articleM"===pageId||"articlelistM"===pageId))$announce.innerHTML=json.announce.announce_con,$announce.style.display="";else{var noticeAd1=this.getNode("noticeAd1"),noticeAd2=this.getNode("noticeAd2"),complete=function(res){var randomIndex=0,adcon1=res[sourceArr[0]].res,adcon2=res[sourceArr[1]].res;(adcon1||adcon2)&&(adcon1&&(randomIndex=0,adcon1.length>1&&(randomIndex=Math.floor((adcon1.length+1)*Math.random())),noticeAd1.innerHTML=adcon1[randomIndex].words,noticeAd1.href=adcon1[randomIndex].a_href,noticeAd1.title=adcon1[randomIndex].a_title,noticeAd1.setAttribute("suda-uatrack",adcon1[randomIndex].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',"")),"undefined"!=typeof SUDA&&SUDA.uaTrack(adcon1[randomIndex].a_v_suda_key,adcon1[randomIndex].a_v_suda_value)),adcon2&&(randomIndex=0,adcon2.length>1&&(randomIndex=Math.floor((adcon2.length+1)*Math.random())),noticeAd2.innerHTML=adcon2[randomIndex].words,noticeAd2.href=adcon2[randomIndex].a_href,noticeAd2.title=adcon2[randomIndex].a_title,noticeAd2.setAttribute("suda-uatrack",adcon2[randomIndex].a_c_suda.replace("suda-uatrack=","").replace('"',"").replace('"',"")),"undefined"!=typeof SUDA&&SUDA.uaTrack(adcon2[randomIndex].a_v_suda_key,adcon2[randomIndex].a_v_suda_value)),$tj.style.display="")};"waitting"===scope.__subscribeSlot?scope.__subscribeSlotFunc=complete:"object"==typeof scope.__subscribeSlot?complete(scope.__subscribeSlot):(scope.__subscribeSlot="waitting",Utils.Io.JsLoad.request("//comet.blog.sina.com.cn/api?maintype=pageslot",{GET:reqdata,onComplete:function(res){complete(res),scope.__subscribeSlot=res,"function"==typeof scope.__subscribeSlotFunc&&scope.__subscribeSlotFunc(res)},onException:function(){}}))}},setTemplate:function(template){this.template=template;var tmp=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=tmp,Core.Dom.insertHTML($E(this.appendTo),tmp.getHtmlString(),"afterbegin"),this.entity=$E("_"+this.uniqueID+"_panel"),this.entity.style.display="none",tempEntity=null}});return notice})),Lib.register("tray.unReadMsgPanel",(function(lib){return Core.Class.define((function(ele){if(lib.Panel.prototype.initialize(),"editor"!=scope.$pageid){this._lockstate=0,this._scrolling=0,this._srcPot=ele;var template=['<div class="cor"></div>','<div class="bd">','<a href="#" id="j-unread-msg-close" class="close" title="关闭">×</a>','<ul id="j-unre-list">',"</ul>","</div>"].join("");this.setTemplate('<div class="messageTips" id="#{panel}" style="left:850px; top:10px;">'+template+"</div>"),this.entity.style.zIndex=500,this._bindEvent()}}),lib.Panel,{show:function(){this.isShow||(v7sendLog("40_02_01"),this.entity.style.display="",this._srcPot&&this._srcPot.setAttribute("unread-show-state",1),this.isHidden=!1,this.isShow=!0,this.backIframe&&(this._updateBackIframe(),this.backIframe.style.display=""),lib.Listener.notify("tray-unread-panel-show",{}))},hide:function(){lib.Panel.prototype.hide.call(this),this._srcPot&&this._srcPot.setAttribute("unread-show-state",0),lib.Listener.notify("tray-unread-panel-hide",{})},_updatePanelIframe:function(){this.backIframe&&this._updateBackIframe()},_updateCont:function(data){var _list=[];if(data.comment+data.message+data.notice+data.gbook!=0){if(data.comment>0&&_list.push("<li>"+data.comment+'条新评论，<a onclick="v7sendLog(\'40_02_02\')" href="//i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">查看评论</a></li>'),data.message>0&&_list.push("<li>"+data.message+'条新纸条，<a onclick="v7sendLog(\'40_02_03\')" href="//control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">查看纸条</a></li>'),data.gbook>0&&_list.push("<li>"+data.gbook+'条新留言，<a onclick="v7sendLog(\'40_02_04\')" href="//i.blog.sina.com.cn/blogprofile/wall.php">查看留言</a></li>'),data.notice>0){var sysurl={notice:"//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",like:"//i.blog.sina.com.cn/profilelist/profilelikelist.php",notice_favourite:"//i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",notice_quote:"//i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",invite:"//control.blog.sina.com.cn/blogprofile/profileinvitelist.php",unreadnotices:"//i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",point:"//control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_note.php"},url=sysurl.notice;for(var key in data.notices)if(data.notices[key]>0){url=sysurl[key]||url;break}_list.push("<li>"+data.notice+'条新通知，<a onclick="v7sendLog(\'40_02_05\')" href="'+url+'">查看通知</a></li>')}$E("j-unre-list").innerHTML=_list.join(""),this.show(),this._setThePos()}else this.hide()},_setThePos:function(){var pop=Core.Dom.getXY(this._srcPot),sv="link"==this._srcPot.className?-2:0,width=$IE7||$IE6?this.entity.offsetWidth:this.entity.clientWidth;if(pop[0]){var x=pop[0]+this._srcPot.clientWidth-width+sv,_y=0;1==this._srcPot.getAttribute("adshow")&&0==this._scrolling&&(_y=pop[1]);var y=this._srcPot.clientHeight+_y+10;this.setPosition(x,y)}},_bindEvent:function(){var _this=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(data){_this._lockstate||(_this._eventHandle(data),_this._setThePos())}}),Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(data){_this._scrolling=1,_this._lockstate||(_this.setFixed(1),_this._setThePos())}}),Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(data){_this._scrolling=0,_this._lockstate||(_this.setFixed(0),_this._setThePos())}}),Lib.Listener.on({name:"topad680-show-end",callBack:function(data){_this._srcPot.setAttribute("adshow",1),_this.isShow&&_this._setThePos()}}),Core.Events.addEvent($E("j-unread-msg-close"),(function(e){var evt=e||window.event;evt.preventDefault?evt.preventDefault():evt.returnValue=!1,_this.hide(),_this._lockstate=1}),"click"),Core.Events.addEvent(window,(function(){_this.isShow&&_this._setThePos()}),"resize")},_eventHandle:function(data){var _data={};_data.comment=data.blogcomment-0+(data.photocomment-0)+data.blogrecomment,_data.notice=data.notice+data.like+data.notice_favourite+data.notice_quote+data.invite+data.unreadnotices+data.point,_data.notices={notice:data.notice,like:data.like,notice_favourite:data.notice_favourite,notice_quote:data.notice_quote,invite:data.invite,unreadnotices:data.unreadnotices,point:data.point},_data.message=data.message,_data.gbook=data.gbook,this._updateCont(_data)}})})),Lib.register("tray.msgSummaryPanel",(function(lib){var JSON=lib.util.JSON,nolist=['<li><a onclick="v7sendLog(\'40_02_13\')" href="//control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span>查看纸条</a></li>','<li><a onclick="v7sendLog(\'40_02_14\')" href="//i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span>查看留言</a></li>','<li><a onclick="v7sendLog(\'40_02_15\')" href="//i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice"><span class="icoms_notice"></span>查看通知</a></li>'];return Core.Class.define((function(ele){lib.Panel.prototype.initialize(),this._srcPot=ele,this._lock=1,this._scrolling=0,this._requirestate=1,this._nums={};var template=['<div class="bd">','<ul id="j-summary-list">',nolist.join(""),"</ul>","</div>"].join("");this.setTemplate('<div class="messageBox" id="#{panel}">'+template+"</div>"),this.entity.style.zIndex=500,this._bindEvent(),this._initNums()}),lib.Panel,{show:function(){this._checkNumChange()?this._updateCont():this._showAction()},_showAction:function(){this.isHidden?(this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",1),this.entity.style.display="",this.isHidden=!1,this.isShow=!0,this.backIframe&&(this._updateBackIframe(),this.backIframe.style.display=""),this._setThePos()):this._setThePos()},_checkNumChange:function(){return this._srcPot.getAttribute("msg-count")!=this._srcPot.getAttribute("old-msg-count")},hide:function(){lib.Panel.prototype.hide.call(this),this._srcPot&&this._srcPot.setAttribute("msg-panel-show-state",0),lib.Listener.notify("tray-msg-panel-hide",{})},_initNums:function(){var data=JSON.parse(this._srcPot.getAttribute("msg-count"));this._formatData(data)},_setThePos:function(){($IE6||$IE7||$IE8)&&(this.entity.style.width="auto");var pop=Core.Dom.getXY(this._srcPot),sv="link"==this._srcPot.className?-2:0,width=$IE7||$IE6?this.entity.offsetWidth:this.entity.clientWidth,x=pop[0]+this._srcPot.clientWidth-width+sv,_y=0;1==this._srcPot.getAttribute("adshow")&&0==this._scrolling&&(_y=$IE6||$IE7||$IE8?pop[1]-2:pop[1]);var y=this._srcPot.clientHeight+_y+1;($IE6||$IE7||$IE8)&&(this.entity.style.width=this.entity.clientWidth+1+"px",this.entity.style.width=this.entity.clientWidth-1+"px"),this.setPosition(x,y)},_updatePanelIframe:function(){this.backIframe&&this._updateBackIframe()},_updateCont:function(fun){var _list=[],_this=this;this._lock=0,this._requirestate&&(this._getDate({},(function(_data){_list.push(_this._getComment(_data)),_list.push(_this._getMessage(_data)),_list.push(_this._getGbook(_data)),_list.push(_this._getNotice(_data)),$E("j-summary-list").innerHTML=_list.join(""),_this._srcPot.setAttribute("old-msg-count",_this._srcPot.getAttribute("msg-count")),$IE6&&($E("j-summary-list").style.width="270px"),_this._showAction()}),(function(_data){})),this._requirestate=0)},_getDate:function(opt,funsuc,funerr){funsuc=funsuc||function(){},funerr=funerr||function(){};var _this=this;Lib.checkAuthor((function(){new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notelist.php","jsload").request({GET:{uid:$UID},onSuccess:function(result){funsuc(result)}.bind2(_this),onError:function(result){funerr({num:0})}.bind2(_this),onFail:function(){funerr({num:0})}.bind2(_this)})}),"msgSummaryPanel"+(new Date).getTime())},_getUserPicUrl:function(uid,size){size=size||50;return"//portrait"+(parseInt(uid)%8+1)+".sinaimg.cn/"+uid+"/blog/"+size},getLen:function(a){if(!a)return 0;var b=a.match(/[^\x00-\xff]/g);return a.length+(b?b.length:0)},strTruncate:function(str,len,suffix){return str=str||"",void 0===suffix&&(suffix="..."),this.getLen(str)>len?this.truncete(str,len)+suffix:str},truncete:function(b,c){var d=b.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");return b=b.slice(0,d.slice(0,c).replace(/\*\*/g," ").replace(/\*/g,"").length),this.getLen(b)>c&&c>0&&(b=b.slice(0,b.length-1)),b},getVipIcon:function(index){if(!index)return"";var vipicon={1:{icon:"SG_icon146",info:"新浪个人认证"},2:{icon:"SG_icon147",info:"新浪机构认证"}};return'<img class="SG_icon '+vipicon[index=index||1].icon+'" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="13" title="'+vipicon[index].info+'" alt="'+vipicon[index].info+'" align="absmiddle" />'},_setNameforIE6:function(name){return $IE6?this.strTruncate(name,4):name},_getComment:function(_data){var str="";if(this._nums._comment>0){var data=_data.msg.cms;if(data.length>0){for(var typemsg={1:"评论了你的博文",2:"评论了你的图片",6:"回复了你的评论"},typeurl={1:"//i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1",2:"//i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=2",6:"//i.blog.sina.com.cn/blogprofile/profilereplylist.php"},types=[],i=0,len=data.length;i<len;i++){var item=data[i],name=item.nick_name||item.name;name=this._setNameforIE6(name);var img=this._getUserPicUrl(item.uid,30),type=item.msg_type;types.push(type);var index=item.user_type||0,time=item.time;str+='<li><a onclick="v7sendLog(\'40_02_06\')" href="'+typeurl[type]+'"><img src="'+img+'"><em class="nl">'+name+"</em>"+this.getVipIcon(index)+'<em class="tm">'+time+"</em>"+typemsg[type]+"</a></li>"}types.sort(),this._nums._comment>3&&(str+='<li class="lcount"><a onclick="v7sendLog(\'40_02_07\')" href="'+typeurl[types[0]]+'">总共'+this._nums._comment+"条新评论</a></li>")}else str=nolist[0]}else str=nolist[0];return str},_getMessage:function(_data){var str="";if(this._nums._message>0){var data=_data.msg.note[0],name=data.name||data.nick_name;name=this._setNameforIE6(name);var numstr=this._nums._message>1?"等"+this._nums._message+"人":"",index=data.user_type||0;str+='<li class="bgc"><a onclick="v7sendLog(\'40_02_08\')" href="//control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1"><span class="icoms_tips"></span><em class="nl">'+name+"</em>"+this.getVipIcon(index)+numstr+'发来纸条<em class="nr">查看纸条</em></a></li>'}else str=nolist[1];return str},_getGbook:function(_data){var str="";if(this._nums._gbook>0){var data=_data.msg.note[1],name=data.name||data.nick_name;if(name){name=this._setNameforIE6(name);var numstr=this._nums._gbook>1?"等"+this._nums._gbook+"人":"给你",index=data.user_type||0;str+='<li class="bgc"><a onclick="v7sendLog(\'40_02_09\')" href="//i.blog.sina.com.cn/blogprofile/wall.php"><span class="icoms_message"></span><em class="nl">'+name+"</em>"+this.getVipIcon(index)+numstr+'留言<em class="nr">查看留言</em></a></li>'}}else str=nolist[2];return str},_getNotice:function(_data){var str="",_pronotice="//i.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilenotice",_sysnotice="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote",typeurl={3:"//control.blog.sina.com.cn/blogprofile/profileinvitelist.php",7:_pronotice,8:_pronotice,9:_pronotice,23:_pronotice,55:"//control.blog.sina.com.cn/blog_rebuild/profile/controllers/points_note.php",13:"//i.blog.sina.com.cn/profilelist/profilelikelist.php",100:_sysnotice,101:_sysnotice,102:_sysnotice,103:_sysnotice,104:_sysnotice,105:_sysnotice,106:_sysnotice,107:_sysnotice,108:_sysnotice,109:_sysnotice,110:_sysnotice,111:_sysnotice,112:_sysnotice};this._nums._notice>0?str+='<li class="bgc last"><a onclick="v7sendLog(\'40_02_10\')" href="'+typeurl[_data.msg.note[2].msg_type||23]+'"><span class="icoms_notice"></span>'+this._nums._notice+'条新通知<em class="nr">查看通知</em></a></li>':str=nolist[3];return str},_bindEvent:function(){var _this=this;Lib.Listener.on({name:"tray-newmsg-loaded",callBack:function(data){_this._requirestate=1,_this._eventHandle(data)}}),Lib.Listener.on({name:"tray-scrolling-nofix",callBack:function(data){_this._scrolling=0,_this._lockstate||(_this.setFixed(0),_this._setThePos())}}),Lib.Listener.on({name:"tray-scrolling-fix",callBack:function(data){_this._scrolling=1,_this._lockstate||(_this.setFixed(1),_this._setThePos())}}),Lib.Listener.on({name:"topad680-show-end",callBack:function(data){_this.isShow&&_this._setThePos()}})},_eventHandle:function(data){this._formatData(data),this.isShow&&this._updateCont()},_formatData:function(data){var _data={};_data._comment=data.blogcomment-0+(data.photocomment-0)+data.blogrecomment,_data._notice=data.notice+data.like+data.notice_favourite+data.notice_quote+data.invite+data.unreadnotices+data.point,_data._message=data.message,_data._gbook=data.gbook,this._cacheNums(data,_data)},_cacheNums:function(data,_data){for(var k in data)this._nums[k]=data[k];for(var key in _data)this._nums[key]=_data[key]}})})),Lib.register("TrayPanel",(function(lib){var _addEvt=Core.Events.addEvent,_removeEvt=Core.Events.removeEvent,_getCookie=Utils.Cookie.getCookie,_contains=Core.Dom.contains,JSON=lib.util.JSON,byClass=Core.Dom.getChildrenByClass,logoId="login_bar_logo_link_350",_trayHolder="______noticeTrayHolder",loadCount=0,tray=null,attr=function(el,attr,v){if("string"!=typeof v)return el.getAttribute(attr);el.setAttribute(attr,v)},TrayPanel=Core.Class.define((function(){var $topBaner=byClass(document.body,"nsinatopbar")[0],$main=this.$main=byClass($topBaner,"ntopbar_main")[0];this.newTipsLog=0,lib.Panel.prototype.initialize.call(this,{appendTo:$main,isPostion:!1,noIframe:!0}),lib.Listener.on({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this},{name:"tray-newmsg-loaded",callBack:this.showNewMsgTips,scope:this},{name:"global-login-out",callBack:function(){clearInterval(this._msgTimer)},scope:this},{name:"tray-announce-loaed",callBack:function(json){var args=arguments,$this=this;this.notice?this.notice.update(json):setTimeout((function(){args.callee.call($this,json)}),200)},scope:this},{name:"tray-unread-panel-hide",callBack:function(){var $trayMsg=this.getNode("trayMsg"),data=JSON.parse($trayMsg.getAttribute("msg-count"));this.showNewMsgTips(data,1)},scope:this},{name:"tray-unread-panel-show",callBack:function(){this.getNode("newTips").style.display="none"},scope:this},{name:"tray-msg-panel-hide",callBack:function(){var $trayMsg=this.getNode("trayMsg"),data=JSON.parse($trayMsg.getAttribute("msg-count"));this.showNewMsgTips(data,1)},scope:this},{name:"tray-announce-close",callBack:function(json){this.setTrayPosition()},scope:this},{name:"topad680-show-start",callBack:function(data){this._hideActiveSub()},scope:this}),loadCount&&loadCount++}),lib.Panel,{subPanels:[],hoverTimeout:"",hoverTime:400,load:function(loginState){if(!loadCount){var $logo=$E(logoId);$logo&&$_GLOBAL&&$_GLOBAL.platformTrayLogo&&(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs?$logo.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs:$_GLOBAL.platformTrayLogo.imgForIE6&&($logo.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6)),this.initSearch()}switch(loginState){case"login":/ipad/i.test(navigator.userAgent)&&v7sendLog("48_01_02");new Date;var $this=this;lib.tray.loadUserInfo($UID,(function(info){var $nick,$userInfo,$msnHolder;(scope.unreadMsg=info,scope.nickname=info.full_nickname,scope.loginUserWtype=info.login_wtype,$this._isRenderUser||($this.renderRight(lib.tray.tpl.loginMemu),$this._isRenderUser=!0),info.isbloguser)?($this.getNode("noOpenBlog").style.display="none",$this.initUserMenu(),$this.initBlogMenu(info),$this.initNewMsgEvt(),$this.initMsg(),$this.initMsgLoder(),$this.initHideSub(),$this.initunReadMsgPanel(),$nick=$this.getNode("userNick"),$userInfo=$this.getNode("openBlog")):(($nick=$this.getNode("ssoNick")).href="//control.blog.sina.com.cn/myblog/htmlsource/blog_notopen.php?uid="+$UID+"&version=7",$this.initOpenBlog(),$this.initLogout(),$userInfo=$this.getNode("noOpenBlog"));$nick.innerHTML="";var $nickTxt=document.createTextNode(info.nickname);($nick.appendChild($nickTxt),$userInfo.style.display="block",Utils.Cookie.getCookie("loginFromMsn")&&$nick)&&(($msnHolder=$this.getNode("msnHolder")).style.display="block",$this.getNode("msnLink").href+=$UID);$msnHolder&&Core.Dom.insertAfter($msnHolder,$nick.parentNode),$this.initNotice()}));break;case"logout":this.trayLogin||(this.trayLogin=new lib.Login.Ui,this.renderRight(lib.tray.tpl.loginOutMemu)),this.initLogin(),this.initNotice()}loadCount++},initMsgLoder:function(){if(!this.msgLoader){this.msgLoader=new lib.tray.MsgLoader,this.msgLoader.load($UID);var $this=this;this._msgTimer=setInterval((function(){$this.msgLoader.load($UID)}),3e4)}},initLogin:function(){attr(this._el,"login")||(attr(this._el,"login","1"),_addEvt(this._el,(function(evt){Lib.jumpLogin()}),"click"))},initLogout:function(){var $loginOut=this.getNode("ssoLoginOut");attr($loginOut,"loginout")||(attr(this._el,"login","1"),_addEvt($loginOut,(function(){lib.tray.loginOut(null,!0)}))),$loginOut=null},initHideSub:function(){var $this=this;_addEvt(document.body,(function(evt){if($this._activeTab){for(var item,target=evt.target||evt.srcElement,panels=$this.subPanels,i=panels.length-1;i>=0;i--){if((item=panels[i]).tab===target||_contains(item.tab,target))return;if(item.panel.entity===target||_contains(item.panel.entity,target))return}$this._hideActiveSub()}}),"click"),_addEvt(window,(function(){var activeTab=$this._activeTab;if(activeTab){var $tabEl=activeTab.tab,panel=activeTab.panel,offsetLeft=activeTab.left,offsetTop=activeTab.top,x=Core.Dom.getLeft($tabEl)+$tabEl.offsetWidth+offsetLeft,y=Core.Dom.getTop($tabEl)+$tabEl.offsetHeight+offsetTop;$IE6&&this.isFixed&&(x-=document.documentElement.scrollLeft,y-=document.documentElement.scrollTop),panel.setPosition(x,y)}}),"resize")},_hideActiveSub:function(){if(this._activeTab){var tabEl=this._activeTab.tab,panel=this._activeTab.panel;this._activeTab=null,panel.hidden(),tabEl.className=tabEl.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}},initUserMenu:function(){var $bindEl=this.getNode("userMenu");if(!attr($bindEl,"init")){attr($bindEl,"init","1");var hasEmail,$this=this,$tabEl=$this.getNode("userMenu"),userMenu=$this._findSub("userMenu"),flag=0;Lib.util.hoverJq({elm:$bindEl,mouseenter:function(e,el,i){if(clearTimeout($this.hoverTimeout),!flag){var panel;flag=1,userMenu?panel=userMenu.panel:(panel=new lib.tray.UserMenuPanel,$this.addSubPanel("userMenu",panel,$bindEl,$tabEl));var $userPanelNode=panel.getNode("panel");panel.initUserInfo($UID),Lib.util.hoverJq({elm:$userPanelNode,mouseenter:function(e,el,i){clearTimeout($this.hoverTimeout),$this._showPanel("userMenu",-160,0)},mouseleave:function(e,el,i){$this.hoverTimeout=setTimeout((function(){$this._hideActiveSub()}),$this.hoverTime)}}),getEmail((function(hasEmail){hasEmail&&(panel.getNode("mail").style.display="")}))}$this._showPanel("userMenu",-160,0)},mouseleave:function(e,el,i){$this.hoverTimeout=setTimeout((function(){$this._hideActiveSub()}),$this.hoverTime)}});var getEmail=function(cb){"boolean"==typeof hasEmail?cb(hasEmail):Utils.Io.JsLoad.request("//service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){var email=sinamailinfo.email;cb(hasEmail=""!=email)},onException:function(){}})}}},initBlogMenu:function(info){var $bindEl=this.getNode("addArticle");if(!attr($bindEl,"init")){attr($bindEl,"init","1");var $this=this,$tabEl=$this.getNode("blogMenu"),flag=0;Lib.util.hoverJq({elm:$tabEl,mouseenter:function(e,el,i){if(clearTimeout($this.hoverTimeout),!flag){var panel;flag=1,$this._findSub("blogMenu")||(panel=new lib.tray.BlogMenuPanel,$this.addSubPanel("blogMenu",panel,$bindEl,$tabEl),1===info.tbh_status&&(panel.getNode("tbh_status").style.display=""));var $blogMenuPanel=panel.getNode("panel");Lib.util.hoverJq({elm:$blogMenuPanel,mouseenter:function(e,el,i){clearTimeout($this.hoverTimeout),$this._showPanel("blogMenu",-74,0)},mouseleave:function(e,el,i){$this.hoverTimeout=setTimeout((function(){$this._hideActiveSub()}),$this.hoverTime)}})}$this._showPanel("blogMenu",-74,0)},mouseleave:function(e,el,i){$this.hoverTimeout=setTimeout((function(){$this._hideActiveSub()}),$this.hoverTime)}})}},initNotice:function(){var productName=scope.$PRODUCT_NAME,pageId=scope.$pageid;if("blog7"===productName)if(-1!==pageId.indexOf("article")||-1!==pageId.indexOf("index")){var flagUid=_getCookie("closeNotice_fzp"),$blogBody=$E("sinablogHead"),_this=this;Lib.checkAuthor((function(){if(flagUid&&flagUid===$UID||!$blogBody)_this.noNotice=!0;else if(!_this.notice){var notice=new lib.tray.BlogNotice({appendTo:$E(logoId).parentNode,isPostion:!1,noIframe:!0});_this.notice=notice;var logFlag,$this=_this,height=$blogBody.offsetHeight+30,onshow=function(){var doc=document;doc.body.scrollTop+doc.documentElement.scrollTop>height?($this.hideActive(),$this.setTrayFixed(),logFlag||(logFlag=1,v7sendLog("48_01_11_"+scope.$pageid))):setTimeout((function(){$this.setTrayPosition(),notice.hide()}))};_addEvt(window,onshow,"scroll"),lib.Listener.on({name:"tray-announce-close",callBack:function(){_removeEvt(window,onshow,"scroll")}})}}),"tray1"+(new Date).getTime())}else this.noNotice=!0;else this.noNotice=!0},initNewMsgEvt:function(){this.tpl;var $newTips=this.getNode("newTips");if(!attr($newTips,"init")){attr($newTips,"init","1");var $this=this;_addEvt($newTips,(function(evt){var $target=(evt=evt||window.event).target||evt.srcElement;Core.Events.stopEvent(evt),$target.style.display="none",$target.innerHTML="";var $msgTab=$this.getNode("trayMsg");Core.Events.fireEvent($msgTab,"click")}),"click"),$newTips=null}},initMsg:function(){var $bindEl=this.getNode("trayMsg");if(!attr($bindEl,"init")){attr($bindEl,"init","1");var $this=this,flag=0;Lib.util.hoverJq({elm:$bindEl,mouseenter:function(e,el,i){if(clearTimeout($this.hoverTimeout),!flag){flag=1;var ev=window.event||e;ev.preventDefault?ev.preventDefault():ev.returnValue=!1;var panel,$bindEl=$this.getNode("trayMsg");$this._findSub("msgPanel")||(panel=new Lib.tray.msgSummaryPanel($bindEl),$this.addSubPanel("msgPanel",panel,$bindEl,$bindEl));var $msgPanel=panel.getNode("panel");Lib.util.hoverJq({elm:$msgPanel,mouseenter:function(e,el,i){clearTimeout($this.hoverTimeout),$this._showPanel("msgPanel",-400,0)},mouseleave:function(e,el,i){$this.hoverTimeout=setTimeout((function(){$this._hideActiveSub()}),$this.hoverTime)}})}$this._showPanel("msgPanel",-400,0)},mouseleave:function(e,el,i){$this.hoverTimeout=setTimeout((function(){$this._hideActiveSub()}),$this.hoverTime)}})}},initunReadMsgPanel:function(){var $bindEl=this.getNode("trayMsg");attr($bindEl,"init-unre")||(attr($bindEl,"init-unre","1"),new lib.tray.unReadMsgPanel($bindEl))},initSearch:function(){if(!loadCount){var panel=new lib.tray.SearchFormPanel({isPostion:!1,appendTo:"traySearchBar",noIframe:!0});panel.show(),_addEvt(document.body,(function(evt){var target=(evt=evt||window.event).target||evt.srcElement;panel.getNode("queryTxt")===target||panel.entity===target||_contains(target,panel.entity)||panel.catePanel.hide()}),"click")}},initOpenBlog:function(){if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"});var $openBlog=this.getNode("openBlogBtn");scope.addBlogOpenerEvent($openBlog)}},notifyMsgPanel:function($msgTab){var newMsg=$msgTab.getAttribute("msg-count");if(newMsg)try{newMsg=JSON.parse(newMsg)}catch(e){newMsg={}}else newMsg=-1},renderRight:function(tpl){this.setTemplate(tpl),this._el=this.entity,byClass(this.$main,"ntopbar_loading")[0].style.display="none",this.show()},addSubPanel:function(name,panel,bindEl,tabEl){this.subPanels.push({name:name,tab:tabEl,bind:bindEl,panel:panel})},_showPanel:function(name,offsetLeft,offsetTop){var subBar=this._findSub(name);if(subBar){var item,$tab,panel=subBar.panel,$tabEl=subBar.tab;if(panel.entity.style.zIndex=512,"msgPanel"===name){var $newTips=this.getNode("newTips");this.notifyMsgPanel($tabEl),$newTips.style.display="none"}if(item=this._activeTab){if(($tab=item.tab)===$tabEl)return;item.panel.hide(),$tab.className=$tab.className.replace(/(?:[ ]*)\bcurrent\b/g,"")}var className=$tabEl.className;/\bcurrent\b/.test(className)||($tabEl.className+=" current"),this._activeTab={name:name,tab:$tabEl,panel:panel,left:offsetLeft,top:offsetTop};var $entity=panel.entity;this.isFixed&&(!$IE||$IE>6)?$entity.style.position="fixed":$entity.style.position="absolute",panel.showWithDom($tabEl,offsetLeft,offsetTop)}},_findSub:function(name){for(var item,i=this.subPanels.length-1;i>=0;i--)if(name===(item=this.subPanels[i]).name)return item;return null},showNewMsgTips:function(data,sign){var sum=data.sum-data.feed,$tips=this.getNode("newTips"),$trayMsg=this.getNode("trayMsg");if(sum){0==$trayMsg.getAttribute("unread-show-state")&&0==$trayMsg.getAttribute("msg-panel-show-state")&&($tips.style.display="block"),"editor"==scope.$pageid&&($tips.style.display="block");var offsetWidth=this.entity.offsetWidth;$tips.style.left=offsetWidth-$tips.offsetWidth-10+"px",$tips.innerHTML=sum<10?sum:"•••",this.newTipsLog||(v7sendLog("40_01_49_"+$UID),this.newTipsLog=1),$trayMsg.setAttribute("msg-count",JSON.stringify(data)),this.startTitleTips(sum)}else $trayMsg.setAttribute("msg-count",JSON.stringify(data)),this.stopTitleTips();var feed=data.feed;if(feed){var $feed=this.getNode("newFeed");$feed.style.display="block";offsetWidth=this.entity.offsetWidth;$feed.style.left=offsetWidth-$feed.offsetWidth-197+"px",feed=feed<10?feed:"•••",$feed.innerHTML=feed,$feed.addEvt||($feed.addEvt=1,_addEvt($feed,(function(){location.href="//i.blog.sina.com.cn/blogprofile/index.php?com=1",$feed.style.display="none",$feed.innerHTML=""})))}},stopTitleTips:function(){if("editor"!=scope.$pageid){var title=document.title.replace(/\(\d+\+*\)/,"");document.title=title}},startTitleTips:function(sum){var title;"editor"!=scope.$pageid&&(sum&&(sum=sum>=1e5?"99999+":sum,title=/\(\d+\+*\)/.test(document.title)?document.title.replace(/\(\d+\+*\)/,"("+sum+")"):"("+sum+")"+document.title),document.title=title)},hideActive:function(){var item,$tab;(item=this._activeTab)&&(item.panel.hide(),($tab=item.tab).className=$tab.className.replace(/(?:[ ]*)\bcurrent\b/g,""),this._activeTab=null)},setTrayFixed:function(){var $logo=$E(logoId);this.notice.show();var $this=this;setTimeout((function(){$E("traySearchBar").parentNode.style.display="none",$logo.style.display="none";var $tray=$logo.parentNode.parentNode;if(!$IE||$IE>6?(lib.Listener.notify("tray-scrolling-fix",{}),$tray.style.position="fixed",$tray.style.top="0px"):6===$IE&&($this.__isFixie6||(_addEvt(window,(function(evt){if($this.isFixed){var oldScrollTop=document.documentElement.scrollTop;setTimeout((function(){var current=document.documentElement.scrollTop;oldScrollTop===current?($tray.style.display="block",$this._ie6fix(evt)):$this.isFixed&&($tray.style.display="none")}),50)}}),"scroll"),$this.__isFixie6=!0)),$tray.style.width="100%",!$E(_trayHolder)){var height=$tray.offsetHeight,$holder=$C("div");$holder.style.height=height+"px",$holder.id=_trayHolder,Core.Dom.insertAfter($holder,$tray)}$this.isFixed=!0}))},_ie6fix:function(evt){if(this.isFixed){var $tray=$E(logoId).parentNode.parentNode;$tray.style.position="absolute",$tray.style.top=document.documentElement.scrollTop+"px";var trayMsg=this.getNode("trayMsg");trayMsg&&(trayMsg.style.display="none",trayMsg.style.display=""),lib.Listener.notify("tray-scrolling-fix",{})}},setTrayPosition:function(){if($IE6){var trayMsg=this.getNode("trayMsg");trayMsg&&(trayMsg.style.display="none",trayMsg.style.display="")}lib.Listener.notify("tray-scrolling-nofix",{});var $logo=$E(logoId),$tray=$logo.parentNode.parentNode;$E(_trayHolder)&&$tray.parentNode.removeChild($E(_trayHolder)),$tray.style.position="";var $search=$E("traySearchBar");$search.style.position="",$search.style.top="",this.notice.hide(),$tray.style.display="block",$logo.style.display="block",$E("traySearchBar").parentNode.style.display="block",this.isFixed=!1}});return Lib.tray.TrayPanel=TrayPanel,function(){return tray||(tray=new TrayPanel),tray}})),Core.System.htmlFilter=function(content){var k,codeHash={"&":"&#038;","<":"&#060;",">":"&#062;"};for(k in codeHash)content=content.replace(new RegExp(k,"g"),codeHash[k]);return content},Utils.Io.loadExternalCSS=function(url,callback){if("string"==typeof url){var linkObj,styleObj,head=document.getElementsByTagName("head")[0];$FF?((styleObj=$C("style")).type="text/css",styleObj.innerHTML="@import url("+url+")",head.appendChild(styleObj),function(){try{styleObj.sheet.cssRules,"function"==typeof callback&&callback()}catch(e){setTimeout(arguments.callee,50)}}()):((linkObj=$C("link")).href=url,linkObj.type="text/css",linkObj.rel="stylesheet",linkObj.media="all",head.appendChild(linkObj),$SAFARI||$CHROME?function(){try{linkObj.sheet.cssRules,"function"==typeof callback&&callback()}catch(e){setTimeout(arguments.callee,50)}}():linkObj.onload=function(){linkObj.onload=null,"function"==typeof callback&&callback()})}},Core.Events.click=function(){var isMobile=/mobile/i.test(navigator.userAgent);return $IE&&$IE<9?function(clickBtn){clickBtn.click()}:function(clickBtn){var evt;(evt=isMobile?document.createEvent("HTMLEvents"):document.createEvent("MouseEvents")).initEvent("click",!0,!0),clickBtn.dispatchEvent(evt)}}(),Core.Dom.removeClassName=Core.Dom.removeClass,scope.trayPlusTemplayLogout=['<div class="topbar_menu">','<span class="link"><a target="_blank" href="//blog.sina.com.cn">博客首页</a></span>','<span class="line_s"></span>',"</div>",'<div class="topbar_login"><a id="linkTrayLogin" class="login" href="javascript:;">登录</a><a id="linkReg" target="_blank" class="register" href="">注册</a></div>','<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join(""),scope.trayPlusTemplayLogin=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a><a href="javascript:;" class="link_arrow" title=""></a></span>','<span class="line_s"></span>','<span style="display:none;" id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="//mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" style="display:none;" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="//i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="//control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="//simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><a href="#" onclick="return false;" class="link_arrow" title=""></a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s"></span>','<span class="link" id="logOut"><a href="#">退出</a></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="loginBarActivity" class="topbar_activity"></div>'].join(""),scope.trayPlusTemplayOnceLoged=['<div class="topbar_menu" id="openedBlogTray">','<span id="loginBarOptApp" class="link"><a id="loginBarAppMenuLabel" href="javascript:;">读取中...</a></span>','<span class="line_s"></span>','<span id="loginBarMail" class="link imfor blog_to_mail"><a target="_blank" href="//mail.sina.com.cn/?s=2">邮件</a><div id="mailpiaohong" style="display:none;" class="imforbox"></div></span>','<span class="line_s" id="line"></span>','<span id="loginBarCenter" class="link"><a target="_self" href="//i.blog.sina.com.cn/blogprofile/index.php?com=1">个人中心</a></span>','<span class="line_s"></span>','<span id="loginBarFriend" class="link"><a target="_blank" href="//control.blog.sina.com.cn/blogprofile/profilefriendlist.php">好友</a></span>','<span class="line_s"></span>','<span id="loginBarInbox" class="link imfor"><img id="imgNewMessage" style="display:none;" class="topbar_msg" src="//simg.sinajs.cn/blog7style/images/common/topbar/topbar_msg.gif"/><a href="#" onclick="return false;">消息</a><div id="ccnotepiaohong" style="display:none;" class="imforbox"></div></span>',"</div>",'<div style="display:none" class="topbar_menu" id="noOpenedBlogTray">','<span class="link" style="cursor:default;"><a id="noOpenBlogName">读取中...</a></span>','<span class="line_s"></span>','<span class="link"><a href="#">退出</a></span>',"</div>",'<div class="topbar_noopen" style="display:none" id="outOfOpenBlogTray">','<a id="openBlogBtnTray" title="立即开通博客" class="nowopen" href="javascript:void(0)" onclick="return false;"></a>',"</div>",'<div id="divPopularize" class="topbar_ad"></div>','<div id="loginBarActivity" class="topbar_activity"></div>'].join(""),scope.newStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="//i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="//control.blog.sina.com.cn/blogprofile/profileremind.php?com=2"><span id="nstFavorite" style="padding:3px 2px;display:none;">你有博文被<span style="color:red">转载/收藏</span></span></a>','<img id="gbimg" class="SG_icon SG_icon83" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="17" height="15" align="absmiddle" style="display:none"/><a style="display:none" href="//i.blog.sina.com.cn/blogprofile/index.php?com=g" id="gbmsg">官博<em>新动态</em></a>',"</div>"].join(""),scope.onceLogedStatusTipTemplay=['<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main tip_ps" style="width:130px;text-align:left;padding:5px 0 2px 5px;color:#000000">','<a onclick="$E(\'newStatusTip\').style.display=\'none\';return false" href="#" class="tb_friend_inputDel" title="关闭" style="margin-top: 5px;"></a>','<a href="javascript:void(0);return false;"><span id="nstUnread" style="padding:3px 2px;display:none;">你有<span style="color:red">未读消息</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstFeed" style="padding:2px 2px;display:none;">你有<span style="color:red">新动态</span>可查看</span></a>','<a href="javascript:void(0);return false;"><span id="nstUpdate" style="padding:3px 2px;display:none;">你最近浏览的博主<span style="color:red">有更新</span></span></a>','<a href="javascript:void(0);return false;"><span id="nstUnpub" style="padding:2px 2px;display:none;">你有<span style="color:red">尚未发表</span>的博文</span></a>',"</div>"].join(""),scope.nicknamePanelTemplate=['<div id="#{panel}" class="tb_layer_Y tb_layer_w2" style="z-index:512;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_ps">','<div class="tb_ps_list">',"<ul>","<li>",'<span class="tb_ps_nm"><a id="#{linkBlog}" href="javascript:;"><img class="SG_icon SG_icon15" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="博客" align="absmiddle" /><strong>博客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostBlog}" href="//control.blog.sina.com.cn/admin/article/article_add.php">发博文</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{linkPhoto}" href="javascript:;"><img class="SG_icon SG_icon18" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="相册" align="absmiddle" /><strong>相册</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkPostPhoto}" href="//photo.blog.sina.com.cn/upload/upload.php">发图片</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a target="_blank" id="#{linkVBlog}" href="javascript:;"><img class="SG_icon SG_icon16" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="播客" align="absmiddle" /><strong>播客</strong></a></span>','<span class="tb_ps_set">[<a target="_blank" id="#{linkUpload}" href="//vupload.you.video.sina.com.cn/u.php?m=1">发视频</a>][<a id="#{linkRecord}" href="//vupload.you.video.sina.com.cn/r.php" target="_blank">录视频</a>]</span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{miniblog}" href="javascript:;" target="_blank"><img class="SG_icon SG_icon51" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="微博" align="absmiddle" /><strong>微博</strong></a></span>',"</li>","<li>",'<span class="tb_ps_nm"><a id="#{mySpace}" href="javascript:;"><img class="SG_icon SG_icon41" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="关于我" align="absmiddle" /><strong>关于我</strong></a></span>',"</li>","</ul>",'<div class="clearit"></div>',"</div>",'<div class="tb_ps_manage">','<p><a target="_blank" id="#{linkChangeFace}" href="javascript:;">修改头像昵称</a></p>','<p><a target="_blank" id="#{linkChangePassword}" href="javascript:;">修改登录密码</a></p>','<p><a target="_blank" id="#{linkAccountSetup}" href="javascript:;">账号安全设置</a></p>','<p><a target="_blank" id="#{bindEmail}" href="javascript:;">绑定邮箱</a></p>',"</div>","</div>","</div>","</div>"].join(""),scope.NicknamePanel=Core.Class.define((function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.nicknamePanelTemplate)}),Lib.Panel,{initUserInfo:function(uid){var nodes=this.getNodes();scope.$bindEmail=function(data){var node=nodes.bindEmail;"y"!=data.ret&&"not_verify"!=data.errcode?node.parentNode.removeChild(node):node.href="https://login.sina.com.cn/bindmail/bindmail.php?entry=blog"};try{var AuthorInfo=Utils.Cookie.getCookie("SUBP");if(AuthorInfo&&""!=AuthorInfo){var username=sinaSSOEncoder.getSUBPCookie.decode(AuthorInfo).ln;Utils.Io.JsLoad.request("https://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent(username)+"&utf82bgk=1&callback=scope.$bindEmail",{noreturn:!0})}}catch(e){}nodes.linkBlog.href="//blog.sina.com.cn/u/"+uid,nodes.linkPhoto.href="//photo.blog.sina.com.cn/u/"+uid,nodes.linkVBlog.href="//you.video.sina.com.cn/m/"+uid,nodes.miniblog.href="//control.blog.sina.com.cn/t_sina_blog/tb.php?uname="+uid,nodes.mySpace.href="//blog.sina.com.cn/s/profile_"+uid+".html",nodes.linkChangeFace.href="//control.blog.sina.com.cn/blogprofile/nick.php",nodes.linkChangePassword.href="https://security.sina.com.cn/account/security?option=chgpwd&entry=blog ",nodes.linkAccountSetup.href="https://security.sina.com.cn/account/security";for(var node=["linkBlog","linkPhoto","linkVBlog","miniblog","mySpace","linkChangeFace","linkChangePassword","linkAccountSetup"],i=0;i<node.length;i++)nodes[node[i]].onclick=function(){v7sendLog("40_01_02_"+$UID)}}});var st=['<div id="#{panel}" style="z-index:512;" class="tb_layerBox">',"<ul>",'<li id="#{blog}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博文</a></li>','<li id="#{bauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">博主</a></li>','<li id="#{song}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">音乐</a></li>','<li id="#{video}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">视频</a></li>','<li id="#{vauthor}"><a href="javascript:;" onclick="v7sendLog(\'40_01_19\')">播主 </a></li>',"</ul>","</div>"];scope.searchPanelTemplate=st.join(""),scope.SearchPanel=Core.Class.define((function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.searchPanelTemplate)}),Lib.Panel,{config:{blog:{text:"博文",url:"//search.sina.com.cn/?c=blog",keyName:"q",range:"article",by:"all"},bauthor:{text:"博主",url:"//search.sina.com.cn/?c=blog",keyName:"q",range:"author",by:"all"},song:{text:"音乐",url:"//music.sina.com.cn/yueku/search/s.php",keyName:"k",t:"song",s:"",ts:"",type:"",stype:""},video:{text:"视频",url:"//search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"1"},vauthor:{text:"播主",url:"//search.video.sina.com.cn/search.php",keyName:"k",t:"",s:"sup",ts:"",type:"boke",stype:"3"}}}),Utils.Flash.swfView={swfList:[],Add:function(sURL,sID,sPID,nWidth,nHeight,nVersion,sBGColor,oVar,oParam){if(sURL&&sPID)return this.swfList[this.swfList.length]={sURL:sURL,sID:sID,sPID:sPID,nWidth:nWidth,nHeight:nHeight,nVersion:nVersion,sBGColor:sBGColor,oVar:oVar,oParam:oParam},void this.Init()},Init:function(){for(var so,list=this.swfList,i=0,len=list.length;i<len;i++){var _list=list[i];if(so=new Utils.Flash.swfObject(_list.sURL,_list.sPID,_list.nWidth,_list.nHeight,_list.nVersion,_list.sBGColor),_list.oVar)for(var key in _list.oVar)so.addVariable(key,_list.oVar[key]);if(_list.oParam)for(var Key in _list.oParam)so.addParam(Key,_list.oParam[Key]);so.write(_list.sID)}list=[],_list=null,so=null}},Utils.Io.loadCss=function(oCss,oTarget){if(null==oCss)return!1;var _css,_target=(oTarget=oTarget||window).document;oCss.id=oCss.id||"",oCss.url?((_css=_target.createElement("link")).setAttribute("rel","stylesheet"),_css.setAttribute("type","text/css"),_css.setAttribute("href",oCss.url)):oCss.text&&((_css=_target.createElement("style")).setAttribute("type","text/css"),$IE?_css.styleSheet.cssText=oCss.text:_css.innerHTML=oCss.text),_css.setAttribute("id",oCss.id),_target.getElementsByTagName("head")[0].appendChild(_css)};var st=['<div id="#{panel}" style="z-index:512;" class="tb_layer_Y tb_layer_w6" style="left:400px; top:700px;">','<div class="tb_layer_arrow"></div>','<div class="tb_layer_Y_main">','<div class="tb_mas" id="#{newInboxList}" style="">','<div class="tb_mas_list">','<ul id="#{changebgli1}"  style="display:none" >','<li  style="display:none" >','<span id="#{ccsysgonggao}" class="tb_friend_nm">[<strong>公告</strong>] <a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪邀你一起共度中秋活动</a></span>','<span class="tb_friend_set"><a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>",'<li style="display:none">','<span id="#{ccsystongzhi}" class="tb_friend_nm">[<strong>通知</strong>] <a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">新浪2010邀你一起共度中秋活动...</a></span>','<span class="tb_friend_set"><a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">&gt;&gt;</a></span>',"</li>","</ul>",'<ul class="bd" id="#{changebgli2}">','<li  id="#{newInboxLoding}" style="cursor:default" ><div style="margin: 0pt; padding: 10px;text-align:center;"><img src="//simg.sinajs.cn/blog7style/images/common/loading.gif"><div></li>','<li  id="#{nomsgli}" style="cursor:default;" >还没有消息</li>','<li style="float:none;"><span class="mas_more"><a id="#{mas_moremsg}" href="//i.blog.sina.com.cn/blogprofile/profilelatestnote.php">全部消息</a></span></li>',"</ul>",'<div class="clearit"></div>',"</div>",'<ul class="commentslist" id="commentdata">','<li><a class="conn" href="//i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1">评论</a><a class="num" href="//i.blog.sina.com.cn/blogprofile/profilecommlist.php?type=1" id="#{commentRelapseCount}" ></a></li>','<li><a class="conn" href="//i.blog.sina.com.cn/blogprofile/wall.php">留言</a><a class="num" href="//i.blog.sina.com.cn/blogprofile/wall.php" id="#{guestBookCount}">1</a></li>','<li class="lst"><a class="conn" href="//control.blog.sina.com.cn/blogprofile/profileinvitelist.php">好友邀请</a><a class="num" href="//control.blog.sina.com.cn/blogprofile/profileinvitelist.php" id="#{inviteCount}" ></a></li>','<li><a class="conn" href="//control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1">纸条</a><a class="num" href="//control.blog.sina.com.cn/blogprofile/profilepaperlist.php?type=1" id="#{messageCount}" ></a></li>','<li><a class="conn" target="_blank" href="//mail.sina.com.cn" reject="1">邮箱</a><a class="num" href="//mail.sina.com.cn" id="#{mailCount}" target="_blank" reject="1"></a></li>','<li><a class="conn" href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">系统消息</a><a class="num" href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote" id="#{sysnoticeCount}" ></a></li>',"</ul>","</div>","</div>","</div>"];scope.newInboxPanelTemplate=st.join(""),Lib.LocalDB={_this:null,isFlashReady:!1,FlaDom:null,updataFun:null,loadedFun:null,regiFun:[],regiFunArgs:[],scacheReady:function(){var me=Lib.LocalDB;me.isFlashReady=!0,me.loadedFun&&me.loadedFun(me._this);for(var f=me.regiFun,a=me.regiFunArgs,i=0;i<f.length;i++)f[i].apply(null,a[i])},registerFun:function(fun,args){this.regiFun.push(fun);var a=args||[];this.regiFunArgs.push(a)},set:function(key,data){if(this.isFlashReady)try{return this.FlaDom.setLazyInterface(key,data),!0}catch(e){trace("set函数出错")}return!1},get:function(key,escapeMsecond,ignore){if(this.isFlashReady)try{return this.FlaDom.getLazyInterface(key,escapeMsecond,ignore)}catch(e){trace("get函数出错")}return!1},clearCache:function(escapeMsecond,key){if(this.isFlashReady)try{$E("scache").clearCache(escapeMsecond,key)}catch(e){trace("gclearCache函数出错")}return!1},loadFlash:function(containerDiv){var random="";if((window.$Maxthon||window.$360||window.$TT)&&(random="?t="+Core.Math.getUniqueId()),!this.FlaDom){var FlashPlayer=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"scache.swf"+random,"scache","1","1","9","#00ff00");FlashPlayer.addParam("quality","high"),FlashPlayer.addParam("wmode","transparent"),FlashPlayer.addParam("allowScriptAccess","always"),FlashPlayer.write(containerDiv),this.FlaDom=$E("scache")}},getServer:function(){try{return this.FlaDom.isServer()}catch(e){return trace("判断是否是通信主机发生错误"),!1}},login:function(uid){try{this.FlaDom.login(uid)}catch(e){trace("login函数出错"),trace(uid)}},sendToClient:function(data){try{this.getServer()&&this.FlaDom.sendToClient(data)}catch(e){trace("sendToClient函数出错")}},setClientJsFun:function(jsFun){try{this.getServer()?this.FlaDom.setClientJsFun(jsFun):trace("非主机不可以设置接收函数")}catch(e){trace("setClientJsFun函数出错")}},receive:function(data){this.updataFun(data)}},scope.msnTipsTemplate=['<div id="#{panel}" style="position: absolute; width: 369px; padding-top: 7px; font-size: 12px; z-index:511">',"<div  style=\"top: 0pt; left: 65px; position: absolute; width: 16px; height: 8px; background: url('//simg.sinajs.cn/blog7style/images/special/move/bg_boxtop_01.png') no-repeat scroll 0pt 0pt transparent; z-index: 100;\"></div>","<div style=\"padding: 5px 6px 9px 14px; border: 1px solid rgb(181, 202, 214); background: url('//simg.sinajs.cn/blog7style/images/special/move/bg_asiangames.jpg') no-repeat scroll left bottom rgb(255, 255, 255); z-index: 1;\">",'<p id="#{close}" class="close" style="float: right; margin: 0pt; cursor: pointer; width: 8px; height: 8px; font-size: 0pt;background:url(\'//simg.sinajs.cn/blog7style/images/special/move/btn_close.gif\') no-repeat 0 0;"></p>','<div style="width: 342px; margin: 10px 0pt 0pt; padding: 0pt 0pt 3px;">','<a style="float: left; margin: 0pt 10px 0pt 0pt;" href="#"><img height="91" width="122" style="border: 0pt none;" alt="MSN" src="//simg.sinajs.cn/blog7style/images/special/move/img_msnphoto.png"></a>','<h3 style="padding: 2px 0pt 5px; color: rgb(0, 0, 0); margin: 0pt; font-size: 12px;">各位拥有MSN帐号的同学注意啦!</h3>','<p style="width: 268px; display: inline; text-indent: 0pt; padding: 0pt; color: rgb(51, 51, 51); line-height: 19px;">新浪博客帐号与MSN帐号已经实现关联。您可以使用MSN帐号来登录博客，绑定后发博文、发图片可同步到Live，第一时间让您的MSN好友知晓。</p>',"</div>",'<p style="clear: both; height: 30px; margin: 12px 10px 4px 0pt; padding: 12px 0pt 0pt; border-top: 1px solid rgb(220, 213, 211); text-align: right;"><a style="float: right; color: rgb(176, 173, 172); margin-top: 10px; text-decoration: none;" href="javascript:void(0);" id="#{noMoreShow}">不再显示</a><a style="float: right; text-decoration: none; margin: 10px 14px 0pt 16px;color:#2d3186;" href="//blog.sina.com.cn/s/blog_4b0f52990100lt3i.html">帮助</a><a id="#{setNow}"style="float: right;" href="//control.blog.sina.com.cn/blogprofile/msnbind.php"><img height="32" width="105" style="border: medium none;" alt="立即设置" src="//simg.sinajs.cn/blog7style/images/special/move/btn_receive01.jpg"></a></p>',"</div>","</div>"].join(""),scope.msnTips=Core.Class.define((function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.msnTipsTemplate)}),Lib.Panel,{initUserInfo:function(nick,uid){var nodes=this.getNodes();this.setFixed($E("loginBarActivity"),-230,-2);var _this=this;nodes.close.onclick=function(){_this.hidden()},nodes.noMoreShow.onclick=function(){_this.hidden(),Utils.Cookie.setCookie("noMoreMsnTips"+$UID,1,2400,"/",".blog.sina.com.cn")},nodes.setNow.onclick=function(){v7sendLog("95_02_01",scope.$pageid,"")}},setFixed:function(dom,offsetLeft,offsetTop){var _this=this;setTimeout((function(){_this.showWithDom(dom,offsetLeft,offsetTop),_this.fadeIn()}),2e3),Core.Events.addEvent(window,(function(){var x=Core.Dom.getLeft(dom)+dom.offsetWidth+offsetLeft,y=Core.Dom.getTop(dom)+dom.offsetHeight+offsetTop;$IE6&&_this.isFixed&&(x-=document.documentElement.scrollLeft,y-=document.documentElement.scrollTop),_this.setPosition(x,y)}),"resize")},fadeIn:function(){var entity=this.entity;Core.Dom.opacity(entity,0);var i=0;!function fn(){Core.Dom.opacity(entity,i+=5),Core.Dom.getStyle(entity,"opacity")<1&&setTimeout(fn,20)}()}}),scope.NewInboxPanel=Core.Class.define((function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.newInboxPanelTemplate),this.nodes=this.getNodes();var me=this,t=Lib.LocalDB;/Mobile/i.test(navigator.userAgent)?setTimeout((function(){me.requestDataInterface()}),100):t.FlaDom?me.FlashLoaded(me):(t._this=me,t.loadedFun=me.FlashLoaded,t.loadFlash("trayFlashConnetion")),Core.Events.addEvent($E("loginBarInbox"),(function(event){v7sendLog("40_01_09_"+$UID);var target=event&&event.target||window.event&&window.event.srcElement;target&&target.tagName&&"a"==target.tagName.toLowerCase()&&v7sendLog("45_01_10_"+$UID),me._hasOverview=!0,$E("ccnotepiaohong").style.display="none",me.requestMsgDate()}),"click"),this.interfaceMessages=new Interface("//interface.blog.sina.com.cn/riaapi/profile/unread.php","jsload")}),Lib.Panel,{nodes:null,_connectSWF:null,_SWFChannelName:"inboxConnection",interfaceMessges:null,isMessageLoaded:!1,isUICServiceLoaded:!0,isHaveNewMessage:!1,_listData:null,_productIDs:{blog:1,vblog:2,group:4,photo:8,cube:16},_msgIsLoad:!1,_newnote:0,_hasOverview:!1,interfaceUICServiceURL:"//uic.sinajs.cn/uic?type=service&uids=#{uids}&varname=service",FlashLoaded:function(me){var t=Lib.LocalDB,_this=me;window.$updateData=function(dataObj){_this.updateData(dataObj)},Lib.checkAuthor((function(){t.login($UID),t.setClientJsFun("$updateData"),setTimeout((function(){_this.requestDataInterface()}),100)}),"NewInboxPanel"+(new Date).getTime())},requestMsgDate:function(){this.updateView("loading");var me=this,clearnum=0;this._hasOverview&&(clearnum=this._newnote,this._newnote=0,this._hasOverview=!1),new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/notetips.php?clearnum="+clearnum,"jsload").request({GET:{uid:$UID},onSuccess:function(res){if("undefined"!=typeof res.announcement&&res.announcement?(me.nodes.ccsysgonggao.innerHTML='[<strong>公告</strong>]&nbsp;<a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+res.announcement+"</a>",me.nodes.ccsysgonggao.parentNode.style.display=""):me.nodes.ccsysgonggao.parentNode.style.display="none","undefined"!=typeof res.sysNote&&res.sysNote?(me.nodes.ccsystongzhi.innerHTML='[<strong>通知</strong>]&nbsp;<a href="//control.blog.sina.com.cn/blog_rebuild/profile/controllers/notelist.php?action=profilesysnote">'+res.sysNote+"</a>",me.nodes.ccsystongzhi.parentNode.style.display=""):me.nodes.ccsystongzhi.parentNode.style.display="none","undefined"==typeof res.sysNote&&"undefined"==typeof res.announcement?me.nodes.ccsystongzhi.parentNode.parentNode.style.display="none":me.nodes.ccsystongzhi.parentNode.parentNode.style.display="",me.nodes.nomsgli.style.display="","undefined"!=typeof res.notice&&res.notice){for(var aNotice=res.notice;me.nodes.changebgli2.childNodes.length>2;)me.nodes.changebgli2.removeChild(me.nodes.changebgli2.childNodes[me.nodes.changebgli2.childNodes.length-3]);for(var i=aNotice.length-1;i>=0;i--){var li=$C("li");li.innerHTML=aNotice[i].data,li._href=aNotice[i].url,me.nodes.changebgli2.insertBefore(li,me.nodes.changebgli2.firstChild),li.onclick=function(){v7sendLog("45_01_11_"+$UID),window.location.href=this._href},me.nodes.nomsgli.style.display="none"}}if(parseInt($E("ccnotepiaohong").innerHTML,10)>0)for(var num=parseInt($E("ccnotepiaohong").innerHTML,10),cn=me.nodes.changebgli2.childNodes,j=0;j<cn.length-2&&j<num;j++)Core.Dom.removeClassName(cn[j],"cur"),cn[j].className+=" cur";me.updateView("loaded"),me._msgIsLoad=!0,me.bindliEvent()},onError:function(data){},onFail:function(){}}),new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/unreadmail.php","jsload").request({onSuccess:function(data){var tota=parseInt(data)||0;tota>99&&(tota="99+"),me.nodes.mailCount.innerHTML=tota||""},onError:function(){me.nodes.mailCount.innerHTML=""}})},requestDataInterface:function(){var _this=this;Lib.checkAuthor((function(){var t=Lib.LocalDB,d=null;t.isFlashReady&&!_this.checkCache&&(_this.clearCache(),d=t.get("uid_"+$UID+"unread",24e4),_this.checkCache=!0);var unreadOk=function(data,isCache){d||isCache||t.set("uid_"+$UID+"unread",data),0==data.isBindToMsn&&Utils.Cookie.getCookie("noMoreMsnTips"+$UID),_this.isMessageLoaded=!0,_this.onMessageLoad(data.nickname),_this._listData=data,scope.unreadMsg=data,scope.nickname=data.full_nickname,scope.loginUserWtype=data.login_wtype,data.svr_time&&(scope.$svr_time=data.svr_time),data.nfn>=1&&(v7sendLog("40_01_03_"+$UID),_this.initNewStatusTip(data)),_this.updateListData(data),_this.isMessageLoaded&&(_this.updateData({data:_this._listData}),_this.onLoaded()),scope.hasOpenBlog=1==data.isbloguser?"open":"no",scope.bindTrayOpenTime=1,Lib.Listener.notify("tray-data-loaded",data),"no"==scope.hasOpenBlog&&1==scope.bindTrayOpenTime&&($E("openblogcss")||Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"}),$E("openedBlogTray").style.display="none",$E("noOpenedBlogTray").style.display="",$E("outOfOpenBlogTray").style.display="",scope.addBlogOpenerEvent($E("openBlogBtnTray")),$E("noOpenBlogName").href="//blog.sina.com.cn/u/"+$UID,scope.bindTrayOpenTime=2),scope.unreadOkExecuted=!0};d?(unreadOk(d,!0),trace("-------unread 使用缓存的数据!!!----")):(trace("-----直接调用unread接口！！！"),_this.interfaceMessages.request({GET:{uid:$UID,product:"blog"},onSuccess:unreadOk,onError:function(data){},onFail:function(){}}))}),"NewInboxPanelrequestDataInterface"+(new Date).getTime())},clearCache:function(){var pageId={profile_notice:"notice",profile_paperlist:"message",profile_invitelist:"invite",profile_commlist:"blogcomment",profile_replylist:"blogrecomment",profile_guestBookM:"gbook",profile_commtrash:"trashcomment",profile_commphotolist:"photocomment",profile_index:"profile_index",profile_remind:"profile_remind"},t=Lib.LocalDB,d=t.get("uid_"+$UID+"unread",24e4);d&&pageId[scope.$pageid]&&typeof d[pageId[scope.$pageid]]!=undefined&&(trace("-----清除缓存"),t.clearCache(10,"uid_"+$UID+"unread"));var ccn=$UID+"_clear_flash";1==Utils.Cookie.getCookie(ccn)&&(trace("【活动】根据cookie标记,清除Flash缓存"),t.clearCache(10,"uid_"+$UID+"unread"),Utils.Cookie.setCookie(ccn,"",0,"/",".sina.com.cn"))},initMsnTips:function(){Lib.checkAuthor((function(){(new scope.msnTips).initUserInfo($nick,$UID)}),"NewInboxPanel"+(new Date).getTime())},initNewStatusTip:function(data){if("profile_index"!=scope.$pageid&&"pageSetM"!=scope.$pageid&&"editor"!=scope.$pageid){var tip=$E("newStatusTip");if(!tip&&data){v7sendLog("45_01_07_"+$UID),(tip=$C("div")).id="newStatusTip",tip.className="tb_layer_Y tb_layer_w3",tip.style.width="138px",tip.innerHTML=scope.newStatusTipTemplay;var a=$T($E("loginBarCenter"),"a")[0],loc=Core.Dom.getXY(a);tip.style.left=loc[0]-(69-a.offsetWidth/2)+"px",tip.style.top=loc[1]+a.offsetHeight+"px",tip.style.zIndex="510",-1==a.href.indexOf("?")&&(a.href+="?type=2&from="+scope.$pageid),Core.Dom.opacity(tip,0),document.body.appendChild(tip),data.nfn>=1&&($E("nstFeed").style.display="block",$E("nstFeed").onclick=function(){v7sendLog("45_01_09_"+$UID),v7sendLog("40_01_04_"+$UID)}),1==data.official_blog&&($E("gbimg").style.display="",$E("gbmsg").style.display="");for(var i=1;i<=500;i++)!function(val){setTimeout((function(){Core.Dom.opacity(tip,2*val/10)}),2*val)}(i);"editor"==scope.$pageid&&(a.target="_blank",$E("nstFeed").parentNode.target="_blank",$E("gbmsg").style.target="_blank",Core.Events.addEvent(a,this.closeTip(a),"click")),Core.Events.addEvent(window,(function(){var a=$T($E("loginBarCenter"),"a")[0],loc=Core.Dom.getXY(a);tip.style.left=loc[0]-(69-a.offsetWidth/2)+"px",tip.style.top=loc[1]+a.offsetHeight+"px"}),"resize")}}},closeTip:function(ele){return function(){$E("newStatusTip").style.display="none",ele.href=ele.href.split("?")[0]}},updateData:function(dataObj){var t=Lib.LocalDB,_this=this;Lib.checkAuthor((function(){try{($UID&&$UID==dataObj.uid||1==t.getServer())&&(_this.isHaveNewMessage=!1,_this.isMessageLoaded=!1,_this.updateListData(dataObj.data),_this._newnote>0&&(v7sendLog("45_01_08_"+$UID),v7sendLog("40_01_08_"+$UID)),dataObj.data.nfn>=1&&_this.initNewStatusTip())}catch(ex){}1==t.getServer()?Lib.checkAuthor((function(){t.sendToClient({data:dataObj.data,uid:$UID}),setTimeout((function(){_this.requestUICService(),_this.requestDataInterface()}),24e4)}),"NewInboxPanel"+(new Date).getTime()):setTimeout((function(){t.getServer()&&(t.setClientJsFun("$updateData"),_this.requestUICService(),_this.requestDataInterface())}),24e4)}),"NewInboxPanel"+(new Date).getTime())},initializeList:function(){this.requestUICService(),this.checkCache=!1},updateListData:function(dataCollection){try{var tota=0;(tota+=parseInt(this._getFormatCountString(dataCollection.invite)||0))>500&&(tota="500+"),this.nodes.inviteCount.innerHTML=tota||""}catch(e){}try{tota=0;(tota+=parseInt(this._getFormatCountString(dataCollection.message)||0))>500&&(tota="500+"),this.nodes.messageCount.innerHTML=tota||""}catch(e){}try{tota=0;tota+=parseInt(dataCollection.unreadnotices||0),(tota+=parseInt(dataCollection.notice||0))>500&&(tota="500+"),this.nodes.sysnoticeCount.innerHTML=tota||""}catch(e){}Lib.checkAuthor();try{tota=0;tota+=parseInt(this._getFormatCountString(dataCollection.gbook)||0),(tota+=parseInt(this._getFormatCountString(dataCollection.trashwall)||0))>500&&(tota="500+"),this.nodes.guestBookCount.innerHTML=tota||""}catch(e){}try{tota=0;tota+=parseInt(dataCollection.blogcomment||0),tota+=parseInt(dataCollection.blogrecomment||0),tota+=parseInt(dataCollection.photocomment||0),(tota+=parseInt(dataCollection.trashcomment||0))>500&&(tota="500+"),this.nodes.commentRelapseCount.innerHTML=tota||""}catch(e){}this._newnote=parseInt(dataCollection.newnotes,10),this._newnote>0?($E("ccnotepiaohong").innerHTML=this._newnote>500?"500+":this._newnote,$E("ccnotepiaohong").style.display=""):$E("ccnotepiaohong").style.display="none";var i,msgCfg=["notice","invite","message","blogcomment","blogrecomment","photocomment","trashcomment","vblogcomment","gbook"],len=msgCfg.length;for(i=0;i<len;i++){var k;for(k in parseInt(dataCollection[msgCfg[i]])>0&&(this.isHaveNewMessage=!0),dataCollection)"version"!=k&&window.parseInt(dataCollection[k])>0&&$E("left_"+k)&&($E("left_"+k).innerHTML="("+dataCollection[k]+")")}},requestUICService:function(){var _this=this;Lib.checkAuthor((function(){_this.isMessageLoaded&&(_this.updateData({data:_this._listData}),_this.onLoaded())}),"newInboxPanel_requestUICService"+(new Date).getTime())},_getFormatCountString:function(count){var result="";return isNaN(parseInt(count))||0==parseInt(count)||(result=parseInt(count)>500?"(<strong>500+</strong>)":count),result},updateView:function(loadState){this.nodes.newInboxLoding.style.display="loaded"==loadState?"none":"","loading"==loadState&&(this.nodes.nomsgli.style.display="none")},onLoaded:function(){},onMessageLoad:function(nickname){$E("loginBarAppMenuLabel").innerHTML=Core.System.htmlFilter(nickname),$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(nickname)},bindliEvent:function(){for(var lis=this.nodes.changebgli1.getElementsByTagName("li"),lis2=this.nodes.changebgli2.getElementsByTagName("li"),i=0;i<lis.length;i++)lis[i].style.cursor="pointer",lis[i].onmouseover=function(){this._className=this.className,this.className="on"},lis[i].onmouseout=function(){this.className=this._className};for(i=0;i<lis2.length-1;i++)lis2[i]!=this.nodes.nomsgli&&(lis2[i].style.cursor="pointer",lis2[i].onmouseover=function(){this._className=this.className,this.className="on"},lis2[i].onmouseout=function(){this.className=this._className});var commentdata=$E("commentdata");function logFunc(event){var target=event&&event.target||window.event&&window.event.srcElement;!target||!target.tagName||"a"!=target.tagName.toLowerCase()&&"li"!=target.tagName.toLowerCase()||target.getAttribute("reject")||(v7sendLog("40_01_10_"+$UID),v7sendLog("45_01_11_"+$UID))}commentdata&&Core.Events.addEvent(commentdata,(function(event){logFunc(event)})),Core.Events.addEvent(this.nodes.changebgli1,(function(event){logFunc(event)})),Core.Events.addEvent(this.nodes.changebgli2,(function(event){logFunc(event)}))}}),scope.addArticleTemplate=['<div id="#{panel}" class="wrtBlog_sub" style="z-index:512;">','<div class="wrtBlog_sub2">','<p><img width="15" height="16" align="absmiddle" title="写365" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon138"><a onclick="v7sendLog(\'48_01_18\');v7sendLog(\'40_01_14\');" href="//control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank">写365</a></p>','<div class="SG_j_linedot"></div>',"</div>","</div>"].join(""),scope.addArticlePanel=Core.Class.define((function(){Lib.Panel.prototype.initialize.apply(this,arguments),this.setTemplate(scope.addArticleTemplate),this.hidden()}),Lib.Panel,{}),Core.Events.stopBubble=function(el){var ev=el||Core.Events.getEvent();null!=ev&&(ev.cancelBubble=!0)},(!$IE||$IE>8)&&(Core.Events.stopBubble=function(el){var ev=el||Core.Events.getEvent();null!=ev&&ev.stopPropagation()}),Lib.PlatformTrayPlus=Core.Class.create(),Lib.PlatformTrayPlus.prototype={tray:null,subPanels:[],trayLogin:null,initialize:function(){},load:function(loginState){var bar_logo=$E("login_bar_logo_link_350");switch(bar_logo&&$_GLOBAL&&$_GLOBAL.platformTrayLogo&&(!$IE6&&$_GLOBAL.platformTrayLogo.imgForOtherBrs?bar_logo.children[0].src=$_GLOBAL.platformTrayLogo.imgForOtherBrs:$_GLOBAL.platformTrayLogo.imgForIE6&&(bar_logo.children[0].src=$_GLOBAL.platformTrayLogo.imgForIE6)),loginState){case"login":null!=$E("loginBarOptApp")&&$isAdmin||(this.render(scope.trayPlusTemplayLogin),trace("++++js渲染 登陆后++++++")),this.initStatic(),/ipad/i.test(navigator.userAgent)&&v7sendLog("48_01_02"),this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]),this.initNicknamePanel(),this.initNewInboxPanel(),this.initActivityPanel();var that=this;if(Utils.Io.JsLoad.request("//service.mail.sina.com.cn/mailproxy/mail.php",{onComplete:function(){""!=sinamailinfo.email&&that.initMailRemind()},onException:function(){}}),this.initMsnLogout(),scope&&scope.$private&&scope.$private.msnfeed){var _this=this;setTimeout((function(){_this.displayUserGuideTips()}),1e3)}break;case"logout":this.trayLogin=new Lib.Login.Ui,null===$E("phprender")?(this.render(scope.trayPlusTemplayLogout),trace("-----------js渲染---------")):trace("-----------php渲染---------"),this.initLogin(),this.initPopularize();break;case"oncelogedon":this.trayLogin=new Lib.Login.Ui,this.render(scope.trayPlusTemplayOnceLoged),this.setNodesMouseHoverStyle(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"]);var info=Lib.Login.info(),uid=info&&info.uid;$E("loginBarAppMenuLabel").innerHTML=info&&info.nick,this.initPopularize(),this.initOnceLogedEvent(["loginBarOptApp","loginBarMail","loginBarCenter","loginBarFriend","loginBarInbox"],uid),this.initOnceLogedTips(uid),this.initStatic()}this.initAddArticlePanel(),this.initSearchPanel(),this.initFilmSearch()},displayUserGuideTips:function(){if(window.scope&&"profile_index"!==scope.$pageid);else Utils.Cookie.setCookie($UID+"alreadyVisitProfileIndex","true","86400","/",".sina.com.cn")},initStatic:function(){if(!this._commetTimer){var send=function(){var uid=scope.$uid,blogid=scope.$articleid||"";Utils.Io.JsLoad.request("//comet.blog.sina.com.cn/api?maintype=notice",{GET:{uid:uid||"",blogid:blogid},onComplete:function(r){}})};this._commetTimer=setInterval(send,3e4),setTimeout((function(){send()}),15)}},initFilmSearch:function(){var ele=$E("loginBarSearchInput");ele&&(ele.value="");var tag=$E("loginBarSearchSType");tag&&(tag.value="title")},render:function(html){$E("trayContainer").innerHTML=html},initLogin:function(){var me=this;Core.Dom.getElementsByClass($E("trayContainer"),"span","link")[0].onclick=function(){v7sendLog("40_01_15")},Core.Events.addEvent($E("linkTrayLogin"),(function(){v7sendLog("40_01_16"),"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),me.trayLogin.login((function(){Lib.checkAuthor((function(){v7sendLog("87_01_"+($UID==scope.$uid?"02":"01")+"_"+$UID,scope.$pageid)}),"PlatformTrayPlus"+(new Date).getTime()),setTimeout((function(){window.location=window.location.toString().replace(/#.*/,"")}),100)}),!1,"referer:"+location.hostname+location.pathname+",func:0007")}),"click"),$E("linkReg").href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=blogicp",$E("linkReg").onclick=function(){v7sendLog("40_01_17")},scope.$channel&&2==scope.$channel&&($E("linkReg").href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid="+scope.$uid+"&src=baby")},initPopularize:function(){var popEl=$E("divPopularize");popEl&&(this.hideActiLink(popEl),this._loadPopularizeData(popEl))},_loadPopularizeData:function(parentEl){Utils.Io.JsLoad.request("//blog.sina.com.cn/lm/iframe/283/2012/0705/1.js",{charset:"utf-8",onComplete:function(data){var cfg=$_GLOBAL.popularizeConfig;if(cfg&&!parentEl.innerHTML){var len=cfg.length,cookieUtil=Utils.Cookie,index=parseInt(cookieUtil.getCookie("blogPopularizeIndex")||0);if(len<=index&&(index=0),cookieUtil.setCookie("blogPopularizeIndex",1+index,24,"/",".blog.sina.com.cn"),parentEl.innerHTML=cfg[index],$E("err_i8t9c")){var txt=parentEl.innerText||parentEl.textContent||"";txt.length>10&&(parentEl.children[0].innerHTML=txt.substr(0,9)+"...")}}}})},setNodesMouseHoverStyle:function(nodeNames){var i,len=nodeNames.length;for(i=0;i<len;i++)Core.Events.addEvent($E(nodeNames[i]),function(idx){return function(){Core.Dom.removeClassName($E(nodeNames[idx]),"current"),$E(nodeNames[idx]).className+=" current"}}(i),"mouseover"),Core.Events.addEvent($E(nodeNames[i]),function(idx){return function(){Core.Dom.removeClassName($E(nodeNames[idx]),"current")}}(i),"mouseout");$E("loginBarCenter").onclick=function(){v7sendLog("40_01_05_"+$UID)},$E("loginBarFriend").onclick=function(){v7sendLog("40_01_06_"+$UID)},$E("logOut").onclick=function(){v7sendLog("40_01_11_"+$UID)}},initNicknamePanel:function(){var nicknamePanel=new scope.NicknamePanel,_this=this;Lib.checkAuthor((function(){nicknamePanel.initUserInfo($UID),_this.addSubPanel(nicknamePanel,$E("loginBarOptApp"),-98,-9)}),"PlatformTrayPlus1"+(new Date).getTime());if(Utils.Cookie.getCookie("loginFromMsn")&&!$E("msnLoginIcon")){var holder=$C("img");holder.src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",holder.style.cssFloat=holder.style.styleFloat="left",holder.width="18",holder.height="0",holder.style.padding="9px 0",holder.align="absmiddle",Core.Dom.insertAfter(holder,$E("loginBarAppMenuLabel")),trace("创建msn icon"),function(holder){var mask=$C("a"),span=holder.parentNode,container=span.parentNode,node=$C("img");function relocation(){var timer=setInterval((function(){if("读取中..."!==$E("loginBarAppMenuLabel").innerHTML){var strLeft=holder.offsetLeft+"px";mask.style.left=strLeft,trace("刷新msn icon mask"),clearInterval(timer)}}),300)}container.style.position="relative",span.style.position="relative",node.id="msnLoginIcon",node.className="SG_icon SG_icon136",node.src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",node.style.width="18px",node.style.height="18px",node.align="absmiddle",mask.appendChild(node),mask.href="//control.blog.sina.com.cn/blogprofile/msnbind.php?c="+ +new Date,mask.target="_blank",mask.style.cssText="display:block; width:18px; height:18px; position:absolute; z-index:1024;",mask.style.paddingTop="4px",mask.title="MSN账号登录",container.insertBefore(mask,container.childNodes[0]),Core.Events.addEvent(window,relocation,"resize"),trace("创建msn icon mask"),relocation(),scope.$msnRelocation=relocation}(holder)}else trace("不渲染msn icon")},initAddArticlePanel:function(){var addArticlePanel=new scope.addArticlePanel;this.addSubPanel(addArticlePanel,$E("arrowAddArticle"),-81,0),$E("arrowAddArticle").onclick=function(){v7sendLog("40_01_13_"+($UID||""))},$E("arrowAddArticle").parentNode.children[0].onclick=function(){v7sendLog("40_01_12_"+($UID||""))}},showPublishWare:function(data){if(data.tbh_status&&parseInt(data.tbh_status,10)){$E("tray_tbh_ware_linedot").style.display="";var publishBtn=$E("tray_tbh_ware_link");publishBtn.style.display="";try{var link=$T(publishBtn,"a")[0];scope&&"editor"==scope.$pageid&&(link.href="javascript:;",link.target="",link.onclick=function(){for(var imgs=$T($E("shortcut_content"),"img"),i=0;i<imgs.length;i++)-1!=imgs[i].src.indexOf("element_shop")&&Core.Events.click(imgs[i])}),link=null,publishBtn=null}catch(e){}}Lib.Listener.off({name:"tray-data-loaded",callBack:this.showPublishWare,scope:this})},initSearchPanel:function(){var searchPanel=new scope.SearchPanel;this.addSubPanel(searchPanel,$E("searchSelect"),-54,-4),Utils.Form.limitMaxLen($E("loginBarSearchInput"),50);var cfg,spNodes=searchPanel.getNodes();for(cfg in searchPanel.config)!function(c){Core.Events.addEvent(spNodes[c],(function(){_setActiveOption(c)}),"click")}(cfg);function _setActiveOption(opt){var formEl=$E("loginBarSearchForm");formEl.action=searchPanel.config[opt].url,$E("loginBarSearchMenuLabel").innerHTML=spNodes[opt].getElementsByTagName("a")[0].innerHTML;var searchCEl=$E("loginBarSearchC"),searchTEl=$E("loginBarSearchT"),searchTypeEl=$E("loginBarSearchType"),searchSEl=$E("loginBarSearchS"),searchTSEl=$E("loginBarSearchTS"),searchTextEl=$E("loginBarSearchInput");switch(opt){case"all":case"blog":case"bauthor":searchCEl||((searchCEl=$C("input")).type="hidden",searchCEl.name="c",searchCEl.id="loginBarSearchC",formEl.appendChild(searchCEl)),searchCEl.value="blog",searchTEl.value=searchPanel.config[opt].range,searchTEl.name="range",searchTypeEl.value=searchPanel.config[opt].by,searchTypeEl.name="by",searchTextEl.name=searchPanel.config[opt].keyName;break;case"song":case"video":case"vauthor":searchCEl&&(searchCEl.value=""),searchTEl.value=searchPanel.config[opt].t,searchTEl.name="t",searchSEl.value=searchPanel.config[opt].s,searchTSEl.value=searchPanel.config[opt].ts,searchTypeEl.value=searchPanel.config[opt].type,searchTypeEl.name="type",$E("loginBarSearchSType").value=searchPanel.config[opt].stype,searchTextEl.name=searchPanel.config[opt].keyName}}_setActiveOption("blog"),$E("searchSelect").onclick=function(){v7sendLog("40_01_18")},Core.Dom.getElementsByClass($E("loginBarSearchForm"),"input","topbar_searchBtn")[0].onclick=function(){v7sendLog("40_01_20")},Core.Events.addEvent($E("loginBarSearchInput"),(function(e){15==(e.keyCode||e.charCode)&&v7sendLog("40_01_20")}),"keyup")},hideActiLink:function(el){var pageId=scope.$pageid;"pageSetM"!==pageId&&"editor"!==pageId&&(el.style.display="none",el.setAttribute("shouldShow","1")),setTimeout((function(){"undefined"!=typeof BLOG_AD_TIPS&&BLOG_AD_TIPS||(el.style.display="")}),3e3)},initActivityPanel:function(){if($_GLOBAL){var loginActLink=$E("loginBarActivity");loginActLink&&(this.hideActiLink(loginActLink),this._loadPopularizeData(loginActLink))}$_GLOBAL.activityBlackList&&$_GLOBAL.activityBlackList[scope.$pageid]&&trace("【活动】当前页面在黑名单")},initMsnLogout:function(){var _tray=$E("openedBlogTray"),_a_list=_tray.getElementsByTagName("a"),_logout_a=_a_list[_a_list.length-1];_logout_a.href="#",_logout_a.onclick=function(){return!1};var _tray_noIn=$E("noOpenedBlogTray"),_a_list_noIn=_tray_noIn.getElementsByTagName("a"),_logout_a_noIn=_a_list_noIn[_a_list_noIn.length-1];_logout_a_noIn.href="#",_logout_a_noIn.onclick=function(){return!1};var _curHref=encodeURIComponent(window.location.href);function logoutMsnAndBlog(){new Interface("//control.blog.sina.com.cn/blog_rebuild/msn/api/msnLoginOut.php","jsload").request({onSuccess:function(res){window.location.href="https://login.sina.com.cn/cgi/login/logout.php?r="+_curHref},onError:function(res){window.location.href="https://login.sina.com.cn/cgi/login/logout.php?r="+_curHref},onFail:function(res){window.location.href="https://login.sina.com.cn/cgi/login/logout.php?r="+_curHref}})}_tray&&Core.Events.addEvent(_logout_a,logoutMsnAndBlog),_tray_noIn&&Core.Events.addEvent(_logout_a_noIn,logoutMsnAndBlog)},addSubPanel:function(panel,dom,offsetLeft,offsetTop){var _this=this;this.subPanels.push(panel),Core.Events.addEvent(dom,(function(){dom===$E("loginBarOptApp")&&v7sendLog("40_01_01_"+$UID),function(){Core.Events.stopEvent();var i,len=_this.subPanels.length;for(i=0;i<len;i++)_this.subPanels[i].hidden();panel.showWithDom(dom,offsetLeft,offsetTop)}()}),"click"),Core.Events.addEvent(document.body,(function(){panel.hidden()}),"click"),Core.Events.addEvent(panel.entity,(function(){Core.Events.stopEvent()}),"mousedown"),Core.Events.addEvent(window,(function(){var x=Core.Dom.getLeft(dom)+dom.offsetWidth+offsetLeft,y=Core.Dom.getTop(dom)+dom.offsetHeight+offsetTop;$IE6&&this.isFixed&&(x-=document.documentElement.scrollLeft,y-=document.documentElement.scrollTop),panel.setPosition(x,y)}),"resize")},initNewInboxPanel:function(){var newInboxPanel=new scope.NewInboxPanel;this.addSubPanel(newInboxPanel,$E("loginBarInbox"),-137,-9);try{if(!$E("ccnotepiaohong")){var di=$C("div");di.className="imforbox",di.style.display="none",di.id="ccnotepiaohong",$E("loginBarInbox").appendChild(di)}$E("loginBarInbox").className="link imfor"}catch(e){}newInboxPanel.onMessageLoad=function(nickname){$E("loginBarAppMenuLabel").innerHTML=nickname,$E("noOpenBlogName").innerHTML=Core.System.htmlFilter(nickname)}},initMailRemind:function(){function remindEmail(){new Interface("//interface.blog.sina.com.cn/riaapi/profile/unreadmail.php","jsload").request({onSuccess:function(data){var tota=parseInt(data,10);if(tota>99&&(tota="99+"),0!==tota&&$E("mailpiaohong")){var num=$E("mailpiaohong");num.style.display="",num.innerHTML=tota}else $E("mailpiaohong").style.display="none"},onError:function(){$E("mailpiaohong").style.display="none"}})}$E("loginBarMail")&&$E("line")&&($E("loginBarMail").style.display="",$E("line").style.display=""),remindEmail();setInterval(remindEmail,3e5);Core.Events.addEvent($E("loginBarMail"),(function(){v7sendLog("40_01_07_"+$UID);var redEl=$E("mailpiaohong");!redEl.style.display&&(redEl.style.display="none")}),"click"),Core.Events.addEvent($E("mailpiaohong"),(function(){$E("mailpiaohong").style.display="none",window.open("//mail.sina.com.cn/?s=2")}),"click")},initOnceLogedEvent:function(nodeNames,uid){var i,len=nodeNames.length,me=this;for(i=0;i<len;i++)$E(nodeNames[i]).onclick=function(){switch(this.id){case"loginBarOptApp":v7sendLog("44_01_07_"+uid);break;case"loginBarMail":v7sendLog("44_01_08_"+uid);break;case"loginBarCenter":v7sendLog("44_01_09_"+uid);break;case"loginBarFriend":v7sendLog("44_01_10_"+uid);break;case"loginBarInbox":v7sendLog("44_01_11_"+uid)}return"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),me.trayLogin.login((function(){setTimeout((function(){window.location=window.location.toString().replace(/#.*/,"")}),100)}),!1),!1}},initOnceLogedTips:function(uid){var me=this;Utils.Io.JsLoad.request("//interface.blog.sina.com.cn/riaapi/profile/unread.php",{GET:{uid:uid,product:"blog"},onComplete:function(res){if("profile_index"!=scope.$pageid&&"pageSetM"!=scope.$pageid&&"editor"!=scope.$pageid){var tip=$E("newStatusTip");if(!tip){(tip=$C("div")).id="newStatusTip",tip.className="tb_layer_Y tb_layer_w3",tip.style.width="138px",tip.innerHTML=scope.onceLogedStatusTipTemplay;var a=$T($E("loginBarCenter"),"a")[0],loc=Core.Dom.getXY(a);tip.style.left=loc[0]-(69-a.offsetWidth/2)+"px",tip.style.top=loc[1]+a.offsetHeight+"px",tip.style.zIndex="510",tip.style.display="none",document.body.appendChild(tip)}res.data.unreadnotes>=1?(v7sendLog("44_01_12_"+uid),tip.style.display="block",$E("nstUnread").style.display="block",$E("nstUnread").onclick=function(){return v7sendLog("44_01_13_"+uid),"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),me.trayLogin.login((function(){setTimeout((function(){window.location="//i.blog.sina.com.cn/blogprofile/profilelatestnote.php"}),100)}),!1),!1}):res.data.nfn>=1&&(v7sendLog("44_01_14_"+uid),tip.style.display="block",$E("nstFeed").style.display="block",$E("nstFeed").onclick=function(){return v7sendLog("44_01_15_"+uid),"undefined"!=typeof sinaSSOController&&(sinaSSOController.loginExtraQuery={}),me.trayLogin.login((function(){setTimeout((function(){window.location="//i.blog.sina.com.cn/blogprofile/index.php?type=3&from=newstatus&com=2"}),100)}),!1),!1}),Core.Events.addEvent(window,(function(){var a=$T($E("loginBarCenter"),"a")[0],loc=Core.Dom.getXY(a);tip.style.left=loc[0]-(69-a.offsetWidth/2)+"px",tip.style.top=loc[1]+a.offsetHeight+"px"}),"resize")}},onException:function(data){}})}},$registJob("tray",(function(){var tray,isNewTray;Lib.Listener.add("tray-data-loaded");var $logo=$E("login_bar_logo_link_350");isNewTray=!(!$logo||"ntopbar_main"!==$logo.parentNode.className),tray=isNewTray?Lib.TrayPanel():new Lib.PlatformTrayPlus;var uid=Lib.Login.info().uid;window.$onceLog=!1;var onceloggedonblog=unescape(Utils.Cookie.getCookie("onceloggedonblog"));if(onceloggedonblog&&uid){time=onceloggedonblog;var now=(new Date).getTime();time&&now>time&&($onceLog=!0)}Lib.checkAuthor((function(){$isLogin?tray.load("login"):tray.load("logout")}),"tray123"+(new Date).getTime()),window.$tray={},window.$tray.renderLogin=function(){Lib.checkAuthor((function(){$isLogin&&tray.load("login")}),"tray1"+(new Date).getTime())},window.$tray.renderLogout=function(){tray.load("logout")}})),$registJob("login",(function(){var Login=new Lib.Login.Ui;Core.Events.addEvent("loginbtn",(function(){Login.login((function(){alert("做一些，登陆之后，做的事情，呵呵！")}))}))})),function(){var getImgStaticPath=function(pid,type){if(!pid)return"";var type=type||"orignal";try{var num=eval("0X"+pid.substring(pid.length-2))%16+1;return"https://s"+num+".sinaimg.cn/"+type+"/"+pid}catch(e){return trace("图片URL计算出错！PID:"+pid),""}};window.getImgStaticPath=getImgStaticPath}(),Utils.insertTemplate=function(el,template,where){var ids=[],nodes={},rndNum="_"+(new Date).getTime().toString().slice(-5)+Math.floor(1e5*Math.random());template=template.replace(/#{(\w+)}/g,(function(match,id){return ids.push(id),id+rndNum})),Core.Dom.insertHTML(el,template,where);for(var id,i=ids.length;i--;)nodes[id=ids[i]]=$E(id+rndNum);return nodes},$registJob("articleShare",(function(){if($E("t_"+scope.$articleid)){var x="javascript:void((function(s,d,e,r,l,p,t,z,c,w){var%20f='//v.t.sina.com.cn/share/share.php?',u=z||d.location,p=['url=',e(u),'&title=',e(t||d.title),'&source=',e(r),'&sourceUrl=',e(l),'&content=',c||'gb2312','&pic=',e(p||''),'&ralateUid=',w].join('');function%20a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=440,height=430,left=',(s.width-440)/2,',top=',(s.height-430)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,'新浪-博客','//blog.sina.com.cn','"+(scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"")+"','分享"+scope.owenerNickName+"的博文："+$E("t_"+scope.$articleid).innerHTML.replace(/'/g,"\\'")+" 推荐给@头条博客','//blog.sina.com.cn/s/blog_"+scope.$articleid+".html','utf-8','1231759973'));";if(x=Core.String.decodeHTML(x),$E("shareminiblogfromblogatarticlepage")&&Lib.Uic.getNickName([scope.$uid],(function(oResult){var nickname=oResult[scope.$uid]||"";nickname=Core.String.encodeHTML(nickname),scope.owenerNickName=nickname,$E("shareminiblogfromblogatarticlepage").href=x})),$_GLOBAL.diggerOpenFlag){var sharewb=$E("sharewb"),sharemail=($E("shareqing"),$E("sharemail"));if(sharewb&&(sharewb.href=x,Core.Events.addEvent(sharewb,(function(){v7sendLog("80_01_04")}))),!sharemail&&sharewb){Utils.insertTemplate(sharewb,'<a href="javascript:;" id="sharemail"><img width="16" height="16" align="absmiddle" title="分享到新浪邮箱" alt="" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon211"></a>',"beforebegin"),sharemail=$E("sharemail")}if(sharemail){if(!scope.$rank||!scope.totalPv){var timer=setInterval((function(){var s=scope.$rank,pv=scope.totalPv;s&&pv&&clearInterval(timer)}),300)}sharemail.onclick=function(){if($isLogin){var url="//mail.sina.com.cn/share/mail.php?aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);return window.open(url,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2),!1}(new Lib.Login.Ui).login((function(){var url="//mail.sina.com.cn/share/mail.php?aid="+encodeURIComponent(scope.$articleid)+"&bl="+encodeURIComponent(scope.$rank)+"&ba="+encodeURIComponent(scope.totalPv);return window.open(url,"shareMail","toolbar=0,status=0,scrollbars=1,resizable=1,width=970,height=630,left="+(screen.width-970)/2+",top="+(screen.height-630)/2),!1}))}}$E("sharexn")&&($E("sharexn").href="javascript:u='//share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)",Core.Events.addEvent($E("sharexn"),(function(){v7sendLog("80_01_07")}))),$E("sharedb")&&($E("sharedb").href="//www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)",Core.Events.addEvent($E("sharedb"),(function(){v7sendLog("80_01_08")}))),$E("sharekx")&&($E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('//www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();",Core.Events.addEvent($E("sharekx"),(function(){v7sendLog("80_01_06")})));var sm=$E("sharemsn");if(sm){var href=[];href.push("url="+encodeURIComponent("//blog.sina.com.cn/s/blog_"+scope.$articleid+".html"));var title=$E("t_"+scope.$articleid);title=$IE?title.innerText:title.textContent,href.push("title="+encodeURIComponent(title));var loc=scope.$album_pic?getImgStaticPath(scope.$album_pic,"bmiddle"):"//portrait"+(parseInt(scope.$uid)%8+1)+".sinaimg.cn/"+scope.$uid+"/blog/180";href.push("screenshot="+encodeURIComponent(loc));var ele=$E("sina_keyword_ad_area2");if(ele){for(var ws=/\s/,i=(ele=(ele=(ele=$IE?ele.innerText:ele.textContent).replace(/\n/gi,"")).replace(/^\s\s*/,"")).length;ws.test(ele.charAt(--i)););href.push("description="+encodeURIComponent(ele.substring(0,101)))}sm.href="//profile.live.com/badge/?"+href.join("&"),sm.target="_blank",Core.Events.addEvent(sm,(function(){v7sendLog("80_01_05")}))}}$E("moreshares")&&Core.Events.addEvent($E("moreshares"),(function(){if($E("sharelayer")){if("none"==$E("sharelayer").style.display){Core.Events.fixEvent(Core.Events.getEvent());var xy=Core.Dom.getXY($E("moreshares"));$E("sharelayer").style.left=xy[0]-45+"px",$E("sharelayer").style.top=xy[1]+15+"px",$E("sharelayer").style.display=""}}else{Core.Dom.insertHTML(document.body,'<div id="sharelayer" style="z-index:100;width:120px;" class="tb_layer_Y tb_layer_w2"><div class="tb_layer_arrow"></div><div class="tb_layer_Y_main" ><div class="tb_ps_share" style="width:96px;"><span class="share"><a id="sharewb" href="#" title="分享到新浪微博"><img height="16" align="absmiddle" width="16" title="微博" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon51"></a></span><span class="share"><a id="sharexn" href="#" title="分享到人人"><img height="16" align="absmiddle" width="16" title="人人" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon113"></a></span><span class="share"><a id="sharedb" target="_blank" href="#" title="分享到豆瓣"><img height="16" align="absmiddle" width="16" title="豆瓣" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon116"></a></span><span class="share"><a id="sharekx" href="#" title="分享到开心001"><img height="16" align="absmiddle" width="16" title="开心001" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon117"></a></span><div class="clearit"></div></div></div></div>',"beforeend");Core.Events.fixEvent(Core.Events.getEvent()),xy=Core.Dom.getXY($E("moreshares"));$E("sharelayer").style.left=xy[0]-45+"px",$E("sharelayer").style.top=xy[1]+15+"px",$E("sharewb").href=x,$E("sharexn").href="javascript:u='//share.xiaonei.com/share/buttonshare.do?link='+location.href+'&title='+encodeURIComponent(document.title);window.open(u,'xiaonei','toolbar=0,resizable=1,scrollbars=yes,status=1,width=626,height=436');void(0)",$E("sharedb").href="//www.douban.com/recommend/?url="+window.location.href+"&title="+encodeURIComponent(document.title)+";window.open(u,'douban','toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330');void(0)",$E("sharekx").href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(kaixin=window.open('//www.kaixin001.com/~repaste/repaste.php?&rurl='+escape(d.location.href)+'&rtitle='+escape('"+document.title+"')+'&rcontent='+escape('"+document.title+"'),'kaixin'));kaixin.focus();",Core.Events.addEvent($E("sharelayer"),(function(){var e=Core.Events.fixEvent(Core.Events.getEvent()),xy=Core.Dom.getXY($E("sharelayer")),scrollPos=Core.System.getScrollPos(document),left=xy[0],top=xy[1],ex=scrollPos[1]+e.clientX,ey=scrollPos[0]+e.clientY;(ex>=left+116||ex<=left||ey>=top+42||ey<=top)&&($E("sharelayer").style.display="none")}),"mouseout")}}),"mouseover");(function(){var weimiShareLayer,closeBtn,shareBtn,weimiTpl=['<div class="layer_weimi">','<a href="javascript:;" class="close" id="weimiShareClose"></a>','<div class="title">微米分享</div>','<ol class="list">','<li class="step code"><img id="weimiQRCode" alt="二维码" /></li>','<li class="step step1">','<div class="pic"><img src="//simg.sinajs.cn/blog7style/images/common/weimilayer/1.jpg" alt="步骤一" /></div>','<div class="desc"><span class="num">1</span><span class="txt">微米扫描左侧二维码</span></div>',"</li>",'<li class="step step2">','<div class="pic"><img src="//simg.sinajs.cn/blog7style/images/common/weimilayer/2.jpg" alt="步骤二" /></div>','<div class="desc"><span class="num">2</span><span class="txt">点击右上角的分享按钮</span></div>',"</li>",'<li class="step step3">','<div class="pic"><img src="//simg.sinajs.cn/blog7style/images/common/weimilayer/3.jpg" alt="步骤三" /></div>','<div class="desc"><span class="num">3</span><span class="txt">选择分享给朋友</span></div>',"</li>","</ol>","</div>"].join(""),_this={},that={},qrImg="//comet.blog.sina.com.cn/qr?"+location.href.replace(/[#?](.*)/,"");return that.init=function(){(shareBtn=$E("shareweimi"))||_this.createShareNode(),Core.Events.addEvent(shareBtn,_this.showLayer,"click"),Core.Events.addEvent(window,_this.resizeLayer,"resize")},_this.createShareNode=function(btn){if($E("shareqing")){var newNode,pNode=$E("shareqing").parentNode,posNode=$E("shareqing");(newNode=$C("a")).id="shareweimi",newNode.innerHTML='<img width="51" height="16" align="absmiddle" title="分享到微米" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon213">',pNode.insertBefore(newNode,posNode),shareBtn=$E("shareweimi")}},_this.createShareLayer=function(){var node=$C("div");node.id="weimiShareLayer",node.innerHTML=weimiTpl,document.body.appendChild(node),$E("weimiQRCode").src=qrImg,weimiShareLayer=$E("weimiShareLayer"),closeBtn=$E("weimiShareClose"),Core.Events.addEvent(closeBtn,_this.hideLayer,"click")},_this.showLayer=function(){return(weimiShareLayer=$E("weimiShareLayer"))||_this.createShareLayer(),_this.setPos(),weimiShareLayer.style.display="",!1},_this.hideLayer=function(){return weimiShareLayer&&(weimiShareLayer.style.display="none"),!1},_this.resizeLayer=function(){weimiShareLayer&&"none"!=weimiShareLayer.style.display&&_this.setPos()},_this.setPos=function(){document.documentElement.clientHeight||document.body.clientHeight;var clientWidth=document.documentElement.clientWidth||document.body.clientWidth;weimiShareLayer.style.position=$IE6?"absolute":"fixed",weimiShareLayer.style.left=Math.abs(clientWidth-586)/2+"px",weimiShareLayer.style.zIndex="1025",$IE6?weimiShareLayer.style.top=document.documentElement.scrollTop+50+"px":weimiShareLayer.style.top="50px"},that})().init()}else trace("应该是私密博文")})),Lib.AudioCheck={};var random="";if((window.$Maxthon||window.$360||window.$TT)&&(random="?t="+(new Date).getTime()),Lib.AudioCheck.swfUrl=$_GLOBAL.flashBasicURL+"mp3.swf"+random,Lib.AudioCheck.soundUrl="//interface.blog.sina.com.cn/riaapi/cksound/cksound.php",Lib.AudioCheck.render=function(target,soundUrl){$E(target).innerHTML='\t\t<a style="margin-left:3px;" id="comment_get_vcode" href="javascript:;" onclick="Lib.AudioCheck.callAudioCheck();return false;">收听验证码</a>\t\t<img id="play_img" name="play_img" src="//image2.sina.com.cn/blog/tmpl/v3/images/blank.gif" align="absmiddle" style="margin-right:2px;" height="15">\t\t<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="0" height="0" id="mp3_player" align="middle">\t\t<param name="allowScriptAccess" value="always" />\t\t<param name="movie" value="'+this.swfUrl+'" />\t\t<param name="quality" value="high" />\t\t<param name="bgcolor" value="#ffffff" />\t\t<param name="FlashVars" value="mp3URL='+soundUrl+'" />\t\t<embed src="'+this.swfUrl+'" FlashVars="mp3URL='+soundUrl+'" quality="high" bgcolor="#ffffff" width="0" height="0" name="mp3_player" swLiveConnect="true" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer"/>\t\t</object>\t'},Lib.AudioCheck.callAudioCheck=function(){setTimeout((function(){$E("play_img").src="//blogimg.sinajs.cn/v5images/play_img.gif",window.document.mp3_player.SetVariable("isPlay","1"),$E("login_check").value="",$E("login_check").focus()}),500);Utils.Io.JsLoad.request("//comet.blog.sina.com.cn/api?maintype=hits&act=3&uid=00000203",{onComplete:function(){}})},$registJob("audioCheck",(function(){if($E("article_comment_list")&&1!=scope.$private.cms&&1!=scope.$isCommentAllow){var dom=$E("comment_get_vcode"),cont=Core.Dom.wrap(dom,"span");cont&&Lib.AudioCheck.render(cont,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}})),$registJob("write",(function(){var writeSlide=new Ui.Slide("SG_Publish_Sub",{duration:.5});writeSlide.hide();var dropNode=Core.Dom.getElementsByClass($E("SG_Publish"),"span","wrtblog_arrow"),parent=writeSlide.container.parentNode.parentNode;null!=dropNode&&Core.Events.addEvent(dropNode[0],(function(){writeSlide.slideIn({before:function(){parent.style.display=""}})}),"mouseover"),Core.Events.addEvent(dropNode[0],(function(e){Core.Events.stopEvent(e)})),Core.Events.addEvent("SG_Publish_Sub",(function(){Core.Events.stopBubble(),setTimeout((function(){writeSlide.slideOut({end:function(){parent.style.display="none"}})}),1e3)}),"mousedown"),Core.Events.addEvent(document.body,(function(){writeSlide.slideOut({end:function(){parent.style.display="none"}})}),"mousedown")})),Utils.text2Copy=function(text2copy){if(window.clipboardData&&$IE6)return window.clipboardData.clearData(),window.clipboardData.setData("Text",text2copy);if(!function(){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){for(var words=navigator.plugins["Shockwave Flash"].description.split(" "),i=0;i<words.length;++i)if(!isNaN(parseInt(words[i],10)))var MM_PluginVersion=words[i];return MM_PluginVersion>=10}if($IE)try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10"),!0}catch(e){return!1}}()){if(!$E("flashcopier")){var divholder=$C("div");divholder.id="flashcopier",document.body.appendChild(divholder)}var divinfo='<embed src="//simg.sinajs.cn/blog7common/clipboard.swf" FlashVars="clipboard='+(text2copy=text2copy.replace(/%/g,escape("%")).replace(/&/g,escape("&")))+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';return $E("flashcopier").innerHTML=divinfo,!0}if($IE)try{return window.clipboardData.clearData(),window.clipboardData.setData("Text",text2copy)}catch(e){return!1}try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var clip=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!clip)return;var trans=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!trans)return;trans.addDataFlavor("text/unicode");var str={};str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var copytext=text2copy;str.data=copytext,trans.setTransferData("text/unicode",str,2*copytext.length);var clipid=Components.interfaces.nsIClipboard;return!!clip&&(clip.setData(trans,null,clipid.kGlobalClipboard),!0)}catch(e){return!1}},Utils.limitLength=function(oTextNode,nMaxLen){var nValue,keyup=function(){nValue=oTextNode.value,Core.String.byteLength(nValue)>nMaxLen&&(oTextNode.value=Core.String.leftB(nValue,nMaxLen))};Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"keyup"),Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"blur"),Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"focus")},Utils.limitReg=function(oNode,re){var keyup=function(){var ov=oNode.value;re.test(ov)&&(oNode.value=ov.replace(re,""))};Core.Events.addEvent(oNode,Core.Function.bind3(keyup,oNode),"keydown"),Core.Events.addEvent(oNode,Core.Function.bind3(keyup,oNode),"keyup"),Core.Events.addEvent(oNode,Core.Function.bind3(keyup,oNode),"blur")},$SYSMSG.extend({B00007:"跳转到自动开通页",B00008:"自动开通用户(跳转到假页)",B00009:"跳转到自动开通页",B00010:"无权限。 ",B00011:"抱歉，Blog ID 错误，操作无法完成。",B00012:"抱歉，可能因为重复操作而无法执行，请刷新本页再试。",B00013:"用户ID被封杀",B00014:"很抱歉，您输入的验证码不正确。",B04101:"请输入您的昵称！",B04102:"请正确输入您的邮件地址！",B04103:"请选择您举报信息的位置！",B04104:"请选择您举报的不良信息的类型！",B04105:"简单描述最多只能输入500个字符！",B04106:"再次感谢您帮助我们进行不良信息的验证工作，我们将认真仔细地处理您提交的内容。",B07006:"您已发的博文正在审查中，请稍后再发文"}),$SYSMSG.extend({B21000:"<span>提示：</span>12个中文或24个字符以内。",B21001:"<span>提示：</span>请输入标题名称。",B21002:"<span>提示：</span>必须是12个中文或24个字符以内，请重新输入。",B21003:"<span>提示：</span>不能使用此类特殊词汇，请重新输入。",B21004:"<span>提示：</span>保存中，请稍候…"}),Lib.modifyTitle=function(){if(Lib.modifyTitle._dialog)return $E("editTitle").value=Core.String.decodeHTML($E("blognamespan").innerHTML),setMessage("B21000"),Lib.modifyTitle._dialog.show(),Lib.modifyTitle._dialog.setMiddle(),void(Lib.modifyTitle.savingflag=!1);var tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}"></strong>','<cite><a title="关闭" class="CP_w_shut" id="#{btnClose}" href="javascript:;" onclick="return false;">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 editBlogNm" id="#{content}">',"</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");function save(){if(0==Lib.modifyTitle.savingflag){Lib.modifyTitle.savingflag=!0,disabledBtn(!0),setMessage("B21004");var title=Core.String.trim($E("editTitle").value),secure_code=$encrypt_code||"";Utils.Io.JsLoad.request("//control.blog.sina.com.cn/admin/custom/update_blogtitle.php?uid="+scope.$uid+"&title="+encodeURIComponent(title)+"&secure_code="+secure_code,{onComplete:function(txt){disabledBtn(!1),txt&&"A00006"==txt.code?($E("blognamespan").innerHTML=Core.String.encodeHTML(title),Lib.modifyTitle._dialog.hidden(),$E("blogTitle").offsetWidth+$E("blogTitle").offsetLeft>$E("headarea").offsetWidth&&($E("blogTitle").style.left=$E("headarea").offsetWidth-$E("blogTitle").offsetWidth+"px"),$E("blogTitle").offsetHeight+$E("blogTitle").offsetTop>$E("headarea").offsetHeight&&($E("blogTitle").style.top=$E("headarea").offsetHeight-$E("blogTitle").offsetHeight+"px")):txt&&"A00006"!=txt.code&&showError(txt.code),Lib.modifyTitle.savingflag=!1}})}}function setMessage(code){$E("editBlogNm_tip").innerHTML=$SYSMSG[code]}function disabledBtn(isTrue,save){isTrue?(save||($E("editTitle").disabled=!0),$E("saveTitle").disabled=!0):(save||($E("editTitle").disabled=!1),$E("saveTitle").disabled=!1,setMessage("B21000"))}Lib.modifyTitle._dialog=winDialog.createCustomsDialog({tpl:tpl,title:"编辑博客名称",content:'<p class="editBlogNm_tip" id="editBlogNm_tip"><span>提示：</span>12个中文或24个字符以内。</p><div class="editBlogNm_input"><input type="text" class="SG_input" id="editTitle" ><a href="javascipt:;" onclick="return false;" class="SG_aBtn SG_aBtnB"><cite id="saveTitle">保存</cite></a><a href="javascript:;" class="SG_aBtn SG_aBtnB" onclick="return false;"><cite id="cancalTitle">取消</cite></a></div>',width:415,height:185},"tips"),$E("editTitle").value=Core.String.decodeHTML($E("blognamespan").innerHTML),Lib.modifyTitle.savingflag=!1,Lib.modifyTitle._dialog.show(),Lib.modifyTitle._dialog.setMiddle(),Lib.modifyTitle._dialog.setAreaLocked(!0),Utils.limitLength($E("editTitle"),24),Utils.limitReg($E("editTitle"),/^[\s\u3000]*$/gi),Core.Events.addEvent($E("saveTitle"),(function(){""!=Core.String.trim($E("editTitle").value)?save():setMessage("B21001")})),Core.Events.addEvent($E("cancalTitle"),(function(){disabledBtn(!1),$E("editBlogNm_tip").innerHTML="",Lib.modifyTitle._dialog.hidden()})),Core.Events.addEvent($E("editTitle"),(function(){var e=Core.Events.getEvent();1!=$E("saveTitle").disabled&&13==e.keyCode&&save()}),"keyup")},$registJob("modifytitle",(function(){$E("modifytitle")&&Core.Events.addEvent($E("modifytitle"),(function(evt){Core.Events.stopEvent(evt),Lib.modifyTitle()}))})),$registJob("updownurl",(function(){$E("new_nextprev_"+scope.$articleid)||Lib.checkAuthor((function(){if("1"==scope.$pn_x_rank&&!$isAdmin)return!1;var cont=$E("nextprev_"+scope.$articleid),inter=new Interface("//blogtj.sinajs.cn/api/get_prevnext_article.php","jsload"),node=$E("t_"+scope.$articleid).parentNode,time=Core.Dom.getChildrenByClass(node,"time")[0].innerHTML;time=time.replace("(","").replace(")",""),inter.request({GET:{uid:scope.$uid,blog_id:scope.$articleid,varname:"prevnext",blog_pubdate:time,pn_x_rank:scope.$pn_x_rank},onSuccess:function(result){var html="";null!=result.prev&&(html+='<div><span class="SG_txtb">前一篇：</span><a href="'+result.prev.blog_url+'">'+result.prev.blog_title+"</a></div>"),null!=result.next&&(html+='<div><span class="SG_txtb">后一篇：</span><a href="'+result.next.blog_url+'">'+result.next.blog_title+"</a></div>"),cont.innerHTML=html},onError:function(){}})}),"updownurl"+(new Date).getTime())})),"object"!=typeof sina)var sina={};sina.$=function(i){return i?document.getElementById(i):null};var sinaFlash=function(V,x,X,Z,v,z,i,c,I,l,o){var w=this;if(document.createElement&&document.getElementById){w.id=x||"";var C="8.0.42.0";(function(I,i){for(var l=0;l<I.length;l++)if(I[l]==i)return l;return-1})(["eladies.sina.com.cn","ent.sina.com.cn"],document.domain)>-1?w.ver=C:w.ver=v||C,w.ver=w.ver.replace(/\./g,","),w.__classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",w.__codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version="+w.ver,w.width=X,w.height=Z,w.movie=V,w.src=w.movie,w.bgcolor=z||"",w.quality=c||"high",w.__pluginspage="//www.macromedia.com/go/getflashplayer",w.__type="application/x-shockwave-flash",w.useExpressInstall="boolean"==typeof i&&i,w.xir=I||window.location,w.redirectUrl=l||window.location,w.detectKey="boolean"!=typeof o||o,w.escapeIs=!1,w.__objAttrs={},w.__params={},w.__embedAttrs={},w.__flashVars=[],w.__flashVarsStr="",w.__forSetAttribute("id",w.id),w.__objAttrs.classid=w.__classid,w.__forSetAttribute("codebase",w.__codebase),w.__forSetAttribute("width",w.width),w.__forSetAttribute("height",w.height),w.__forSetAttribute("movie",w.movie),w.__forSetAttribute("quality",w.quality),w.__forSetAttribute("pluginspage",w.__pluginspage),w.__forSetAttribute("type",w.__type),w.__forSetAttribute("bgcolor",w.bgcolor)}};sinaFlash.prototype={getFlashHtml:function(){var I=this,i="<object ";for(var l in I.__objAttrs)i+=l+'="'+I.__objAttrs[l]+'" ';for(var l in i+=">\n",I.__params)i+='\t<param name="'+l+'" value="'+I.__params[l]+'" />\n';for(var l in""!=I.__flashVarsStr&&(i+='\t<param name="flashvars" value="'+I.__flashVarsStr+'" />\n'),i+="\t<embed ",I.__embedAttrs)i+=l+'="'+I.__embedAttrs[l]+'" ';return i+="></embed>\n</object>"},__forSetAttribute:function(I,i){var l=this;if(void 0!==I&&""!=I&&void 0!==i&&""!=i)switch(I=I.toLowerCase()){case"classid":break;case"pluginspage":l.__embedAttrs[I]=i;break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"codebase":l.__objAttrs[I]=i;break;case"src":case"movie":l.__embedAttrs.src=i,l.__params.movie=i;break;case"width":case"height":case"align":case"vspace":case"hspace":case"title":case"class":case"name":case"id":case"accesskey":case"tabindex":case"type":l.__objAttrs[I]=l.__embedAttrs[I]=i;break;default:l.__params[I]=l.__embedAttrs[I]=i}},__forGetAttribute:function(i){var I=this;return i=i.toLowerCase(),"undefined"!=typeof I.__objAttrs[i]?I.__objAttrs[i]:"undefined"!=typeof I.__params[i]?I.__params[i]:"undefined"!=typeof I.__embedAttrs[i]?I.__embedAttrs[i]:null},setAttribute:function(I,i){this.__forSetAttribute(I,i)},getAttribute:function(i){return this.__forGetAttribute(i)},addVariable:function(I,i){var l=this;l.escapeIs&&(I=escape(I),i=escape(i)),""==l.__flashVarsStr?l.__flashVarsStr=I+"="+i:l.__flashVarsStr+="&"+I+"="+i,l.__embedAttrs.FlashVars=l.__flashVarsStr},getVariable:function(I){var o=this,i=o.__flashVarsStr;o.escapeIs&&(I=escape(I));new RegExp(I+"=([^\\&]*)(\\&?)","i").exec(i);return o.escapeIs?unescape(RegExp.$1):RegExp.$1},addParam:function(I,i){this.__forSetAttribute(I,i)},getParam:function(i){return this.__forGetAttribute(i)},write:function(i){"string"==typeof i?document.getElementById(i).innerHTML=this.getFlashHtml():"object"==typeof i&&(i.innerHTML=this.getFlashHtml())}},addAdvertise=function(){var adDiv=$E("blogads");if(scope.$pageid.indexOf("article")>-1&&null!=adDiv){var div2=$C("div");div2.id="blogads2",div2.className="blogads2 borderc",div2.innerHTML='<p><a href="javascript:;" id="adversite_bottom"></a></p><p class="SG_txtc">新浪广告共享计划</p>'+($isAdmin?'<div class="manage SinaAd_mg2"><a href="//share.sass.sina.com.cn/widget_ad/index_out.php?done" class="SinaAd_linkcolor SinaAd_link" target="_blank">[管理]</a></div>':""),div2.style.display="none",scope.$pn_x_rank&&0==window.parseInt(scope.$pn_x_rank)&&($E("nextprev_"+scope.$articleid)?Core.Dom.insertAfter(div2,$E("nextprev_"+scope.$articleid)):$E("new_nextprev_"+scope.$articleid)&&Core.Dom.insertAfter(div2,$E("new_nextprev_"+scope.$articleid)))}Utils.Io.JsLoad.request("//sjs.sinajs.cn/blog7/adwidget.js?v1",{onComplete:function(){"undefined"!=typeof adShare&&adShare.init(scope.$uid,"sinablog","SINABLOG")},noreturn:!0,isRemove:!1})},$registJob("renderAd",(function(){scope.$private.ad=scope.$private.ad||0,scope.$private.ad>0&&Lib.checkAuthor((function(){addAdvertise()}),"Advertise"+(new Date).getTime())})),$TEMPLATECLONE_MSG={A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4000520066。",A00002:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4000520066。",A00003:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4000520066。",A00004:"未登录",A00005:"抱歉，你暂时不能复制该模板",A00006:"操作成功",A11007:'你还未开通新浪博客，请先 <a href="https://login.sina.com.cn/hd/reg_sec.php?entry=blog"  id="cloneTemplateButNoReg">开通博客</a>'},Lib.TemplateClone=Core.Class.create(),Lib.TemplateClone.prototype={type:"1",version:"7",interfaceClone:null,btnClone:null,initialize:function(btnClone,callBack){var _this=this;this.interfaceClone=new Interface("//control.blog.sina.com.cn/riaapi/conf/template_clone.php","jsload"),this.btnClone=btnClone,this.btnClone&&Core.Events.addEvent(this.btnClone,(function(){_this.clone(callBack)}),"click")},clone:function(callBack,tplNum){var _this=this,tipText=tplNum?"<a style='color:red' href='//finance.sina.com.cn/333/2010-02-05/guest920.shtml' target='_blank'>315十大行业满意度调查</a>":"";Lib.checkAuthor((function(){$isLogin?winDialog.confirm("确定使用此模板吗?",{subText:tipText,funcOk:function(){scope.blogOpener.showDialog((function(){_this.request(callBack)}))}}):(new Lib.Login.Ui).login((function(){winDialog.confirm("确定使用此模板吗?",{subText:tipText,funcOk:function(){scope.blogOpener.showDialog((function(){_this.request(callBack)}))},funcCancel:function(){location.reload()}})}))}),"templateClone"+(new Date).getTime())},request:function(callBack){this.interfaceClone.request({GET:{uid_cloned:scope.$uid,type:this.type,version:this.version},onSuccess:function(data){callBack&&callBack()},onError:function(data){if("A11007"==data.code){Lib.checkAuthor();var tempAlertDialog=winDialog.alert($TEMPLATECLONE_MSG[data.code].replace(/#\{linkNewBlog\}/g,"//control.blog.sina.com.cn/reg/reg_blog.php?version=7"),{icon:"01"});$E("cloneTemplateButNoReg").onclick=function(){tempAlertDialog.hidden().destroy()}}else winDialog.alert($TEMPLATECLONE_MSG[data.code],{icon:"02"})},onFail:function(){}})}},Lib.insertMoban=function(){scope.tpl&&""!=scope.tpl&&("13"==scope.tpl.split("_")[0]||$_GLOBAL.flashtemplate[scope.tpl])&&Lib.insertMobanFunc(scope.tpl)},Lib.insertMobanFunc=function(id){var headflash=$E("headflash");if(headflash){headflash.innerHTML="",headflash.style.display="";var swf_url="//simg.sinajs.cn/blog7newtpl/css/"+id.split("_")[0]+"/"+id+"/top.swf",width=950,height=266;$_GLOBAL.flashtemplate[id].width&&(width=$_GLOBAL.flashtemplate[id].width),$_GLOBAL.flashtemplate[id].height&&(height=$_GLOBAL.flashtemplate[id].height),trace("flash height="+height);Utils.Flash.swfView.Add(swf_url,"headflash","headflash_f",width,height,"9.0.0.0","#000",{},{allowScriptAccess:"false",wmode:"transparent",allowFullScreen:"false"})}},Lib.tplFuncArr={},Lib.tplFuncCount=0,Lib.getTplNum=function(func){if(Lib.tplFuncArr[Lib.tplFuncCount++]=func||function(){},$isAdmin&&scope.tpl&&""!=scope.tpl)for(var k in Lib.tplFuncArr)Lib.tplFuncArr[k](),Lib.tplFuncArr[k]=null,delete Lib.tplFuncArr[k];else if($IE){for(var ss=document.styleSheets,re=/\S*(blog7tpl([^t]*))\S*/gi,re2=/\S*(blog7newtpl\/css([^t]*))\S*/gim,i=0;i<ss.length;i++)if("uid_link_css"==ss[i].id){var res=re.exec(ss[i].cssText),res2=re2.exec(ss[i].cssText);null==res&&null==res2||(null!=res?scope.tpl=res[2].split("/")[2]:null!=res2&&(scope.tpl=res2[2].split("/")[2]));break}for(var k in Lib.tplFuncArr)Lib.tplFuncArr[k](),Lib.tplFuncArr[k]=null,delete Lib.tplFuncArr[k]}else{if(!$IE&&"blog7"==scope.$PRODUCT_NAME){for(var k in Lib.tplFuncArr)Lib.tplFuncArr[k](),Lib.tplFuncArr[k]=null,delete Lib.tplFuncArr[k];return}$IE||"blog7"==scope.$PRODUCT_NANM||Utils.Io.JsLoad.request("//blog.sina.com.cn/s/"+scope.$uid+".js",{GET:{tm:(new Date).getTime()},onComplete:function(){for(var k in Lib.tplFuncArr)Lib.tplFuncArr[k](),Lib.tplFuncArr[k]=null,delete Lib.tplFuncArr[k]}.bind2(this)})}},$registJob("templateClone",(function(){Lib.checkAuthor((function(){$isAdmin?trace("博主。不执行代码"):Lib.getTplNum((function(){var tmpCloneFuc=function(){if(scope.tpl){var tcInfo=$_GLOBAL.cloneTemplateConfig[scope.tpl];if(tcInfo&&""!=tcInfo.template_clone_pic.replace(/\s/g,"")){if("8_52"==scope.tpl&&($E("template_clone_pic").parentNode.parentNode.style.top="0px",window.screen.width<1280&&($E("template_clone_pic").parentNode.parentNode.style.right="88px"),$E("template_clone_pic").parentNode.parentNode.style.zIndex=201),$E("template_clone_pic").innerHTML=tcInfo.template_clone_pic,$E("template_clone_link").innerHTML=tcInfo.template_clone_link,$E("template_clone_other").innerHTML=tcInfo.template_clone_other,tcInfo.count_id){var url="//comet.blog.sina.com.cn/api?maintype=hits&act=3&uid="+tcInfo.count_id+"&varname=templatecc";Utils.Io.JsLoad.request(url,{onComplete:function(){var num,tmp,cnf;"undefined"!=typeof templatecc?(num=templatecc.pv,tmp=new Ui.Template($_GLOBAL.cloneTemplateConfig[scope.tpl].count_text),(cnf={}).template_pv=num,$E("template_clone_link").innerHTML=tmp.evaluate(cnf)):$E("template_clone_link").style.display="none"}})}new Lib.TemplateClone($E("template_clone_pic"),(function(){winDialog.alert("克隆模板成功!",{icon:"03",funcOk:function(){Lib.checkAuthor((function(){window.location.href="//blog.sina.com.cn/u/"+$UID}),"templateClonefuncOk"+(new Date).getTime())}})}))}var gwinfo=$_GLOBAL.GUANWANG[scope.tpl];gwinfo&&""!=gwinfo.template_clone_pic.replace(/\s/g,"")&&($E("template_clone_pic").innerHTML=gwinfo.template_clone_pic,$E("template_clone_other").innerHTML=gwinfo.template_clone_other,$E("template_clone_pic")&&"a"==$E("template_clone_pic").parentNode.tagName.toLowerCase()&&($E("template_clone_pic").parentNode.href=gwinfo.template_clone_link,$E("template_clone_pic").parentNode.target="_blank"));var fmInfo=$_GLOBAL.famous_conf[scope.tpl];fmInfo&&""!=fmInfo.template_clone_pic.replace(/\s/g,"")&&($E("template_clone_pic").innerHTML=fmInfo.template_clone_pic,$E("template_clone_link").innerHTML=fmInfo.template_clone_link,$E("template_clone_other").innerHTML=fmInfo.template_clone_other,$E("template_clone_pic")&&"a"==$E("template_clone_pic").parentNode.tagName.toLowerCase()&&($E("template_clone_pic").parentNode.href="//ba.sass.sina.com.cn/front/tp/deliver?blogId="+scope.$uid+"&tp="+scope.tpl))}};$_GLOBAL.cloneTemplateConfig?tmpCloneFuc():Utils.Io.JsLoad.request("//sjs.sinajs.cn/blog7common/conf/tmp_clone.js",{onComplete:function(){tmpCloneFuc()},noreturn:!0,isRemove:!1})}))}),"templateClone"+(new Date).getTime())})),$registJob("getTplNum",(function(){}));var QuoteList=Core.Class.create();if(QuoteList.prototype={saving:!1,articleID:"",pageCount:0,initialize:function(target_id,container_id){this.container_id=container_id,this.articleID=scope.$articleid||"",this.initInterface(),this.bindEvent(target_id),$E(this.container_id)&&this.initHtml()},bindEvent:function(ele_id){var me=this;$E(ele_id)&&Core.Events.addEvent($E(ele_id),(function(){me.show()}))},initInterface:function(){this.addInterface=new Interface("//control.blog.sina.com.cn/myblog/htmlsource/quotelist.php","jsload"),this.delInterface=new Interface("//control.blog.sina.com.cn/admin/article/article_quote_del.php","jsload")},show:function(articleID,container_id,pageCount){this.pageCount=pageCount||scope.$x_quote_c||0,container_id&&(this.container_id=container_id),this.container_id&&(this.articleID=articleID||scope.$articleid,container_id&&(this.container_id=container_id),$E(this.container_id)&&""===$E(this.container_id).innerHTML.replace(/\s/g,"")&&this.initHtml(),this.isShow?this.hidden():($E(this.container_id).style.display="block",this.loadData(),this.isShow=!0))},hidden:function(){$E(this.container_id).style.display="none",this.isShow=!1},initHtml:function(){var ele=$E(this.container_id);if(ele){var aID=this.articleID||"",html='<h3><a href="#" onclick="return false" title="关闭" id="ql_close'+aID+'" class="blogzz_closepic SG_floatR"></a>转载列表：</h3>                <ul class="ul_zzlist" id="ql_content'+aID+'">                </ul>\t\t\t\t<ul style="display:none"><li id="ql_tip'+aID+'"></li></ul>                <div class="SG_clearB"></div>                <div class="blogzz_btn">\t\t\t\t\t<a id="btnArticleQuote'+aID+'" href="#" onclick="scope.article_quote && scope.article_quote.check(\''+aID+'\');return false;" class="SG_aBtn SG_aBtn_ico SG_turn"><cite><img class="SG_icon SG_icon111" id="quoteList_quote'+aID+'" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />转载</cite></a>\t\t\t\t\t<p id="quoteDescription'+aID+'" class="SG_turntxt">转载是分享博文的一种常用方式...</p>\t\t\t\t</div>\t\t\t\t<div id="ql_page'+aID+'" class="blogzz_paged"></div>\t\t\t\t<div class="clearit"></div>';ele.innerHTML=html;var _this=this;Lib.checkAuthor((function(){$E("btnArticleQuote"+aID)&&($E("btnArticleQuote"+aID).style.display=$isAdmin?"none":""),$E("quoteDescription"+aID)&&($E("quoteDescription"+aID).style.display=$isAdmin?"":"none"),Core.Events.addEvent($E("ql_close"+aID),_this.hidden.bind2(_this))}),"quote_list"+(new Date).getTime())}},setTip:function(type){var aID=this.articleID||"",ele=$E("ql_tip"+aID),ele_lst=$E("ql_content"+aID);"ok"!=type?(ele.innerHTML="暂无转载。",ele_lst.style.display="none",ele.parentNode.style.display="block"):(ele.parentNode.style.display="none",ele_lst.style.display="block")},loadData:function(page){page=page||1;var param={blogid:this.articleID,version:7,page:page};this.addInterface.request({GET:param,onSuccess:function(_data){_data.length>0?(this.setTip("ok"),this.parseData(_data),this.page(page)):this.setTip()}.bind2(this),onError:function(_data){showError(_data.code)},onFail:function(){}})},parseData:function(data){for(var aID=this.articleID||"",html="",len=data.length,i=0;i<len;i++)html+=this.buildListHtml(data[i]);$E("ql_content"+aID).innerHTML=html,scope.quoteList_quote=new Quote("quoteList_quote"+aID)},page:function(pageNum){var aID=this.articleID||"",count=this.pageCount,maxPage=Math.ceil(count/10,10);maxPage>1?Ui.Pagination.init({pageNode:"ql_page"+aID,nodeClassNamePrefix:"SG",curPage:pageNum,maxPage:maxPage,pageTpl:this.loadData.bind2(this),type:3}).show():$E("ql_page"+aID).innerHTML=""},buildListHtml:function(data){$isAdmin?data.isShow="":data.isShow="none";var html=['<li id="pl_#{rp_blogid}">','<p class="blogzz_pinfo SG_txtb SG_floatL">','<a target="_blank" href="//blog.sina.com.cn/u/#{rp_bloguid}">#{rp_bloguname}</a>','<span class="zzlist_mleft zzlist_mright">等级<em class="SG_txtc">(#{rp_ugrade})</em></span>','<span class="zzlist_mleft">转载了此文：</span><a target="_blank" href="//blog.sina.com.cn/s/blog_#{rp_blogid}.html">#{rp_blogtitle}</a>',"</p>",'<p class="SG_floatR">','<em class="SG_txtc">#{rp_blogpubdate}</em>','<a href="#" style="display:#{isShow}" class="CP_a_fuc" onclick="scope.article_quoteList.del(\'#{rp_blogid}\',\''+this.articleID+'\');return false;">[<cite id="pl_del_#{rp_bloguid}">删除</cite>]</a>',"</p>","</li>"].join("");return data.rp_ugrade=data.rp_ugrade.toString(),new Ui.Template(html).evaluate(data)},del:function(blogid,articleID){var param={sblog_id:scope.$articleid||articleID,version:7,blog_id:blogid},me=this;$E("quote_sign_count")&&($E("quote_sign_count").innerHTML=+$E("quote_sign_count").innerHTML-1),Core.Dom.removeNode($E("pl_"+blogid));var aID=me.articleID||"";$E("ql_content"+aID)&&0==$E("ql_content"+aID).getElementsByTagName("li").length&&me.setTip(),this.delInterface.request({GET:param,onSuccess:function(_data){me.onDeleted()}.bind2(this),onError:function(_data){showError(_data.code)},onFail:function(){}})},onDeleted:function(){}},$registJob("quote_list",(function(){var node=$E("z_"+scope.$articleid);$E("quote_sign")?scope.article_quoteList=new QuoteList("quote_sign","blog_quote"):node&&(scope.article_quoteList=new QuoteList("z_"+scope.$articleid,"blog_quote"),"(0)"==node.innerHTML&&(node.style.display="none"))})),Core.String.StringBuffer=function(){this.buffer=[]},Core.String.StringBuffer.prototype.append=function(str){return this.buffer.push(str),this},Core.String.StringBuffer.prototype.toString=function(){return this.buffer.join("")},$SYSMSG.extend({B00901:"投票不存在。",B00902:"投票已截止。",B00903:"超出允许投票个数。",B00904:"你已投过票了!<br/>重复投票是没有意义的。",B00905:"投票主题过短<br/>至少要5个汉字或10个字符！",B00906:"投票选项至少要填写2项",B00907:"投票的截止时间不能小于当前时间，请重新选择 ",B00908:"投票选项最多可填写7项",B00909:"投票主题不能为空"}),void 0===infosoftglobal)var infosoftglobal=new Object;"undefined"==typeof infosoftglobal.FusionChartsUtil&&(infosoftglobal.FusionChartsUtil=new Object),infosoftglobal.FusionCharts=function(swf,id,w,h,debugMode,registerWithJS,c,scaleMode,lang,detectFlashVersion,autoInstallRedirect){document.getElementById&&(this.initialDataSet=!1,this.params=new Object,this.variables=new Object,this.attributes=new Array,swf&&this.setAttribute("swf",swf),id&&this.setAttribute("id",id),debugMode=debugMode||0,this.addVariable("debugMode",debugMode),(w=w.toString().replace(/\%$/,"%25"))&&this.setAttribute("width",w),(h=h.toString().replace(/\%$/,"%25"))&&this.setAttribute("height",h),c&&this.addParam("bgcolor",c),this.addParam("quality","high"),this.addParam("allowScriptAccess","always"),this.addVariable("chartWidth",w),this.addVariable("chartHeight",h),this.addVariable("DOMId",id),registerWithJS=registerWithJS||0,this.addVariable("registerWithJS",registerWithJS),scaleMode=scaleMode||"noScale",this.addVariable("scaleMode",scaleMode),lang=lang||"EN",this.addVariable("lang",lang),this.detectFlashVersion=detectFlashVersion||1,this.autoInstallRedirect=autoInstallRedirect||1,this.installedVer=infosoftglobal.FusionChartsUtil.getPlayerVersion(),!window.opera&&document.all&&this.installedVer.major>7&&(infosoftglobal.FusionCharts.doPrepUnload=!0))},infosoftglobal.FusionCharts.prototype={setAttribute:function(name,value){this.attributes[name]=value},getAttribute:function(name){return this.attributes[name]},addParam:function(name,value){this.params[name]=value},getParams:function(){return this.params},addVariable:function(name,value){this.variables[name]=value},getVariable:function(name){return this.variables[name]},getVariables:function(){return this.variables},getVariablePairs:function(){var key,variablePairs=new Array,variables=this.getVariables();for(key in variables)variablePairs.push(key+"="+variables[key]);return variablePairs},getSWFHTML:function(){var swfNode="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){swfNode='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"  ',swfNode+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var params=this.getParams();for(var key in params)swfNode+=[key]+'="'+params[key]+'" ';(pairs=this.getVariablePairs().join("&")).length>0&&(swfNode+='flashvars="'+pairs+'"'),swfNode+="/>"}else{swfNode='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">',swfNode+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var pairs;params=this.getParams();for(var key in params)swfNode+='<param name="'+key+'" value="'+params[key]+'" />';(pairs=this.getVariablePairs().join("&")).length>0&&(swfNode+='<param name="flashvars" value="'+pairs+'" />'),swfNode+="</object>"}return swfNode},setDataURL:function(strDataURL){if(0==this.initialDataSet)this.addVariable("dataURL",strDataURL),this.initialDataSet=!0;else{var chartObj=infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id"));chartObj.setDataURL||__flash__addCallback(chartObj,"setDataURL"),chartObj.setDataURL(strDataURL)}},encodeDataXML:function(strDataXML){var arrDQAtt=strDataXML.match(/=\s*\".*?\"/g);if(arrDQAtt)for(var i=0;i<arrDQAtt.length;i++){var repStr=arrDQAtt[i].replace(/^=\s*\"|\"$/g,"");repStr=repStr.replace(/\'/g,"%26apos;");var strTo=strDataXML.indexOf(arrDQAtt[i]),repStrr="='"+repStr+"'";strDataXML=strDataXML.substring(0,strTo)+repStrr+strDataXML.substring(strTo+arrDQAtt[i].length)}return strDataXML=(strDataXML=(strDataXML=strDataXML.replace(/\"/g,"%26quot;")).replace(/%(?![\da-f]{2}|[\da-f]{4})/gi,"%25")).replace(/\&/g,"%26")},setDataXML:function(strDataXML){0==this.initialDataSet?(this.addVariable("dataXML",this.encodeDataXML(strDataXML)),this.initialDataSet=!0):infosoftglobal.FusionChartsUtil.getChartObject(this.getAttribute("id")).setDataXML(strDataXML)},setTransparent:function(isTransparent){void 0===isTransparent&&(isTransparent=!0),isTransparent?this.addParam("WMode","transparent"):this.addParam("WMode","Opaque")},render:function(elementId){if(!(1==this.detectFlashVersion&&this.installedVer.major<8)){var n="string"==typeof elementId?document.getElementById(elementId):elementId;if(this.getVariable("scaleMode").search(/noscale/i)>=0&&(this.getAttribute("width").search("%")>0||this.getAttribute("height").search("%")>0)){var obj=this;window.addEventListener?window.addEventListener("load",(function(){n.innerHTML=obj.getSWFHTML()}),!1):window.attachEvent?window.attachEvent("onload",(function(){n.innerHTML=obj.getSWFHTML()})):n.innerHTML=this.getSWFHTML()}else n.innerHTML=this.getSWFHTML();return document.embeds[this.getAttribute("id")]||window[this.getAttribute("id")]||(window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))),!0}return 1==this.autoInstallRedirect&&(!!window.confirm("You need Adobe Flash Player 8 (or above) to view the charts. It is a free and lightweight installation from Adobe.com. Please click on Ok to install the same.")&&void(window.location="//www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash"))}},infosoftglobal.FusionChartsUtil.getPlayerVersion=function(){var PlayerVersion=new infosoftglobal.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];x&&x.description&&(PlayerVersion=new infosoftglobal.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0)for(var axo=1,counter=3;axo;)try{counter++,axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+counter),PlayerVersion=new infosoftglobal.PlayerVersion([counter,0,0])}catch(e){axo=null}else{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");PlayerVersion=new infosoftglobal.PlayerVersion([6,0,21]),axo.AllowScriptAccess="always"}catch(e){if(6==PlayerVersion.major)return PlayerVersion}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}null!=axo&&(PlayerVersion=new infosoftglobal.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(",")))}return PlayerVersion},infosoftglobal.PlayerVersion=function(arrVersion){this.major=null!=arrVersion[0]?parseInt(arrVersion[0]):0,this.minor=null!=arrVersion[1]?parseInt(arrVersion[1]):0,this.rev=null!=arrVersion[2]?parseInt(arrVersion[2]):0},infosoftglobal.FusionChartsUtil.cleanupSWFs=function(){for(var objects=document.getElementsByTagName("OBJECT"),i=objects.length-1;i>=0;i--)for(var x in objects[i].style.display="none",objects[i])"function"==typeof objects[i][x]&&(objects[i][x]=function(){})},infosoftglobal.FusionCharts.doPrepUnload&&(infosoftglobal.unloadSet||(infosoftglobal.FusionChartsUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){},window.attachEvent("onunload",infosoftglobal.FusionChartsUtil.cleanupSWFs)},window.attachEvent("onbeforeunload",infosoftglobal.FusionChartsUtil.prepUnload),infosoftglobal.unloadSet=!0)),!document.getElementById&&document.all&&(document.getElementById=function(id){return document.all[id]}),null==Array.prototype.push&&(Array.prototype.push=function(item){return this[this.length]=item,this.length}),infosoftglobal.FusionChartsUtil.getChartObject=function(id){var chartRef=null;return(chartRef=-1==navigator.appName.indexOf("Microsoft Internet")?document.embeds&&document.embeds[id]?document.embeds[id]:window.document[id]:window[id])||(chartRef=document.getElementById(id)),chartRef};var getChartFromId=infosoftglobal.FusionChartsUtil.getChartObject,FusionCharts=infosoftglobal.FusionCharts,voteValues=[];function changeFontSize(e){var fontClass,str="字体大小：",i=3,choice=["小","中","大"];switch(str+=new Array(4).join("<strong>#</strong>&nbsp;"),e){case 2:fontClass="fontSize_L";break;case 0:fontClass="fontSize_S";break;default:fontClass="fontSize_M"}str=str.replace(/(<strong>)(#)(<\/strong>)/g,(function(a,b,c,d){return--i!=e?'<a href="#" onclick="changeFontSize('+i+');return false;">'+choice[i]+"</a>":b+choice[e]+d})),$E("articleFontManage").innerHTML=str.substring(0,str.length-6),"undefined"!=typeof attentionWorldCup?$E("articlebody").className="worldcup_article "+fontClass:$E("articlebody").className="artical "+fontClass,"undefined"!=typeof SUDA&&SUDA.uaTrack("blog_article","h_article16")}RenderFlash=Core.Class.create(),RenderFlash.prototype={flashId:null,data:null,current:null,eventDom:null,_labels:null,selected:[],initialize:function(){this.eventDom={tab:$E("tabDiv")?$E("tabDiv"):null,line:$E("lineView")?$E("lineView"):null,pie:$E("pieView")?$E("pieView"):null,column:$E("columnView")?$E("columnView"):null,content:$E("voteViewContent")?$E("voteViewContent"):null},this._refreshFlashId(),this._addClickEvent(this.eventDom.line),this._addClickEvent(this.eventDom.pie),this._addClickEvent(this.eventDom.column),this.combineData()},showTab:function(flashType,flashId,parentId){if(this.current!=flashType){var flashBar=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];if(flashBar&&(flashBar.style.display=""),window.clearAllInterval(),"line"==flashType){this.current="line",$E("voteViewContent").innerHTML=window.vote_cache_content_html,window.renderVoteNum();for(var items=document.getElementsByName("chb1"),j=0;j<items.length;j++){items[j].disabled="true";try{items[j].parentNode.childNodes[3].style.cursor="default"}catch(error){}}}else if("Pie3D.swf"==flashType){this.current="Pie3D.swf";for(var html=this._tabTemplate.chooses.join(""),uls="",i=0;i<this._labels.length;i++){uls+=this._tabTemplate.item.join("").replace("#{type}",window.vote_rc_type+"").replace(/([#][{]index[}])/gi,i+1).replace("#{text}",this._labels[i])}html=html.replace("#{uls}",uls),html+=this._tabTemplate.flash.join(""),this.eventDom.content.innerHTML=html,(height=30*this._labels.length)<150&&(height=150);var xml="<chart baseFontSize='12' baseFontColor='888888' numberSuffix='%25' showAboutMenuItem='0' decimals='2' chartTopMargin='0' chartBottomMargin='0' caption='' showValues='0' formatNumberScale='0' bgColor='99CCFF,FFFFFF' bgAlpha='0,0' startingAngle='60'>";for(i=0;i<this.data.length;i++){this.data[i];null!=this.selected[i]?xml+="<set label='"+(i+1)+"' value='"+voteValues[i].replace("%","")+"' displayValue='"+Core.String.shorten(this._labels[i],7,"…")+"' toolText='"+this._labels[i]+"("+voteValues[i]+")' isSliced='1' />":xml+="<set label='"+(i+1)+"' value='"+voteValues[i].replace("%","")+"' displayValue='"+Core.String.shorten(this._labels[i],7,"…")+"' toolText='"+this._labels[i]+"("+voteValues[i]+")' />"}xml+="</chart>",(chart=new FusionCharts($_GLOBAL.flashBasicURL+"Pie3D.swf",flashId,"360",height,"0","0")).setDataXML(xml),chart.setTransparent(!0),chart.render(parentId)}else if("Column3D.swf"==flashType){this.current="Column3D.swf";for(html=this._tabTemplate.chooses.join(""),uls="",i=0;i<this._labels.length;i++){uls+=this._tabTemplate.item.join("").replace("#{type}",window.vote_rc_type+"").replace(/([#][{]index[}])/gi,i+1).replace("#{text}",this._labels[i])}var height,chart;html=html.replace("#{uls}",uls),html+=this._tabTemplate.flash.join(""),this.eventDom.content.innerHTML=html,(height=30*this._labels.length)<150&&(height=150);for(xml="<chart baseFontSize='12' baseFontColor='888888' showValues='1' outCnvBaseFontColor='999999' outCnvBaseFontSize='12' numberSuffix='%25' showAboutMenuItem='0' decimals='2' yAxisMaxValue='100' palette='2' enableRotation='1' canvasBgColor='ffffff' canvasBgAlpha='0' canvasBgDepth='3' canvasBaseColor='ffffff' divLineColor='d8d8d8' numDivLines='4' bgAlpha='0' divLineColor='d8d8d8' canvasPadding='8' chartLeftMargin='0' chartRightMargin='5' chartTopMargin='5' chartBottomMargin='0' maxColWidth='70' showValues='0'><styles><definition><style name='myToolTip' type='font' size='12' color='666666' /></definition><application><apply toObject='ToolTip' styles='myToolTip' /></application></styles>",i=0;i<this.data.length;i++){this.data[i];xml+="<set label='"+(i+1)+"' value='"+voteValues[i].replace("%","")+"' toolText='"+this._labels[i]+"("+voteValues[i]+")' />"}xml+="</chart>",(chart=new FusionCharts($_GLOBAL.flashBasicURL+"Column3D.swf",flashId,"360",height,"0","0")).setDataXML(xml),chart.setTransparent(!0),chart.render(parentId)}$E("flashContent")&&($E("flashContent").style.padding="13px 0 0 ")}},_refreshFlashId:function(){this.flashId=Core.Math.getUniqueId()},_addClickEvent:function(dom){var _this=this;dom&&(dom.onclick=function(){_this._onClickHandler(this)})},_onClickHandler:function(dom){var _this=this;function updateTabStatus(type){_this.eventDom.line.parentNode.className="",_this.eventDom.pie.parentNode.className="",_this.eventDom.column.parentNode.className="",_this.eventDom[type].parentNode.className="cur SG_txtb"}if(null!=dom){var id=dom.id;"lineView"==id?(this.showTab("line","lineId","voteViewContent"),updateTabStatus("line")):"pieView"==id?(this.showTab("Pie3D.swf","Pie3D_"+this.flashId,"flashContent"),updateTabStatus("pie")):"columnView"==id&&(this.showTab("Column3D.swf","Column3D_"+this.flashId,"flashContent"),updateTabStatus("column"))}},combineData:function(changeData){this.data=[];for(var labels=this._getLabel(),i=0;i<labels.length;i++)this.data[this.data.length]={label:labels[i],num:window.vote_count.detail[i]}},_getLabel:function(){for(var labels=[],spans=Core.Dom.getElementsByClass($E("voteViewContent"),"span",""),length=spans.length,i=0;i<length;i++)labels[labels.length]=spans[i].innerHTML;return this._labels=labels,labels},_tabTemplate:{chooses:['<div class="vContentRe">',"<ul>","#{uls}","</ul>","</div>"],item:['<li class="clearfix">','<div class="choosed">','<input type="#{type}" disabled="disabled" id="chb#{index}"/><label for="chb#{index}" style="cursor:default"><em>#{index}.</em><span>#{text}</span></label>',"</div>","</li>"],flash:['<div id="flashContent" class="vContentPic">',"</div>"]}},function(_){_.rf=null,_.changeType=function(flag){$E("mutiple").style.display=flag?"":"none",$E("voteType").value=flag?$E("mutiple").value:1},_.checkNum=function(self,mutipleNum){for(var chks=document.getElementsByName("chb1"),chkedNum=0,i=0;i<chks.length;i++){chks[i].checked&&chkedNum++}chkedNum>mutipleNum&&(winDialog.alert("最多只能选"+mutipleNum+"项！",{icon:"01"}),self.checked=!1)},_.isExpired=function(sDate){return sDate.replace(/(-)|\s/g,"")<getTimestamp("yyyy-MM-dd hh").replace(/(-)|\s/g,"")},_.getTimestamp=function(format){var currentTime=new Date,thisYear=currentTime.getFullYear(),thisMonth=currentTime.getMonth()+1;thisMonth=thisMonth>9?thisMonth:"0"+thisMonth;var today=currentTime.getDate()>9?currentTime.getDate():"0"+currentTime.getDate(),hh=currentTime.getHours(),mm=currentTime.getMinutes()>9?currentTime.getMinutes():"0"+currentTime.getMinutes(),ss=currentTime.getSeconds()>9?currentTime.getSeconds():"0"+currentTime.getSeconds();return format.replace(/(y{2,4})/,thisYear).replace("MM",thisMonth).replace("dd",today).replace("hh",hh).replace("mm",mm).replace("ss",ss)},_.readyFun=function(){var uid,isVoted=!1,_this=this;Lib.checkAuthor((function(){uid=$isLogin?$UID:"0";var mycookie=swfAPI.getC(uid);if(mycookie)for(var cookielist=mycookie.split("|"),i=0;i<cookielist.length;i++){if(cookielist[i]==scope.$articleid){isVoted=!0;break}}if(isVoted){var btn=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),btn.innerHTML='<span class="voteState">已投票</span>';for(var items=document.getElementsByName("chb1"),j=0;j<items.length;j++){items[j].disabled="true";try{$IE?items[j].parentNode.childNodes[2].style.cursor="default":items[j].parentNode.childNodes[3].style.cursor="default"}catch(error){}}var flashBar=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];flashBar&&(flashBar.style.display="")}else Core.Events.addEvent("voteBtn",(function(){for(var items=$T($E("voteViewContent"),"input"),selectedItems=[],i=0;i<items.length;i++){var item=items[i];item.checked&&item.name&&"chb1"==item.name&&selectedItems.push(i+1)}if(selectedItems.length<1)return winDialog.alert("请选择要投票的项！",{icon:"01"}),!1;Lib.checkAuthor((function(){function setFlashCookie(){try{var flashBar=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];flashBar&&(flashBar.style.display=""),mycookie?cookielist.length>99?swfAPI.clearK(uid):mycookie=scope.$articleid+"|"+mycookie:mycookie=scope.$articleid,swfAPI.setC(uid,mycookie.toString())}catch(e){Debug.error("投票种flash cookie失败！错误原因："+e)}}uid=$isLogin?$UID:"0",_this.flag=!0;var selectedLen=selectedItems.length;new Interface("//control.blog.sina.com.cn/admin/vote/shot_vote.php?version=7","ijax").request({POST:{blog_id:scope.$articleid,vote_checklist:selectedItems.join(",")},onSuccess:function(res){setFlashCookie();try{var btn=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),btn.innerHTML='<span class="voteState">已投票</span>',clearAllInterval()}catch(error){}window.vote_count.total+=1;for(var spans=Core.Dom.getElementsByClass($E("voteViewContent"),"span",""),tempArr=[],m=0;m<selectedLen;m++){var item=selectedItems[m];window.vote_count.detail[item-1]+=1,tempArr.push(spans[item-1].innerHTML)}var newItem={};newItem.uid=$UID;var time=(new Date).getTime();time/=1e3,time=Math.ceil(time),newItem.time=time,newItem.vote=tempArr;for(var tempResult=window.vote_interface_result,tempRArr=[],i=0;i<tempResult.length;i++)tempRArr[i+1]=tempResult[i];tempRArr[0]=newItem,window.vote_interface_result=tempRArr,renderVoteNum(),initLoginBar()},onError:function(res){try{if(winDialog.alert($SYSMSG[res.code]),"B00902"==res.code){var btn=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),btn.innerHTML='<span class="voteState">投票已截止</span>';for(var voteItems=$N("chb1"),i=0;i<voteItems.length;i++){voteItems[i].disabled=!0;try{voteItems[i].parentNode.childNodes[3].style.cursor="default"}catch(error){}}var flashBar=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];flashBar&&(flashBar.style.display="")}else if("B00904"==res.code){isVoted||setFlashCookie();btn=Core.Dom.getElementsByClass(document,"div","vBtn")[0];Core.Dom.removeParentNode($E("voteBtn")),btn.innerHTML='<span class="voteState">已投票</span>';for(voteItems=$N("chb1"),i=0;i<voteItems.length;i++){voteItems[i].disabled=!0;try{voteItems[i].parentNode.childNodes[3].style.cursor="default"}catch(error){}}}}catch(error){}}})}),"domEventreadyFun"+(new Date).getTime())}),"click",!1)}),"domEventreadyFun"+(new Date).getTime())},_.swfAPI={setC:function(key,value){$E("swfId").setC(key,value)},getC:function(key){return $E("swfId").getC(key)},clearK:function(key){$E("swfId").clearK(key)},clearC:function(){$E("swfId").clearC()}},_.insertList=function(oResult){var nS,date,list="",getVHTML=Lib.blogv.getVHTML;if(this.vote_interface_result){for(var i=0;i<vote_interface_result.length;i++){var item=vote_interface_result[i],html='<li><span class="SG_dot"></span><span class="txt"><a target="_blank" href="#{url}">#{nick}</a>#{userV}&nbsp;<span class="SG_txtb">投票给 #{vote}</span><em class="SG_txtc">#{time}</em></span></li>';html=(html=(html=(html=html.replace("#{url}","//blog.sina.com.cn/u/"+item.uid)).replace("#{nick}",oResult[item.uid])).replace("#{userV}",getVHTML(item.wtype))).replace("#{time}",(nS=item.time,date=void 0,(date=new Date(1e3*nS)).getFullYear()+"-"+(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-"+date.getDate()+" "+date.getHours()+":"+(date.getMinutes()<10?"0"+date.getMinutes():date.getMinutes())));for(var con="",j=0;j<item.vote.length;j++)con+='"'+item.vote[j]+'" ';if(list+=html=html.replace("#{vote}",con),10==i)break}$E("voterlist")&&($E("voterlist").innerHTML=list)}},_.initLoginBar=function(){Lib.checkAuthor((function(){$E("vote_login_txt")&&($isLogin?$E("vote_login_txt").style.display="none":($E("vote_login_txt").style.display="",$E("vote_login").onclick=function(){(new Lib.Login.Ui).login()}))}),"domEvent"+(new Date).getTime())},_.initNewVote=function(){Lib.checkAuthor(),$E("voteAD")&&($E("voteAD").innerHTML='<a class="SG_linka"><img height="15" align="top" width="15" class="SG_icon SG_icon33" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" title="投票"></a>&nbsp;<a target="_blank" href="//control.blog.sina.com.cn/admin/article/article_add.php#voteadd">发起新投票</a>&nbsp;&nbsp;&nbsp;<a class="SG_linka"><img height="18" align="top" width="18" title="" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon110"></a>&nbsp;<a href="#" id="shareVote">分享此投票</a>',$E("shareVote").onclick=function(){var u="//v.t.sina.com.cn/share/share.php?searchPic=false&title="+encodeURIComponent("分享投票："+$T($E("voter"),"span")[0].innerHTML+"——来自"+scope.owenerNickName+"的博文："+Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML||"")+"&url="+encodeURIComponent(document.location)+"&source=新浪-博客&sourceUrl="+encodeURIComponent("//blog.sina.com.cn")+"&content=utf-8&appkey=1617465124";return window.open(u,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),!1});var morevotediv=$E("cc_morevote");morevotediv||((morevotediv=$C("div")).id="cc_morevote",morevotediv.className="voteapp_btnMore",morevotediv.innerHTML='<a href="//control.blog.sina.com.cn/blogprofile/profilevote.php?type=1" target="blank" title="查看更多投票">查看更多投票&gt;&gt;</a><img class="SG_icon SG_icon11" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="新" align="absmiddle" />',$E("voterlist").parentNode.parentNode.appendChild(morevotediv))},_.renderVoteNum=function(){for(var uidList=[],result=window.vote_interface_result,i=0;i<result.length;i++){var item=result[i];uidList[uidList.length]=item.uid}Lib.Uic.getNickName(uidList,insertList),this.initNewVote();var temp=$E("chb1");null!=temp&&"radio"==temp.type?window.vote_rc_type="radio":window.vote_rc_type="checkbox",this.valueContents=Core.Dom.getElementsByClass($E("voter"),"div","num");var k;voteValues=[];var counts=window.vote_count.detail,total=window.vote_count.total;$E("total").innerHTML=total+"人";for(var totalTickets=0,j=0;j<counts.length;j++)totalTickets+=counts[j];for(k=0;k<valueContents.length;k++){var itemVote=counts[k];if(0==totalTickets)var percent="0%";else if(Math.round(itemVote/totalTickets*100)>100)percent="100%";else percent=Math.round(itemVote/totalTickets*100)+"%";voteValues.push(percent),valueContents[k].innerHTML=itemVote+'<span class="SG_txtc">('+percent+")</span>"}renderProgress(voteValues)},_.renderProgress=function(voteValues){var i;window.itvIds=[];var valueBars=Core.Dom.getElementsByAttr($E("voter"),"name","voteResult"),valueContents=Core.Dom.getElementsByClass($E("voter"),"div","num"),percentW=[];for(i=0;i<valueContents.length;i++)/\((.*)\)/.test(valueContents[i].innerHTML),percentW[i]=RegExp.$1;for(i=0;i<valueBars.length;i++)valueBars[i].className="color c"+(i+1),valueBars[i].style.fontSize="8px",valueBars[i].style.width="0px",window.itvIds[i]=window.setInterval(function(idx){return function(){parseInt(valueBars[idx].style.width)<parseInt(percentW[idx])?valueBars[idx].style.width=parseInt(valueBars[idx].style.width,10)+1+"%":window.clearInterval(itvIds[idx])}}(i),10);this.rf||(_.rf=new RenderFlash)},_.clearAllInterval=function(){if(window.itvIds)for(var i=0;i<window.itvIds.length;i++)window.clearInterval(itvIds[i])}}(window),$registJob("dynamicVoteView",(function(){$E("voter");window.vote_progress_css=["1px solid #8d458e","1px solid #578425","1px solid #89ba00","1px solid #008d8e","1px solid #7da4cf","1px solid #d54545","1px solid #ff8d46","1px solid #f6bd0e","1px solid #008dd5","1px solid #b2aa01"],$E("voterlist")&&Lib.checkAuthor((function(){var isEscape="";try{isEscape=Core.Dom.getElementsByClass($E("voter"),"span","voteState")[0].innerHTML}catch(error){}Utils.Io.JsLoad.request("//control.blog.sina.com.cn/blog_rebuild/riaapi/blog/get_user_vote.php",{GET:{blog_id:scope.$articleid},onComplete:function(res){try{if("A00006"==res.code)window.vote_cache_content_html=$E("voteViewContent")?$E("voteViewContent").innerHTML:"",window.vote_interface_result=res.data&&res.data.newten,window.vote_count=res.data&&res.data.count,renderVoteNum();else if(winDialog.alert(res.code,{icon:"02"}),$E("voterlist")&&$isLogin&&"投票已截止"!=isEscape)$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。";else if("投票已截止"==isEscape)try{var flashBar=Core.Dom.getElementsByClass($E("voter"),"div","vShape")[0];flashBar&&(flashBar.style.display="none"),Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(error){}else $isLogin?$E("voterlist").innerHTML="加载中…":$E("voterlist").innerHTML="还没有博主投票呢，赶紧抢个沙发吧。"}catch(e){trace("vote error")}},noencode:!0,onError:function(res){if($E("voterlist")&&($E("voterlist").innerHTML="加载中…"),"投票已截止"==isEscape)try{Core.Dom.getElementsByClass($E("module_920"),"div","newVoteList SG_j_linedot1")[0].style.display="none"}catch(error){}}})}),"dynamicVoteView"+(new Date).getTime())})),function(){var container,url,readyFun,swfID,FlashPlayer,random="";(window.$Maxthon||window.$360||window.$TT)&&(random="?uid="+Core.Math.getUniqueId(1,10)),container="swfbox",url=$_GLOBAL.flashBasicURL+"voteCookie.swf"+random,readyFun="readyFun",swfID="swfId",(FlashPlayer=new Utils.Flash.swfObject(url,swfID,"1","1","9","#00ff00")).addParam("quality","high"),FlashPlayer.addParam("allowScriptAccess","always"),FlashPlayer.addVariable("readyFun",readyFun),FlashPlayer.write(container)}(),$SYSMSG.extend({B03020:"博文已收藏成功！",B03002:"已达收藏数2000条上限，不能继续收藏。",B03004:"已收藏过此博文，不能重复收藏。",B03005:"确实要取消此收藏吗？",B03006:"确实要删除此博文吗？删除后可在“回收站”恢复。",B03007:"确实要删除此草稿吗？删除后不可恢复。",B03008:"确实要彻底删除此博文吗？删除后不可恢复。",B03010:"确实要替换已置顶的博文吗？",B03011:"确实要取消置顶吗？取消后可在“博文”页恢复。",B03014:"博文已成功置顶到首页！",B03015:"抱歉，您的博客尚未升级，请<a href='//blog.sina.com.cn/u/#UID' target='_blank'>升级</a>后再“收藏” 。",S01107:"已收藏过此博文，不能重复收藏。",B03016:"是否要彻底删除此博文？博文删除后不可恢复，博文内图片如被其他博文引用也将无法显示。",B03017:"私密博文不能被收藏。",B119000:"对不起，您短时间点击收藏过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"}),App.ArticleMange=Core.Class.create(),Core.Class.extend(App.ArticleMange.prototype,{initialize:function(sArticleId,oOption){for(var key in oOption)this[key]=oOption[key];this.articleId=sArticleId,this.pretreat()},pretreat:function(){return null==this.articleId?void Debug.error("ArticleManage need the article id."):(this.checkLogin(),this)},checkLogin:function(){var _this=this;Lib.checkAuthor((function(){_this.needLogin=_this.needLogin(),Debug.log("checkLogin : "+_this.needLogin);var callback,actionConfirm=Core.Function.bind2(_this.confirm,_this);_this.needLogin||!$isLogin?(callback=actionConfirm,(new Lib.Login.Ui).login(callback)):actionConfirm()}),"ArticleManage"+(new Date).getTime())},confirm:function(){var _self=this;Lib.checkAuthor((function(){$isLogin||$tray.renderLogin(),_self.needLogin=!1;var tok=_self.textOk||"确定",tca=_self.textCancel||"取消";_self.confirmMSG?winDialog.confirm(_self.confirmMSG,{funcOk:Core.Function.bind2(_self.doAction,_self),textOk:tok,textCancel:tca}):_self.doAction()}),"ArticleManage2"+(new Date).getTime())},doAction:function(){$IE&&Core.Events.getEvent()&&Core.Events.stopEvent();var param={};for(var key in this.param)"function"==typeof this.param[key]?param[key]=Core.Function.bind2(this.param[key],this)():param[key]=this.param[key];"POST"==param.getType?(param.getType&&delete param.getType,this.Interface.request({POST:param,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(oData){showError(oData.code)},onFail:function(){showError("A00001")}})):(param.getType&&delete param.getType,this.Interface.request({GET:param,onSuccess:this.callback||this.requestOk||function(){window.location.reload()},onError:this.requestError||function(oData){showError(oData.code)},onFail:function(){showError("A00001")}}))}}),Lib.IframeDialog=Core.Class.create(),Lib.IframeDialog.prototype={dialog:null,initialize:function(option){this.id=Core.Math.getUniqueId(),this.option=option},initDialog:function(){var this_option=this.option,obj={ad:!1,drag:!0,tpl:this_option.tpl||this.tpl,title:this_option.title,content:'<iframe frameborder="0" id="ifrDialog_'+this.id+'" scrolling="no"></iframe>',renderer:Ui.SimpleRenderer,width:this_option.width,height:this_option.height};this.dialog=winDialog.createCustomsDialog(obj),this.dialog.setAreaLocked(!0);var iframe=$E("ifrDialog_"+this.id);iframe.src=this_option.url,iframe.style.width=this_option.width+"px",iframe.style.height=this_option.height+"px",this_option.funcClose&&this.bindColseFunc()},tpl:'<table id="#{entity}" class="CP_w"><thead id="#{titleBar}"><tr><th class="tLeft"><span></span></th><th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="javascript:;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th><th class="tRight"><span></span></th></tr></thead><tfoot><tr><td class="tLeft"><span></span></td><td class="tMid"><span></span></td><td class="tRight"><span></span></td></tr></tfoot><tbody><tr><td class="tLeft"><span></span></td><td class="tMid" id="#{content}"></td><td class="tRight"><span></span></td></tr></tbody></table>',reset:function(){if(this.dialog){this.hidden();var dialogParentNode=this.dialog.nodes.panel||this.dialog.nodes.entity;dialogParentNode.parentNode.removeChild(dialogParentNode),this.dialog=null}},bindColseFunc:function(){Core.Events.addEvent(this.dialog.nodes.btnClose,this.option.funcClose)},setSize:function(nWidth,nHeight){var ele=this.dialog.nodes.content.firstChild;this.dialog.setSize(nWidth,nHeight),ele.style.width=nWidth+"px",ele.style.height=nHeight+"px"},show:function(){this.reset(),this.initDialog(),this.dialog.show(),this.dialog.setMiddle()},close:function(){this.dialog.hidden()}},Lib.AccountChecker=Core.Class.create(),Lib.AccountChecker.prototype={initialize:function(ssoUrl){ssoUrl.indexOf("vt=1")>0||ssoUrl.indexOf("vt=2")>0?this.showDialog(ssoUrl):window.location.href=ssoUrl},showDialog:function(ssoUrl){document.domain="sina.com.cn",window.accDialog||(window.accDialog=new Lib.IframeDialog({url:ssoUrl,title:"账号安全",width:300,height:165}),scope.accCallback=function(){window.accDialog.close()}),window.accDialog.show();var nodes=window.accDialog.dialog.nodes,content=nodes.content;content.firstChild.style.marginLeft="25px",nodes.btnClose.style.display="none";var p=document.createElement("p");p.style.lineHeight="70px",p.innerHTML="　　为了您的账号安全，请输入验证码后再进行操作",content.insertBefore(p,content.firstChild)},hideDialog:function(){window.accDialog&&window.accDialog.hidden()}},App.deleteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_del_recycle.php","ijax"),needLogin:function(){return trace("检查用户"),!$isAdmin},confirmMSG:$SYSMSG.B03006,param:{getType:"POST","blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(oData){oData&&"B30001"===oData.code?new Lib.AccountChecker(oData.data.ssoUseUrl):showError(oData.code)}}),App.deleteDraftArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_draft_del.php","jsload"),needLogin:function(){return!$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.clearRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_recycle_del.php","jsload"),needLogin:function(){return!$isAdmin},confirmMSG:$SYSMSG.B03016,textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.restoreRecycleBinArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_recycle_resume.php","jsload"),needLogin:function(){return!$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.addFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/favourites_save.php","jsload"),needLogin:function(){return!$isLogin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){$E("f_"+scope.$articleid)&&($E("f_"+scope.$articleid).innerHTML=$E("f_"+scope.$articleid).innerHTML.replace(/\((\d*)\)/gi,(function(a,b){return"("+(window.parseInt(b)+1)+")"}))),winDialog.alert($SYSMSG.B03020,{icon:"03"})}}),App.deleteFavoriteArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/favourites_del.php","jsload"),needLogin:function(){return!$isAdmin},confirmMSG:$SYSMSG.B03005,param:{resourceids:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.setTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){return!$isAdmin},param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.replaceTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_top.php","jsload"),needLogin:function(){return!$isAdmin},confirmMSG:$SYSMSG.B03010,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.unsetTopArticle=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_top_del.php","jsload"),needLogin:function(){return!$isAdmin},confirmMSG:$SYSMSG.B03011,param:{blog_id:function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()}}),App.moreLayer=function(sAid,evt){var beVisMore,ele,beHidLayer="",beVisLayer="";function isChildNodes(ele,src){if(ele.hasChildNodes())for(var children=ele.childNodes,i=0;children[i];i++)if(isChildNodes(children[i],src))return!0;return ele==src}scope.moreLayerId||(scope.moreLayerId=[0,0]),scope.moreLayerId.push(sAid),scope.moreLayerId.shift(),beHidLayer=$E("a_layer_"+scope.moreLayerId[0]),beVisMore=$E("a_more_"+scope.moreLayerId[1]),(beVisLayer=$E("a_layer_"+scope.moreLayerId[1])).style.left=Core.Dom.getLeft(beVisMore)-30+"px",beVisLayer.style.top=Core.Dom.getTop(beVisMore)+beVisMore.offsetHeight+"px",beHidLayer&&(beHidLayer.style.display="none"),beVisLayer.style.height="80px",beVisLayer.style.display="",beVisLayer.onmouseout=(ele=beVisLayer,function(e){var src=(e=e||window.event).relatedTarget||e.toElement;$FF?isChildNodes(ele,src)||(ele.style.display="none"):ele.contains(src)||(ele.style.display="none")})},App.modifyCategory=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/riaapi/article/edit_cat.php","jsload"),param:{},requestOk:function(){window.location.reload()},requestError:function(sCode){},needLogin:function(){return trace("检查用户"),!$isAdmin},confirmMSG:['<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt" style="padding:0;">','<table class="CP_w_ttl"><tr><td id="#{text}">','<p style="font-size:13px; font-weight:normal; padding-left:30px;">文章分类：','<select id="#{cateSel}" style="width:130px;">{0}</select>',"</p>","</td></tr></table>",'<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns" style="padding-left:60px;">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"><span id="#{ok}">确认</span></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"><span id="#{cancel}">取消</span></cite></a>',"</p>","</div>","</div>"].join(""),confirm:function(){var _this=this;function _articleFunc(){_this.confirmMSG?App.cacheSort?_this.showLayer():App.getArticlesSort((function(data){App.cacheSort=data.data,_this.showLayer()})):_this.doAction(),_this.confirmMSG?App.cacheSort?_this.showLayer():App.getArticlesSort((function(data){App.cacheSort=data.data,_this.showLayer()})):_this.doAction()}Lib.checkAuthor((function(){$isLogin?_articleFunc():(_articleFunc(),$tray.renderLogin())}),"article_modifyCate"+(new Date).getTime()),_this.needLogin=!1},showLayer:function(){for(var modiDial,cateSel,datai,_this=this,curid=+this.cateId,curIndex=0,opts="<option value='00'>选择分类</option>",i=0;i<App.cacheSort.length;i++)datai=App.cacheSort[i],opts+="<option value='{1}'>{0}</option>".format(datai.name,datai.id),datai.id===curid&&(curIndex=i+1);opts+="<option value='0'>私密博文</option>",this.confirmMSG=this.confirmMSG.format(opts),(modiDial=winDialog.createCustomsDialog({title:"修改博文分类",content:this.confirmMSG})).setFixed(!0),modiDial.setMiddle(),modiDial.show(),(cateSel=modiDial.nodes.cateSel).selectedIndex=curIndex,modiDial.nodes.linkCancel.onclick=function(){return modiDial.close(),!1},modiDial.nodes.btnClose.onclick=function(){return modiDial.close(),!1},modiDial.nodes.linkOk.onclick=function(){return _this.param={old_cat:_this.cateId,new_cat:cateSel.options[cateSel.selectedIndex].value,blog_id:_this.articleId},"0"===_this.param.new_cat?(_this.privacyArticleCheck(Core.Function.bind2(_this.doAction,_this)),void modiDial.close()):(Core.Function.bind2(_this.doAction,_this)(),modiDial.close(),!1)}},privacyArticleCheck:function(cb){var itf=new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/points/check_vip.php","ijax");itf.request({POST:{type:4},onSuccess:function(data){cb()},onError:function(result){result&&"A00001"==result.code&&function(cb){var interfacePrivacy=new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/points/points_redeem.php","ijax");winDialog.alert("你尚未开通私密博文功能!",{funcOk:function(){interfacePrivacy.request({POST:{user:scope.$uid||$UID,type:4,auto:1},onSuccess:function(data){cb()},onError:function(result){result&&"A00003"==result.code?winDialog.alert(result.data,{subText:'<a href="//blog.sina.com.cn/huodong/lottery.html?f=1">马上获得1888积分! </a>'}):winDialog.alert(result&&result.data)},onFail:function(){}})},textOk:"兑换并修改",subText:"私密博文一个月(30天)功能仅需30积分"},"privacyArticleDialog")}(cb)},onFail:function(){}})},requestOk:function(){winDialog.alert("修改分类成功",{icon:"03",funcOk:function(){window.location.reload()}})}}),App.deleteClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/admin/article/article_clockpub_del.php","jsload"),needLogin:function(){return!$isAdmin},confirmMSG:"博文删除后将无法恢复，确定要删除吗？",textOk:"是",textCancel:"否",param:{"blog_id[]":function(){return this.articleId},uid:scope.$uid},requestOk:function(){window.location.reload()},requestError:function(oData){"B00011"===oData.code?winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"}):showError(oData.code)}}),App.sendClockpub=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/blog_rebuild/riaapi/blog/clockPubImmediate.php","jsload"),needLogin:function(){return!$isAdmin},param:{blog_id:function(){return this.articleId}},requestOk:function(data){winDialog.alert("博文已发布成功",{funcOk:function(){setTimeout((function(){window.location.href="//blog.sina.com.cn/s/blog_"+data+".html"}),1)},icon:"03"})},requestError:function(oData){"B40003"===oData.code||"B36101"===oData.code?winDialog.alert("博文已不在定时列表中",{funcOk:function(){window.location.reload()},icon:"01"}):showError(oData.code)}}),App.articleHide=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=0","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否要隐藏此博文",needLogin:function(){return trace("检查用户"),!$isAdmin},requestOk:function(){winDialog.alert("隐藏成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(sCode){winDialog.alert("失败，请重试")}}),App.articleRestore=Core.Class.define(null,App.ArticleMange,{Interface:new Interface("//control.blog.sina.com.cn/riaapi/article/edit_cat.php?old_cat=0&new_cat=00","jsload"),param:{blog_id:function(){return this.articleId}},confirmMSG:"是否恢复此博文",needLogin:function(){return!$isAdmin},requestOk:function(){winDialog.alert("恢复成功",{icon:"03",funcOk:function(){window.location.reload()}})},requestError:function(sCode){winDialog.alert("恢复失败，请重试")}}),$articleManage=function(sArticleId,nAction,oOption){if($IE)try{Core.Events.stopEvent(),$E("a_layer_"+scope.moreLayerId[1]).style.display="none",$E("a_layer_"+scope.moreLayerId[0]).style.display="none"}catch(e){}switch(oOption=oOption||{},nAction){case 1:new App.deleteArticle(sArticleId,oOption);break;case 2:new App.deleteDraftArticle(sArticleId,oOption);break;case 3:new App.clearRecycleBinArticle(sArticleId,oOption);break;case 4:new App.restoreRecycleBinArticle(sArticleId,oOption);break;case 5:var testFunc=function(){scope.blogOpener.showDialog((function(){new App.addFavoriteArticle(sArticleId,oOption)}))};Lib.checkAuthor((function(){$isLogin?testFunc():(v7sendLog("48_01_35"),(new Lib.Login.Ui).login(testFunc))}),"articleManageFactory"+(new Date).getTime());break;case 6:new App.deleteFavoriteArticle(sArticleId,oOption);break;case 7:new App.setTopArticle(sArticleId,oOption);break;case 8:new App.replaceTopArticle(sArticleId,oOption);break;case 9:new App.unsetTopArticle(sArticleId,oOption);break;case 10:App.moreLayer(sArticleId,Core.Events.getEvent());break;case 11:new App.modifyCategory(sArticleId,oOption);break;case 12:new App.articleHide(sArticleId,oOption);break;case 13:new App.articleRestore(sArticleId,oOption);break;case 14:new App.deleteClockpub(sArticleId,oOption);break;case 15:new App.sendClockpub(sArticleId,oOption)}},$registJob("stylefix",(function(){$IE6&&scope.UserPic&&scope.UserPic[1]&&"1"==scope.UserPic[1].apply&&($E("blognavBg").style.filter="none");var body=$E("sina_keyword_ad_area2");if(body)body.getElementsByTagName("embed"),body.getElementsByTagName("object");var style=document.createElement("style");style.type="text/css",style.id="stylefix";var css="#bsPanelHolder,#sinaads_pdps54771{display:none;}";try{style.appendChild(document.createTextNode(css))}catch(ex){style.styleSheet.cssText=css}document.getElementsByTagName("head")[0].appendChild(style)})),$registJob("imageLazyLoad",(function(){for(var imgs=document.getElementsByTagName("IMG"),list=[],i=0,len=imgs.length;i<len;i++)null!=imgs[i].getAttribute("real_src")&&list.push(imgs[i]);list.length>0&&Lib.LazyLoad(list,{callback:function(o){scope.sharePhoto&&scope.sharePhoto.bindFn&&scope.sharePhoto.bindFn(o,"real_src");var src=o.getAttribute("real_src");scope.showPicSlide&&scope.showPicSlide(o,src),o.src=src,"articletjTech"===scope.$pageid&&(o.complete&&o.width>550?o.width=550:o.onload=function(){o.width>550&&(o.width=550)})}})})),$registJob("flashtemplate",(function(){Lib.checkAuthor((function(){Lib.getTplNum((function(){scope.tpl&&Lib.insertMoban()}))}),"flashtemplate"+(new Date).getTime())})),Lib.Ticket={requestTickets:[],_interface:"https://login.sina.com.cn/sso/getst.php",_setParam:function(param){var urlArray=[];urlArray.push(this._interface);var i=0;for(var name in param)0==i?urlArray.push("?"):urlArray.push("&"),urlArray.push(name),urlArray.push("="),urlArray.push(param[name]),i++;return urlArray.join("")},get:function(callbackFunc,count,entry,service){if(callbackFunc){var options={success:function(){},fail:function(){}};"function"==typeof callbackFunc?options.success=callbackFunc:("function"==typeof callbackFunc.success&&(options.success=callbackFunc.success),"function"==typeof callbackFunc.fail&&(options.fail=callbackFunc.fail));var param={};param.entry=entry||"blog",param.service=service||"tupian",param.cnt=count||20;var url=this._setParam(param);Utils.Io.JsLoad.request(url,{onComplete:function(result){var oldTickets=Lib.Ticket.requestTickets;result&&(Lib.Ticket.requestTickets=oldTickets.concat(result.ticket)),options.success(result)},onException:function(){options.fail()},timeout:3e4,charset:"UTF-8"})}}},"undefined"==typeof Lib.flashComponent&&(Lib.flashComponent={}),Lib.flashComponent.HeadPhotoEditorConfig={t3_34:{middlePointX:350,middlePointY:100,maskX:108,maskY:0,maskURL:"//simg.sinajs.cn/blog7swf/baby/mask3_34.swf",frameURL:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_34.png",defaultPhoto:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_35:{middlePointX:200,middlePointY:100,maskX:6,maskY:0,maskURL:"//simg.sinajs.cn/blog7swf/baby/mask3_35.swf",frameURL:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_35.png",defaultPhoto:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_36:{middlePointX:300,middlePointY:120,maskX:131,maskY:23,maskURL:"//simg.sinajs.cn/blog7swf/baby/mask3_36.swf",frameURL:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_36.png",defaultPhoto:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"},t3_37:{middlePointX:230,middlePointY:100,maskX:71,maskY:0,maskURL:"//simg.sinajs.cn/blog7swf/baby/mask3_37.swf",frameURL:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/frame3_37.png",defaultPhoto:"//simg.sinajs.cn/blog7style/images/bring/baby_flashResource/babyPhoto.png"}},Lib.FlashDetector=function(ver){this.version=ver}.$define({version:"",detect:function(){var i,l,isFlashed,nav=window.navigator,clientVersion="0.0.0";if(nav.plugins&&nav.plugins.length){for(i=0,l=nav.plugins.length;i<l;i++)if(-1!=nav.plugins[i].name.toLowerCase().indexOf("shockwave flash")){clientVersion=nav.plugins[i].description.toLowerCase().replace(/shockwave flash\s?/,"").split(" ")[0],isFlashed=!0;break}}else if(window.ActiveXObject)for(i=11;i>=1;i--)try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i)){clientVersion=i+".0",isFlashed=!0;break}}catch(ex){}isFlashed?this._detectVersion(clientVersion):this.onUninstalled&&this.onUninstalled.call(this)},_detectVersion:function(clientVersion){var i,cvs=this._getFormatVersion(clientVersion).split("."),vs=this._getFormatVersion(this.version).split("."),l=vs.length;for(i=0;i<l;i++){if(+cvs[i]>+vs[i])return void(this.onSuccess&&this.onSuccess.call(this));if(+cvs[i]<+vs[i])return void(this.onVersionLower&&this.onVersionLower.call(this,clientVersion))}this.onSuccess&&this.onSuccess.call(this)},_getFormatVersion:function(ver){var v=ver+"";return-1==v.indexOf(".")&&(v+=".0.0"),v.split(".").length<3&&(v+=".0"),v},onVersionLower:function(clientVersion){},onUninstalled:function(){},onSuccess:function(){}}),Lib.flashComponent.FlashContianer=function(cfg){this._initCfg(cfg),this._flashDetector=new Lib.FlashDetector(this.flashCfg.version),this._detect()}.$define({flashCfg:{url:"",width:0,height:0,containerID:"divContainer",flashID:"flashID",flashVar:"",version:"9",wmode:"transparent",allowScriptAccess:"always"},rerender:function(){this._initFlash()},_renderText:["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="//get.adobe.com/cn/flashplayer/">','<img src="//simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join(""),_flash:null,_falshEntity:null,_flashDetector:null,_initFlash:function(){this._addFlash(),this._initFlashEntity()},_detect:function(){var fd=this._flashDetector,me=this;fd.onSuccess=function(){me._initFlash()},fd.onUninstalled=function(){me._renderUninstalled()},fd.onVersionLower=function(clientVersion){me._renderVersionLower()},fd.detect()},_renderVersionLower:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的Flash播放器版本过低")},_renderUninstalled:function(){$E(this.flashCfg.containerID).innerHTML=this._renderText.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器")},_initCfg:function(cfg){var k;for(k in this.flashCfg)"undefined"!=typeof cfg[k]&&(this.flashCfg[k]=cfg[k])},_addFlash:function(){var fc=this.flashCfg;this._flash=new Utils.Flash.swfObject(fc.url,fc.flashID,fc.width,fc.height,fc.version,"#ffffff"),this._flash.addParam("allowScriptAccess",fc.allowScriptAccess),this._flash.addParam("wmode",fc.wmode),this._flash.addParam("flashVars",fc.flashVar),this._flash.write(fc.containerID)},_initFlashEntity:function(){this._flashEntity=$IE?window[this.flashCfg.flashID]:document[this.flashCfg.flashID]}}),Lib.flashComponent.HeadPhotoEditor=function(cfg){}.$extends(Lib.flashComponent.FlashContianer).$define({updateRender:function(tplName){var hpc=Lib.flashComponent.HeadPhotoEditorConfig[tplName];this._flashEntity.setFrameURL&&this._flashEntity.setFrameURL(hpc.frameURL),this._flashEntity.setMask&&this._flashEntity.setMask(hpc.maskURL,hpc.maskX,hpc.maskY),this._flashEntity.setMiddlePoint&&this._flashEntity.setMiddlePoint(hpc.middlePointX,hpc.middlePointY),this.resetPhoto()},resetPhoto:function(){this._flashEntity.resetPhoto&&this._flashEntity.resetPhoto()},save:function(){this._flashEntity.save&&this._flashEntity.save()},setMessage:function(msg){this._flashEntity.setMessage&&this._flashEntity.setMessage(msg)},setPhotoParam:function(angle,zoom,x,y){this._flashEntity.setPhotoParam&&this._flashEntity.setPhotoParam(angle,zoom,x,y)},getSaveParams:function(){return this._flashEntity.getSaveParams?this._flashEntity.getSaveParams():""},sendTo:function(url){this._flashEntity.sendTo&&this._flashEntity.sendTo(url)},setSavedPhotoURL:function(url){this._flashEntity.setSavedPhotoURL&&this._flashEntity.setSavedPhotoURL(url)},setSendToURL:function(url){this._flashEntity.setSendToURL&&this._flashEntity.setSendToURL(url)}}),"undefined"==typeof scope.flashComponent&&(scope.flashComponent={}),scope.flashComponent.HeadPhotoEditorDialog=function(tpl){this.tpl=tpl}.$define({tpl:"",_isInit:!1,_dialog:null,_initDialog:function(){this._dialog=winDialog.createCustomsDialog({content:'<div style="width:540px;height:400px;" id="divHeadPhotoEditorFlash"></div>',title:"上传宝宝照片",renderer:Ui.SimpleRenderer}),this._isInit=!0},_initFlash:function(){var cfg=Lib.flashComponent.HeadPhotoEditorConfig["t"+this.tpl]||Lib.flashComponent.HeadPhotoEditorConfig.t3_34,headPhotoInfo=scope.UserBabyPic||{},me=this;Lib.checkAuthor((function(){scope.babyHeadPhotoEditor=new Lib.flashComponent.HeadPhotoEditor({url:$_GLOBAL.flashBasicURL+"baby/headPhotoEditor.swf?"+(new Date).getTime(),width:540,height:400,containerID:"divHeadPhotoEditorFlash",flashID:"swfHeadPhotoEditor",flashVar:["maskURL=",cfg.maskURL,"&maskX=",cfg.maskX,"&maskY=",cfg.maskY,"&photoURL=",headPhotoInfo.photoURL||cfg.defaultPhoto,"&photoX=",headPhotoInfo.photoX||0,"&photoY=",headPhotoInfo.photoY||0,"&photoZoom=",headPhotoInfo.zoom||1,"&photoAngle=",headPhotoInfo.angle||0,"&frameURL=",cfg.frameURL,"&uploadURL=","//icp.api.sina.com.cn/person/up_pic.php","&fuid=",$UID,"&type=","babyicon","&isShowButton=1","&echo=","","&middlePointX=",cfg.middlePointX,"&middlePointY=",cfg.middlePointY,"&saveURL=","//control.blog.sina.com.cn/riaapi/reg/init_blog_headflash.php","&onCancel=","scope.babyHeadPhotoEditor.onCancel","&onSaved=","scope.babyHeadPhotoEditor.onSaved","&onUploaded=","scope.babyHeadPhotoEditor.onUploaded","&onSendCompleted=","scope.babyHeadPhotoEditor.onSendCompleted","&onFileTypeError=","scope.babyHeadPhotoEditor.onFileTypeError"].join("")}),scope.babyHeadPhotoEditor.onCancel=function(){me.hidden()}}),"headPhotoEditorDialog"+(new Date).getTime())},show:function(){!this._isInit&&this._initDialog(),this._dialog.setFixed(!0),this._dialog.setAreaLocked(!0),this._dialog.show(),this._dialog.setMiddle();var me=this;setTimeout((function(){me._initFlash(),me.onShow&&me.onShow.call(me)}),1)},hidden:function(){this._dialog.hidden()},onShow:function(){}}),Lib.flashComponent.HeadPhoto=function(cfg){}.$extends(Lib.flashComponent.FlashContianer).$define({setMaskPosition:function(x,y){x=isNaN(x)?0:x,y=isNaN(y)?0:y,this._flashEntity.setMaskPosition&&this._flashEntity.setMaskPosition(x,y)},setPhotoURL:function(url){this._flashEntity.setPhotoURL&&this._flashEntity.setPhotoURL(url)},getPhotoURL:function(url){if(this._flashEntity.getPhotoURL)return this._flashEntity.getPhotoURL()},setPhotoPosition:function(x,y){x=isNaN(x)?0:x,y=isNaN(y)?0:y,this._flashEntity.setPhotoPosition&&this._flashEntity.setPhotoPosition(x,y)},setPhotoZoom:function(zoom){zoom=isNaN(zoom)?1:zoom,this._flashEntity.setPhotoZoom&&this._flashEntity.setPhotoZoom(zoom)},setPhotoAngle:function(angle){angle=isNaN(angle)?0:angle,this._flashEntity.setPhotoAngle&&this._flashEntity.setPhotoAngle(angle)}}),$registJob("baby_headPhoto",(function(){var headPhotoInfo=scope.UserBabyPic||{},headFlash=$E("headflash"),babyTpls=scope.babyTpl_conf||["3_34","3_35","3_36","3_37"];scope.renderHeadPhoto=function(tpl){if(headFlash){headFlash.style.display="";var cfg=Lib.flashComponent.HeadPhotoEditorConfig["t"+tpl]||Lib.flashComponent.HeadPhotoEditorConfig.t3_34;scope.headPhoto=new Lib.flashComponent.HeadPhoto({url:$_GLOBAL.flashBasicURL+"baby/headPhoto.swf",width:540,height:285,containerID:"headflash",flashID:"flashHeadPhoto",flashVar:["maskURL=",cfg.maskURL,"&maskX=",cfg.maskX,"&maskY=",cfg.maskY,"&middlePointX=",cfg.middlePointX,"&middlePointY=",cfg.middlePointY,"&photoURL=",headPhotoInfo.photoURL||cfg.defaultPhoto,"&photoX=",headPhotoInfo.photoX||0,"&photoY=",headPhotoInfo.photoY||0,"&photoZoom=",headPhotoInfo.zoom||1,"&photoAngle=",headPhotoInfo.angle||0].join("")})}};for(var i=0,l=babyTpls.length;i<l;i++)if(babyTpls[i]==scope.tpl){scope.renderHeadPhoto(scope.tpl);break}})),$SYSMSG.extend({A11007:"备孕宝贝时间出错",A00015:"参数非法"}),$registJob("baby_headPhotoEditorDialog",(function(){$callJob("baby_headPhoto");var hp=scope.headPhoto,hped=new scope.flashComponent.HeadPhotoEditorDialog(scope.tpl),btnHPEDialog=$E("btnHPEDialog"),data,cfg=Lib.flashComponent.HeadPhotoEditorConfig["t"+scope.tpl]||Lib.flashComponent.HeadPhotoEditorConfig.t3_34,getParamObj=function(param){if(-1==param.indexOf("&"))return null;for(var arr=param.split("&"),paramObj={},i=0,l=arr.length;i<l;i++){if(-1==arr[i].indexOf("="))return null;var ps=arr[i].split("="),k=ps[0],v=ps[1];paramObj[k]=v}return paramObj},setHeadPhotoParam=function(paramObj){paramObj&&(paramObj.photoURL.length>0&&paramObj.photoURL!=cfg.defaultPhoto&&(paramObj.photoURL=getPhotoURLByKey(paramObj.photoURL)),paramObj.photoURL.length>0&&scope.headPhoto.getPhotoURL()!=paramObj.photoURL&&paramObj.photoURL!=cfg.defaultPhoto&&scope.headPhoto.setPhotoURL(paramObj.photoURL),scope.headPhoto.setPhotoZoom(paramObj.zoom),scope.headPhoto.setPhotoAngle(paramObj.angle),scope.headPhoto.setPhotoPosition(paramObj.photoX,paramObj.photoY),scope.UserBabyPic&&(scope.UserBabyPic.photoURL=paramObj.photoURL,scope.UserBabyPic.angle=paramObj.angle,scope.UserBabyPic.zoom=paramObj.zoom,scope.UserBabyPic.photoX=paramObj.photoX,scope.UserBabyPic.photoY=paramObj.photoY))};btnHPEDialog&&(Core.Events.addEvent(btnHPEDialog,(function(){hped.show()})),hped.onShow=function(){initTicket(),scope.babyHeadPhotoEditor.onSendCompleted=function(dataStr){var savedData,url,code;try{eval("savedData="+dataStr),url=savedData.data.pics.pic_1&&savedData.data.pics.pic_1.pid,code=savedData.code}catch(ex){}if("A00006"==code)scope.babyHeadPhotoEditor.setSavedPhotoURL(url),scope.babyHeadPhotoEditor.save();else{if(-11===savedData.data.pics.pic_1.ret)winDialog.alert("图片格式异常，请重新上传");else winDialog.alert("图片存储服务暂不可用!");initTicket()}},scope.babyHeadPhotoEditor.onSaved=function(dataStr,params){try{eval("data="+dataStr)}catch(ex){}if("object"==typeof data)if("A00006"==data.code)try{setHeadPhotoParam(getParamObj(params)),hped.hidden()}catch(ex){alert(ex.message)}else winDialog.alert($SYSMSG[data.code])}});var _c=10;function initTicket(){Lib.Ticket.get((function(data){var c=10;!function setSendToURL(){scope.babyHeadPhotoEditor._flashEntity.setSendToURL?scope.babyHeadPhotoEditor.setSendToURL("//pupload.photo.sina.com.cn/interface/pic_upload.php?s=json&ticket="+data.ticket[0]+"&app=photo&t="+(new Date).getTime()):--c>0&&setTimeout((function(){setSendToURL.call()}),200)}()}),1)}function getPhotoURLByKey(key){var s=key.substr(-2);return"//s"+(parseInt(s,16)%16+1)+".sinaimg.cn/orignal/"+key}function checkedBabyTpl(tpl){for(var babyTpls=scope.babyTpl_conf||["3_34","3_35","3_36","3_37"],ret=!1,i=0,l=babyTpls.length;i<l;i++)if(babyTpls[i]==tpl){ret=!0;break}return ret}"object"==typeof __pageSetVar&&__pageSetVar.tabs&&__pageSetVar.tabs[0]&&__pageSetVar.tabs[0].addEventListener("BGChanged",(function(tpl){checkedBabyTpl(tpl)&&(scope.renderHeadPhoto(tpl),hped.tpl=tpl)}))})),$registJob("baby_babyBarFlashDetect",(function(){var divBabyBayFlash=$E("divBabyBarFlash"),fd=new Lib.FlashDetector("9.0.0"),text=["#{reason}，为了能够正常显示，请您 ",'<a target="_blank" href="//get.adobe.com/cn/flashplayer/">','<img src="//simg.sinajs.cn/blog7style/images/common/baby/flash.png">',"下载最新版本","</a>","。"].join("");fd.onUninstalled=function(){divBabyBayFlash&&(divBabyBayFlash.innerHTML=text.replace(/\#\{reason\}/g,"您的浏览器未安装Flash播放器"))},fd.onVersionLower=function(clientVersion){divBabyBayFlash&&(divBabyBayFlash.innerHTML=text.replace(/\#\{reason\}/g,"您的Flash播放器版本过低"))},fd.detect()})),Lib.Tip=Core.Class.create(),Lib.Tip.prototype={initialize:function(){}},$SYSMSG.extend({A11102:"已添加过此模块，不能重复添加。",A11103:"抱歉，您的组件已经太多。",A11104:"抱歉！你不是博客7.0用户，不能添加此组件。",A11105:"您近期的操作过于频繁，请稍后再试。",A11007:'你还未开通新浪博客，请先 <a href="#{linkNewBlog}">开通博客</a>',A11107:'您提交的内容中含有广告等不适当内容，"确认"后将被清除！'}),Lib.Component.clone=function(sCompId,nSize){if(null==sCompId||isNaN(sCompId))Debug.log("请提供被克隆组件的有效ID，当前是："+sCompId);else{nSize=nSize.toString().replace(/0$/,"");var cloneStart=function(){function _cloneFunc(){var i_cloneComp=new Interface("//control.blog.sina.com.cn/riaapi/conf/module_clone.php","jsload"),param={productid:"0x00000001",suid:$UID,uid:scope.$uid,moduleid:sCompId,cwidth:nSize,version:7,feed:1};i_cloneComp.request({GET:param,onSuccess:function(_data){winDialog.alert($SYSMSG.A02006,{icon:"03",funcOk:function(){window.open("//blog.sina.com.cn/u/"+$UID,"_blank","")}})},onError:function(_data){switch(_data.code){case"A00003":winDialog.confirm($SYSMSG.A02005.replace("#UID",$UID),{funcOk:function(){window.open("//blog.sina.com.cn/u/"+$UID,"_blank","")},textOk:"升级",textCancel:"关闭",icon:"03"});break;case"A11007":winDialog.confirm($SYSMSG.A11007.replace("#{linkNewBlog}","//blog.sina.com.cn/u/"+$UID),{funcOk:function(){window.open("//blog.sina.com.cn/u/"+$UID,"_blank","")},textOk:"开通",textCancel:"关闭",icon:"01"});break;default:showError(_data.code)}},onFail:function(){showError($SYSMSG.A00001)}})}Debug.log("start to clone "+sCompId),Lib.checkAuthor((function(){$isLogin?_cloneFunc():(_cloneFunc(),$tray.renderLogin())}),"cloneComponent"+(new Date).getTime())};Lib.checkAuthor((function(){$isLogin?scope.blogOpener.showDialog((function(){cloneStart()})):(new Lib.Login.Ui).login((function(){scope.blogOpener.showDialog((function(){Core.Function.bind3(cloneStart,null,[sCompId])()}))}))}),"cloneComponent"+(new Date).getTime())}},$CloneComp=function(sCompId){Lib.Component.clone(sCompId,210)},$registJob("modify_tip",(function(){scope.tip=new Lib.Tip($E("sinablogb"))})),$registJob("teams_wc",(function(){if("undefined"!=typeof attentionWorldCup){new FavTeamsInfo;var url="//comet.blog.sina.com.cn/api?maintype=hits&act=3&uid=00000300&tm"+(new Date).getTime();Utils.Io.JsLoad.request(url,{onComplete:function(){}})}}));var FavTeamsInfo=function(){this.entity=$E("favTeams"),this.entity&&(this.allTeams=$T(this.entity,"li"),this.isTweenIn=[],this.isTweenOut=[],this.initialize())};FavTeamsInfo.prototype={initialize:function(){if(this.entity){var _this=this,zIndex=64;Core.Array.foreach(this.allTeams,(function(team,i){var tar=$T(team,"p")[1];tar.style.zIndex=512,team.style.zIndex=zIndex--,Core.Events.addEvent(team,(function(){($IE||_this.justIn(Core.Events.getEvent(),team))&&_this.tweenIn(team,tar,i)}),$IE?"mouseenter":"mouseover"),Core.Events.addEvent(team,(function(){($IE||_this.justIn(Core.Events.getEvent(),team))&&_this.tweenOut(team,tar,i)}),$IE?"mouseleave":"mouseout")}))}},justIn:function(evt,bNode){for(var reltarg=evt.relatedTarget;reltarg&&reltarg!=bNode;)reltarg=reltarg.parentNode;return reltarg!=bNode},tweenIn:function(team,tar,i){try{Ui.tween.stop(tar)}catch(e){}team.className="hover",Core.Dom.setStyle(tar,"opacity",1),tar.style.display=""},tweenOut:function(team,tar,i){new Ui.tween(tar,["opacity"],[0],.3,"simple",{end:function(){tar.style.display="none",team.className=""}})}};var CalendarWc=function(){this.entity=$E("wdc_calender"),this.closeBtn=$E("wcc_close"),this.fakeImg=$C("div"),this.switchOn=!1,this.isTween=!1,this.posRelDom=null,this.lockPosX,this.lockPosY,this.initialize()};CalendarWc.prototype={initialize:function(){if(this.entity){var _this=this;this.fakeImg.style.cssText="z-index:612; position:absolute; border:2px solid #d2d9e6; background-color:white;",document.body.insertBefore(this.fakeImg,document.body.firstChild),this.renderNew(),this.renderToday(),Core.Events.addEvent(this.closeBtn,(function(){_this.resetCalendar()})),Core.Events.addEvent(window,(function(){_this.justiPos()}),"resize")}},resetCalendar:function(){try{Ui.tween.stop(this.fakeImg)}catch(e){}Core.Dom.setStyle(this.entity,"display","none"),Core.Dom.setStyle(this.entity,"visibility","hidden"),Core.Dom.setStyle(this.fakeImg,"display","none"),this.switchOn=!1,this.isTween=!1},justiPos:function(){this.switchOn&&(Core.Dom.setStyle(this.entity,"left",Core.Dom.getLeft(this.posRelDom)-this.lockPosX+"px"),Core.Dom.setStyle(this.entity,"top",Core.Dom.getTop(this.posRelDom)-this.lockPosY+"px"))},renderNew:function(){var _this=this,attDate=attentionWorldCup.show_attentiondate;if(attDate||attDate.length)for(var i=0;i<attDate.length;i++){var curLi,month_day=attDate[i].split("_");if(!(curLi=$E("wcc_"+month_day[0]+"_"+month_day[1])))break;$T(curLi,"a")[0].title="有关注的赛事",this.addClass(curLi,"new"),Core.Events.addEvent(curLi,function(i){return function(){_this.resetCalendar(),window.location.href="#"+attDate[i]}}(i))}},renderToday:function(){var month=(new Date).getMonth()+1,day=(new Date).getDate();this.addClass($E("wcc_"+month+"_"+day),"cur")},setPos:function(withDom,offsetLeft,offsetTop){this.posRelDom=withDom;var left=Core.Dom.getLeft(withDom)+(offsetLeft||0),top=Core.Dom.getTop(withDom)+(offsetTop||0);$IE6&&$IE7&&(left+=document.documentElement.scrollLeft,top+=document.documentElement.scrollTop),this.fakeImg.style.left=left+"px",this.fakeImg.style.top=top+"px"},arcFunc:function(a,b,c){return function(x){return a*x*x+b*x+c}},tweenPlay:function(){this.resetCalendar();var _this=this;Core.Dom.setStyle(this.entity,"display",""),Core.Dom.setStyle(this.fakeImg,"display",""),Core.Dom.setStyle(this.fakeImg,"opacity",.6),Core.Dom.setStyle(this.fakeImg,"width","48px"),Core.Dom.setStyle(this.fakeImg,"height","15px"),this.isTween=!0,new Ui.tween(this.fakeImg,["opacity","height","width","left"],[1,this.entity.offsetHeight-4,this.entity.offsetWidth-4,Core.Dom.getLeft(this.posRelDom)-217],.3,"strongEaseIn",{end:function(){new Ui.tween(_this.fakeImg,["opacity"],[1],.1,"simple",{end:function(){_this.entity.style.left=Core.Dom.getLeft(_this.fakeImg)+"px",_this.entity.style.top=Core.Dom.getTop(_this.fakeImg)+"px",_this.fakeImg.style.display="none",_this.entity.style.visibility="visible",_this.switchOn=!0,_this.lockPosX=Core.Dom.getLeft(_this.posRelDom)-Core.Dom.getLeft(_this.entity),_this.lockPosY=Core.Dom.getTop(_this.posRelDom)-Core.Dom.getTop(_this.entity)}})}})},addClass:function(dom,clz){if(!dom)return!1;this.hasClass(dom,clz)||(dom.className=Core.String.trim(dom.className.concat(" "+clz)))},delClass:function(dom,clz){if(!dom)return!1;var reg=new RegExp("(?: +|^)"+clz+"(?=( |$))","ig");dom.className=Core.String.trim(dom.className.replace(reg,""))},hasClass:function(dom,clz){return!!dom&&new RegExp("(?: +|^)"+clz+"(?=( |$))","ig").test(dom.className)}},$registJob("calendar_wc",(function(){if("undefined"!=typeof attentionWorldCup){var wcc=new CalendarWc;$E("calendar_wc").onmouseover=function(){if(!wcc.isTween)return wcc.setPos(this,0,0),wcc.tweenPlay(),!1}}})),scope.$worldCupInfos={teams:{1:{name:"南非",group:"A",URL:"//2010.sina.com.cn/teams/southafrica.shtml"},2:{name:"墨西哥",group:"A",URL:"//2010.sina.com.cn/teams/mexico.shtml"},3:{name:"乌拉圭",group:"A",URL:"//2010.sina.com.cn/teams/uruguay.shtml"},4:{name:"法国",group:"A",URL:"//2010.sina.com.cn/teams/france.shtml"},5:{name:"阿根廷",group:"B",URL:"//2010.sina.com.cn/teams/argentina.shtml"},6:{name:"尼日利亚",group:"B",URL:"//2010.sina.com.cn/teams/nigeria.shtml"},7:{name:"韩国",group:"B",URL:"//2010.sina.com.cn/teams/korearepublic.shtml"},8:{name:"希腊",group:"B",URL:"//2010.sina.com.cn/teams/greece.shtml"},9:{name:"英格兰",group:"C",URL:"//2010.sina.com.cn/teams/england.shtml"},10:{name:"美国",group:"C",URL:"//2010.sina.com.cn/teams/usa.shtml"},11:{name:"阿尔及利亚",group:"C",URL:"//2010.sina.com.cn/teams/algeria.shtml"},12:{name:"斯洛文尼亚",group:"C",URL:"//2010.sina.com.cn/teams/slovenia.shtml"},13:{name:"德国",group:"D",URL:"//2010.sina.com.cn/teams/germany.shtml"},14:{name:"澳大利亚",group:"D",URL:"//2010.sina.com.cn/teams/australia.shtml"},15:{name:"塞尔维亚",group:"D",URL:"//2010.sina.com.cn/teams/serbia.shtml"},16:{name:"加纳",group:"D",URL:"//2010.sina.com.cn/teams/ghana.shtml"},17:{name:"荷兰",group:"E",URL:"//2010.sina.com.cn/teams/netherlands.shtml"},18:{name:"丹麦",group:"E",URL:"//2010.sina.com.cn/teams/denmark.shtml"},19:{name:"日本",group:"E",URL:"//2010.sina.com.cn/teams/japan.shtml"},20:{name:"喀麦隆",group:"E",URL:"//2010.sina.com.cn/teams/cameroon.shtml"},21:{name:"意大利",group:"F",URL:"//2010.sina.com.cn/teams/italy.shtml"},22:{name:"巴拉圭",group:"F",URL:"//2010.sina.com.cn/teams/paraguay.shtml"},23:{name:"新西兰",group:"F",URL:"//2010.sina.com.cn/teams/newzealand.shtml"},24:{name:"斯洛伐克",group:"F",URL:"//2010.sina.com.cn/teams/slovakia.shtml"},25:{name:"巴西",group:"G",URL:"//2010.sina.com.cn/teams/brazil.shtml"},26:{name:"朝鲜",group:"G",URL:"//2010.sina.com.cn/teams/koreadpr.shtml"},27:{name:"科特迪瓦",group:"G",URL:"//2010.sina.com.cn/teams/cotedivoire.shtml"},28:{name:"葡萄牙",group:"G",URL:"//2010.sina.com.cn/teams/portugal.shtml"},29:{name:"西班牙",group:"H",URL:"//2010.sina.com.cn/teams/spain.shtml"},30:{name:"瑞士",group:"H",URL:"//2010.sina.com.cn/teams/switzerland.shtml"},31:{name:"洪都拉斯",group:"H",URL:"//2010.sina.com.cn/teams/honduras.shtml"},32:{name:"智利",group:"H",URL:"//2010.sina.com.cn/teams/chile.shtml"}},games:{1:{teams:["1","2"],time:"2010-06-11 22:00:00",score:"",group:"A"},2:{teams:["3","4"],time:"2010-06-12 02:30:00",score:"",group:"A"},3:{teams:["5","6"],time:"2010-06-12 22:00:00",score:"",group:"B"},4:{teams:["7","8"],time:"2010-06-12 19:30:00",score:"",group:"B"},5:{teams:["9","10"],time:"2010-06-13 02:00:00",score:"",group:"C"},6:{teams:["11","12"],time:"2010-06-13 19:30:00",score:"",group:"C"},7:{teams:["13","14"],time:"2010-06-14 02:30:00",score:"",group:"D"},8:{teams:["15","16"],time:"2010-06-13 22:00:00",score:"",group:"D"},9:{teams:["17","18"],time:"2010-06-14 19:30:00",score:"",group:"E"},10:{teams:["19","20"],time:"2010-06-14 22:00:00",score:"",group:"E"},11:{teams:["21","22"],time:"2010-06-15 02:30:00",score:"",group:"F"},12:{teams:["23","24"],time:"2010-06-15 19:30:00",score:"",group:"F"},13:{teams:["27","28"],time:"2010-06-15 22:00:00",score:"",group:"G"},14:{teams:["25","26"],time:"2010-06-16 02:30:00",score:"",group:"G"},15:{teams:["31","32"],time:"2010-06-16 19:30:00",score:"",group:"H"},16:{teams:["29","30"],time:"2010-06-16 22:00:00",score:"",group:"H"},17:{teams:["1","3"],time:"2010-06-17 02:30:00",score:"",group:"A"},18:{teams:["2","4"],time:"2010-06-18 02:30:00",score:"",group:"A"},19:{teams:["6","8"],time:"2010-06-17 22:00:00",score:"",group:"B"},20:{teams:["5","7"],time:"2010-06-17 19:30:00",score:"",group:"B"},21:{teams:["13","15"],time:"2010-06-18 22:00:00",score:"",group:"D"},22:{teams:["12","10"],time:"2010-06-18 22:00:00",score:"",group:"C"},23:{teams:["9","11"],time:"2010-06-19 02:30:00",score:"",group:"C"},24:{teams:["16","14"],time:"2010-06-19 02:30:00",score:"",group:"D"},25:{teams:["17","19"],time:"2010-06-19 19:30:00",score:"",group:"E"},26:{teams:["18","20"],time:"2010-06-20 02:30:00",score:"",group:"E"},27:{teams:["22","24"],time:"2010-06-20 19:30:00",score:"",group:"F"},28:{teams:["21","23"],time:"2010-06-20 22:00:00",score:"",group:"F"},29:{teams:["25","27"],time:"2010-06-21 02:00:00",score:"",group:"G"},30:{teams:["26","28"],time:"2010-06-21 19:30:00",score:"",group:"G"},31:{teams:["30","32"],time:"2010-06-21 22:00:00",score:"",group:"H"},32:{teams:["29","31"],time:"2010-06-22 02:00:00",score:"",group:"H"},33:{teams:["2","3"],time:"2010-06-22 22:00:00",score:"",group:"A"},34:{teams:["1","4"],time:"2010-06-22 22:00:00",score:"",group:"A"},35:{teams:["6","7"],time:"2010-06-23 02:30:00",score:"",group:"B"},36:{teams:["5","8"],time:"2010-06-23 02:30:00",score:"",group:"B"},37:{teams:["9","12"],time:"2010-06-23 22:00:00",score:"",group:"C"},38:{teams:["10","11"],time:"2010-06-23 22:00:00",score:"",group:"C"},39:{teams:["13","16"],time:"2010-06-24 02:30:00",score:"",group:"D"},40:{teams:["15","14"],time:"2010-06-24 02:30:00",score:"",group:"D"},41:{teams:["21","24"],time:"2010-06-24 22:00:00",score:"",group:"F"},42:{teams:["22","23"],time:"2010-06-24 22:00:00",score:"",group:"F"},43:{teams:["18","19"],time:"2010-06-25 02:30:00",score:"",group:"E"},44:{teams:["17","20"],time:"2010-06-25 02:30:00",score:"",group:"E"},45:{teams:["25","28"],time:"2010-06-25 22:00:00",score:"",group:"G"},46:{teams:["26","27"],time:"2010-06-25 22:00:00",score:"",group:"G"},47:{teams:["29","32"],time:"2010-06-26 02:30:00",score:"",group:"H"},48:{teams:["30","31"],time:"2010-06-26 02:30:00",score:"",group:"H"},49:{},50:{},51:{},52:{},53:{},54:{},55:{},56:{},57:{},58:{},59:{},60:{},61:{},62:{},63:{},64:{}},teammatches:{1:["1","17","34"],2:["1","18","33"],3:["2","17","33"],4:["2","18","34"],5:["3","20","36"],6:["3","19","35"],7:["4","20","35"],8:["4","19","36"],9:["5","23","37"],10:["5","22","38"],11:["6","23","38"],12:["6","22","37"],13:["7","21","39"],14:["7","24","40"],15:["8","21","40"],16:["8","24","39"],17:["9","25","44"],18:["9","26","43"],19:["10","25","43"],20:["10","26","44"],21:["11","28","41"],22:["11","27","42"],23:["12","28","42"],24:["12","27","41"],25:["14","29","45"],26:["14","30","46"],27:["13","29","46"],28:["13","30","45"],29:["16","32","47"],30:["16","31","48"],31:["15","32","48"],32:["15","31","47"]}},$registJob("favGames",(function(){function init(){var i,k,gameHash=scope.wc_match_info,teamHash=scope.wc_teams_info,gameInfo=attentionWorldCup.show_attentiongame,gameExcel=(attentionWorldCup.show_attentionteam,['<table border="0" cellpadding="0" cellspacing="1">',"<tr>",'<th scope="col" class="w1">日期</th>','<th scope="col" class="w2">时间</th>','<th scope="col">对阵</th>',"</tr>#{itemLines}","</table>"].join("")),gameItem=["<tr>","<td>#{date}</td>",'<td class="wdc_ta">#{time}</td>','<td class="wdc_te"><span class="matchL">#{army1}</span><span class="vs wdc_ta"> VS </span><span class="matchR">#{army2}</span></td>',"</tr>"].join(""),gameExcelBox=$E("favGames"),temp="",week=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],seqTime=[],tempTime=[],userGameHash=[];for(i=0;i<gameInfo.length;i++)trace("userGameHash "+gameHash[gameInfo[i]].score+"////"+i),userGameHash.push(gameHash[gameInfo[i]]);var tt,ttid,userLastMatch=function(arr,pName,num,reverse){var i,pureArr=[],result=[];for(i=0;i<arr.length;i++)(reverse?!arr[i][pName]:arr[i][pName])&&pureArr.push(arr[i]);for(i=0;i<num;i++){if(!pureArr[i]){trace("src not enough");break}result.push(pureArr[i])}return result}(userGameHash,"score",6,!0);for(trace("length: "+userLastMatch.length),i=0;i<userLastMatch.length;i++){trace(i);var preDate=userLastMatch[i].time.split(" ")[0].split("-"),preTime=userLastMatch[i].time.split(" ")[1].split(":")[0];(d=new Date).setMonth(preDate[1]-1),d.setDate(preDate[2]),d.setHours(preTime),seqTime[i]=d.getTime()}tempTime=tempTime.concat(seqTime);var arraged=[];for(k=0;k<seqTime.length;k++){for(tt=seqTime[0],ttid=0,i=1;i<seqTime.length;i++)seqTime[i]<tt&&(tt=seqTime[i],ttid=i);arraged.push(ttid),seqTime[ttid]=Infinity}for(i=0;i<seqTime.length;i++){var d;preDate=userLastMatch[arraged[i]].time.split(" ")[0].split("-");(d=new Date).setMonth(preDate[1]-1),d.setDate(preDate[2]);var w=d.getDay();d=d.getMonth()+1+"月"+d.getDate()+"日",temp+=new Ui.Template(gameItem).evaluate({army1:teamHash[userLastMatch[arraged[i]].teams[0]].name,army2:teamHash[userLastMatch[arraged[i]].teams[1]].name,date:d+" "+week[w],time:userLastMatch[arraged[i]].time.split(" ")[1].slice(0,-3)})}gameExcelBox.innerHTML=new Ui.Template(gameExcel).evaluate({itemLines:temp})}"undefined"!=typeof attentionWorldCup&&attentionWorldCup.show_attentiongame.length&&(scope.wc_match_info?init():Utils.Io.JsLoad.request("//blog.sina.com.cn/2010worldcup/worldcup.js",{onComplete:function(){scope.wc_match_info=wc_match_info,scope.wc_teams_info=wc_team_info,init()}}))})),$SYSMSG.extend({B00802:"抱歉，此篇图片已经被删除",B00803:"抱歉，此篇专辑已经被删除",B00804:"抱歉，此篇文章已经被删除"}),$registJob("digger",(function(){var diggerCite=$E("d1_digg_"+scope.$articleid);scope.digger||(scope.digger={}),scope.digger.flashReady=function(){},scope.digger.diggerPer=function(){},scope.digger.diggerNums=function(){},scope.digger.setData=function(){},scope.digger.diggerPost=function(){},scope.digger.bindEvent=function(){},scope.digger.showLast10=function(){},scope.digger.hiddenLast10=function(){},$E("diggerFla")?$_GLOBAL.diggerOpenFlag?Lib.checkAuthor((function(){var currentUser="";$isLogin&&(currentUser=$UID,trace("当前用户:"+$UID));var flashReady=!1,failed=!1;scope.digger.flashReady=function(){trace("--------顶踩加载完毕...."),flashReady=!0},trace("--------顶踩开始加载完毕....");var random="";(window.$Maxthon||window.$360||window.$TT)&&(random="?t="+Core.Math.getUniqueId());var FlashPlayer=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"digger.swf"+random,"digger","1","1","9","#00ff00");FlashPlayer.addParam("quality","high"),FlashPlayer.addParam("wmode","transparent"),FlashPlayer.addParam("allowScriptAccess","always"),FlashPlayer.write("diggerFla");var digger=$E("digger");function waitToSet(_opt){failed?trace("不等待,flash已经是不可靠的，顶没有放入flash cookie"):flashReady?(digger.setData(_opt.res_id+"_"+(_opt.res_uid||scope.$uid)+"_"+currentUser+"_"+_opt.res_type),trace(_opt.res_id+"_"+(_opt.res_uid||scope.$uid)+"_"+currentUser+"_"+_opt.res_type+"放入成功!")):function(_opt){var timmer=0,inter=setInterval((function(){(timmer+=500)>=$_GLOBAL.diggerFlashTimeout&&(trace("已超时，不再尝试放进flash cookie:"+_opt.res_id+"_"+(_opt.res_uid||scope.$uid)+"_"+currentUser+"_"+_opt.res_type),clearInterval(inter),failed=!0),flashReady&&(clearInterval(inter),waitToSet(_opt))}),500)}(_opt)}function whenFailed(_opt){for(var event in _opt.events)_opt.targetEle["on"+event]=_opt.events[event](_opt)}scope.digger.diggerPer=function(opt){opt.params||(opt.params={res_id:opt.res_id,res_uid:opt.res_uid||scope.$uid}),opt.url="//control.blog.sina.com.cn/riaapi/digg/get_digg.php",makeReq(opt)},scope.digger.diggerNums=function(opt){opt.params||(opt.params={res_id:opt.res_id,res_uid:opt.res_uid||scope.$uid}),opt.url="//blogtj.sinajs.cn/api/get_digg_num.php",makeReq(opt)},scope.digger.setData=function(rss_id,uid,type){waitToSet({res_id:rss_id,res_uid:uid,res_type:type})},scope.digger.diggerPost=function(opt){Lib.checkAuthor((function(){if($isLogin){if(opt.params||(opt.params={res_id:opt.res_id,res_uid:opt.res_uid||scope.$uid,action:opt.action||"0",res_type:opt.res_type}),opt.url="//control.blog.sina.com.cn/admin/digg/post_digg.php",opt.onSuccess){var temp=opt.onSuccess;opt.onSuccess=function(data){temp(data),waitToSet(opt)}}else opt.onSuccess=function(data){waitToSet(opt)};makeReq(opt)}else{(new Lib.Login.Ui).login((function(){scope.blogOpener.showDialog((function(){pageInfo._uid=$UID,popup.show()}))}),!1,"referer:"+location.hostname+location.pathname+",func:diggerPost")}}),"article_digger")},scope.digger.bindEvent=function(opt){if(failed)return trace("不等待,flash已经是不可靠的，直接执行代码"),void whenFailed(opt);var _opt,timmer,inter;flashReady?(trace("读取"+opt.res_id+"_"+(opt.res_uid||scope.$uid)+"_"+currentUser+"_"+opt.res_type+":"+digger.getData(opt.res_id+"_"+(opt.res_uid||scope.$uid)+"_"+currentUser+"_"+opt.res_type)),digger.getData(opt.res_id+"_"+(opt.res_uid||scope.$uid)+"_"+currentUser+"_"+opt.res_type)?(trace(opt.res_id+"_"+(opt.res_uid||scope.$uid)+"_"+currentUser+"_"+opt.res_type+": 找到，不绑定事件"),opt.whenFind&&opt.whenFind(opt)):(trace(opt.res_id+"_"+(opt.res_uid||scope.$uid)+"_"+currentUser+"_"+opt.res_type+": 未找到，绑定事件"),whenFailed(opt))):(trace("falsh还没有加载完毕"),_opt=opt,timmer=0,inter=setInterval((function(){if(timmer+=500,trace("waitOrExecute:等待flash加载..."+timmer),flashReady&&(clearInterval(inter),scope.digger.bindEvent(_opt)),timmer>=$_GLOBAL.diggerFlashTimeout)return trace("响应超时，直接执行代码"),clearInterval(inter),whenFailed(_opt),void(failed=!0)}),500))};var posting=!1;function makeReq(opt){posting||(posting=!0,new Interface(opt.url,"jsload").request({GET:opt.params,onSuccess:function(_data){opt.onSuccess&&opt.onSuccess(_data),posting=!1},onError:function(_data){opt.onError&&opt.onError(_data),posting=!1},onFail:function(){opt.onFail&&opt.onFail(),posting=!1}}))}var div=document.createElement("div");div.className="tb_layer_Y tb_layer_w3",div.style.cssText="z-index: 511;position:absolute;display:none;width:160px";var arrDiv=document.createElement("div");arrDiv.className="tb_layer_arrow";var content=document.createElement("div");content.className="tb_layer_Y_main tip_ps",content.style.cssText="width:auto;",diggerCite&&"顶"===diggerCite.innerHTML?content.innerHTML='<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>\t\t\t\t\t\t\t<div style="text-align:left;color:#999999">最近顶了的博主：</div>\t\t\t\t\t\t\t<div></div>':content.innerHTML='<a style="margin-top: 5px;" title="关闭" class="tb_friend_inputDel" href="javascript:void(0)"></a>\t\t\t\t\t\t\t<div style="text-align:left;color:#999999">最近喜欢了的博主：</div>\t\t\t\t\t\t\t<div></div>',div.appendChild(arrDiv),div.appendChild(content),document.body.appendChild(div);var close=content.getElementsByTagName("a")[0],con=content.getElementsByTagName("div")[1];function changeToLoadind(){con.innerHTML='<div style="text-align:center;"><img src="//simg.sinajs.cn/blog7style/images/common/loading.gif" />加载中…</div>'}con.style.whiteSpace="nowrap",changeToLoadind(),close.onclick=function(){scope.digger.hiddenLast10()},scope.digger.showLast10=function(opt){changeToLoadind(),scope.digger.diggerPer(opt);var loc=Core.Dom.getXY(opt.ele);opt.onError=function(data){con.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">数据请求失败，请稍后重试</div>'},opt.onFail=opt.onError,opt.onSuccess=function(data){if(div.style.display)trace("已经被关闭，不再往里面写入信息");else{for(var pers=[],getVHTML=Lib.blogv.getVHTML,i=0;data[i];i++){var per=data[i],sName=per.action_uname;pers.push("<div>",'<a target="_blank" title="到',per.action_uname,'的博客去看看" href="//blog.sina.com.cn/u/',per.action_uid,'">',sName,"</a>",getVHTML(parseInt(per.wtype||-1)),"</div>")}pers.length?con.innerHTML=pers.join(""):diggerCite&&"顶"===diggerCite.innerHTML?con.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户顶过</div>':con.innerHTML='<div style="text-align:center;color:#999999;font-weight:bolder;">暂无登录用户喜欢过</div>'}};var dx=(opt.dx||-76)+loc[0],dy=(opt.dy||10)+loc[1];$IE&&(dx-=1,dy-=2),$SAFARI&&(dx+=1),$CHROME&&(dx+=1,dy+=2),div.style.display="",div.style.left=dx+"px",div.style.top=dy+"px",Core.Dom.opacity(div,0),new Ui.tween(div,["opacity"],[1],.3,"strongEaseIn"),window.onresize=function(){var nLoc=Core.Dom.getXY(opt.ele);div.style.left=nLoc[0]-76+"px",div.style.top=nLoc[1]+10+"px"}},scope.digger.hiddenLast10=function(){new Ui.tween(div,["opacity"],[0],.3,"strongEaseOut")}}),"digger"+(new Date).getTime()):trace("close..."):trace("no diggerFla")})),$registJob("miniBlogAttention",(function(){new Interface("//weibo.com/attention/aj_addfollow.php","jsload");scope.attMiniBlog=function(){Lib.checkAuthor((function(){$UID&&Utils.Io.JsLoad.request("//weibo.com/attention/aj_addfollow.php?jsdomain=1&uid=1231759973&fromuid="+$UID,{onComplete:function(){}})}),"miniBlogAttention"+(new Date).getTime())}})),$registJob("articleDigger",(function(){if($E("diggerFla")&&$_GLOBAL.diggerOpenFlag){var timmer,aid=scope.$articleid;timmer=setInterval((function(){scope.useNewInterfaceToGetNum&&(trace("通过别的借口进行装载"),scope.useNewInterfaceToGetNum.onSuccess=function(data){scope.useNewInterfaceToGetNum=null,diggerCallBack(data)},scope.useNewInterfaceToGetNum.onError=function(data){scope.useNewInterfaceToGetNum=null,diggerCallBack(null)},scope.useNewInterfaceToGetNum.onFail=function(data){scope.useNewInterfaceToGetNum=null,diggerCallBack(null)},trace("装载完毕"),clearInterval(timmer))}),50)}function setLikedStatusTjTech(_opt){_opt.ele.parentNode.className="SG_aBtn SG_aBtn_ico SG_turn SG_click",_opt.ele.children[1].innerHTML="已喜欢"}function setLikedStatus(_opt){var states;if("articletj"!==scope.$pageid){_opt.ele.className="upBox upBox_dis",_opt.ele.style.cursor="default";var cons=(states=_opt.ele.getElementsByTagName("p")[1]).innerHTML,div=SinaEx.createNode("<div>"+cons+"</div>"),firstP=SinaEx.findNode(div,"nextSibling","firstChild");div.removeChild(firstP);var con=div.innerHTML;states.innerHTML="顶"===con?'<img width="15" height="15" align="absmiddle" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon34">已顶':"已喜欢"}else{var spanEls=_opt.ele.getElementsByTagName("span"),likeBtn=(states=spanEls[0]).parentNode;likeBtn.parentNode.parentNode.className="upBox upBox_dis",states.style.cursor="default",likeBtn.style.cursor="default",spanEls[1].style.cursor="default",spanEls[2].style.cursor="default",states.innerHTML="已喜欢"}}function diggerCallBack(data){var tjTechFlag="articletjTech"===scope.$pageid,mNum=data?data["digg_m_"+aid]:0,countEle=$E("dbox2_"+aid);if(countEle){countEle.innerHTML=mNum||"0";var res_id=aid;countEle.setAttribute("mnum",mNum);var tar,parent=countEle.parentNode;if(parent.style.cursor="pointer",scope.digger.bindEvent({ele:parent,targetEle:parent,ti_title:encodeURIComponent(countEle.getAttribute("ti_title")||""),disClass:"upBox upBox_dis",res_id:res_id,uid:scope.$uid,res_type:"1",whenFind:function(_opt){tjTechFlag?setLikedStatusTjTech(_opt):setLikedStatus(_opt)},events:{mouseover:function(_opt){return function(){tjTechFlag||function(_opt){if("articletj"!==scope.$pageid)_opt.ele.className="upBox upBox_click",_opt.ele.getElementsByTagName("p")[0].innerHTML="+1";else{var spanEls=_opt.ele.getElementsByTagName("span");states=spanEls[0],states.parentNode.parentNode.parentNode.className="upBox upBox_click",states.innerHTML='<span class="up1">+1</span>喜欢'}}(_opt)}},mouseout:function(_opt){return function(){tjTechFlag||function(_opt){if("articletj"!==scope.$pageid){_opt.ele.className="upBox";var ele=_opt.ele.getElementsByTagName("p")[0];ele.innerHTML=ele.getAttribute("mnum")}else{var spanEls=_opt.ele.getElementsByTagName("span");states=spanEls[0],states.parentNode.parentNode.parentNode.className="upBox",states.innerHTML='<img class="SG_icon SG_icon34" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="推荐" align="absmiddle">喜欢'}}(_opt)}},click:function(_opt){return function(){return scope.blogOpener.showDialog((function(){scope.digger.diggerPost({params:{res_id:_opt.res_id,res_uid:_opt.res_uid||scope.$uid,action:"0",res_type:"1",ti_title:_opt.ti_title},res_id:_opt.res_id,res_uid:_opt.res_uid||scope.$uid,action:"0",res_type:"1",onSuccess:function(data){_opt.targetEle.onmouseover=function(){},_opt.targetEle.onmouseout=function(){},_opt.targetEle.onclick=function(){},tjTechFlag?setLikedStatusTjTech(_opt):setLikedStatus(_opt);var ele=$E("dbox2_"+_opt.res_id),curr=parseInt(ele.getAttribute("mnum"))+1;ele.innerHTML=curr,Lib.Listener.notify("article_like_success")},onError:function(data){if("B00801"==data.code){winDialog.alert("这篇博文您已经喜欢过啦!",{icon:"01"}),_opt.targetEle.onmouseover=function(){},_opt.targetEle.onmouseout=function(){},_opt.targetEle.onclick=function(){},tjTechFlag?setLikedStatusTjTech(_opt):setLikedStatus(_opt),scope.digger.setData(_opt.res_id,scope.$uid,1);var ele=$E("dbox2_"+_opt.res_id),curr=ele.getAttribute("mnum");ele.innerHTML=curr}else showError(data.code)}})})),!1}}}}),$E("d1_digg_"+aid))$E("d1_digg_"+aid).onclick=(tar={ele:$E("d1_digg_down_"+aid),res_id:aid,res_uid:scope.$uid},function(e){return scope.digger.showLast10(tar),!1}),$E("d1_digg_down_"+aid).onclick=function(tar){return function(e){return scope.digger.showLast10(tar),!1}}({ele:$E("d1_digg_down_"+aid),res_id:aid,res_uid:scope.$uid})}else trace("没有找到计数模块，认为这是不需要顶踩功能的")}})),Lib.register("util.loadScript",(function(){var cache={};return function(url,fun){var item=cache[url],cb=item&&item.cb;item?item.isLoading?cb.push(fun):fun():(item={isLoading:true,cb:cb=[fun]},cache[url]=item,function(url,item){Utils.Io.JsLoad.request(url,{isRemove:!1,noreturn:!0,onComplete:function(data){cache[url].isLoading=!1;for(var cb=cache[url].cb,i=0,len=cb.length;i<len;i++)cb[i](data);cache[url].cb=null}})}(url))}})),Lib.register("sendSuda",(function(lib){return function(fun){lib.util.loadScript("//www.sinaimg.cn/unipro/pub/suda_s_v851c.js",fun)}})),$registJob("suda",(function(){var d,s,id,n,pageId=scope&&scope.$pageid,wlh=window.location.href,isTj=wlh.indexOf("tj=1")>-1,suda_flag=pageId&&("articletj"===pageId||"index"===pageId||"indexM"===pageId||"editor"===pageId||isTj);function addSudaPage(pageId,parm1,parm2,parm3,parm4){switch(isTj&&v7sendLog(parm4),pageId){case"index":case"indexM":v7sendLog(parm1);break;case"editor":v7sendLog(parm2);break;case"articletj":v7sendLog(parm3)}}if(suda_flag)var url=encodeURIComponent(wlh),refer=encodeURIComponent(document.referrer);"function"!=typeof _S_pSt?(Lib.checkAuthor((function(){if(suda_flag){if($isLogin)tj="42_01_01_"+$UID+"_"+(new Date).getTime()+"_"+url+"_"+refer;else var tj="42_01_01_"+(new Date).getTime()+"_"+url+"_"+refer;addSudaPage(pageId,"42_01_08","42_01_14",tj,"42_01_05")}Lib.sendSuda((function(){try{_S_pSt("")}catch(e){}if(suda_flag){if($isLogin)succTj="42_01_02_"+$UID+"_"+(new Date).getTime()+"_"+url+"_"+refer;else var succTj="42_01_02_"+(new Date).getTime()+"_"+url+"_"+refer;addSudaPage(pageId,"42_01_09","42_01_15",succTj,"42_01_06")}}));var ele=$E("blognamespan");ele&&Lib.Uic.getNickName([scope.$uid],(function(oResult){var nickName=oResult[scope.$uid];nickName=nickName.replace(/\u7684\u535a\u5ba2$/,""),nickName=Core.String.leftB(nickName,30),nickName+="的博客",ele.innerHTML=nickName}))}),"suda_blognamespan"+(new Date).getTime()),d=document,s="script",id="sinaads-ck-script",n=d.getElementsByTagName(s)[0],d.getElementById(id)||((s=d.createElement(s)).id=id,s.setAttribute("charset","utf-8"),s.src="//d"+Math.floor(0+9*Math.random())+".sina.com.cn/litong/zhitou/sinaads/src/spec/sinaads_ck.js",n.parentNode.insertBefore(s,n))):suda_flag&&v7sendLog("42_01_03_"+(new Date).getTime()+"_"+url+"_"+refer)})),Lib.register("execZhitou",(function(lib){return document.createElement("inc"),function(fun){lib.util.loadScript("//d5.sina.com.cn/litong/zhitou/sinaads/release/sinaads.js",fun)}}));var blogAd={getInitPermission:function(oParam){var __root;return!!(oParam&&oParam.ads&&oParam.ads[0])&&("mixed"==(__root=oParam&&oParam.ads&&oParam.ads[0]).type||__root.ref)},insertIns:function(pdps,relateEl,inc,style){inc=inc||"beforeend";var html='<ins class="sinaads" data-ad-pdps="'+pdps+'" style="'+((style=style||"display:block;")||"")+'"></ins>';return relateEl=relateEl||document.body,Core.Dom.insertHTML(relateEl,html,inc)}};Core.System.getParam=function(name){var arr=window.location.search.match(new RegExp("(\\?|&)"+name+"=([^&]*)(&|$)"));return null!=arr?unescape(arr[2]):null},$registJob("scrollAd",(function(){"articleM"!=scope.$pageid&&"article"!=scope.$pageid&&"articleM_new"!=scope.$pageid&&"article_new"!=scope.$pageid||(blogAd.insertIns("PDPS000000054727"),Lib.execZhitou((function(data){(window.sinaads||[]).push({params:{sinaads_follow_top:30,sinaads_follow_mini_top:200}})})))})),Core.Events.stopDefaultEvent=function(el){var ev=el||Core.Events.getEvent();null!=ev&&(ev.preventDefault?ev.preventDefault():ev.returnValue=!1)},Utils.excBeforeCloseWin=function(tips1,tips2,func,args){closeVar={},closeVar.func=func,closeVar.tips1=tips1,closeVar.tips2=tips2,closeVar.args=args,closeVar.length=arguments.length,window.beforeunloadfunc=function(){if(1==closeVar.length)return closeVar.tips1;if(!$IE){return function(value){1==value&&(closeVar.args?Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])():closeVar.func())}.call(this,confirm(closeVar.tips2))}var e=Core.Events.fixEvent(Core.Events.getEvent());(e.clientY<0||e.altKey)&&confirm(closeVar.tips2)&&(closeVar.args?Core.Function.bind3(closeVar.func,closeVar.func,[closeVar.args])():closeVar.func())},Core.Events.addEvent(window,beforeunloadfunc,"beforeunload")};var StaticUser=Core.Class.create();function commonLog(url){var image=window.clog_img=new Image;image.onload=image.onerror=function(){window.clog_img=null},image.src=url+(url.indexOf("?")>0?"&__rnd=":"?")+Math.random(),image=null}StaticUser.prototype={container_id:null,is_init:!1,localDB:null,initialize:function(cnt_id){if(this.container_id=cnt_id,Lib.LocalDB.FlaDom)this.loaded();else{trace("first 加载");var _this=this;Lib.LocalDB.registerFun((function(){setTimeout((function(){_this.loaded()}),10)})),Lib.LocalDB.loadFlash("trayFlashConnetion")}},loaded:function(){Lib.LocalDB.get("SUKeya",31536e6)?(window.staticunload=function(){if($IE){Core.Events.fixEvent(Core.Events.getEvent());this.record()}else this.record()},Core.Events.addEvent(window,Core.Function.bind2(window.staticunload,this),"beforeunload")):(Lib.LocalDB.set("SUKeya",window.staticTime+parseInt(1e5*Math.random()).toString()),this.record(),this.send());Lib.LocalDB.get("SUInfo",31536e6);if(Lib.LocalDB.get("SULastTime",31536e6)){var lasttime=Lib.LocalDB.get("SULastTime",31536e6);(new Date).getTime()-lasttime>36e5&&this.send()}else Lib.LocalDB.set("SULastTime",(new Date).getTime())},record:function(){var tmp=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536e6)),logininfo="",refer=document.referrer;""!=(ts=Utils.Cookie.getCookie("SUBP"))?(ts=sinaSSOEncoder.getSUBPCookie.decode(ts),""!=ts&&(logininfo+="|lu:"+ts.uid.replace(/(^\s*)|(\s*$)/g,"")),scope.unreadMsg&&scope.unreadMsg.isbloguser&&(logininfo+="|ib:"+scope.unreadMsg.isbloguser),Lib.LocalDB.get("SULoginFlag")?""==refer?logininfo+="|al:4":refer.indexOf("blog.sina.com.cn")>-1?logininfo+="|al:2":logininfo+="|al:3":logininfo+="|al:1|at:"+(new Date).getTime(),""!=Utils.Cookie.getCookie("ALF")&&(logininfo+="|pu:1"),Lib.LocalDB.set("SULoginFlag",!0)):Lib.LocalDB.set("SULoginFlag",!1);var string="et:"+window.staticTime+"|r:"+refer+"|u:"+window.location.href+"|lt:"+(new Date).getTime().toString()+"|vu:"+scope.$uid+logininfo+";";Lib.LocalDB.set("SUInfo",encodeURIComponent(tmp+string))},send:function(){var k=Lib.LocalDB.get("SUKeya",31536e6),t=decodeURIComponent(Lib.LocalDB.get("SUInfo",31536e6)),ts=t.split(";");if(ts.length>5){for(var tinfo="",i=0;i<ts.length;i++)(i+1)%5==0?(v7sendLog("StaticUser","",encodeURIComponent("k:"+k+";"+tinfo)),tinfo=""):tinfo+=ts[i]+";";""!=tinfo&&v7sendLog("StaticUser","",encodeURIComponent("k:"+k+";"+tinfo))}else v7sendLog("StaticUser","",encodeURIComponent("k:"+k+";"+t));Lib.LocalDB.set("SUInfo",""),Lib.LocalDB.set("SULastTime",(new Date).getTime())}},$registJob("static",(function(){window.staticClass=new StaticUser;var androidBtn=Core.Dom.byClz($E("blogtopoption"),"a","dwnAndroid");androidBtn.length&&(androidBtn=androidBtn[0],"下载应用"===Core.String.trim(androidBtn.innerText||androidBtn.textContent||"")&&function(){var node_dis=document.createElement("div");node_dis.className="dowAndroidTip",node_dis.id="dow_AndroidTip",node_dis.innerHTML='<div class="dowAndroidTipInner"><p style="cursor:pointer;" id="save2mobile">将此博客<span>保存到手机</span></p><p style="cursor:pointer;" id="save2mobile2">阅读随时随地</p><span class="arrowMod"><span class="arrowModInner"></span></span><a id="close_discover" class="close" href="javascript:;" title="关闭">关闭</a></div>',$E("headarea").appendChild(node_dis);var inputXY=Core.Dom.getXY(document.body),inputBtnXY=Core.Dom.getXY($E("blogtopoption"));node_dis.style.position="absolute",node_dis.style.left=inputXY[0]+728+"px",node_dis.style.top=inputBtnXY[1]-45+"px",$E("close_discover").onclick=function(){return v7sendLog("70_01_05_"+($UID||0)),$E("dow_AndroidTip").style.visibility="hidden",!1},$E("save2mobile").onclick=$E("save2mobile2").onclick=function(e){Core.Events.stopEvent(e),v7sendLog("70_01_06_"+($UID||0)),window.open("//appmaster.hudee.com/sina/download.jsp?uid="+scope.$uid),$E("dow_AndroidTip").style.visibility="hidden"}}(),Core.Events.addEvent(androidBtn,(function(){var code;switch(Core.String.trim(androidBtn.innerText||androidBtn.textContent||"")){case"下载应用":code="70_01_01_"+($UID||0);break;case"制作应用":code="70_01_02_"+$UID;break;case"管理应用":code="70_01_04_"+$UID;break;case"制作中":code="70_01_03_"+$UID}code&&v7sendLog(code)})))})),$registJob("SinglesDay",(function(){scope.addFriendForSinglesDay=function(){Lib.checkAuthor((function(){$UID&&new Interface("//control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax").request({POST:{uid:$UID,aid:1259295385}})}),"SinglesDay"+(new Date).getTime())}})),$registJob("selectionShare",(function(){if($E("sina_keyword_ad_area2")){var tipsNode=$C("div");tipsNode.innerHTML='<img src="//simg.sinajs.cn/blog7style/images/common/share.gif" title="将选中内容分享到新浪微博"/>',tipsNode.id="selectionShare",tipsNode.style.display="none",tipsNode.style.position="absolute",tipsNode.style.cursor="pointer",document.body.appendChild(tipsNode),Core.Events.addEvent(document.body,(function(){hideTips()})),Core.Events.addEvent(tipsNode,(function(){!function(){shareWord&&shareWord.length>80&&(shareWord=shareWord.substr(0,80)+"……");var blogTitleEl=Core.Dom.byClz(document.body,"h2","titName")[0],blogTitle=blogTitleEl.textContent||blogTitleEl.innerHTML;if(shareWord)var title=encodeURIComponent(shareWord+"——博文片段来自"+nickName+"："+blogTitle);else title=encodeURIComponent("分享"+nickName+"的博文图片："+blogTitle);var r="新浪-博客",l="//blog.sina.com.cn",u="//v.t.sina.com.cn/share/share.php?searchPic=false&title="+title+"&url="+document.location+"&source="+r+"&sourceUrl="+encodeURIComponent(l)+"&content=utf-8&appkey=1617465124";shareImg&&(u=u+"&pic="+shareImg);window.open(u,"selectionshare","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),hideTips()}(),Core.Events.stopEvent()}));var nickName=null;Lib.Uic.getNickName([scope.$uid],(function(oResult){nickName=oResult[scope.$uid]}));var shareWord,shareImg,mx=0,my=0,sx=0,sy=0;Core.Events.addEvent($E("sina_keyword_ad_area2"),(function(e){e=Core.Events.getEvent();e=Core.Events.fixEvent(e),setTimeout((function(){getSelectContent()?(setTimeout((function(){tipsNode.style.left=mx+"px",tipsNode.style.top=my+"px",tipsNode.style.display=""}),100),function(e){if(!$IE)return void function(){var refElem,fontSize,pos,sel=window.getSelection(),index=sel.rangeCount-1,range=sel.getRangeAt(index),testSpan=$C("span"),clone=range.cloneRange(),beforeToEnd=!1;refElem=range.startContainer,range.startContainer!=range.endContainer?sel.focusNode!=range.startContainer&&(beforeToEnd=!0,refElem=range.endContainer):sel.focusOffset>sel.anchorOffset&&(beforeToEnd=!0);clone.collapse(!beforeToEnd),clone.insertNode(testSpan),pos=Core.Dom.getXY(testSpan),3==refElem.nodeType&&(refElem=refElem.parentNode);"IMG"==refElem.tagName.toUpperCase()?fontSize=refElem.offsetWidth:(fontSize=Core.Dom.getStyle(refElem,"fontSize"),fontSize=parseInt(fontSize.substring(0,fontSize.length-2)));beforeToEnd?(mx=pos[0]-33,my=pos[1]+10,$FF||(my+=fontSize)):(mx=pos[0]+7,my=pos[1]-36,$FF&&(my-=fontSize));testSpan.parentNode.removeChild(testSpan),sel.removeAllRanges(),sel.addRange(range)}();var sel=document.selection.createRange(),sel2=sel.duplicate();sel2.collapse(!1),sel2.moveStart("word",-1);for(;0==sel2.text.length;)sel2.moveStart("word",-1);var isFront=!1;e.pageY-sy<=-sel2.boundingHeight&&(isFront=!0,trace(11111));Math.abs(e.pageY-sy)<sel2.boundingHeight&&(e.pageX-sx<0?(isFront=!0,trace(11111)):(isFront=!1,trace(22222)));if(sel.collapse(isFront),!isFront)for(sel.moveStart("word",-1);0==sel.text.length;)sel.moveStart("word",-1),sel.moveEnd("word",-1);var tHtml=sel.htmlText,id="temp_"+parseInt(1e3*Math.random()),width=sel.boundingWidth,height=sel.boundingHeight;sel.pasteHTML('<a id="'+id+'" >$</a>'+tHtml);var ele=$E(id);isFront?(mx=Core.Dom.getLeft(ele)+10,my=Core.Dom.getTop(ele)-26-7):(mx=Core.Dom.getLeft(ele)+width-36,my=Core.Dom.getTop(ele)+height);ele.parentNode.removeChild(ele)}(e)):hideTips()}))}),"mouseup"),Core.Events.addEvent($E("sina_keyword_ad_area2"),(function(e){e=Core.Events.getEvent();e=Core.Events.fixEvent(e),sx=e.pageX,sy=e.pageY}),"mousedown")}function getSelectContent(){shareWord=null,shareImg=null;var _trim=Core.String.trim;if(document.selection){(w=(sel=document.selection.createRange()).text).length>=10&&(shareWord=w);var html=sel.htmlText;/<img[\s\S]+src="(\S+)"[\s\S]+>/gim.test(html)&&(shareImg=RegExp.$1)}else try{var w,sel=window.getSelection().getRangeAt(0);if(!Core.Dom.contains($E("sina_keyword_ad_area2"),sel.commonAncestorContainer))return;(w=sel.toString()).length>=10&&(shareWord=w);var div=$C("div");div.appendChild(sel.cloneContents());var img=$T(div,"img");img.length>0&&(shareImg=img[0].src||img[0].real_src)}catch(e){}return shareWord&&(shareWord=_trim(shareWord).replace(/\r|\n/g,"")),shareWord}function hideTips(){tipsNode.style.display="none"}})),$registJob("sharePhoto",(function(){var nickName,nowImgSrc,nowImg,wrapLeft,image,foreach=Core.Array.foreach,pageid=scope.$pageid,isArt="article"==pageid||"articleM"==pageid||"article_new"==pageid||"articleM_new"==pageid,uid=scope.$uid,wrap=$E("sina_keyword_ad_area2")||document.body,minHeight=62,fixAutoHover=1,sharewrap=SinaEx.createNode('<div id="sharePhoto" style="display:none;width:120px;position:absolute;"><div class="picShareFlt"><div class="share SG_txtb" style="margin-top:5px;"><span>分享到新浪微博</span></div></div></div>'),div2=sharewrap.children[0];function fnover(){if(this.width<165||this.height<minHeight)return!1;var left=Core.Dom.getXY(this)[0]+this.width-124;left=Math.min(left,wrapLeft-134),shareConStyle.left=left+"px",shareConStyle.top=Core.Dom.getXY(this)[1]+this.height-minHeight+27+"px",fixAutoHover&&(shareConStyle.display=""),nowImgSrc=encodeURIComponent(this.getAttribute("real_src")||this.src),nowImg=this}function fnout(){var e=Core.Events.getEvent(),et=e.relatedTarget||e.toElement;et&&Core.Dom.contains(sharewrap,et)||(shareConStyle.display="none")}document.body.appendChild(sharewrap),setTimeout((function(){Lib.Uic.getNickName([uid],(function(oResult){nickName=oResult[uid]}))}),500);var shareConStyle=sharewrap.style;function bindFn(img,attr){(img.getAttribute(attr)||"").indexOf("//www.sinaimg.cn/uc/myshow/blog/misc/gif/E___")&&Core.Dom.contains(wrap,img)&&(getWrapLeft(),image=new Image,Core.Events.addEvent(image,function(){this.width>165&&this.height>35&&(Core.Events.addEvent(img,fnover.bind2(img),"mouseover"),Core.Events.addEvent(img,fnout.bind2(img),"mouseout"))}.bind2(image),"load"),image.src=img.getAttribute(attr))}function getWrapLeft(){wrapLeft=Core.Dom.getXY(wrap)[0]+wrap.clientWidth}function bindWrapFn(){fixAutoHover=1,foreach($T(wrap,"img"),(function(img){bindFn(img,"src")}))}if(Core.Events.addEvent(div2,(function(){var u="//v.t.sina.com.cn/share/share.php?searchPic=false&title="+encodeURIComponent("分享"+nickName+"的博文图片："+(isArt?Core.Dom.byClz(document.body,"h2","titName")[0].innerHTML:""))+"&url="+encodeURIComponent(function(node){if(isArt)return;var tagMore;for(;node=node.parentNode;)if("content"==node.className&&"DIV"==node.nodeName&&"tagMore"==(tagMore=node.nextElementSibling||node.nextSibling).className)return($T(tagMore,"a")[0]||{}).href||""}(nowImg)||document.location)+"&source=新浪-博客&sourceUrl="+encodeURIComponent("//blog.sina.com.cn")+"&content=utf-8&appkey=1617465124&pic="+nowImgSrc;window.open(u,"mb","toolbar=0,status=0,resizable=1,width=440,height=430,left="+(screen.width-440)/2+",top="+(screen.height-430)/2),v7sendLog("80_01_09"),"undefined"!=typeof SUDA&&SUDA.uaTrack("blog_article","h_article21"),Core.Events.stopEvent()})),Core.Events.addEvent(window,getWrapLeft,"resize"),"index"!=pageid&&"indexM"!=pageid&&"article"!=pageid&&"articleM"!=pageid&&"article_new"!=pageid&&"articleM_new"!=pageid||foreach([$E("module_10001"),$E("module_10002"),$E("module_10003"),$E("module_920")],(function(comp){comp&&comp.clientWidth>500&&(wrap=comp,bindWrapFn())})),Lib&&Lib.Component.Comp_10001){var _afterLoadList=Lib.Component.Comp_10001.prototype.afterLoadList;Lib.Component.Comp_10001.prototype.afterLoadList=function(){fixAutoHover=0,shareConStyle.display="none",_afterLoadList.apply(this,arguments),setTimeout(bindWrapFn,100)}}scope.sharePhoto={bindFn:bindFn}})),Core.Dom.byClass=function(className,tagName,elem){if((elem=elem||document).getElementsByClassName)return elem.getElementsByClassName(className);var i,rcn=new RegExp("\\b"+className+"\\b"),ret=[],els=elem.getElementsByTagName(tagName),len=els.length;for(i=0;i<len;i++)1===(elem=els[i]).nodeType&&elem.className&&rcn.test(elem.className)&&ret.push(elem);return ret},Core.Dom.byId=$E,$registJob("share",(function(){var tpl=['<div class="share-pannel clearfix">','<a class="bshare-sinaminiblog" target="__blank" title="分享到新浪微博" href="javascript:void(0);"></a>','<a class="bshare-qzone" target="__blank" title="分享到QQ空间" href="javascript:void(0);"></a>','<a class="bshare-douban" target="__blank" title="分享到豆瓣" href="javascript:void(0);"></a>','<a class="bshare-weixin" title="分享到微信" href="javascript:void(0);">','<div class="weixin-pannel"><img src="//comet.blog.sina.com.cn/qr?',location.href,'">','<div class="txt"><p>打开微信“扫一扫”</p><p>打开网页后点击屏幕</p><p>右上角“分享”按钮</p></div>',,"</div>","</a>","</div>"].join("");try{var shareDom=Core.Dom.byClass("bshare-custom");Core.Dom.addHTML(shareDom[0],tpl);var weiboURL=["https://service.weibo.com/share/share.php?appkey=&title=",scope.$shareData.title,"&url=",location.href,"&pic=",scope.$shareData.pic].join("");Core.Dom.byClass("bshare-sinaminiblog")[0].setAttribute("href",weiboURL);var qqURL=["https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=",encodeURIComponent(location.href),"&title=",scope.$shareData.title,"&pics=",scope.$shareData.pic,"&summary=","&desc=",scope.$shareData.content].join("");Core.Dom.byClass("bshare-qzone")[0].setAttribute("href",qqURL);var douban=["https://www.douban.com/share/service?image=",scope.$shareData.pic,"&href=",location.href,"&name=",scope.$shareData.title,"&text=",scope.$shareData.content].join("");Core.Dom.byClass("bshare-douban")[0].setAttribute("href",douban)}catch(e){console.log(e.stack)}})),$registJob("toZoneStatic",(function(){"1513474044"!=scope.$uid&&"1632440911"!=scope.$uid&&"1311747503"!=scope.$uid&&"1374847633"!=scope.$uid&&"1265252974"!=scope.$uid&&"1218670734"!=scope.$uid&&"1156966391"!=scope.$uid||Utils.Io.JsLoad.request("//sjs.sinajs.cn/blog7activity/zoneStatic.js",{isRemove:!1,onComplete:function(){"function"==typeof zoneStatic&&zoneStatic(),"function"==typeof traceFunction&&traceFunction()},noreturn:!0})})),$registJob("userResidenceTime",(function(){var uuid=function(len,prefix){var lists=["1","2","3","4","5","6","7","8","9","0","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ret=[],total=lists.length;prefix&&(lists=lists.concat(prefix));for(var i=0;i<len;i++)ret.push(lists[Math.floor(Math.random()*total)]);return ret.join("")}(15,(new Date).valueOf().toString().slice(-5).split(""));Math.floor(100*Math.random())<1&&(v7sendLog("24_01_01_"+scope.$pageid+"_"+uuid,null,null),setInterval((function(){v7sendLog("24_01_01_"+scope.$pageid+"_"+uuid,null,null)}),3e3))})),Lib.templateUtils=function(){},Lib.templateUtils.prototype.getTemplateNodes=function(template){var i,box=document.createElement("div"),nodes={},ids_without_rndNum=[],rndNum=(new Date).getTime().toString().slice(-5)+Math.floor(1e5*Math.random());template=template.replace(/#{([a-z0-9_]+)}/gi,(function(match,f1){return ids_without_rndNum.push(f1),f1+"_"+rndNum})),box.innerHTML=template;var key,len=ids_without_rndNum.length;for(i=0;i<len;i++)nodes[key=ids_without_rndNum[i]]=this.findById(key+"_"+rndNum,box);return nodes},Lib.templateUtils.prototype.getIdNodes=function(template){var i,j,len,tagsLen,idName,idNode,tags,nodes={},ids=[],idTags=[],box=document.createElement("div");for(box.innerHTML=template,tags=box.getElementsByTagName("*"),template.replace(/id *= *"([^{ ]+?)"/gi,(function(match,f1){ids[ids.length]=f1})),len=tags.length,i=0;i<len;i++)tags[i].id&&(idTags[idTags.length]=tags[i]);for(len=ids.length,i=0;i<len;i++)for(idName=ids[i],j=0,tagsLen=idTags.length;j<tagsLen;)idName==(idNode=idTags[j]).id&&(nodes[idName]=idNode,idTags.splice(j,1)),j++;return nodes},Lib.templateUtils.prototype.findById=function(id,context,tag){var i,tags=(context=context||document).getElementsByTagName(tag||"*"),len=tags.length;for(i=0;i<len;i++)if(tags[i].getAttribute("id")==id)return tags[i]},Lib.templateUtils.prototype.formatTemplate=function(curStr,oParam){var formatReg=new RegExp("#{([a-z0-9]+)}","ig");return curStr=curStr.replace(formatReg,(function(match,f1,index,srcStr){return oParam[f1]}))},Function.prototype.$defineProto=function(def){var k;for(k in def)this.prototype[k]=def[k];if(this.__interface__)for(k in this.prototype)if("NI"===this.prototype[k])throw new Error("类定义错误，接口方法["+k+"]未实现");return this.prototype.constructor=this,this.$extendClass=this.$defineProto=this.$implements=function(){throw new Error("$defineProto 语句定义后面不能再作其它定义")},this},Function.prototype.$extendClass=function(){var sup,fn,me=this;if(0===arguments.length)throw new Error("$extendClass 语句错误：未指定父类");return fn=function(){var _this=this;for(var fName in this.$super={},sup.prototype)sup.prototype[fName]&&(this.$super[fName]=function(f){return function(){sup.prototype[f].apply(_this,arguments)}}(fName));sup.apply(this,arguments),me.apply(this,arguments)},(fn.prototype=function(o){function F(){}return F.prototype=o,new F}((sup=arguments[0]).prototype)).constructor=fn,fn},Function.prototype.$implements=function(){for(var k,arg=Array.prototype.slice.call(arguments,0),i=arg.length;i--;){if("object"!=typeof arg[i])throw new Error("$implements 语句错误：参数必须为 object 类型");for(k in arg[i])"undefined"==typeof this.prototype[k]&&(this.prototype[k]="NI")}return this.__interface__=!0,this.$extendClass=function(){throw new Error("$extendClass 语句错误：$extendClass 语句不能出现在 $implements 定义之后")},this},Function.prototype.$mixProto=function(){this.$extendClass=this.$defineProto=function(){throw new Error("$mixProto 必须放在最后使用")};var srcClsProto=arguments[0].prototype;for(var fn in srcClsProto){if(this[fn])throw new Error("目标类有同名方法");srcClsProto[fn]&&(this.prototype[fn]=srcClsProto[fn])}return this},blogAd.CommAd=function(oParam){var __tempNodes,i,_this=this,box1=$E("commAd_1"),box2=$E("commAd_2");if(!box1)for(trace("no id"),$E("articlebody"),__tempNodes=articlebody.getElementsByTagName("strong"),i=0;i<__tempNodes.length;i++)"评论"==__tempNodes[i].innerHTML?box1=__tempNodes[i].parentNode.getElementsByTagName("span")[0]:"发评论"==__tempNodes[i].innerHTML&&(box2=__tempNodes[i].parentNode.getElementsByTagName("span")[0]);this.MARK_ID=2,this.LIMITED=24;['<span style="margin-left:15px; width:220px; display:inline-block;">','<a target="_blank" href="//blog.sina.com.cn/lm/8/2009/0325/105340.html">重要提示：警惕虚假中奖信息</a>',"</span>"].join("");var adTemp='<span style="display:inline-block;width:220px;white-space:nowrap;">#{link}</span>',hasAd=!1;Lib.checkAuthor((function(){!$isAdmin&&oParam&&!+oParam.code&&oParam.ads&&(oParam.ads[0]&&oParam.ads[0].link&&(hasAd=!0,_this.formatTemplate(adTemp,{link:oParam.ads[0].link}),oParam.ads[0].status&&oParam.ads[0].status.adstart&&((new Image).src=oParam.ads[0].status.adstart)),oParam.ads[1]&&oParam.ads[1].link&&(hasAd=!0,_this.formatTemplate(adTemp,{link:oParam.ads[1].link}),oParam.ads[1].status&&oParam.ads[1].status.adstart&&((new Image).src=oParam.ads[1].status.adstart)),oParam.ads[2]&&oParam.ads[2].link&&(hasAd=!0,_this.formatTemplate(adTemp,{link:oParam.ads[2].link}),oParam.ads[2].status&&oParam.ads[2].status.adstart&&((new Image).src=oParam.ads[2].status.adstart))),box1&&(box1.style.display="inline-block"),box2&&(box2.style.display="inline-block"),hasAd&&commonLog("//1092.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tjbw_plq_wzl&db=sina&border=0&local=yes&js=ie")}),"CommAd"+(new Date).getTime())}.$defineProto({}).$mixProto(Lib.templateUtils),blogAd.insertIns=function(pdps,relateEl,inc,style){inc=inc||"beforeend";var html='<ins class="sinaads" data-ad-pdps="'+pdps+'" style="'+((style=style||"display:block;")||"")+'"></ins>';return relateEl=relateEl||document.body,Core.Dom.insertHTML(relateEl,html,inc)};var Article={getSearchReferrer:function(){var o={},docURL=document.URL;if(-1!=docURL.indexOf("blog.sina.com.cn")&&-1!=docURL.indexOf("k=")){var u=new Utils.Url(docURL);return o.key=u.getParam("k"),o.type=u.getParam("t"),o}var refer=document.referrer;if(!refer||""===refer)return!1;var searchParam={"www.google.co.jp":{param:"q",type:"utf-8"},"www.google.com.hk":{param:"q",type:"utf-8"},"www.baidu.com":{param:"wd",type:"GBK",needTrans:!0},"www.soso.com":{param:"query",type:"GBK",needTrans:!0},"search.yahoo.com":{param:"p",type:"utf-8"},"cn.bing.com":{param:"q",type:"utf-8"},"www.youdao.com":{param:"q",type:"utf-8"},"www.sogou.com":{param:"query",type:"GBK",needTrans:!0},"www.so.com":{param:"q",type:"utf-8"}};for(var k in searchParam){var url=new Utils.Url(refer);if(-1!=refer.indexOf(k)){o.key=url.getParam(searchParam[k].param),o.type=searchParam[k].type,o.needTrans=searchParam[k].needTrans;break}}return!(!o.key||""===o.key)&&o}};window.sendLogToQing=function(log,uid){"undefined"==typeof scope&&(window.scope={},scope.$uid=scope.$pageid="");var _log=log||"",_uid=uid||scope.$uid,_pageId=scope.$pageid,value=_log+"|"+(new Date).getTime()+"|"+_pageId+"|"+_uid,image=window.actlog_img=new Image;image.onLoad=image.onError=function(){window.actlog_img=null},image.src=$_GLOBAL.qingURL+"blog/api/actlog.php?msg="+encodeURIComponent(value),image=null},$registJob("searchToQing",(function(){if(scope.isFromSearchEngine||Article.getSearchReferrer()){var docEle=document.documentElement,docBody=document.body;!function(){var iframe,div,clientHeight=docEle.clientHeight||docBody.clientHeight,iframeSRC="//blog.sina.com.cn/lm/iframe/article/searchqing.html?t="+ +new Date;(iframe=$C("iframe")).src=iframeSRC,iframe.width="100%",iframe.scrolling="no",iframe.style.border="0px",iframe.frameBorder="no",closeBtn=$C("a"),closeBtn.className="nblog_searchBtmBtn",closeBtn.href="javascript:void(0);",closeBtn.title="关闭",closeBtn.innerHTML="关闭",closeBtn.id="serachToQingCloseBtn",closeBtn.onClick="return false",(div=$C("div")).id="searchToQing",div.style.width="100%",div.style.height="100px",div.style.left="0px",div.style.top=clientHeight-130+"px",div.style.position="fixed",div.style.zIndex=201,div.appendChild(closeBtn),div.appendChild(iframe),Core.Events.addEvent(closeBtn,(function(){trace("add events to closeBtn"),$E("searchToQing").parentNode.removeChild($E("searchToQing"))}),"click"),$IE6&&(div.style.position="absolute",div.style.overflow="hidden",Core.Events.addEvent(window,(function(){var scrollTop=docEle.scrollTop||docBody.scrollTop,clientHeight=docEle.clientHeight||docBody.clientHeight,height=Math.abs(clientHeight-130);$IE6&&(height=Math.abs(clientHeight+scrollTop-130)),$E("searchToQing").style.top=height+"px"}),"scroll"),iframe.style.left=div.style.left,iframe.style.top=div.style.top);docBody.appendChild(div),Core.Events.addEvent(window,(function(e){setTimeout((function(){var scrollTop=docEle.scrollTop||docBody.scrollTop,clientHeight=docEle.clientHeight||docBody.clientHeight,height=Math.abs(clientHeight-130);$IE6&&(height=Math.abs(clientHeight+scrollTop-130)),$E("searchToQing").style.top=height+"px"}),20)}),"resize"),Core.Events.addEvent($E("serachToQingCloseBtn"),(function(e){sendLogToQing("79_01_12|blog7",$UID||"")}),"click"),div=null,iframe=null,$E("searchToQing")&&SUDA&&SUDA.uaTrack("blog_sflow","v_sflow")}()}})),Lib.ADBlogRecommendDialog=Core.Class.create(),Lib.ADBlogRecommendDialog.prototype={template:['<div id="#{panel}" class="popBox">','<div id="#{frame}" class="popBox_bg">','<div id="#{popFlashContent}" class="popFlash" style="z-index:10;">','<a target="_blank" id="#{clickURL}" style="display:none;position:absolute;"></a>',"</div>",'<div id="#{popMain_bg}" class="popMain_bg" style="z-index:11;"></div>','<div class="popMain" style="z-index:12">','<div id="#{content}">',"</div>","</div>",'<div id="#{titleBar}" class="popBox_btn" style="z-index:12;">','<a id="#{btnMin}" href="#" onclick="return false;" title="" class="mini"></a>','<a id="blogNorAd_Cls" href="#" onclick="return false;" title="" class="close"></a>',"</div>","</div>","</div>"].join(""),contentUrl:'<iframe style="width:100%;height:185px;" allowtransparency="yes" frameborder="0" scrolling="no" src="//blog.sina.com.cn/lm/mini/noborder/01.html"></iframe>',name:"blogRecoDialog",_slide:null,_dialog:null,_cookie:"ad680",_mode:null,_timePoints:null,flashURL:"",picURL:"",flashWidth:0,flashHeight:0,tjURL:"",btnURL:"",clickURL:"",_toolbarHeight:0,width:262,height:255,isMin:!1,displayState:"max",closedADLayer:null,closedFlashTemplate:"",_evt:null,initialize:function(mode,timePoints,picURL,flashURL,flashWidth,flashHeight,tjURL,btnURL,clickURL,oParam){var nodes,me=this;this._mode=mode,this.flashURL=flashURL,this.picURL=picURL,this.flashWidth=flashWidth,this.flashHeight=flashHeight,this.tjURL=tjURL,this.btnURL=btnURL,this.clickURL=clickURL,this._timePoints=timePoints,this.oParam=oParam,+oParam.code||(this.isShowClosedAD=!0),this._dialog||(this._dialog=new Ui.Panel,this._dialog.setTemplate(this.template),(nodes=this._dialog.nodes).btnClose=$E("blogNorAd_Cls"),this._dialog.entity.style.zIndex="1000",this._dialog.ifm&&(this._dialog.ifm.style.zIndex="100"),this._dialog.setContent(this.contentUrl),this._dialog.setFixed(!0),this.setPos(),scope.isFromSearchEngine&&this._searchToQing()),this._evt=new Core.Events.EventDispatcher(this),Core.Events.addEvent(nodes.btnClose,this.close.bind2(this)),Core.Events.addEvent(nodes.btnMin,this.toggle.bind2(this)),Core.Events.addEvent(window,(function(){if(me._dialog&&me._dialog.entity){var y=Math.max(document.documentElement.clientHeight)-me.height-me._toolbarHeight,x=Math.max(document.documentElement.clientWidth)-me.width;scope.isFromSearchEngine&&(y-=100),me._dialog.setPosition({x:x,y:y})}}),"resize"),!this.clickURL&&this.initFlashAD(nodes.popFlashContent.id)},setPos:function(){var w=document.documentElement.clientWidth||document.body.clientWidth,h=document.documentElement.clientHeight||document.body.clientHeight,_x=w-this.width,_y=h-this.height-this._toolbarHeight;scope.isFromSearchEngine&&(_y-=100),this._dialog.setPosition({x:_x,y:_y})},initFlashAD:function(nodeID){var sinaFlash2=new sinaFlash(this.flashURL,"popSmallFlash",this.flashWidth,this.flashHeight,"8","#FFFFFF",!1,"High","//www.sina.com.cn/","//www.sina.com.cn/",!1);sinaFlash2.addParam("allowScriptAccess","always"),sinaFlash2.addParam("wmode","transparent"),sinaFlash2.write(nodeID)},show:function(){var nodes=this._dialog.nodes;nodes.frame.style.backgroundImage="url("+this.picURL+")",nodes.btnClose.style.backgroundImage="url("+this.btnURL+")",nodes.btnMin.style.backgroundImage="url("+this.btnURL+")",nodes.popMain_bg.style.backgroundImage="url("+this.tjURL+")",this.clickURL&&(nodes.clickURL.style.display="",nodes.clickURL.style.width=(this.flashWidth||260)+"px",nodes.clickURL.style.height=(this.flashHeight||50)+"px",nodes.clickURL.href=this.clickURL);var me=this;this._dialog.show(),this._evt.dispatchEvent("show"),this.uiStatus="2",this._slide=new Ui.Slide($E(this._dialog.entity.id));var cs=this._slide.container.style;if(cs.top="0px",$IE6?(cs.overflow="visible",cs.height=0):cs.position="absolute",this._slide.onSlideMax=function(){me._evt.dispatchEvent("max")},this._slide.slideMax=function(){this.node.style.marginTop=this.offset+"px",new Ui.tween(this.node,"marginTop",0,this.duration,this.animation,{tween:function(x){}.bind2(this),end:this.onSlideMax})}.bind2(this._slide),this._slide.onSlideMin=function(){me._evt.dispatchEvent("min")},this._slide.slideMin=function(){new Ui.tween(this.node,"marginTop",this.offset-55,this.duration,this.animation,{tween:function(x){}.bind2(this),end:this.onSlideMin})}.bind2(this._slide),this._slide.slideIn=function(){new Ui.tween(this.node,"marginTop",this.offset,5*this.duration,this.animation,{tween:function(x){}.bind2(this),end:this.onSlideIn})}.bind2(this._slide),this._slide.onSlideIn=function(){Core.Dom.removeNode(this._dialog.entity),this._dialog.entity=null,me._evt.dispatchEvent("close")}.bind2(this),this._slide.slideMax(),blogAd.getInitPermission(this.oParam)){this.oParam=this.oParam.ads[0],commonLog("//1088.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_fdtc_bk&db=sina&border=0&local=yes&js=ie");var rightADWrap=$E("rightADWrap");rightADWrap&&Core.Dom.setStyle(rightADWrap,"right","260px")}},toggle:function(){this._dialog.nodes.btnMin&&("max"==this.displayState?(this.uiStatus="1",this._slide.slideMin(),this.displayState="min"):(this.uiStatus="2",this._slide.slideMax(),this.displayState="max"),this.onToggle())},close:function(){Utils.Cookie.setCookie(this._cookie,(new Date).getHours(),24,"/");this.uiStatus="0",Lib.execZhitou((function(res){var ad=new sinaadToolkit.Box({position:"right bottom",width:300,height:250,follow:1});ad.getMain().innerHTML='<ins class="sinaads" id="PDPS000000058147" data-ad-status="async" data-ad-pdps="PDPS000000058147"></ins>',setTimeout((function(){(sinaads=window.sinaads||[]).push({element:$E("PDPS000000058147"),params:{sinaads_success_handler:function(){ad.show(),setTimeout((function(){ad.hide()}),5e3)}}})}),1e3)})),this._slide.slideIn()},createNode:function(txt){var _box=$C("div");return _box.innerHTML=txt,_box.childNodes[0]},appendSwf:function(url,ObjId,width,height,targetId){if(void 0!==sinaFlash){var swfAdder=new sinaFlash(url,ObjId,width+"",height+"","9","#FFFFFF",!1,"High","//www.sina.com.cn/","//www.sina.com.cn/",!1);swfAdder.addParam("allowScriptAccess","always"),swfAdder.addParam("wmode","transparent"),swfAdder.write(targetId)}},onToggle:function(){},addEventListener:function(type,fun){this._evt.addEventListener(type,fun)},getHeight:function(){var flashAd=this.closedADLayer,height=0;return this._dialog.entity&&(trace("dialog height"),height=this._dialog.entity.clientHeight-parseInt(this._slide.node.style.marginTop),trace("dialog height"+height)),flashAd&&"none"!=flashAd.entity.style.display&&(trace("flash height===="),height=this.oParam.height,trace("flash height===="+height)),height},_searchToQing:function(){var me=this;Core.Events.addEvent($E("serachToQingCloseBtn"),(function(){if(scope.isFromSearchEngine){if(scope.isFromSearchEngine=!1,me._dialog&&me._dialog.entity){var y=Math.max(document.documentElement.clientHeight)-me.height-me._toolbarHeight,x=Math.max(document.documentElement.clientWidth)-me.width;me._dialog.setPosition({x:x,y:y})}if(me.closedADLayer&&me.closedADLayer.entity){var closeADLayer=me.closedADLayer.entity,top=closeADLayer.style.top;closeADLayer.style.top=parseInt(top)+100+"px"}}}),"click")}},scope.searchEngineList={"www.google.com":{param:"q",encode:"utf-8"},"www.google.com.hk":{param:"q",encode:"utf-8"},"www.baidu.com":{param:"wd",encode:"gbk"},"www.soso.com":{param:"w",encode:"gbk"},"cn.yahoo.com":{param:"p",encode:"utf-8"},"search.yahoo.com":{param:"p",encode:"utf-8"},"web.gougou.com":{param:"search",encode:"utf-8"},"cn.bing.com":{param:"q",encode:"utf-8"},"www.youdao.com":{param:"q",encode:"utf-8"},"www.sogou.com":{param:"query",encode:"gbk"},"uni.sina.com.cn":{param:"k",encode:"gbk"},"search.sina.com.cn":{param:"q",encode:"utf-8"}},scope.searchFloatingLayerTemplate=['<div id="statBottomforniangs" class="blog_sfout">','<div class="blog_srhflt">','<div id="searchFloatingLayer_LeftContentArea" class="blog_sfL">','<div class="blog_sfTit"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_01\');return false;" id="searchFloatingLayer_RelatedArticle" target="_blank">相关博文</a></div>','<div class="blog_sflist">','<ul id="searchFloatingLayer_RelatedArticleList"></ul>','<span class="SG_more"><a href="#" onclick="v7sendLog && v7sendLog(\'85_01_04\');return false;" id="searchFloatingLayer_More" target="_blank">更多&gt;&gt;</a></span>',"</div>","</div>",'<div class="blog_sM" id="searchFloatingLayer_ad"></div>','<div class="blog_sfR">','<div class="mren">',"<strong>看看名嘴们都在说什么</strong>",'<ul class="mren_list" id="searchFloatingLayer_CelebrityList"></ul>','<div class="clear"></div>',"</div>","</div>",'<div class="clear"></div>',"</div>",'<div class="blog_sfClo"><a id="searchFloatingLayer_CloseBtn" href="#" onclick="return false;"></a></div>',"</div>"].join(""),scope.searchFloatingLayer={dataURL:"//control.blog.sina.com.cn/riaapi/article/search_recommend.php",isDisplay:function(){var anchorObj=new Utils.Url(window.location.href).anchor||{},keyword=anchorObj.sFLKeyword,refer=document.referrer;if("blog.sina.com.cn"===window.location.host&&keyword)return this.keyword=keyword,this.encode=anchorObj.sFLEncode||"utf-8",!0;if(refer){var sList=scope.searchEngineList,urlObj=new Utils.Url(refer);for(var searchEngine in sList)if(urlObj.url.indexOf(searchEngine)>-1)return this.keyword=urlObj.getParam(sList[searchEngine].param),"search.sina.com.cn"!==searchEngine&&"www.baidu.com"!==searchEngine||!urlObj.getParam("ie")?this.encode=sList[searchEngine].encode:this.encode=urlObj.getParam("ie"),!0}},displayFloatingLayer:function(oParam){var _this=this;blogAd.getInitPermission(oParam)&&(oParam=oParam.ads[0],Utils.Io.JsLoad.request(this.dataURL,{charset:"utf-8",noencode:!0,GET:{encode:this.encode,keyword:this.keyword},onComplete:function(result){result&&"A00006"===result.code&&_this.createFloatingLayerWithData(result.data,oParam)}}))},createFloatingLayerWithData:function(data,oParam){if(!data.relatedArticle||0!==data.relatedArticle.length){var searchPanel=new Ui.Panel;searchPanel.setTemplate('<div id="#{panel}">'+scope.searchFloatingLayerTemplate+"</div>").setFixed(!0),searchPanel.show(),searchPanel.entity.style.zIndex="9999",updatemsnFeedFloatLayerPos($IE6?"":"first"),Core.Events.addEvent($E("searchFloatingLayer_CloseBtn"),(function(){searchPanel.destroy()})),Core.Events.addEvent(window,(function(){updatemsnFeedFloatLayerPos()}),"resize",!1),this.updateContent(data,oParam),!$IE6&&this.playDisplayEffect(searchPanel)}function updatemsnFeedFloatLayerPos(first){var winWidth=document.documentElement.clientWidth,winHeight=document.documentElement.clientHeight;searchPanel.setPosition({x:0,y:winHeight-(first?0:searchPanel.entity.offsetHeight)}),$E("statBottomforniangs").style.width=winWidth+"px"}},updateContent:function(data,oParam){var i,__cantSeeMe,aArr=data.relatedArticle,cArr=data.celebrity,aHTML=[],cHTML=[],url="//search.sina.com.cn/?c=blog&by=title&range=all&q="+this.keyword+"&ie="+this.encode,__adNode=$E("searchFloatingLayer_ad");for(i=0;i<aArr.length&&i<2;i++)aHTML[aHTML.length]="<li>",aArr[i].isRecommend&&(aHTML[aHTML.length]='<img class="SG_icon SG_icon107" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="18" height="18" title="推荐" align="absmiddle" />'),aHTML[aHTML.length]="<a onclick=\"v7sendLog && v7sendLog('85_01_0"+(2+i)+'\');" href="'+aArr[i].url.replace(/\?.*/,"")+"#sFLKeyword="+this.keyword+"&sFLEncode="+this.encode+'" target="_blank">'+aArr[i].title.replace(data.keyword,'<span class="blog_sfNm">'+data.keyword+"</span>")+"</a>",aHTML[aHTML.length]="</li>";for(1===aArr.length&&($E("searchFloatingLayer_LeftContentArea").className="blog_sfL blog_onlyone"),1===data.type&&($E("searchFloatingLayer_RelatedArticle").parentNode.className="blog_sfTit blog_nofTit"),$E("searchFloatingLayer_RelatedArticleList").innerHTML=aHTML.join(""),i=0;i<cArr.length&&i<5;i++)cHTML[cHTML.length]="<li>",cHTML[cHTML.length]="<a onclick='v7sendLog && v7sendLog(\"85_01_0"+(5+i)+"\");' href='//blog.sina.com.cn/u/"+cArr[i].uid+"#sFLKeyword="+encodeURIComponent(cArr[i].uname)+"&sFLEncode=utf-8' target='_blank'>"+cArr[i].uname+"</a>",cHTML[cHTML.length]="</li>";$E("searchFloatingLayer_CelebrityList").innerHTML=cHTML.join(""),$E("searchFloatingLayer_RelatedArticle").href=url,$E("searchFloatingLayer_More").href=url+"&s=2",oParam&&__adNode&&("swf"==oParam.type?this.appendSwf(oParam.ref,"",oParam.width,oParam.height,__adNode):(__adNode.style.cssText="height:"+oParam.height+"px; width:"+oParam.width+"px;",__adNode.innerHTML="<img src='"+oParam.ref+"' alt=''/>"),oParam.click&&(__adNode.style.position="relative",(__cantSeeMe=this.createNode('<a href="#" target="_blank"></a>')).href=oParam.click,__cantSeeMe.style.cssText=($IE?"filter:alpha(opacity=0);":"opacity:0")+"; height:"+oParam.height+"px; width:"+oParam.width+"px; background:#F00; display:block;z-index:1020; position:absolute; left:0; top:0;",__adNode.appendChild(__cantSeeMe)),__adNode.style.marginTop=parseInt((70-oParam.height)/2)+"px")},createNode:function(txt){var _box=$C("div");return _box.innerHTML=txt,_box.childNodes[0]},playDisplayEffect:function(panel){var domElement=panel.entity,top=parseInt(domElement.style.top),tweenObj=new Ui.TweenStrategy(top,top-domElement.offsetHeight,.5);tweenObj.onTween=function(v){domElement.style.top=v+"px"},tweenObj.onEnd=function(){panel.setPosition({x:0,y:document.documentElement.clientHeight-domElement.offsetHeight})},tweenObj.start()},appendSwf:function(url,id,width,height,targetId){if(void 0!==sinaFlash){var sinaFlash2=new sinaFlash(url,id,width+"",height+"","9","#FFFFFF",!1,"High","//www.sina.com.cn/","//www.sina.com.cn/",!1);sinaFlash2.addParam("allowScriptAccess","always"),sinaFlash2.addParam("wmode","transparent"),sinaFlash2.write(targetId)}}},$registJob("outSearch",(function(){function loadAd(){new BlogAd({pos:"jumpin"}).getAd((function(res){+res.code||Utils.Io.loadExternalCSS($_GLOBAL.cssBasicURL+"module/layer/re_seach.css",(function(){var sObj=scope.searchFloatingLayer;sObj.isDisplay()&&sObj.displayFloatingLayer(res)}))}))}("undefined"==typeof BlogAd?function(){Utils.Io.JsLoad.request("//pfp.sina.com.cn/blog/js/blogad.js",{charset:"gb2312",onComplete:function(){"undefined"!=typeof BlogAd&&loadAd()},isRemove:!1})}:loadAd)()})),blogAd.popAd=function(){var blogreco,isToggle=!1,oParam={code:"2101",ads:{0:{type:"mixed"}}},that={};if(setTimeout((function(){Lib.Listener.notify("blogRecommendAfter")}),4e3),null==scope.handler_680)return scope.handler_680=null,that.renderPopAd=function(data){var match;if(0!=(!(match=document.cookie.match(/(?:ad|dlg)680=(\d+)/))||classHour(match[1])!==classHour((new Date).getHours()))){if(data&&data.isAD){var t="?"+(new Date).getTime();data.flashURL&&(data.flashURL+=t),data.picURL&&(data.picURL+=t),data.borderImg&&(data.borderImg+=t),data.btnImg&&(data.btnImg+=t),(blogreco=new Lib.ADBlogRecommendDialog("once",1,data.picURL,data.flashURL,data.flashWidth,data.flashHeight,data.borderImg,data.btnImg,data.clickUrl,oParam)).onToggle=function(){isToggle=!0};var img=new Image;img.onload=function(){scope.handler_680=blogreco,scope.Bind680EventHandler&&scope.Bind680EventHandler(),blogreco.show(),blogreco._dialog.entity?"none"==blogreco._dialog.entity.style.display&&$callJob("outSearch"):$callJob("outSearch"),setTimeout((function(){!isToggle&&blogreco._slide&&"max"==blogreco.displayState&&blogreco.toggle()}),6e4),img=null},img.src=data.picURL;var isBindFun=!1;data.logurls&&blogreco.addEventListener("show",(function(){isBindFun||(isBindFun=!0,Core.Events.addEvent(blogreco._dialog.nodes.popFlashContent,Core.Function.bind3(adClickCounts,this,[data.logurls]),"click"))}))}}else $callJob("outSearch")},that;function classHour(hour){return hour>21?1:hour>14?3:hour>7?2:1}function adClickCounts(logurls){for(var i=0;i<logurls.length;i++)commonLog&&commonLog(logurls[i])}},$registJob("tjAd",(function(){scope.isFromSearchEngine=Article.getSearchReferrer();window.location.href.indexOf("tj=1");var isMid=scope.$pageid.indexOf("articletj")>-1;new blogAd.CommAd;var adJsDomain="//d"+~~(100*Math.random())%10+".sina.com.cn";Lib.util.loadScript(adJsDomain+"/litong/zhitou/sinaads/release/spec/getSinaadsExParamsForBlog.js",(function(){})),function(){if(isMid){var m904=$E("module_904"),m904TopAd=$E("module_904_top_ad"),tj2Tpl='<div class="right_fixed_area"  id="rightFixedArea"></div>';m904TopAd?Utils.insertTemplate(m904TopAd,tj2Tpl,"beforebegin"):Utils.insertTemplate(m904,tj2Tpl,"beforebegin");var tj2Style=document.createElement("style"),cssText=[".right_fixed_area{margin-bottom:10px;}",".right_fixed{position: fixed;top: 0;width: 300px;}"].join("\n");tj2Style.setAttribute("type","text/css"),tj2Style.styleSheet?tj2Style.styleSheet.cssText=tj2Style.innerHTML+cssText:tj2Style.appendChild(document.createTextNode(cssText)),$T(document,"head")[0].appendChild(tj2Style),Lib.execZhitou((function(res){var $adEl=blogAd.insertIns("PDPS000000055753",$E("rightFixedArea"),"afterbegin");(window.sinaads||[]).push({element:$adEl,params:{sinaads_success_handler:function(){var reIE=/MSIE\s([^;]*)/,browser={ie:0,loaded:!1};!function(browser){var str,count,temp=(navigator&&navigator.userAgent||"").match(reIE);temp&&temp[1]&&(browser.ie=(str=temp[1],count=0,parseFloat(str.replace(/\./g,(function(){return 1==++count?".":""})))))}(browser),function(){var utils={byId:function(id){return"string"!=typeof id?id:document.getElementById(id)},getByClassName:function(str,root,tag){tag=tag||"*";for(var els=(root=root?"string"==typeof root?document.getElementById(root):root:document.body).getElementsByTagName(tag),arr=[],i=0,n=els.length;i<n;i++)for(var j=0,k=els[i].className.split(" "),l=k.length;j<l;j++)if(k[j]==str){arr.push(els[i]);break}return arr},hasClass:function(elem,cls){return new RegExp("(^|\\s)"+cls+"($|\\s)").test(elem.className)},removeClass:function(elem,cls){var reg=new RegExp("(^|\\s)"+cls+"($|\\s)","g");elem.className=elem.className.replace(reg," ")},addClass:function(elem,cls){utils.hasClass(elem,cls)||(elem.className+=" "+cls)},viewData:function(){var e,l,j=window,h=document,k=h.documentElement;return e=k.clientWidth||h.body.clientWidth||0,l=j.innerHeight||k.clientHeight||h.body.clientHeight||0,{scrollTop:h.body.scrollTop||k.scrollTop||j.pageYOffset||0,scrollLeft:h.body.scrollLeft||k.scrollLeft||j.pageXOffset||0,documentWidth:Math.max(h.body.scrollWidth,k.scrollWidth||0),documentHeight:Math.max(h.body.scrollHeight,k.scrollHeight||0,l),viewWidth:e,viewHeight:l}}};function getPosition(a){for(var b={x:0,y:0};a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b}function addEvent(obj,eventType,func){obj.attachEvent?obj.attachEvent("on"+eventType,func):obj.addEventListener(eventType,func,!1)}if(6!=browser.ie){var container=utils.byId("rightFixedArea"),sidebar=utils.byId("column_2"),theY=getPosition(sidebar).y+sidebar.offsetHeight;setTimeout((function(){theY=getPosition(sidebar).y+sidebar.offsetHeight}),1e3);var scrollTimeout=null,scrollCallback=function(){!function(bottomHeight){var adY=getPosition(sidebar).y+sidebar.offsetHeight;0!=adY&&(theY=utils.hasClass("container","right_fixed")?adY+container.offsetHeight:adY);var adH=container.offsetHeight,vD=utils.viewData();vD.documentHeight-bottomHeight-vD.scrollTop>=adH&&vD.scrollTop>=theY?utils.addClass(container,"right_fixed"):utils.removeClass(container,"right_fixed")}(160)},resizeTimeout=null;addEvent(window,"scroll",(function(){scrollTimeout&&window.clearTimeout(scrollTimeout),scrollTimeout=window.setTimeout(scrollCallback,10)})),addEvent(window,"resize",(function(){resizeTimeout&&window.clearTimeout(resizeTimeout),resizeTimeout=window.setTimeout(scrollCallback,10)}))}}()}}})}))}else Lib.execZhitou((function(res){var listener=Lib.Listener,$adEl=blogAd.insertIns("PDPS000000049439",$E("trayFlashConnetion").parentNode,"beforebegin","width:1000px; display:block; margin:0 auto");function end(){var $blogbody=$E("sinabloga");if($blogbody){var $rndv=$E("ramdomVisitDiv");$rndv&&($rndv.style.top=$blogbody.offsetTop+"px")}}listener.notify("topad680-show-start",{}),(window.sinaads||[]).push({element:$adEl,params:{sinaads_ad_width:1e3,sinaads_success_handler:function(){end(),listener.notify("topad680-show-end",{show:!0})},sinaads_fail_handler:function(){end(),listener.notify("topad680-show-end",{show:!1})}}})}));Lib.execZhitou((function(res){var $adEl=blogAd.insertIns("PDPS000000051781");$adEl.style.display="none";var popAd=blogAd.popAd();(window.sinaads||[]).push({element:$adEl,params:{sinaads_success_handler:function(elem,data){var result;elem.style.display="none",result=function(saxData){var result={};return 0===data.content[0].src[0].replace(/(^\s*)|(\s*$)/g,"").length?result.isAD=!1:result={isAD:!0,flashURL:adJsDomain+"/litong/kuaijieweibo/yafeng/boke/sc/bk.swf",flashWidth:293,flashHeight:60,picURL:saxData.content[0].src[0],clickUrl:saxData.content[0].link[0],borderImg:adJsDomain+"/litong/kuaijieweibo/yafeng/boke/images/imgbgnn.gif",btnImg:adJsDomain+"/201007/09/237719_btn.gif",logurls:saxData.content[0].monitor},result}(data),popAd.renderPopAd(result)},sinaads_fail_handler:function(elem,data){elem.style.display="none",popAd.renderPopAd({isAD:!1})}}})})),isMid||Lib.checkAuthor((function(){!$isAdmin&&Lib.execZhitou((function(res){var beforeNode;if(!beforeNode){var n=$E("module_904")||$E("module_903"),c=n.parentNode.children;beforeNode=3>c.length?n.parentNode.lastChild:c[2]}var newEl=blogAd.insertIns("PDPS000000055124",beforeNode,"afterend");(window.sinaads||[]).push({element:newEl,params:{sinaads_success_handler:function(){newEl.style.marginBottom="10px"}}})}))}),"tjAd"+(new Date).getTime())}(),Lib.Listener.on({name:"blogRecommendAfter",callBack:function(isHidden){Lib.execZhitou((function(res){var url=adJsDomain+"/litong/zhitou/sinaads/demo/changwy/link/blog_bottom_float.js";Lib.util.loadScript(url,(function(){(sinaads=window.sinaads||[]).push({element:adEl,params:{}})}));var adEl=blogAd.insertIns("PDPS000000052950",document.body)}))}})})),Utils.Io.TimeoutJsLoad=function(url,opts){if(this._opts={url:"",charset:"utf-8",noreturn:!1,noencode:!1,timeout:-1,GET:{},onComplete:null,onException:null,type:"blogScript",jsonpParamName:"callback"},!url||"string"!=typeof url)throw new Error("url参数不能为空!");this._opts.url=url,this.isAborted=!1,this.scriptIdentifier="",this.varname="",this.loadComplete=!1,this.timeObj,Core.System.parseParam(this._opts,opts),this.loadScript()},Utils.Io.TimeoutJsLoad.prototype={constructor:Utils.Io.TimeoutJsLoad,__jsonpCounter:(new Date).getTime(),loadScript:function(){var opts=this._opts,scriptObj=$C("script"),head=$T(document,"head")[0],_this=this,jsonp=this._processUrl();function originalCallback(result){var type=opts.type;if("blogScript"!==type||!scriptObj||!scriptObj.readyState||"loaded"==scriptObj.readyState||"complete"==scriptObj.readyState){if(_this.loadComplete=!0,"jsonp"===type){window[jsonp]=undefined;try{delete window[jsonp]}catch(jsonpError){}}else"blogScript"===type&&(scriptObj.onload=scriptObj.onreadystatechange=scriptObj.onerror=null);head.removeChild(scriptObj),_this.isAborted||"function"!=typeof opts.onComplete||(_this.timeObj&&clearTimeout(_this.timeObj),opts.onComplete("blogScript"===type?window[_this.varname]:result))}}scriptObj.async=!0,scriptObj.src=opts.url,scriptObj.charset=opts.charset,scriptObj.id="script"+this.scriptIdentifier,"jsonp"===opts.type?window[jsonp]=originalCallback:"blogScript"===opts.type&&(scriptObj.onload=scriptObj.onerror=scriptObj.onreadystatechange=originalCallback),head.insertBefore(scriptObj,head.firstChild),opts.timeout>0&&(this.timeObj=setTimeout((function(){_this.abortRequest()}),opts.timeout))},abortRequest:function(){this.loadComplete||(this.isAborted=!0,/opera/i.test(navigator.userAgent)&&$E("script"+this.scriptIdentifier)&&($E("script"+this.scriptIdentifier).src=""),"function"==typeof this._opts.onException&&this._opts.onException())},_processUrl:function(){var key,opts=this._opts,url=opts.url,queryString=opts.GET,rnd=window.parseInt(1e8*Math.random()),url_cls=new Utils.Url(url);for(key in queryString)url_cls.setParam(key,!0===opts.noencode?queryString[key]:Core.String.encodeDoubleByte(queryString[key]));if(this.scriptIdentifier=rnd,"blogScript"===opts.type)this.varname=url_cls.getParam("varname")||"requestId_"+rnd,!0!==opts.noreturn&&url_cls.setParam("varname",this.varname);else if("jsonp"===opts.type){var jsonp="jsonp"+this.constructor.prototype.__jsonpCounter++;url_cls.setParam(opts.jsonpParamName,jsonp)}return opts.url=url_cls.toString(),jsonp}},$registJob("tranVideo",(function(){var ua,isMac={isIpad:null!=(ua=navigator.userAgent.toLowerCase()).match(/ipad/i),isIphone:null!=ua.match(/iphone/i),isIpod:null!=ua.match(/ipod/i)};if(isMac.isIpad||isMac.isIphone||isMac.isIpod){Utils.Io.JsLoad.request;var __newTOJ=Utils.Io.TimeoutJsLoad,tranVideo_createVideoTag=(Core.Dom.insertHTML,Core.String.j2o,function(obj){var src="//video.sina.com.cn/api/getIpadUrl.php?url="+encodeURIComponent(obj.src.replace(".swf",""));new __newTOJ(src,{type:"blogScript",GET:{rmd:Math.random()},onComplete:function(result){if(""!=result.ipad_url){obj.style.display="none";var vTag=$C("video");vTag.className="video",vTag.setAttribute("width","482px"),vTag.setAttribute("height","388px"),vTag.setAttribute("controls","controls"),vTag.setAttribute("src",result.ipad_url),obj.parentNode.insertBefore(vTag,obj)}},onException:Function()})});allEmbed=document.getElementsByTagName("embed");for(var i=0;i<allEmbed.length;i++)-1==allEmbed[i].src.indexOf("//p.you.video.sina.com.cn")&&-1==allEmbed[i].src.indexOf("//you.video.sina.com.cn")||tranVideo_createVideoTag(allEmbed[i])}})),$registJob("errorTips",(function(){function createNode(html){var elem=$C("div");return elem.innerHTML=html,elem.firstChild}Lib.checkAuthor((function(){$isLogin&&Utils.Io.JsLoad.request("//control.blog.sina.com.cn/riaapi/warning.php",{GET:{uid:$UID},onComplete:function(result){var errorTips,target;if(result&&1==result.iswarning){var html='<div id="err_i8t9c" class="tb_layer_Y tb_layer_w6" style="display:'+(Utils.Cookie.getCookie("i8t9c"+$UID)!==result.date?"block":"none")+';z-index:500;position:absolute;top:-300px;"><div class="tb_layer_arrow" style="margin:0 0;left:219px"></div><div class="tb_layer_Y_main"><div class="tb_mas"><span style="float:right;"><a class="conn" href="javascript:;" onclick="scope.i8t9c()">×</a></span></div><div class="tb_mas">'+result.msg+'<p style="text-align:center;padding:6px;"><input type="button" value="知道了" onclick="scope.i8t9c()" /></p></div></div></div></div>';scope.i8t9c=function(){$E("err_i8t9c").style.display="none",Utils.Cookie.setCookie("i8t9c"+$UID,result.date,8760,"/"),Utils.Cookie.setCookie("i8t9c"+$UID,result.date,8760,"/","blog.sina.com.cn")},scope.i8t9c.show=function(){$E("err_i8t9c").style.display="",updatePos()},errorTips=createNode(html),document.body.appendChild(errorTips);var act=$E("loginBarActivity");target=createNode('<div class="topbar_activity"><a href="javascript:;" onclick="scope.i8t9c&&scope.i8t9c.show();">[公告]</a></div>'),act.parentNode.insertBefore(target,act),setTimeout(updatePos,10),Core.Events.addEvent(window,(function(){updatePos()}),"resize"),Lib.Listener.on({name:"topad680-show-end",callBack:updatePos,scope:this});document.documentElement.scrollTop,document.body.scrollTop}function updatePos(){var pos=Core.Dom.getXY(target),width=errorTips.offsetWidth;errorTips.style.visibility="inherit",errorTips.style.top=pos[1]+23+"px",errorTips.style.left=pos[0]-width+41+"px"}}})}),"errorTips"+(new Date).getTime())})),Core.Dom.findNode=function(element,direction,start){for(var node=element[start];node;node=node[direction])if(1==node.nodeType)return node;return null},Core.Dom.nextNode=function(srcEl){return Core.Dom.findNode(srcEl,"nextSibling","nextSibling")},blogAd.shareToWeibo=function(oParam){var url=new Utils.Url("//v.t.sina.com.cn/share/share.php"),encode=encodeURIComponent;for(var p in oParam.clickCode&&((new Image).src=oParam.clickCode),oParam)oParam.hasOwnProperty(p)&&url.setParam(p,encode(oParam[p]));oParam.title||url.setParam("title",encode(oParam.title||document.title)),url.setParam("content","utf-8");var openWnd=function(){url=url.toString(),window.open(url,"mb",["toolbar=0,status=0,resizable=1,width=440,height=430,left=",(screen.width-440)/2,",top=",(screen.height-430)/2].join(""))||(location.href=url)};/Firefox/.test(navigator.userAgent)?setTimeout(openWnd,0):openWnd()},blogAd.nickTrayAd=function(oParam,relativeNode){relativeNode.innerHTML=oParam.adLink;var __this=this,__template=['<div id="#{entity}" class="tips_layer1 tips_bg_a" style="z-index:150;position:absolute;top:23px;left:0px;display:none;">','<div id="#{body}" class="tips_bd">','<a id="#{imageLink}" href="" class="link" title="" target="_blank"></a>','<div class="tips_detail"> <span id="#{closeBtn}" class="close" title="关闭">×</span>','<p id="#{userNick}" class="tips_nickname"></p>','<p id="#{tipsTitle}" class="tips_txt"></p>','<p id="#{tipsTxtLink}" class="tips_ad"></p>','<p id="#{tipsBtn}" class="tips_btn"></p>',"</div>","</div>","</div>"].join("");this.relativeNodeId=relativeNode.id,this.MARK_ID=1,this.LIMITED=24;var nodes=this.nodes=this.getTemplateNodes(__template);if(Core.Dom.insertAfter(nodes.entity,document.body.lastChild),$IE6&&oParam.ie6BackgroundPic)nodes.entity.style.backgroundImage="url("+oParam.ie6BackgroundPic+")";else if(oParam.backgroundPic)try{nodes.entity.style.backgroundImage="url("+oParam.backgroundPic+")"}catch(e){}nodes.imageLink.href=oParam.imageLinkHref;var nick=typeof $nick;nick="undefined"==nick?"亲爱的网友":$nick,nodes.userNick.innerHTML="HI，"+nick.replace(/</g,"&lt;"),nodes.tipsTitle.innerHTML=oParam.tipsTitle,oParam.tipsTxtLink&&(nodes.tipsTxtLink.innerHTML=oParam.tipsTxtLink);var linkStyle=nodes.tipsTxtLink.children[0].style;!$IE6&&oParam.tipsTxtLinkBgPic?(linkStyle.backgroundImage="url("+oParam.tipsTxtLinkBgPic+")",linkStyle.backgroundRepeat="no-repeat"):$IE6&&oParam.ie6TipsTxtLinkBgPic&&(linkStyle.backgroundImage="url("+oParam.ie6TipsTxtLinkBgPic+")",linkStyle.backgroundRepeat="no-repeat"),nodes.tipsBtn.innerHTML=oParam.tipsBtn,Core.Events.addEvent(nodes.closeBtn,(function(){__this.hide(),scope.$channel=null;var closeLog=oParam.status.adclose;closeLog&&((new Image).src=closeLog)}),"click"),setTimeout((function(){__this.setPos(),__this.show(),__this.initResizeEvent()}),15);oParam.status&&oParam.status.adclose;Core.Events.addEvent(nodes.entity,(function(e){var target=e.target||e.srcElement,entity=nodes.entity;do{if("A"===target.nodeName.toUpperCase()&&-1!=target.href.indexOf("http")){__this.hide(),scope.$channel=null;var closeLog=oParam.status.adclose;closeLog&&((new Image).src=closeLog);break}}while(target&&target==entity)}),"click"),oParam.status.adstart&&((new Image).src=oParam.status.adstart),oParam.blogTip?v7sendLog(oParam.logCode):commonLog("//1090.adsina.allyes.com/main/adfshow?user=AFP6_for_SINA|2012_add|2012_blog_tip&db=sina&border=0&local=yes&js=ie")}.$defineProto({setMark:function(){var nextShowHours=24-(new Date).getHours();Utils.Cookie.setCookie("blogTipsAd",1,nextShowHours,"/",".blog.sina.com.cn")},setPos:function(){var relativeNode=$E(this.relativeNodeId),xy=Core.Dom.getXY(relativeNode),linkWidth=relativeNode.offsetWidth,nodeStyle=this.nodes.entity.style;nodeStyle.left=parseInt(xy[0])+(linkWidth-100)+"px",nodeStyle.top=parseInt(xy[1])+23+"px"},show:function(){this.isHidden=!1;var tipsEl=this.nodes.entity,_setStyle=Core.Dom.setStyle,tween=new Ui.TweenStrategy(0,1,.5,(function(t,b,c,d){return-c*(t/=d)*(t-2)+b}));tween.onTween=function(val){_setStyle(tipsEl,"opacity",val)},tween.onEnd=function(){$IE?tipsEl.style.filter="none":_setStyle(tipsEl,"opacity","none")},_setStyle(tipsEl,"opacity",0),tipsEl.style.display="block",tween.start()},hide:function(){this.setMark(),this.isHidden=!0;var tipsEl=this.nodes.entity,_setStyle=Core.Dom.setStyle,tween=new Ui.TweenStrategy(1,0,.5,(function(t,b,c,d){return-c*(t/=d)*(t-2)+b}));tween.onTween=function(val){_setStyle(tipsEl,"opacity",val)},tween.onEnd=function(){$IE?tipsEl.style.filter="none":_setStyle(tipsEl,"opacity","none"),tipsEl.style.display="none"},tween.start()},initResizeEvent:function(){var me=this;Core.Events.addEvent(window,(function(){me.isHidden||me.setPos()}),"resize")}}).$mixProto(Lib.templateUtils),blogAd.loadNickTrayAd=function(data){Lib.Listener;var actBtn=$E("loginBarActivity")||$E("divPopularize"),day=(actBtn.getAttribute("shouldShow"),(new Date).getDay()),isClosed=Utils.Cookie.getCookie("blogTipsAd");if(actBtn.style.display="",(1==day||3==day||5==day)&&!isClosed){Utils.Io.loadExternalCSS("//simg.sinajs.cn/blog7style/css/module/layer/layer20.css",(function(){if(data){if(!data||!data.isShow)return;data.logCode&&(data.logCode=data.logCode+"|"+$UID),blogAd.trayAdHandle=new blogAd.nickTrayAd(data,actBtn),actBtn=null}}))}},$registJob("trayTipsAd",(function(){var topbarAdLoaded,trayLoaded,adData,listener=Lib.Listener,showAdCondition=function(data){data=data&&data.weicaopan&&data.weicaopan.weicaopan_con,Lib.execZhitou((function(){function showOrHideChild(isShow){for(var node=actBtn.firstChild,style=isShow?"":"none";node;)"a"===node.nodeName.toLowerCase()&&(node.style.display=style),node=node.nextSibling}var actBtn=$E("loginBarActivity")||$E("divPopularize");actBtn.style.display="";var left,actBtnXY,$bar=actBtn.parentNode,top=$bar.parentNode.offsetHeight;if(showOrHideChild(!1),"none"===$bar.style.display){$bar.style.position="absolute",$bar.style.top="-40px",$bar.style.display="",actBtnXY=Core.Dom.getXY(actBtn);var $logo=$E("login_bar_logo_link_350");$logo.style.display="",left=$logo.children[0].offsetWidth+actBtnXY[0],topbarAdLoaded&&(top+=90),$bar.style.position="",$bar.style.top="",$bar.style.display="none",$logo.style.display="none"}else top+=(actBtnXY=Core.Dom.getXY(actBtn))[1],left=actBtnXY[0];var $adEl=blogAd.insertIns("PDPS000000033238",actBtn);(window.sinaads||[]).push({element:$adEl,params:{sinaads_tip_top:top,sinaads_tip_left:left,sinaads_success_handler:function(){showOrHideChild(!1),window.BLOG_AD_TIPS=1},sinaads_fail_handler:function(){showOrHideChild(!0),blogAd.loadNickTrayAd(data)},sinaads_ad_zindex:590}})})),listener.off({name:"ad_show_hide_conditions",callBack:showAdCondition}),showAdCondition=null};listener.on({name:"ad_show_hide_conditions",callBack:function(data){void 0!==topbarAdLoaded?showAdCondition(data):adData=data,trayLoaded=!0}}),listener.on({name:"topad680-show-end",callBack:function(data){topbarAdLoaded=data.show,trayLoaded&&showAdCondition(adData)}})}));var ReblogToQing=Core.Class.create();function main(){window.location.href.indexOf("tj=1")>-1&&v7sendLog("42_01_07");var job=new Jobs;job.add("suda"),job.add("blogTip"),job.add("tray"),job.add("trayTipsAd"),job.add("renderAd"),job.add("digger"),job.add("articleDigger"),job.add("articleCommentV2"),job.add("articleNumberV2"),job.add("articleMaxImg"),job.add("imageLazyLoad"),job.add("articleCommentPostV2"),job.add("dynamicVoteView"),job.add("quote_list"),job.add("updownurl"),job.add("write"),job.add("sharePhoto"),job.add("share"),job.add("favGames"),job.add("articleComp2"),job.add("teams_wc"),job.add("calendar_wc"),job.add("templateClone",3),job.add("modifytitle",3),job.add("audioCheck",3),job.add("articleShare",3),job.add("modify_tip"),job.add("flashtemplate",3),job.add("miniBlogAttention"),job.add("baby_headPhotoEditorDialog"),job.add("baby_babyBarFlashDetect"),job.add("scrollAd"),job.add("SinglesDay"),job.add("static"),job.add("selectionShare"),job.add("toZoneStatic",3),job.add("userResidenceTime"),job.add("tjAd",3),job.add("tranVideo"),job.add("errorTips"),job.add("adNoticeChannel"),job.add("blogNotice"),job.add("renderReblogDiv"),job.add("showSlideBox"),job.add("showSlideBtn"),job.add("userDetect",3),job.add("osl_article",3),job.add("loginStatus"),job.add("padSwitch"),job.add("loginFollow"),job.add("share"),job.add("uatrack"),job.add("xgBlogAD"),job.add("blogAppAd"),job.add("stylefix",3),job.start()}ReblogToQing.prototype={saving:!1,blogId:"",initialize:function(){},reblog:function(blogId){if(this.blogId=blogId,!this.blogId)throw new Error("转载博文ID未定义");this.checkUser(this.blogId)},checkUser:function(blogId){this.blogId=blogId||scope.$blogId;var me=this;Lib.checkAuthor((function(){$isLogin?scope.blogOpener.showDialog((function(){me.save()})):(v7sendLog("48_01_32"),(new Lib.Login.Ui).login((function(){scope.blogOpener.showDialog((function(){me.save.bind2(me)()}))})))}),"ReblogToQing"+(new Date).getTime())},save:function(){var me=this;if(!this.saving){this.saving=!0;var param={version:7,blogId:me.blogId,rnd:+new Date},showUnkownError=function(){winDialog.alert("对不起，系统繁忙请稍后！",{icon:"01",funcOk:function(){}})},url="//control.blog.sina.com.cn/blog_rebuild/riaapi/blog/share2qing.php?rnd="+ +new Date;Utils.Io.Ijax.request(url,{POST:param,returnType:"json",onComplete:function(result){if(this.saving=!1,result){try{result=new Function("return "+result)()}catch(e){showUnkownError()}"A00006"==result.code?(winDialog.alert(["已成功转载到Qing博客！<br/><span style='font-weight: 100; font-size: 12px;'>",result.data.qingId?"<a target='_blank' href='"+$_GLOBAL.qingURL+result.data.userId+"/"+result.data.qingId+".html'>去查看已转载的文章>></a>":"","</span>"].join(""),{icon:"03"}),me.onSuccess(result,param)):"A00420"==result.code?me.showOpenQingWnd():"A00421"==result.code?me.showShareToQingFailure():showUnkownError()}else showUnkownError()}.bind2(this),onException:function(data){this.saving=!1,data||showUnkownError()}.bind2(this)})}},showOpenQingWnd:function(){var dialog=winDialog.createCustomsDialog({content:['<div class="CP_layercon2 unilayer">','<div class="CP_prompt toQing">','<table class="CP_w_ttl"><tbody><tr><td>您的新浪博客账号未开通Qing。开通后可转载到Qing中。</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a id="#{openQing}" class="SG_aBtn SG_aBtnB" href="'+$_GLOBAL.qingURL+'home" target="_blank"><cite>开通Qing</cite></a>','&nbsp;&nbsp;<a id="#{cancel}" class="SG_aBtn SG_aBtnB" href="javascript:void(0);"><cite>取消</cite></a></p>',"</div>","</div>"].join(""),shadow:1},"openQing");dialog.setMiddle(),dialog.show(),dialog.nodes.openQing.onclick=function(){setTimeout((function(){dialog.close(),dialog.onclick=null,dialog=null}),200)},dialog.nodes.cancel.onclick=function(){setTimeout((function(){dialog.close(),dialog.onclick=null,dialog=null}),200)}},showShareToQingFailure:function(){winDialog.alert("对不起，转载至Qing博客失败。",{icon:"01",funcOk:function(){}})},onSuccess:function(aId){},onError:function(){}},$registJob("renderReblogDiv",(function(){var _addEvent=Core.Events.addEvent,_getEventTarget=Core.Events.getEventTarget,_getXY=Core.Dom.getXY,delegateEl,delegateElId,cls="",isNew="article_new"==scope.$pageid||"articleM_new"==scope.$pageid,reblogDivId="reblog_"+ +new Date;isNew&&(cls="oper_list");var reblogDivInnerHTML='<ul class="'+cls+'"><li><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载到博客">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>')+'博客</a></li><li style="display:none;"><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'toBlog\'}" href="javascript:void(0);" title="转载原文">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon141"/>')+'转载原文</a></li><li><a suda-uatrack="key=blog_article&value=h_article17" action-type="click_reblog" action-data="{action:\'cwb\'}" href="javascript:;" title="发布长微博">'+(isNew?"":'<img width="18" height="18" align="absmiddle" src="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon143"/>')+"长微博</a></li></ul>",reblogDiv=SinaEx.createNode('<div id="'+reblogDivId+'" class="turnList" style="display:none;position:absolute;z-index:20;">'+reblogDivInnerHTML+"</div>");document.body.appendChild(reblogDiv);var getActionData=Lib.util.getActionData,sinablogbody=$E("sinablogbody"),idCard,reblogBtn,isIdCard=!1,isValidateIdentity=0,onMouseOverReblogBtn=function(e){var srcEl=$E(this.id),tEl=_getEventTarget(e),eventData=getActionData(e,"reblog");if(eventData){$E("sinablogbody").setAttribute("ismouseover","1");var data=eval("("+eventData.data+")");reblogBtn=eventData.targetEl.parentNode.parentNode,setTimeout((function(){var isMouseHover=$E("sinablogbody").getAttribute("ismouseover")||0;if(isMouseHover=parseInt(isMouseHover)||parseInt($E(reblogDivId).getAttribute("ismouseover")||0)){isNew&&(eventData.targetEl.className="lk_a lka_last lka_hover");var reblogDiv=$E(reblogDivId),pos=_getXY(eventData.targetEl);reblogDiv.style.display="",reblogDiv.style.top=pos[1]+23+"px",$IE6||$IE7?reblogDiv.style.left=pos[0]-2+"px":reblogDiv.style.left=pos[0]+"px",reblogDiv.setAttribute("blogId",data.blogId);var sameVariable=reblogDiv.children[0];Lib.checkAuthor((function(){setTimeout((function(){if(data.srcBlog?sameVariable.children[1].style.display="none":(sameVariable.children[0].style.display="none",$isAdmin?sameVariable.children[1].style.display="none":sameVariable.children[1].style.display=""),(!isIdCard||!reblogBtn.getAttribute("isshow"))&&"1"==data.srcBlog&&$isLogin){if(isValidateIdentity)return;Utils.Io.Ijax.request("//control.blog.sina.com.cn/blog_rebuild/riaapi/blog/qingEditing.php",{onComplete:function(data){var result=Core.String.j2o(data);"A00006"===result.code&&(idCard=result.data.message)&&(sameVariable.children[3].style.display=""),isIdCard=!0,reblogBtn.setAttribute("isshow","1")}})}}),2)}),"renderReblogDiv"+(new Date).getTime())}}),400)}},onMouseOutReblogBtn=function(e){$E(this.id),_getEventTarget(e);var eventData=getActionData(e,"reblog");if(eventData&&($E("sinablogbody").setAttribute("ismouseover","0"),!(timer=$E("sinablogbody").getAttribute("timer"))))var timer=setInterval((function(){var isMouseHover=$E("sinablogbody").getAttribute("ismouseover")||0,isReblogDivMouseHover=$E(reblogDivId).getAttribute("ismouseover")||0;(isMouseHover=parseInt(isMouseHover)||parseInt(isReblogDivMouseHover))||($E(reblogDivId).style.display="none",$E("sinablogbody").removeAttribute("timer"),isNew&&(eventData.targetEl.className="lk_a lka_last"),clearInterval(timer))}),1e3)},MOUSEOVER="mouseover",MOUSEOUT="mouseout",addModuleMouseEvent=function(moduleId){if($E(moduleId))try{"articletjTech"!==scope.$pageid&&"article_new"!=scope.$pageid&&"articleM_new"!=scope.$pageid||(moduleBody=$E(moduleId),_addEvent(moduleBody,Core.Function.bind2(onMouseOverReblogBtn,moduleBody),MOUSEOVER),_addEvent(moduleBody,Core.Function.bind2(onMouseOutReblogBtn,moduleBody),MOUSEOUT));var moduleBody=$E(moduleId).children[1];moduleBody&&"SG_connBody"==moduleBody.className&&(moduleBody.id=moduleId+"_SG_connBody",_addEvent(moduleBody,Core.Function.bind2(onMouseOverReblogBtn,moduleBody),MOUSEOVER),_addEvent(moduleBody,Core.Function.bind2(onMouseOutReblogBtn,moduleBody),MOUSEOUT))}catch(e){trace("注册转载博问按钮事件代理出错，组件ID："+moduleId)}else trace("没有组件："+moduleId)};addModuleMouseEvent("module_10001"),addModuleMouseEvent("module_10002"),addModuleMouseEvent("module_10003"),addModuleMouseEvent("module_920"),addModuleMouseEvent("module_921"),addModuleMouseEvent("module_3001_SG_connBody"),addModuleMouseEvent("module_920_SG_connBody");var onMouseOverReblogDiv=function(e){$E(reblogDivId).setAttribute("ismouseover",1)},onMouseOutReblogDiv=function(e){$E(reblogDivId).setAttribute("ismouseover",0)};function showError(icon,ico){if(icon.message)var msg=icon.message;winDialog.alert(msg,{icon:ico||"01"})}_addEvent(reblogDiv,onMouseOverReblogDiv,MOUSEOVER),_addEvent(reblogDiv,onMouseOutReblogDiv,MOUSEOUT),!scope.article_quote&&(scope.article_quote=new Quote),scope.articel_quote_alert=function(articleID){scope.article_quote.check(articleID)};var reblogToQing=new ReblogToQing,reblog=function(e){var srcEl=$E(reblogDivId),tEl=_getEventTarget(e),eventData=getActionData(e,"click_reblog");if(eventData&&"1"!==reblogBtn.getAttribute("isreblog")){var blogId=$E(reblogDivId).getAttribute("blogId"),data=eval("("+eventData.data+")");"cwb"===data.action?window.open("//control.blog.sina.com.cn/admin/article/changWeiBo.php?url="+encodeURIComponent("//blog.sina.com.cn/s/blog_"+blogId+".html")):scope.articel_quote_alert(blogId),v7sendLog&&v7sendLog("79_01_22",scope.$pageid,"qingLink")}};_addEvent(reblogDiv,reblog,"click"),reblogDiv=null,delegateEl=null})),$registJob("adNoticeChannel",(function(){Core.Events.addEvent;var listener=Lib.Listener,pageId=scope.$pageid,refer=(window.location.href.indexOf("tj=1"),document.referrer);if(refer){var host=refer.match(/(\:\/\/)(.*?)(\/)/g);refer=host&&host[0].replace(/(\:\/\/){0,}(\/){0,}/g,"")}else refer="";Lib.checkAuthor((function(){Utils.Io.JsLoad.request("//comet.blog.sina.com.cn/api?maintype=load_channel",{GET:{uid:$UID,bloguid:scope.$uid,refer:refer},onComplete:function(result){result&&"A00006"===result.code&&(scope.$channel=result.data,"article_new"!=pageId&&"articleM_new"!=pageId&&"article"!==pageId&&"articleM"!==pageId&&"index"!==pageId&&"indexM"!==pageId&&"articlelist"!==pageId&&"articlelistM"!==pageId&&"wanwan_index"!==pageId&&"articlepreview_new"!==pageId||listener.notify("notice_ad_layer",scope.$channel||{}),listener.notify("ad_show_hide_conditions",scope.$channel||{}))}})}),"adNoticeChannel"+(new Date).getTime())})),function(){var toStyleAttribute=function(styleName){for(var arr=styleName.split("-"),cc=arr[0],i=1;i<arr.length;i++)cc+=arr[i].charAt(0).toUpperCase()+arr[i].substring(1);return cc};Core.Dom.setStyle2=function(elem,style){for(var name in"string"==typeof elem&&(elem=$E(elem)),style)styleAttr=toStyleAttribute(name),Core.Dom.setStyle(elem,styleAttr,style[name])}}(),$registJob("blogNotice",(function(){var logFlag,showFlag,$logo=$E("login_bar_logo_link_350"),__addEvent=Core.Events.addEvent,__removeEvent=Core.Events.removeEvent,__setCookie=Utils.Cookie.setCookie,__getCookie=Utils.Cookie.getCookie,_setStyle=Core.Dom.setStyle,listener=Lib.Listener,flagUid=__getCookie("closeNotice_fzp");Lib.checkAuthor((function(){if(!flagUid||flagUid!==$UID){var pageid=scope.$pageid;scope.$uid,window.location.href.indexOf("tj=1");if($logo&&"ntopbar_main"===$logo.parentNode.className)listener.on({name:"notice_ad_layer",callBack:function(json){listener.notify("tray-announce-loaed",json)}});else{var _guide,dd=document.documentElement,template={guideLayer:'<div class="l_hornbg" id="#{guideLayer}" style="display:none;"><div class="l_horn"><span class="close" title="关闭" id="#{close}">&times;</span><div class="horn1" id="#{noticeLayer}" style="display:none;"><div class="horn_left"><span class="horn_icon" id="#{noticeIcon}"></span></div><div class="horn_right" id="#{noticeAdLayer}">推荐：<a href="" target="blank" id="#{noticeAdCon1}" onclick="v7sendLog(\'48_01_12\');"></a><a href="" target="blank" id="#{noticeAdCon2}" onclick="v7sendLog(\'48_01_13\');"></a></div></div><div class="horn2" id="#{adLayer}">推荐：<a href="" target="blank" id="#{adContent1}" onclick="v7sendLog(\'48_01_12\');"></a><a href="" target="blank" id="#{adContent2}" onclick="v7sendLog(\'48_01_13\');"></a></div></div></div>'},option={mid:{"z-index":"500",position:$IE6?"absolute":"fixed"}},noticeCSSUrl=$_GLOBAL.cssBasicURL+"module/layer/layer24.css";Utils.Io.loadExternalCSS(noticeCSSUrl);function funcShowNotice(){document.body.scrollTop+document.documentElement.scrollTop>height?(!function(el){if(!showFlag){showFlag=1;var tween=new Ui.TweenStrategy(0,1,.6,(function(t,b,c,d){return-c*(t/=d)*(t-2)+b}));tween.onTween=function(val){_setStyle(el,"opacity",val)},tween.onEnd=function(){$IE?el.style.filter="none":_setStyle(el,"opacity","none")},_setStyle(el,"opacity",0),el.style.display="block",tween.start()}}(_guide.guideLayer),$IE6||(_guide.guideLayer.style.top="0"),logFlag||(logFlag=1,v7sendLog("48_01_11_"+scope.$pageid))):function(el){if(showFlag){showFlag=0;var tween=new Ui.TweenStrategy(1,0,.6,(function(t,b,c,d){return-c*(t/=d)*(t-2)+b}));tween.onTween=function(val){_setStyle(el,"opacity",val)},tween.onEnd=function(){$IE?el.style.filter="none":_setStyle(el,"opacity","none"),el.style.display="none"},tween.start()}}(_guide.guideLayer)}function ie6Fixed(){_guide.guideLayer.style.top=document.documentElement.scrollTop+"px",_guide.guideLayer.style.left="0px"}listener.on({name:"notice_ad_layer",callBack:function(json){var obj;_guide=Utils.insertTemplate($E("sinabloga"),template.guideLayer,"BeforeBegin"),obj=_guide.guideLayer,Core.Dom.setStyle2(obj,option.mid),$IE6&&(_guide.guideLayer.style.position="absolute",dd.style.backgroundImage="url(ablout:blank)",dd.style.backgroundAttachment="fixed",__addEvent(window,ie6Fixed,"scroll")),__addEvent(window,funcShowNotice,"scroll"),function(result){if($isLogin&&result.announce.result&&("indexM"===pageid||"articleM"===pageid||"articlelistM"===pageid)){_guide.noticeLayer.style.display="",_guide.adLayer.style.display="none";var info=result.announce;Core.Dom.insertHTML(_guide.noticeIcon,info.announce_con,"AfterEnd")}else _guide.adLayer.style.display="";if(result.advertise){var adInfo=result.advertise,adCon1=decodeURIComponent(adInfo.advertise_con1.content),adCon2=decodeURIComponent(adInfo.advertise_con2.content),adHref1=decodeURIComponent(adInfo.advertise_con1.link),adHref2=decodeURIComponent(adInfo.advertise_con2.link);_guide.noticeAdCon1.innerHTML=adCon1,_guide.noticeAdCon1.href=adHref1,_guide.noticeAdCon2.innerHTML=adCon2,_guide.noticeAdCon2.href=adHref2,_guide.adContent1.innerHTML=adCon1,_guide.adContent1.href=adHref1,_guide.adContent2.innerHTML=adCon2,_guide.adContent2.href=adHref2,_guide.close&&__addEvent(_guide.close,(function(){__setCookie("closeNotice_fzp",$UID,24,"/",".blog.sina.com.cn"),Core.Dom.removeNode(_guide.guideLayer),__removeEvent(window,funcShowNotice,"scroll"),__removeEvent(window,ie6Fixed,"scroll"),scope.$channel=null}))}}(json)}})}}}),"blogNotice"+(new Date).getTime())})),Ui.LayerCount=function(){var zIndex=500;return function(type){return"mode"===type?1024:(zIndex+=24)>1024?974:zIndex}}(),Lib.OnlyShadow=function(opacity,parent,id,cfg){this.entity=null,this.parent=parent||document.body,cfg=Lib.apply({zIndex:1024,backgroundColor:"black"},cfg),this._ie6Fixed=function(){if(_this.entity){_this.entity.style.top=document.documentElement.scrollTop+"px";var left=document.documentElement.scrollLeft-_this._ie6EntityXY[0],wholeWidth=left+_this.entity.offsetWidth,scrollWidth=document.documentElement.scrollWidth||document.body.scrollWidth;wholeWidth<=scrollWidth&&(_this.entity.style.left=left+"px"),_this.ifm&&(_this.ifm.style.top=_this.entity.style.top,wholeWidth<=scrollWidth&&(_this.ifm.style.left=_this.entity.style.left))}};var _this=this;this.resetShadowDiv=Core.Function.bind3((function(){_this.entity&&setTimeout((function(){if(_this.updateSize(),$IE6&&_this.isShow()){_this.entity.style.left="0px";var xy=Core.Dom.getXY(_this.entity);_this._ie6EntityXY=xy,_this._ie6Fixed()}}),1)}),this),this._create=function(){if(_this.entity=$C("div"),id&&(_this.entity.id=id),_this.entity.style.position="absolute",_this.entity.style.width=_this.getAreaWidth()+"px",_this.entity.style.height=_this.getAreaHeight()+"px",_this.entity.style.left="0px",_this.entity.style.top="0px",_this.entity.style.zIndex=cfg.zIndex,_this.entity.style.backgroundColor=cfg.backgroundColor,_this.parent.appendChild(_this.entity),_this._setOpacity(_this.entity,isNaN(opacity)?.5:opacity),$IE6){var xy=Core.Dom.getXY(_this.entity);_this._ie6EntityXY=xy;var left=document.documentElement.scrollLeft-_this._ie6EntityXY[0];_this.entity.style.left=left+"px"}_this.addIframe(),Core.Events.addEvent(window,_this.resetShadowDiv,"resize"),_this.setFixed(!0),_this.hidden()},id&&$E(id)?_this.entity=$E(id):_this._create()},Lib.OnlyShadow.prototype={isShow:function(){return this.entity.offsetHeight>0},show:function(){if(this.entity.style.display="",this.ifm&&(this.ifm.style.display=""),$IE6){this.updateSize(),this.entity.style.left="0px";var xy=Core.Dom.getXY(this.entity);this._ie6EntityXY=xy,this._ie6Fixed()}this.onShow()},hidden:function(){this.entity.style.display="none",this.ifm&&(this.ifm.style.display="none"),this.onHidden()},close:function(){this.hidden(),this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll"),Core.Events.removeEvent(window,this.resetShadowDiv,"resize"),this.entity.parentNode.removeChild(this.entity),this.entity=null,this.ifm&&(this.ifm.parentNode.removeChild(this.ifm),this.ifm=null)},addIframe:function(){this.ifm=$C("iframe"),this._setOpacity(this.ifm,0),this.ifm.style.position="absolute",this.ifm.style.zIndex=this.entity.style.zIndex,this.ifm.style.left=this.entity.style.left,this.ifm.style.top=this.entity.style.top,this.ifm.style.width=this.entity.style.width,this.ifm.style.height=this.entity.style.height,this.entity.parentNode.insertBefore(this.ifm,this.entity)},insertBefore:function(obj){obj.parentNode.insertBefore(this.entity,obj),this.ifm&&this.entity.parentNode.insertBefore(this.ifm,this.entity)},updateSize:function(){var width=this.getAreaWidth(),height=this.getAreaHeight();this.entity.style.width=width+"px",this.entity.style.height=height+"px",this.ifm&&(this.ifm.style.width=width+"px",this.ifm.style.height=height+"px")},getAreaHeight:function(){return Math.max(document.documentElement.clientHeight,document.body.clientHeight)},getAreaWidth:function(){return document.documentElement.clientWidth||document.body.clientWidth},setFixed:function(state){if($IE6){state?(this._ie6Fixed(),Core.Events.addEvent(window,this._ie6Fixed,"scroll")):Core.Events.removeEvent(window,this._ie6Fixed,"scroll")}else this.entity.style.position=state?"fixed":"absolute"},_setOpacity:function(obj,v){$IE?obj.style.filter="alpha(opacity="+100*v+")":obj.style.opacity=v},onShow:function(){},onHidden:function(){}},Article.SlideTJCover=function(cfg){var args=arguments,o=args.callee._instance;if(this.cfg=cfg=Lib.apply(this.cfg||{},cfg),o)return o;var __this=this;args.callee._instance=this;var addImg=function(id,src,blogId){var img=new Image;img.src=src,$E(id).setAttribute("blogId",blogId);img.complete?$E(id).src=src:($E(id).src=pixPic,img.onload=function(){!function(id,src){$E(id).getAttribute("blogId")===blogId&&($E(id).src=src)}(id,src)},img.onerror=function(){$E(id).src="//s4.sinaimg.cn/image/default_cover.gif#4"})},setTitle=function(el,title,blogId){var href;title=title||"查看原文",(el=$E(el)).textContent?el.textContent=title:el.innerText=title,href=blogId?"//blog.sina.com.cn/s/blog_"+blogId+".html":"javascript:;",el.href=href},fixLayerPos=function(containerEl,el){var top=(containerEl.offsetHeight-el.offsetHeight)/2,left=(containerEl.offsetWidth-el.offsetWidth)/2;top<0&&(top=0),el.style.top=top+"px",left<0&&(left=0),el.style.left=left+"px"},setActionData=function(id,data,time,action){data&&$E(id).setAttribute("action-data",encodeURIComponent(data+"###"+time+"###"+action))},hidePageBtn=function(direction){$E(nodeIds[direction+"Btn"]).style.visibility="hidden"},showPageBtn=function(){$E(nodeIds.nextBtn).style.visibility="",$E(nodeIds.preBtn).style.visibility=""},hideNextArea=function(direction){setTitle(nodeIds[direction+"Title"],""),addImg(nodeIds[direction+"Img"],"//simg.sinajs.cn/blog7style/images/common/sg_trans.gif"),setActionData(nodeIds[direction+"Btn"],""),$E(nodeIds[direction+"Img"]).style.visibility="hidden",$E(nodeIds[direction+"Title"]).style.visibility="hidden",hidePageBtn(direction)},convertUrl=function(url){var groups=url.match(/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/);if(!groups)return url;switch(groups[1]){case"bmiddle":return url.replace(/\/bmiddle\//,"/cover/");case"mw690":return url.replace(/\/mw690\//,"/cover/");case"middle":return url.replace(/\/middle\//,"/cover/");case"mw600":return url.replace(/\/mw600\//,"/cover/");default:return url}},pixPic="//simg.sinajs.cn/blog7style/images/common/sg_trans.gif",_tplStr='<div id="#{entity}" class="showEnd" style="position:absolute;visibility:hidden;"><div class="tit"><strong>该篇博文浏览结束</strong><a id="#{review}" href="javascript:;" class="replay" title="重新浏览" hidefocus="true"></a></div><div class="pages"><a id="#{preBtn}" href="javascript:void(0);" class="preview" action-type="show-next-tj" hidefocus="true">&lt;&lt;上一篇</a><a id="#{nextBtn}" href="javascript:void(0);" class="next" action-type="show-next-tj" hidefocus="true">下一篇&gt;&gt;</a></div><div class="content"><ul><li><a id="#{preImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{preImg}" src="'+pixPic+'" /></a><a id="#{preTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li><li class="nomgr"><a id="#{nextImgBtn}" action-type="show-next-slide" href="javascript:;" hidefocus="true"><img id="#{nextImg}" src="'+pixPic+'" /></a><a id="#{nextTitle}" href="javascript:;" target="_blank" hidefocus="true">标题</a></li></ul></div></div>',tpl=(document,new Lib.HtmlTemplate(_tplStr));Core.Dom.addHTML(cfg.renderTo,tpl.getHtmlString());var nodeIds=tpl.getNodeIds(),_addEvent=Core.Events.addEvent;_addEvent($E(nodeIds.review),function(){v7sendLog("49_01_06"),this.cfg.review(this)}.bind2(this)),_addEvent($E(nodeIds.preBtn),(function(){v7sendLog("49_01_07")})),_addEvent($E(nodeIds.nextBtn),(function(){v7sendLog("49_01_08")})),_addEvent($E(nodeIds.preImgBtn),(function(){v7sendLog("49_01_09")})),_addEvent($E(nodeIds.nextImgBtn),(function(){v7sendLog("49_01_10")})),_addEvent($E(nodeIds.entity),(function(e){var datas=Lib.util.getActionData(e,"show-next-slide");if(datas){var blogId=decodeURIComponent(datas.data).split("###")[0];(new Article.MultipleImgLayer).showNextSlide(blogId)}})),_addEvent($E(nodeIds.entity),(function(e){var datas=Lib.util.getActionData(e,"show-next-tj");if(datas){var data=decodeURIComponent(datas.data).split("###"),blogId=data[0],time=data[1]||"",action=data[2]||"next",layer=new Article.MultipleImgLayer;return layer.setDirection("next"),layer.getNextSlideData(blogId,time,(function(data){data.pre.blogId||data.next.blogId?(showPageBtn(),__this.show(data)):hidePageBtn(action)}),action),!1}}));var _that={isHidden:!0,getEntity:function(){return $E(nodeIds.entity)},fixPos:function(){this.isHidden||fixLayerPos(this.cfg.renderTo,this.getEntity())},show:function(data){var coEl=$E(nodeIds.preImgBtn).parentNode.parentNode.parentNode,btnEl=$E(nodeIds.preBtn).parentNode;data?(coEl.style.display="",btnEl.style.display=""):(coEl.style.display="none",btnEl.style.display="none",data={});var containerEl=this.cfg.renderTo,el=this.getEntity();if(0==el.offsetHeight||0==el.offsetWidth)return!1;fixLayerPos(containerEl,el),this.isHidden=!1,el.style.visibility="inherit";var preTitleEl=$E(nodeIds.preTitle),nextTitleEl=$E(nodeIds.nextTitle),isHiddenBg=!1;if(data.pre&&data.pre.images&&data.pre.images.length>0){var preBlogId=data.pre.blogId,prePubTime=data.pre.publishTime;$E(nodeIds.preTitle).style.visibility="inherit",setTitle(preTitleEl,data.pre.title,preBlogId),addImg(nodeIds.preImg,convertUrl(data.pre.images[0]),preBlogId),$E(nodeIds.preImg).style.visibility="inherit",setActionData(nodeIds.preBtn,preBlogId,prePubTime,"pre"),$E(nodeIds.preBtn).style.visibility="inherit",setActionData(nodeIds.preImgBtn,preBlogId)}else isHiddenBg=!0,hideNextArea("pre");if(data.next&&data.next.images&&data.next.images.length>0){var nextBlogId=data.next.blogId,nextPubTime=data.next.publishTime;$E(nodeIds.nextTitle).style.visibility="inherit",setTitle(nextTitleEl,data.next.title,nextBlogId),addImg(nodeIds.nextImg,convertUrl(data.next.images[0]),nextBlogId),$E(nodeIds.nextImg).style.visibility="inherit",setActionData(nodeIds.nextBtn,nextBlogId,nextPubTime,"next"),$E(nodeIds.nextBtn).style.visibility="inherit",setActionData(nodeIds.nextImgBtn,nextBlogId)}else isHiddenBg=!0,hideNextArea("next");return isHiddenBg?coEl.style.backgroundImage="none":$IE6?coEl.style.backgroundImage="url("+orURL+")":coEl.style.background="url("+orURL+") 235px 100px no-repeat",this.cfg.data=data,!0},hide:function(){return this.getEntity().style.visibility="hidden",this.isHidden=!0,!0}},orURL="//simg.sinajs.cn/blog7style/images/common/multishow_or."+(6==$IE?"gif":"png");Lib.apply(this,_that)},Lib.register("diYuanXinLog",(function(){var isLoading,isLoadScript=!1,cache=[],url="//sjs.sinajs.cn/xblogtheme/js/di_yuan_xin.js?ver="+("undefined"!=typeof $_GLOBAL&&null!=$_GLOBAL.ver&&$_GLOBAL.ver.di_yuan_xin||"-1")+".js";isLoadScript=function(){Utils.Io.JsLoad.request(url,{isRemove:!1,noreturn:!0,onComplete:function(){isLoading=!1,isLoadScript=!0;for(var i=0,len=cache.length;i<len;i++)cache[i]();cache=[]}})};return function(fun){!0===isLoadScript?fun():!0===isLoading?cache.push(fun):(cache.push(fun),isLoadScript())}})),Article.MultipleImgLayer=function(cfg){var args=arguments,o=args.callee._instance;if(o)return o;args.callee._instance=this;var me=this,showScroller=function(){$IE6?document.body.removeAttribute("scroll"):(document.documentElement.style.overflow="auto",!$IE8&&(document.body.style.overflow="auto")),$FF&&(document.documentElement.scrollTop=me.scrollTop)},getWinSize=function(){var clientSize=function(name){var doc=document,docElemProp=doc.documentElement["client"+name],body=doc.body;return"CSS1Compat"===doc.compatMode&&docElemProp||body&&body["client"+name]||docElemProp};return{height:clientSize("Height"),width:clientSize("Width")}},showLoading=function(winSize){var loadingEl=$E(layerNodesId.multiPicLoading),height=Math.max(winSize.height,500),width=Math.max(winSize.width,500);loadingEl.style.top=(height-181)/2+"px",loadingEl.style.left=(width-141)/2+"px",removeCurrentPic()},updateWinPosAndSize=function(entity){var winSize=getWinSize(),height=Math.max(winSize.height,500),width=Math.max(winSize.width,500),doc=document,scrollHeight=doc.documentElement.scrollTop+doc.body.scrollTop;entity.style.height=height+"px",entity.style.width=width+"px",entity.style.top=scrollHeight+"px",$E(layerNodesId.multiPicContent).style.height=height-88+"px"},getCurrentPic=function(){for(var img,pics=$E(layerNodesId.multiPicContent).getElementsByTagName("IMG"),i=0,l=pics.length;i<l;i++)if((img=pics[i]).getAttribute("origin-size"))return img;return null},removeCurrentPic=function(){var curentPic=getCurrentPic();curentPic&&curentPic.parentNode.removeChild(curentPic)},setCurrentPicSize=function(winSize,imageEl){var maxHeight=Math.max(winSize.height-88,412),maxWidth=Math.max(winSize.width,500),imgHeight=imageEl.height,imgWidth=imageEl.width;imageEl.setAttribute("origin-size",imgWidth+"*"+imgHeight);var hPercent=(winSize.height-88)/imgHeight,wPercent=winSize.width/imgWidth;if(isFinite(hPercent)&&isFinite(wPercent)){var width,height;1>hPercent&&hPercent<wPercent?(width=(height=Math.min(imgHeight,maxHeight))/imgHeight*imgWidth,imageEl.height=height,imageEl.width=width):1>wPercent&&(height=(width=Math.min(imgWidth,maxWidth))/imgWidth*imgHeight,imageEl.width=width,imageEl.height=height),$IE&&$IE<8&&(imageEl.style.zoom=1)}},setCurrentPicPos=function(containerEl,el){if(0!=el.offsetHeight&&0!=el.offsetWidth){var top=(containerEl.offsetHeight-el.offsetHeight)/2,left=(containerEl.offsetWidth-el.offsetWidth)/2;top<0&&(top=0),el.style.top=top+"px",left<0&&(left=0),el.style.left=left+"px",trace("left: "+left+" top:"+top);var oPicEl=$E(layerNodesId.orignalPic);oPicEl.style.top=top+10+"px",oPicEl.style.left=left+10+"px"}},hideOrignalLink=function(){$E(layerNodesId.orignalPic).style.visibility="hidden"},tipsShow=!1,showError=function(msg,okCb,closeCb){tipsShow||(tipsShow=!0,winDialog.alert(msg,{icon:"01",textOk:"知道了",funcOk:function(){errorCount=0,tipsShow=!1,goToNextPic(),okCb&&okCb()},funcClose:function(){errorCount=0,tipsShow=!1,goToNextPic(),closeCb&&closeCb()}},"slide-box-tips"))},showTooSmall=function(msg){isHidden||(smallCount=0,showError(msg||"图片太小啦，无法展示！"))},currentSrc="",showPic=function(imgUrl,len,index,img){if(!isHidden){var src=convertUrl(imgUrl.url);if(!img)(img=new Image).src=src;currentSrc=src;var indexHtml="<em>"+(currentPicIndex+1)+"</em>/<span>"+len+"</span>";$E(layerNodesId.multiPicIndex).innerHTML=indexHtml,removeCurrentPic();var winSize=getWinSize();img.style.top="-10000px",img.style.position="absolute",imgContainer.appendChild(img);var image,pn,isRightSize=img.width>200||img.height>200;if(!$IE6&&isRightSize||img.complete&&isRightSize)_setStyle(img,"opacity",.5),$E(layerNodesId.multiPicLoading).style.top="-1000px",setTimeout((image=img,pn=$E(layerNodesId.multiPicContent),function(){image.src===currentSrc?(function(src){var gImg="___$image"+(new Date).getTime(),img=window[gImg]=new Image;blogId=$E(layerNodesId.multiPicLike).getAttribute("blog-id"),img.src="//control.blog.sina.com.cn/riaapi/article/filmslide.php?"+gImg+"&blogId="+blogId+"&img="+src,img.onload=img.onerror=function(){img=null,window[gImg]=null}}(image.src),image.setAttribute("action-type","show-large-layer"),image.setAttribute("action-data",encodeURIComponent(image.src)),pn.appendChild(image),setTimeout((function(){setCurrentPicSize(getWinSize(),image),setCurrentPicPos(pn,image);var tween=new Ui.TweenStrategy(.5,1,.5);tween.onTween=function(v){if(img.src!==currentSrc)return image.parentNode&&image.parentNode.removeChild(image),tween.stop(),void(image=null);_setStyle(image,"opacity",v)},tween.start(),function(src){src.match(/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/large/),$E(layerNodesId.orignalLink).href=src}(image.src)}))):imgContainer.removeChild(image)}));else{args=arguments,showLoading(winSize);var count=0,t=setInterval(function(image,i){return function(){if(_images){var isRightSize=image.offsetWidth>200||image.offsetHeight>200,time=15*count/1e3;count++;var isSmall=image.complete&&image.width>0&&image.height>0&&image.width<200&&image.height<200;if(isSmall&&!_images[i].recordSmall&&(smallCount++,_images[i].recordSmall=1),_images&&_images.length==smallCount+errorCount)return clearInterval(t),void(0==errorCount&&showTooSmall());if(time>5||isSmall)return clearInterval(t),errorCount++,void(i===currentPicIndex&&(removeCurrentPic(),goToNextPic()));if(image.complete&&isRightSize){clearInterval(t);for(var params=[],l=0,len=args.length;l<len;l++)params.push(args[l]);return params.push(image),void args.callee.apply(null,params)}}else clearInterval(t)}}(img,index),15);img.onerror=function(i){return function(e){if(_images[i].recordError||(errorCount++,_images[i].recordError=1),errorCount+smallCount>=len)return clearInterval(t),void showError("抱歉，图片读取失败。");img.onerror=null,removeCurrentPic(),goToNextPic()}}(index)}}},goToNextPic=function(){"pre"===$E(layerNodesId.multiPicEntity).getAttribute("direction")?prePic():nextPic()},convertUrl=function(url){var groups=url.match(/(?:(?:ww\d+|s\d+).sinaimg.cn|photo\.sina\.com\.cn)\/(mw690|mw600|middle|bmiddle)/);if(!groups)return url;switch(groups[1]){case"bmiddle":return url.replace(/\/bmiddle\//,"/large/");case"mw690":return url.replace(/\/mw690\//,"/large/");case"middle":return url.replace(/\/middle\//,"/large/");case"mw600":return url.replace(/\/mw600\//,"/large/");default:return url}},loadingNextPic=function(imgUrls,sum){for(var imgUrl=null,count=Math.abs(sum),i=(imgUrls.length,1);i<count;i++){var index=sum>0?currentPicIndex+i:currentPicIndex-i;(imgUrl=imgUrls[index])&&0===imgUrl.loaded&&function(src,pos){setTimeout((function(){var img=new Image;img.onload=img.onerror=function(){img=null},img.src=src,_images[pos].loaded=1}),40)}(convertUrl(imgUrl.url),index)}},hideLayer=function(evt){if(evt&&"IMG"===Core.Events.getEventTarget(evt).nodeName.toUpperCase())return;tjCover&&tjCover.hide(),imgContainer&&(imgContainer.innerHTML="",document.body.removeChild(imgContainer),imgContainer=null),isHidden=!0;getWinSize();showScroller(),$E(layerNodesId.multiPicEntity).style.display="none",mask.hidden(),_images=[],currentPicIndex=0,errorCount=0,smallCount=0,null,__this.data=null,loginUi&&loginUi.dialog&&loginUi.dialog.hidden()},isTJShow=!1,setHidden=function(id){$E(id).style.visibility="hidden"},setVisible=function(id){$E(id).style.visibility="inherit"},showBorder=function(){setVisible(layerNodesId.multiPicLike),setVisible(layerNodesId.multiPicTitle),setVisible(layerNodesId.multiPicIndex),setVisible(layerNodesId.multiPicNext),setVisible(layerNodesId.multiPicPre)},hideTJCover=function(){tjCover&&tjCover.hide()},showTJCover=function(direction){isTJShow=!0;var currentImg=getCurrentPic();currentImg&&(currentImg.style.visibility="hidden",currentImg=null),function(direction){setHidden(layerNodesId.multiPicLike),setHidden(layerNodesId.multiPicTitle),setHidden(layerNodesId.multiPicIndex),setHidden("next"===direction?layerNodesId.multiPicNext:layerNodesId.multiPicPre)}(direction),hideOrignalLink(),tjCover||(tjCover=new Article.SlideTJCover({renderTo:$E(layerNodesId.multiPicContent),review:function(){showBorder(),currentPicIndex=-1,nextPic(),tjCover.hide()}}));var blogId=$E(layerNodesId.multiPicEntity).getAttribute("blog-id"),blogLink=$E(layerNodesId.multiPicTitle),time=decodeURIComponent(blogLink.getAttribute("publish-time")||"");__this.getNextSlideData(blogId,time,(function(data){tjCover.show(data)}),"")},prePic=function(evt){evt&&Core.Events.stopEvent(evt),Lib.sendSuda((function(){try{SUDA.log("","blog_slide_page")}catch(e){}})),Lib.diYuanXinLog((function(){try{vjEventTrack("")}catch(e){}}));var len=_images.length;if(currentPicIndex<=0)return showTJCover("pre"),void(currentPicIndex=-1);currentPicIndex--,isTJShow&&hideTJCover(),isTJShow&&showBorder(),isTJShow=!1;var img=_images[currentPicIndex];showPic(img,len,currentPicIndex),$E(layerNodesId.multiPicEntity).setAttribute("direction","pre"),loadingNextPic(_images,-3)},nextPic=function(evt){Lib.sendSuda((function(){try{SUDA.log("","blog_slide_page")}catch(e){}})),Lib.diYuanXinLog((function(){try{vjEventTrack("")}catch(e){}})),evt&&Core.Events.stopEvent(evt);var len=_images.length;if(currentPicIndex>=len-1)return showTJCover("next"),void(currentPicIndex=len);currentPicIndex++,isTJShow&&hideTJCover(),isTJShow&&showBorder(),isTJShow=!1;var img=_images[currentPicIndex];showPic(img,len,currentPicIndex),$E(layerNodesId.multiPicEntity).setAttribute("direction","next"),loadingNextPic(_images,3)},zIndex=99999+parseInt(Ui.LayerCount()||0,10),_tplStr='<div id="#{multiPicEntity}" class="dialogMultiShow"                 style="display:none;z-index:'+(zIndex+1)+';">              <a id="#{multiPicClose}" href="javascript:void(0);" title="关闭" class="close" style="z-index:'+(zIndex+2)+'" hidefocus="true">关闭</a>              <a id="#{multiPicPre}" href="javascript:void(0);" class="btn_preview" style="z-index:'+(zIndex+2)+'" hidefocus="true"></a>              <a id="#{multiPicNext}" href="javascript:void(0);" class="btn_next" style="z-index:'+(zIndex+2)+'" hidefocus="true"></a>              <a id="#{multiPicLike}" href="javascript:void(0);" class="ico_unlike" style="z-index:'+(zIndex+2)+';display:none;" hidefocus="true">喜欢</a>              <div class="bd">                <div id="#{multiPicIndex}" class="count"><em>5</em>/<span>20</span></div>                <div id="#{multiPicContent}" class="pic" style="position:relative;">                    <div class="con" id="#{orignalPic}" style="position:absolute;z-index:1025;">                        <a id="#{orignalLink}" target="_blank" href="#" class="opic" title="查看原图"  hidefocus="true">查看原图</a>                    </div>                    <div id="#{multiPicLoading}" class="loadding" style="top:-10000px;">图片加载中......</div>                </div>                <div class="title"><a id="#{multiPicTitle}" target="_blank" href="javascript:void(0);"  hidefocus="true">标题</a></div>              </div>            </div>',doc=document,mask=null,__this=this,tpl=new Lib.HtmlTemplate(_tplStr),layerNodesId=tpl.getNodeIds(),layerHtml=tpl.getHtmlString(),errorCount=0,smallCount=0,_images=[],_addEvent=Core.Events.addEvent,_setStyle=Core.Dom.setStyle,isHidden=!0,currentPicIndex=0,tjCover=null;Utils.Io.loadExternalCSS("//simg.sinajs.cn/blog7style/css/common/multishow.css",(function(){})),Core.Dom.addHTML(document.body,layerHtml),_addEvent($E(layerNodesId.multiPicClose),hideLayer),_addEvent($E(layerNodesId.multiPicPre),prePic),_addEvent($E(layerNodesId.multiPicNext),nextPic),_addEvent(document,(function(e){if(!isHidden){var direction=$E(layerNodesId.multiPicEntity).getAttribute("direction");37!==e.keyCode||isTJShow&&"pre"===direction?39!==e.keyCode||isTJShow&&"next"===direction||nextPic():prePic()}}),"keydown"),_addEvent($E(layerNodesId.multiPicTitle),(function(e){Core.Events.stopBubble(e)})),_addEvent($E(layerNodesId.multiPicContent),(function(e){Lib.util.getActionData(e,"show-large-layer")&&($E(layerNodesId.orignalPic).style.visibility="inherit")}),"mouseover"),_addEvent($E(layerNodesId.multiPicContent),(function(e){if(Lib.util.getActionData(e,"show-large-layer")){var toEl=e.toElement||e.relatedTarget,fromEl=e.srcElement||e.target;toEl&&"A"===toEl.nodeName.toUpperCase()&&"IMG"===fromEl.nodeName.toUpperCase()||hideOrignalLink()}}),"mouseout"),_addEvent(window,(function(evt){if(!isHidden){var winSize=getWinSize();document.body;setTimeout((function(){var currentSize=getWinSize();currentSize.height===winSize.height&&currentSize.width===winSize.width&&(updateWinPosAndSize($E(layerNodesId.multiPicEntity)),setTimeout((function(){var winSize=getWinSize(),el=null;isTJShow?tjCover&&!tjCover.isHidden&&tjCover.fixPos():((el=getCurrentPic())&&setCurrentPicSize(winSize,el),el&&setCurrentPicPos($E(layerNodesId.multiPicContent),el))}),25))}),80)}}),"resize");var imgContainer=null,loginUi=null;Lib.checkAuthor((function(){$isLogin||(loginUi=new Lib.Login.Ui)}),"MultipleImgLayer"+(new Date).getTime());var _that={scrollTop:0,show:function(pics,link,title,isLiked,blogId,publishTime){var entityEl=$E(layerNodesId.multiPicEntity);if(entityEl&&pics.length){Lib.checkAuthor(),isTJShow=!1,imgContainer||((imgContainer=document.createElement("DIV")).id="_sile-img-box"+(new Date).getTime(),imgContainer.style.position="absolute",imgContainer.style.top="-10000px",this.imgContainer=imgContainer,document.body.appendChild(imgContainer)),hideOrignalLink(),errorCount=0,smallCount=0,title=title||"",isHidden=!1;getWinSize();$FF&&(me.scrollTop=document.documentElement.scrollTop),$IE6?document.body.setAttribute("scroll","no"):(document.documentElement.style.overflow="hidden",!$IE8&&(document.body.style.overflow="hidden")),blogId=blogId||scope.$articleid,$E(layerNodesId.multiPicEntity).setAttribute("blog-id",blogId),setTimeout((function(){mask||((mask=new Lib.OnlyShadow(.9,doc.body,"mask_mutiplepic",{zIndex:zIndex})).entity.style.zIndex=zIndex,mask.entity.style.backgroundColor="black");var currentSize=getWinSize();mask.entity.style.width=currentSize.width+"px",mask.show(),entityEl.style.display="",updateWinPosAndSize(entityEl);for(var src,tmpPics=[],i=0,len=pics.length;i<len;i++)o=pics[i],-1===(src=o.url).indexOf("sinaimg.cn/uc/myshow")&&-1===src.indexOf("img.t.sinajs.cn")&&-1===src.indexOf("simg.sinajs.cn")&&-1===src.indexOf("sinaimg.cn/small")&&-1===src.indexOf("sinaimg.cn/square")&&tmpPics.push(o);if(0<tmpPics.length?function(pics,blogId){var i,len=pics.length,winSize=getWinSize();if(_images=pics,0<len){showLoading(winSize),showBorder();var hasPos=!1;for(i=0;i<len;i++)if(_images[i].click){currentPicIndex=i,showPic(_images[i],len,i),hasPos=!0;break}hasPos||(currentPicIndex=0,showPic(_images[0],len,0)),loadingNextPic(_images,3),loadingNextPic(_images,-3)}else hideLayer()}(tmpPics):showTooSmall(),link){var blogHref="string"!=typeof link?link.href:link,blogLink=$E(layerNodesId.multiPicTitle);blogLink.href=blogHref,blogLink.innerHTML="",blogLink.setAttribute("publish-time",encodeURIComponent(publishTime));var text=document.createTextNode(Core.String.trim(title)||"查看原文");blogLink.appendChild(text);var likeBtn=$E(layerNodesId.multiPicLike);likeBtn.setAttribute("blog-id",blogId),isLiked?(likeBtn.className="ico_unlike ico_liked",likeBtn.innerHTML="已喜欢"):(likeBtn.className="ico_unlike",likeBtn.innerHTML="喜欢")}}),25)}},getNextSlideData:function(blogId,publishTime,callBack,action){var me=this;Utils.Io.JsLoad.request("//control.blog.sina.com.cn/riaapi/article/getArticlePrevNextPic.php?rnd="+Math.random(),{GET:{blog_id:blogId,blog_pubdate:publishTime,uid:$UID||"",action:action||""},onComplete:function(data){"A00006"===data.code?me.data=data.data:me.data={pre:{},next:{}},callBack&&callBack(me.data)},onException:function(){}})},setDirection:function(direction){$E(layerNodesId.multiPicEntity).setAttribute("direction",direction)},showNextSlide:function(blogId){var data=this.data;if(data){var blogInfo;for(var p in this.recordPV(blogId),data)if((blogInfo=data[p])&&blogId===blogInfo.blogId)break;if(blogInfo){for(var url,link="//blog.sina.com.cn/s/blog_"+blogInfo.blogId+".html",pics=[],i=blogInfo.images.length-1;i>=0;i--)url=blogInfo.images[i],pics.unshift({url:url,loaded:0,click:0});this.show(pics,link,blogInfo.title,blogInfo.isLiked,blogInfo.blogId,blogInfo.publishTime),tjCover&&tjCover.hide()}}},recordPV:function(blogId){if(blogId!==scope.$articleid){var img=new Image,rnd=parseInt(1e3*Math.random()),imgSrc="//comet.blog.sina.com.cn/api?maintype=hits&act=4&aid="+blogId+"&ref="+encodeURIComponent(location.href)+"&rnd="+rnd;img.src=imgSrc,window["log_pv"+rnd]=img,img.onload=img.onerror=function(){window["log_pv"+rnd]=null,img=null}}},hide:function(){hideLayer()},destroy:function(){hideLayer(),showScroller(),document.body.removeChild($E(layerNodesId.multiPicEntity)),layerHtml=null,_images=null,layerNodesId=null,tjCover&&(tjCover.destroy(),tjCover=null)}};Lib.apply(this,_that)},$registJob("showSlideBox",(function(sandBox){var __getActionData=Lib.util.getActionData,__addEvent=Core.Events.addEvent,regex=/([^\/]+)$/,showSlideBox=function(imgUrls,blogLinkEl,title,isLiked,articleid,publishTime){Lib.sendSuda((function(){try{SUDA.log("","blog_slide_page")}catch(e){}})),Lib.diYuanXinLog((function(){try{vjEventTrack("")}catch(e){}})),(new Article.MultipleImgLayer).show(imgUrls,blogLinkEl,title,isLiked,articleid,publishTime)},getImgObj=function(src,currentHref,picName){var isBlank=src===currentHref,obj=null,isFace=function(src){return-1!==src.indexOf("sinaimg.cn/uc/myshow")||-1!==src.indexOf("img.t.sinajs.cn")||-1!==src.indexOf("simg.sinajs.cn")||-1!==src.indexOf("sinaimg.cn/small")||-1!==src.indexOf("sinaimg.cn/square")}(src);return-1!==src.indexOf("/blog7style")||-1!==src.indexOf("sg_trans.gif")||isBlank||isFace||(obj={url:src,loaded:0,click:picName===src.match(regex)[1].replace(/\&amp;690/,"&690")}),obj};__addEvent(document.body,(function(e){var datas=__getActionData(e,"show-slide");if(datas){Core.Events.stopDefaultEvent(e);var realSrc,img,picName,articleid=scope.$articleid,currentHref=location.protocol+"//"+location.host+location.pathname,imgUrls=[],pageId=scope.$pageid;if("undefined"!=typeof SUDA&&SUDA.uaTrack("blog_article","h_article19"),"article"===pageId||"articleM"===pageId||"article_new"==pageId||"articleM_new"==pageId){var likeEl=$E("dbox_"+articleid),blogLinkEl=location.href,titleEl=$E("t_"+articleid),title=titleEl.innerText||titleEl.textContent,isLiked=/\bupBox_dis\b/.test(likeEl.className),imgs=$T($E("sina_keyword_ad_area2"),"img"),clickPicSrc=decodeURIComponent(datas.data);for(picName=clickPicSrc.match(regex)[1],i=0,l=imgs.length;i<l;i++){if((realSrc=(img=imgs[i]).getAttribute("real_src"))===(src=img.getAttribute("src"))){var badWidth=img.width>1&&img.width<200,badHeight=img.height>1&&img.height<200;if(badWidth&&badHeight)continue}var obj=getImgObj(src=realSrc||src,currentHref,picName);obj&&imgUrls.push(obj)}var timeEl,spanEls=$T(document.body,"span");if(!(publishTime=scope.$publishTime)){for(var i=spanEls.length-1;i>=0;i--)if("time SG_txtc"===(timeEl=spanEls[i]).className){publishTime=timeEl.innerText||timeEl.textContent;break}publishTime=publishTime.replace("(","").replace(")","")}showSlideBox(imgUrls,blogLinkEl,title,isLiked,scope.$articleid,publishTime)}else{var params=datas.data.split("&"),src=decodeURIComponent(params[0]),blogId=decodeURIComponent(params[1]),link=decodeURIComponent(params[2]),publishTime=(title=decodeURIComponent(params[3]),decodeURIComponent(params[4]));Utils.Io.JsLoad.request("//control.blog.sina.com.cn/riaapi/article/getArticlePic.php?rnd="+Math.random(),{GET:{blog_id:blogId,blog_pubdate:publishTime,uid:$UID||""},onComplete:function(result){if("A00006"===result.code){var data=result.data,imgs=data.images;for(picName=src.match(regex)[1],i=0,l=imgs.length;i<l;i++){src=imgs[i];var obj=getImgObj(src,currentHref,picName);obj&&imgUrls.push(obj)}showSlideBox(imgUrls,link,title,data.isLiked,blogId,data.publishTime)}},onException:function(){}})}}}))})),$registJob("showSlideBtn",(function(sandBox){var wrapLeft,foreach=Core.Array.foreach,pageid=scope.$pageid,isArt="article"==pageid||"articleM"==pageid||"article_new"==pageid||"articleM_new"==pageid,wrap=(scope.$uid,$E("sina_keyword_ad_area2")||document.body),fixAutoHover=1,__addEvent=Core.Events.addEvent,slideWrapper=SinaEx.createNode('<div style="left: -1000px; top: -1000px;position:absolute;" class="picSlideBtn" action-type="show-slide" action-data="http%3A%2F%2Fww4.sinaimg.cn%2Flarge%2F697db644jw1dw1s1zljvaj.jpg"><a href="javascript:void(0);">幻灯播放</a></div>');function fnover(){if(this.width<200&&this.height<200)return!1;var src=this.getAttribute("real_src")||this.getAttribute("src");this.setAttribute("action-data",encodeURIComponent(src)),this.setAttribute("action-type","show-slide");var left=Core.Dom.getXY(this)[0]+10;left=Math.min(left,wrapLeft-134),slideWrapper.style.left=left+"px",slideWrapper.style.top=Core.Dom.getXY(this)[1]+10+"px",fixAutoHover&&(slideWrapper.style.display="",slideWrapper.setAttribute("action-data",encodeURIComponent(this.src)))}function fnout(){if(this.width<200&&this.height<200)return!1;var e=Core.Events.getEvent(),et=e.relatedTarget||e.toElement;et&&Core.Dom.contains(slideWrapper,et)||(slideWrapper.style.display="none")}function bindEvent(img){__addEvent(img,fnover.bind2(img),"mouseover"),__addEvent(img,fnout.bind2(img),"mouseout")}function bindFn(img){if(!function(img){var src=img.getAttribute("real_src")||img.getAttribute("src")||"";return-1!==src.indexOf("sinaimg.cn/uc/myshow")||-1!==src.indexOf("img.t.sinajs.cn")||-1!==src.indexOf("simg.sinajs.cn")||-1!==src.indexOf("sinaimg.cn/small")||-1!==src.indexOf("sinaimg.cn/square")}(img)&&Core.Dom.contains(wrap,img)){getWrapLeft();var pnLink=function(node){if(!isArt)return null;for(;node=node.parentNode;)if("A"==node.nodeName.toUpperCase())return node;return null}(img);if(!pnLink||-1!==pnLink.href.indexOf("photo.blog.sina.com.cn")){var isDefault=-1!==img.getAttribute("src").indexOf("sg_trans.gif");img.complete&&!isDefault?bindEvent(img):img.onload=function(){bindEvent(this);var src=this.getAttribute("real_src"),currentSrc=this.getAttribute("src");src||src!==currentSrc||(img.onload=null)}.bind2(img)}}}function getWrapLeft(){wrapLeft=Core.Dom.getXY(wrap)[0]+wrap.clientWidth}document.body.appendChild(slideWrapper),Core.Events.addEvent(window,getWrapLeft,"resize"),fixAutoHover=1,foreach($T(wrap,"img"),(function(img){bindFn(img)})),scope.showPicSlide=function(img,src){bindFn(img)}})),$registJob("userDetect",(function(){var whiteList={cn:{sinajs:1,sina:1,weibo:1,bshare:1,com:{sina:1,msn:1}},com:{sina:1,baidu:1,allyes:1,weibo:1,qq:1,google:1,msn:1,163:1}},sendHosts=[],checkHost=function(tagEls,tree,sendHost){for(var src="",reg=/http\:\/\/([^\/]+)/,illegalHosts=[],_contain=Core.Array.findit,i=(sendHost=sendHost||[],0),len=tagEls.length;i<len;i++)if((src=tagEls[i].src)&&reg.test(src))for(var host=src.match(reg)[1],leafs=host.split("."),whiteLeaf=tree,l=leafs.length-1;l>-1&&1!==(whiteLeaf=whiteLeaf[leafs[l]]);l--)if(null==whiteLeaf){-1===_contain(sendHost,host)&&illegalHosts.push(host);break}return illegalHosts},sendHost=function(hosts){hosts.length&&Utils.Io.JsLoad.request("//control.blog.sina.com.cn/riaapi/blogDetect.php",{GET:{uDomain:hosts.join(","),type:100},onComplete:function(){},onException:function(){},timeout:3e4})},jsHosts=checkHost($T(document,"script"),whiteList),iframeHosts=checkHost($T(document,"iframe"),whiteList);(sendHosts=jsHosts.concat(iframeHosts)).length&&sendHost(sendHosts);var count=1,delay=10,limit=9;setTimeout((function(){if(count>limit)return count=1,delay=100,void(limit=6);var jsHosts=checkHost($T(document,"script"),whiteList,sendHosts),iframeHosts=checkHost($T(document,"iframe"),whiteList,sendHosts),currentHosts=jsHosts.concat(iframeHosts);currentHosts.length&&(sendHost(currentHosts),sendHosts=sendHosts.concat(currentHosts)),count++,args=arguments,setTimeout((function(){args.callee.apply(null,args)}),Math.pow(2,count)*delay)}),30+Math.pow(2,count)*delay)})),Lib.countOSLink=function(linkInfo){for(var j,blogid,uid,clinks,href,__addEvent=Core.Events.addEvent,rBlogLink=/^http:\/\/[\w\.]*?blog.sina.com.cn/i,i=linkInfo.length;i--;)for(blogid=linkInfo[i].blogid,uid=linkInfo[i].uid,j=(clinks=linkInfo[i].container?$T(linkInfo[i].container,"a"):document.links).length;j--;)!(href=clinks[j].href)||href.match(rBlogLink)||href.indexOf("javascript:")>-1||function(bid,a,url,uid){__addEvent(a,bid?function(){commonLog("//interface.blog.sina.com.cn/riaapi/article/click_url.php?blogid="+bid+"&url="+encodeURIComponent(url))}:function(){commonLog("//interface.blog.sina.com.cn/riaapi/article/click_url.php?uid="+uid+"&url="+encodeURIComponent(url))}),a=null}(blogid,clinks[j],href,uid);clinks=null,__addEvent=null},$registJob("osl_article",(function(){Lib.countOSLink([{blogid:scope.$articleid||"",container:$E("sina_keyword_ad_area2")}])})),Lib.classUtils=function(){},Lib.classUtils.prototype.addClass=function(dom,clz){if(!dom)return!1;this.hasClass(dom,clz)||(dom.className=Core.String.trim(dom.className.concat(" "+clz)))},Lib.classUtils.prototype.delClass=function(dom,clz){if(!dom)return!1;var reg=new RegExp("( +|^)"+clz+"(?=( |$))","ig");dom.className=Core.String.trim(dom.className.replace(reg,""))},Lib.classUtils.prototype.hasClass=function(dom,clz){return!!dom&&new RegExp("( +|^)"+clz+"(?=( |$))","ig").test(dom.className)},"8_52"===scope.tpl&&Lib.checkAuthor((function(){!function(){var div=$C("div");div.className="module365",div.style.position="absolute",div.style.top="0px",div.style.right="0px",div.style.zIndex="200",div.innerHTML='<ul id="blog365_calCon"><li class="d1"><div class="pic"></div></li><li class="d2"><div class="pic"></div></li><li class="d3"><div class="pic"></div></li><li class="d4"><div class="pic"></div></li><li class="d5"><div class="pic"></div></li><li class="d6"><div class="pic"></div></li><li class="d7"><div class="pic"></div></li><li class="d8"><div class="pic"></div></li><li class="d9"><div class="pic"></div></li><li class="d10"><div class="pic"></div></li><li class="d11"><div class="pic"></div></li><li class="d12"><div class="pic"></div></li><li class="d13"><div class="pic"></div></li><li class="d14"><div class="pic"></div></li><li class="d15"><div class="pic"></div></li><li class="d16"><div class="pic"></div></li><li class="d17"><div class="pic"></div></li><li class="d18"><div class="pic"></div></li><li class="d19"><div class="pic"></div></li><li class="d20"><div class="pic"></div></li><li class="d21"><div class="pic"></div></li><li class="d22"><div class="pic"></div></li><li class="d23"><div class="pic"></div></li><li class="d24"><div class="pic"></div></li><li class="d25"><div class="pic"></div></li><li class="d26"><div class="pic"></div></li><li class="d27"><div class="pic"></div></li><li class="d28"><div class="pic"></div></li><li class="d29"><div class="pic"></div></li><li class="d30"><div class="pic"></div></li><li class="d31"><div class="pic"></div></li><li class="actpage"><div class="pic"><a title="活动页" target="_blank" href="//qing.blog.sina.com.cn/tag/365"></a></div></li></ul><div class="wdate" id="blog365_dateNum"></div>',$E("headarea")&&$E("headarea").appendChild(div);var children=$E("blog365_calCon")&&$E("blog365_calCon").children,now=new Date,day=now.getDate(),year=now.getFullYear(),month=now.getMonth()+1,t1=now.getTime(),t2=new Date(year,0,1).getTime(),time=t1-t2;if(time=0==time?1:Math.floor(time/864e5)+1,$E("blog365_dateNum").innerHTML=time,$isAdmin){var today=children[day-1];todayDiv=today.getElementsByTagName("div")[0],today.className+=" today";var html='<a onclick="v7sendLog(\'48_01_22\')" href="//control.blog.sina.com.cn/admin/article/article_add.php?tag365" target="_blank"><span class="rectoday" title="记录今天"></span></a>';todayDiv.innerHTML=html;for(var monthDays=function(y,m){var isLeap=function(y){return y%400?y%100?y%4?0:1:0:1};if(!y*m)return 0;var d=31;switch(m){case 4:case 6:case 9:case 11:d=30;break;case 2:d=isLeap(y)?29:28}return d}(year,month),j=day;j<monthDays;j++){var child=children[j],childDiv=child.getElementsByTagName("div")[0];child.className+=" coming",html='<a onclick="v7sendLog(\'48_01_23\')" href="//control.blog.sina.com.cn/admin/article/article_add.php?tag365='+year+"-"+month+"-"+(j+1)+'" target="_blank"><span class="tq">提前<br>记录</span></a>',childDiv.innerHTML=html}}}(),Utils.Io.JsLoad.request("//control.blog.sina.com.cn/riaapi/activity/get_blog365.php?data=1",{GET:{uid:scope.$uid||""},onComplete:function(result){result.code&&"A00006"===result.code&&function(data){var children=$E("blog365_calCon")&&$E("blog365_calCon").children,now=new Date,day=now.getDate();for(var item in now.getFullYear(),now.getMonth(),data){var i=item.split("-")[2]-1,child=children[i],childDiv=child.getElementsByTagName("div")[0];if(data[item].pre&&data[item].href){child.className="d"+(i+1)+" writed";var html="";$isAdmin&&(html='<a href="'+data[item].href+'" target="_blank" ><span class="date">'+(i+1)+"日</span></a>",childDiv.innerHTML=html),childDiv.innerHTML=html}else{var href;i===day-1&&(child.className="d"+day),href=data[item].href?data[item].href:"javascript:void(0);",target=data[item].href?"_blank":"",html=data[item].src&&data[item].src.indexOf("sinaimg.cn")>=0?'<a href="'+href+'" target="'+target+'"><img src="'+data[item].src+'"/><span class="date">'+(i+1)+"日</span></a>":'<a href="'+href+'" target="'+target+'"><span class="date">'+(i+1)+"日</span></a>",childDiv.innerHTML=html}}}(result.data)}})}),"templateCanlendar"+(new Date).getTime()),$registJob("loginStatus",(function(){var _getCookie=Utils.Cookie.getCookie,_setCookie=Utils.Cookie.setCookie,statusUid=_getCookie("_s_loginStatus"),loginUid=_getCookie("_s_loginuid");Lib.checkAuthor((function(){if($isLogin){if(loginUid===$UID)return}else if(!statusUid||statusUid===loginUid)return;_setCookie("_s_loginuid",$UID||statusUid,24-(new Date).getHours(),"","blog.sina.com.cn");var url="//control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}})}),"loginStatus"+(new Date).getTime())})),$registJob("padSwitch",(function(){var ua=navigator.userAgent,isiPad=/(iPad).*OS\s([\d_]+)/.test(ua),_addevent=Core.Events.addEvent,url=window.location.href;isiPad&&(Core.Dom.insertHTML($E("sinablogfooter"),'<div class="webSelect"><a id="sw_web" class="current" href="javascript:void(0);">电脑版</a><a id="sw_pad" href="javascript:void(0)">PAD版</a></div>',"AfterBegin"),_addevent($E("sw_pad"),(function(e){var name,Then;e.target.className="current",Core.Dom.removeClass($E("sw_web"),"current"),name="ipad4web",(Then=new Date).setTime(Then.getTime()-1),document.cookie=name+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+Then.toGMTString(),url=url.replace("blog","m.blog"),window.location.href=url})))})),$registJob("loginFollow",(function(){Lib.checkAuthor((function(){var loginFollow=$E("loginFollow"),onceloggedonblog=unescape(Utils.Cookie.getCookie("onceloggedonblog")),userInfo=Lib.Login.info(),uid=userInfo.uid,nick=userInfo.nick;if(loginFollow&&onceloggedonblog&&!$isLogin&&uid&&nick&&uid!==scope.$uid){var tpl='<div class="loginFollow"><div class="con"><p id="#{loginFollowCon}"></p><div class="btm"><a id="#{loginBtn}" href="javascript:void(0);" class="btn" title="登录并关注"></a><span>还没有博客账号？点此<a href="https://login.sina.com.cn/signup/signupmail.php?entry=blog&r=&srcuid=&src=blogicp" target="_blank" onclick="v7sendLog(\'44_01_03_'+uid+"')\">注册</a>一个</span></div></div></div>",nodes=Utils.insertTemplate(loginFollow,tpl,"BeforeEnd");nodes.loginFollowCon.innerHTML="Hi，"+nick+"！我是"+(scope.owenerNickName||$E("ownernick").innerHTML.replace(/(\r|\n)/g,""))+"。  现在就登录关注我的博客，不要错过我的任何更新！",v7sendLog("44_01_01_"+uid);var trayLogin=new Lib.Login.Ui;Core.Events.addEvent(nodes.loginBtn,(function(){v7sendLog("44_01_02_"+uid),trayLogin.login((function(){v7sendLog("44_01_04_"+uid),Lib.Component.Attention($UID,scope.$uid,(function(){location.reload()}))}))}),"click")}}),"loginFollow"+(new Date).getTime())})),$registJob("blogTip",(function(){Lib.Listener.on({name:"article-msg-loaded",callBack:function(data){onDataComplete(data)},scope:this});var uid="",cid="",NickName="",UserPicUrl="",onDataComplete=function(json){if(json){if(json.cms_id==cid)return;!function(_uid){uid=_uid;var size=size||50,n=parseInt(_uid)%8+1;UserPicUrl="//portrait"+n+".sinaimg.cn/"+_uid+"/blog/"+size}(json.uid),cid=json.cms_id+"",NickName=json.nick_name,creatTip(),showTip()}},creatTip=function(){if(!$E("blogTip")){Core.Dom.addHTML(document.body,'<div id="blogTip" class="mDynaState" style="position:fixed;z-index:300; left:580px; top:92px; opacity:0.0;"><div class="con"><a onclick="v7sendLog(\'40_01_47\')" href="###"><img id="UIMG" width="30" height="30" alt=""></a><a href="###" onclick="v7sendLog(\'40_01_47\')" id="NName" class="nickname"></a>刚刚对此博文进行了评论<span id="blogTipShowBtn">,<a href="###" onclick="v7sendLog(\'40_01_46\')">查看</a></span></div><a href="###" onclick="v7sendLog(\'40_01_48\');" class="close" title="关闭" id="blogTip_closeBtn">×</a></div>');var xy=Core.Dom.getXY($E("sinabloga"));$E("blogTip").style.top=xy[1]+"px",Core.Events.addEvent(blogTip,(function(){(hideTip(),$E("article_comment_list").childNodes[0].childNodes.length<1)?((new Comment.List).load(1),scope.$comment_is_load_page_1=1,setTimeout(checkCMS,1e3)):checkCMS();Core.Events.stopEvent()}),"click"),Core.Events.addEvent(blogTip_closeBtn,(function(){hideTip(),Core.Events.stopEvent()}),"click"),Core.Events.addEvent(UIMG,(function(){window.open("//blog.sina.com.cn/u/"+uid),hideTip(),Core.Events.stopEvent()}),"click"),Core.Events.addEvent(NName,(function(){window.open("//blog.sina.com.cn/u/"+uid),hideTip(),Core.Events.stopEvent()}),"click")}$E(UIMG).src=UserPicUrl;for(var nickNameLength=0,a=NickName.split(""),flag=0,i=0;i<a.length;i++)a[i].charCodeAt(0)<299?nickNameLength+=.75:nickNameLength+=1,nickNameLength>=8&&0==flag&&(flag=i);$E(NName).innerHTML=flag>0?NickName.substr(0,flag)+"...":NickName,$E("blogTipShowBtn").style.display=cid?"":"none"},checkCMS=function(){if($E("cmt_"+cid))changeHASH();else{var url="//control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/getCms.php?uid="+scope.$uid+"&cms_id="+cid;Utils.Io.JsLoad.request(url,{onComplete:function(result){result&&"A00006"===result.code&&(result.data.cid=cid,addCMS(result.data))},onException:function(){location.hash="commonComment"},timeout:3e3})}},addCMS=function(data){var $container=$E("article_comment_list"),comment=new CommentV2.Add,item=data;item.action_data=Utils.Json.flatten({articleid:scope.$articleid,commentid:item.id,fromProduct:item.fromProduct,comm_uid:item.uid,uname:item.nick_name,ulink:item.ulink,src_uid:item.src_uid,cms_reply_num:item.cms_reply_num}),item.uname=item.nick_name,item.action_data=encodeURIComponent(item.action_data);var $li=comment.render(item);$container.insertBefore($li,$container.firstChild),changeHASH()},changeHASH=function(){location.hash="cmt_"+cid},showTip=function(){v7sendLog("40_01_45"),$E("blogTip").style.display="";var tween=new Ui.TweenStrategy(0,1,.5);tween.onTween=function(value){Core.Dom.setStyle($E("blogTip"),"opacity",value)},tween.onEnd=function(){tween=null,setTimeout(hideTip,5e3)},tween.start()},hideTip=function(){var tween=new Ui.TweenStrategy(1,0,.5);tween.onTween=function(value){Core.Dom.setStyle($E("blogTip"),"opacity",value)},tween.onEnd=function(){tween=null,$E("blogTip").style.display="none"},tween.start()}})),$registJob("uatrack",(function(){Lib.sendSuda((function(){var pageid=scope.$pageid,_byClass=Core.Dom.byClass;switch(pageid){case"editor":_byClass("msnTips_lx","div")&&(v7sendLog("41_01_05"),SUDA.uaTrack("blog_post","v_post1"));break;case"article":case"articleM":var btjblog=$E("module_909"),blogxg=$E("module_903"),tjblog=$E("module_904");btjblog&&SUDA.uaTrack("blog_btjblog","v_btjblog"),blogxg&&SUDA.uaTrack("blog_xg","v_blogxg"),tjblog&&SUDA.uaTrack("blog_tjblog","v_tjblog")}}))})),$registJob("xgBlogAD",(function(){var bodyWrapper,secondLi,moreWrapper,newVersion="articleM_new"==scope.$pageid||"article_new"==scope.$pageid,$getByClass=Core.Dom.getElementsByClass,$insertHTML=Core.Dom.insertHTML,xgWrap=$E("module_903"),adTpl_common1='<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="//blog.sina.com.cn/u/{{uid}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>',adTpl_common2='<li class="reco_bloglist_con"><span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{a_title}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="//blog.sina.com.cn/u/{{uid}}" target="_blank">{{author}}</a></span></li>',adTpl_common3='<li><p class=Ltit><a {{a_c_suda}} class="BNE_lkA" href="{{a_href}}" target="_blank" title="{{a_title}}"><i class="icon i7_dot"></i>{{a_title}}</a></p><p class="Lname"><a {{a_c_suda}} class="BNE_lkB" href="//blog.sina.com.cn/u/{{uid}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>';function tplToData(template,data){var t,key,reg;for(key in data)reg=new RegExp("{{"+key+"}}","ig"),t=(t||template).replace(reg,data[key]);return t}"articletj"==scope.$pageid?(bodyWrapper=$getByClass(xgWrap,"div","SG_connBody"),secondLi=$getByClass(bodyWrapper[0],"li","reco_bloglist_con")[1]):newVersion?(bodyWrapper=$getByClass(xgWrap,"ul","crlaList"),secondLi=$getByClass(bodyWrapper[0],"li","")[1]):(bodyWrapper=$getByClass(xgWrap,"div","SG_connBody"),secondLi=$getByClass(bodyWrapper[0],"li","SG_j_linedot1")[1]),secondLi&&Lib.checkAuthor((function(){Utils.Io.JsLoad.request("//comet.blog.sina.com.cn/api?maintype=pagexg",{GET:{id:"SLOT_89",uid:$UID||0,blogerid:scope.$uid||0},onComplete:function(res){var data=null;if(res.SLOT_89&&(data=res.SLOT_89.res[0]),data){if("articletj"==scope.$pageid){var htmlxg2=tplToData('<li class="reco_bloglist_con"><span class="blogname"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></span><span class="bloguser"><a {{a_c_suda}} onclick="v7sendLog(\'41_01_07\');" class="SG_linkb" href="{{a_href}}" target="_blank">{{author}}</a></span></li>',data);$insertHTML(secondLi,htmlxg2,"AfterEnd")}else if(newVersion){var htmlxg3=tplToData('<li><p class=Ltit><a {{a_c_suda}} class="BNE_lkA" href="{{a_href}}" target="_blank" title="{{a_title}}"><i class="icon i7_dot"></i>{{words}}</a></p><p class="Lname"><a {{a_c_suda}} class="BNE_lkB" href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>',data);$insertHTML(secondLi,htmlxg3,"AfterEnd")}else{var htmlxg1=tplToData('<li class="SG_j_linedot1"><p class="atcTitCell_tit SG_dot"><a {{a_c_suda}} href="{{a_href}}" target="_blank" title="{{a_title}}">{{words}}</a></p><p class="atcTitCell_nm"><a {{a_c_suda}} href="{{a_href}}" class="SG_linkb" target="_blank">{{author}}</a></p></li>',data);$insertHTML(secondLi,htmlxg1,"AfterEnd")}SUDA&&SUDA.uaTrack(data.a_v_suda_key,data.a_v_suda_value)}!function(){var articleId=scope.$articleid,cateId=scope.$cate_id,sortId=scope.$sort_id;if(articleId){var url="//blog.sina.com.cn/s/related_"+articleId+".js",reqdata={cate_id:cateId,sort_id:sortId};if(bodyWrapper=newVersion?$getByClass(xgWrap,"ul","crlaList"):$getByClass(xgWrap,"div","SG_connBody"),moreWrapper=$getByClass(xgWrap,"div",newVersion?"more":"atcTit_more"),("articletj"==scope.$pageid?$getByClass(bodyWrapper[0],"li","reco_bloglist_con").length:newVersion?$getByClass(bodyWrapper[0],"li","").length:$getByClass(bodyWrapper[0],"li","SG_j_linedot1").length)>3)return;Utils.Io.Ajax.request(url,{returnType:"json",GET:reqdata,onComplete:function(res){var res2=res.slideReads;if(res=res.relatedReads,"articletj"==scope.$pageid){if(ulNode=$getByClass(bodyWrapper[0],"ul","reco_bloglist have_user")[0])for(var i=0;i<res.length;i++){var htmlcommon2=tplToData(adTpl_common2,res[i]);$insertHTML(ulNode,htmlcommon2,"BeforeEnd")}}else if(newVersion){if(ulNode=bodyWrapper[0])for(i=0;i<res.length;i++){var htmlcommon3=tplToData(adTpl_common3,res[i]);$insertHTML(ulNode,htmlcommon3,"BeforeEnd")}}else{var ulNode;if(ulNode=$getByClass(bodyWrapper[0],"ul","")[0])for(i=0;i<res.length;i++){var htmlcommon1=tplToData(adTpl_common1,res[i]);$insertHTML(ulNode,htmlcommon1,"BeforeEnd")}}var moreNode=$getByClass(moreWrapper[0],"a","")[0];moreNode&&("111"==sortId?moreNode.setAttribute("href","//finance.sina.com.cn/blog/8.html"):"153"==sortId&&moreNode.setAttribute("href","//finance.sina.com.cn/blog/2.html")),"function"==typeof window.scope.___fnForListenerSlot?window.scope.___fnForListenerSlot(res2):window.scope.___fnForListenerSlot=res2},onException:function(res){}})}}()},onException:function(res){}})}),"xgBlogAD"+(new Date).getTime())})),Lib.register("blogAppAd",(function(lib){lib.execZhitou((function(){!function(){Core.Dom.insertHTML(document.body,'<div id="sinaads_pdps54771"></div>',"beforeend");var cookieKeyName="sinaads_blogAppAd_"+scope.$PRODUCT_NAME+scope.$pageid;if(-1===document.cookie.indexOf(cookieKeyName)){document.getElementById("sinaads_pdps54771").innerHTML=' <ins class="sinaads" data-ad-pdps="PDPS000000054771"></ins>  ',(sinaads=window.sinaads||[]).push({params:{sinaads_ls_root:"sinablogbody",sinaads_ls_cookieKey:cookieKeyName}});var expires=new Date;expires.setTime(expires.getTime()+864e5),document.cookie="blogAppAd_"+scope.$PRODUCT_NAME+scope.$pageid+"=1; expires="+expires.toGMTString()}}()}));var ad=new(0,lib.Panel);return ad.init=function(root){return},ad})),$registJob("blogAppAd",(function(){Lib.blogAppAd.init("sinablogbody")})),$registJob("articleMaxImg",(function(){var pageid=scope.$pageid,getElementsByClass=Core.Dom.getElementsByClass,getStyle=Core.Dom.getStyle;function setMax(img,max,width){setTimeout((function(){img.width>width&&("max-width"in img.style?img.style["max-width"]=max:img.style.width=max),1==img.width&&setMax(img,max,width)}),100)}function setImgMax(contents,max){if(contents&&contents[0])for(var width=parseInt(getStyle(contents[0],"width"),10),i=0;i<contents.length;i++)for(var imgs=contents[i].getElementsByTagName("img"),k=0;k<imgs.length;k++){setMax(imgs[k],max,width)}}"indexM"==pageid||"index"==pageid?setImgMax(getElementsByClass($E("module_10001_SG_connBody"),"div","content"),"100%"):"articleM"!=pageid&&"article"!=pageid||setImgMax([$E("sina_keyword_ad_area2")],"100%")}));